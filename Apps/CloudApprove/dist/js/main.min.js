/* Zepto v1.2.0 - zepto event ajax form ie - zeptojs.com/license */

//     Zepto.js
//     (c) 2010-2016 Thomas Fuchs
//     Zepto.js may be freely distributed under the MIT license.

/**
 * mOxie - multi-runtime File API & XMLHttpRequest L2 Polyfill
 * v1.2.1
 *
 * Copyright 2013, Moxiecode Systems AB
 * Released under GPL License.
 *
 * License: http://www.plupload.com/license
 * Contributing: http://www.plupload.com/contributing
 *
 * Date: 2014-05-14
 */

/**
 * Plupload - multi-runtime File Uploader
 * v2.1.2
 *
 * Copyright 2013, Moxiecode Systems AB
 * Released under GPL License.
 *
 * License: http://www.plupload.com/license
 * Contributing: http://www.plupload.com/contributing
 *
 * Date: 2014-05-14
 */

define("md5",["require"],function(e){var t=function(e,t){return e<<t|e>>>32-t},i=function(e,t){var i,n,a,o,s;return a=2147483648&e,o=2147483648&t,i=1073741824&e,n=1073741824&t,s=(1073741823&e)+(1073741823&t),i&n?2147483648^s^a^o:i|n?1073741824&s?3221225472^s^a^o:1073741824^s^a^o:s^a^o},n=function(e,t,i){return e&t|~e&i},a=function(e,t,i){return e&i|t&~i},o=function(e,t,i){return e^t^i},s=function(e,t,i){return t^(e|~i)},r=function(e,a,o,s,r,l,c){return e=i(e,i(i(n(a,o,s),r),c)),i(t(e,l),a)},l=function(e,n,o,s,r,l,c){return e=i(e,i(i(a(n,o,s),r),c)),i(t(e,l),n)},c=function(e,n,a,s,r,l,c){return e=i(e,i(i(o(n,a,s),r),c)),i(t(e,l),n)},p=function(e,n,a,o,r,l,c){return e=i(e,i(i(s(n,a,o),r),c)),i(t(e,l),n)},d=function(e){for(var t,i=e.length,n=i+8,a=(n-n%64)/64,o=16*(a+1),s=Array(o-1),r=0,l=0;l<i;)t=(l-l%4)/4,r=l%4*8,s[t]=s[t]|e.charCodeAt(l)<<r,l++;return t=(l-l%4)/4,r=l%4*8,s[t]=s[t]|128<<r,s[o-2]=i<<3,s[o-1]=i>>>29,s},h=function(e){var t,i,n="",a="";for(i=0;i<=3;i++)t=e>>>8*i&255,a="0"+t.toString(16),n+=a.substr(a.length-2,2);return n},u=function(e){e=e.replace(/\x0d\x0a/g,"\n");for(var t="",i=0;i<e.length;i++){var n=e.charCodeAt(i);n<128?t+=String.fromCharCode(n):n>127&&n<2048?(t+=String.fromCharCode(n>>6|192),t+=String.fromCharCode(63&n|128)):(t+=String.fromCharCode(n>>12|224),t+=String.fromCharCode(n>>6&63|128),t+=String.fromCharCode(63&n|128))}return t};return function(e){var t,n,a,o,s,f,g,m,y,v=Array(),w=7,x=12,b=17,_=22,D=5,I=9,S=14,C=20,T=4,k=11,R=16,$=23,L=6,A=10,E=15,P=21;for(e=u(e),v=d(e),f=1732584193,g=4023233417,m=2562383102,y=271733878,t=0;t<v.length;t+=16)n=f,a=g,o=m,s=y,f=r(f,g,m,y,v[t+0],w,3614090360),y=r(y,f,g,m,v[t+1],x,3905402710),m=r(m,y,f,g,v[t+2],b,606105819),g=r(g,m,y,f,v[t+3],_,3250441966),f=r(f,g,m,y,v[t+4],w,4118548399),y=r(y,f,g,m,v[t+5],x,1200080426),m=r(m,y,f,g,v[t+6],b,2821735955),g=r(g,m,y,f,v[t+7],_,4249261313),f=r(f,g,m,y,v[t+8],w,1770035416),y=r(y,f,g,m,v[t+9],x,2336552879),m=r(m,y,f,g,v[t+10],b,4294925233),g=r(g,m,y,f,v[t+11],_,2304563134),f=r(f,g,m,y,v[t+12],w,1804603682),y=r(y,f,g,m,v[t+13],x,4254626195),m=r(m,y,f,g,v[t+14],b,2792965006),g=r(g,m,y,f,v[t+15],_,1236535329),f=l(f,g,m,y,v[t+1],D,4129170786),y=l(y,f,g,m,v[t+6],I,3225465664),m=l(m,y,f,g,v[t+11],S,643717713),g=l(g,m,y,f,v[t+0],C,3921069994),f=l(f,g,m,y,v[t+5],D,3593408605),y=l(y,f,g,m,v[t+10],I,38016083),m=l(m,y,f,g,v[t+15],S,3634488961),g=l(g,m,y,f,v[t+4],C,3889429448),f=l(f,g,m,y,v[t+9],D,568446438),y=l(y,f,g,m,v[t+14],I,3275163606),m=l(m,y,f,g,v[t+3],S,4107603335),g=l(g,m,y,f,v[t+8],C,1163531501),f=l(f,g,m,y,v[t+13],D,2850285829),y=l(y,f,g,m,v[t+2],I,4243563512),m=l(m,y,f,g,v[t+7],S,1735328473),g=l(g,m,y,f,v[t+12],C,2368359562),f=c(f,g,m,y,v[t+5],T,4294588738),y=c(y,f,g,m,v[t+8],k,2272392833),m=c(m,y,f,g,v[t+11],R,1839030562),g=c(g,m,y,f,v[t+14],$,4259657740),f=c(f,g,m,y,v[t+1],T,2763975236),y=c(y,f,g,m,v[t+4],k,1272893353),m=c(m,y,f,g,v[t+7],R,4139469664),g=c(g,m,y,f,v[t+10],$,3200236656),f=c(f,g,m,y,v[t+13],T,681279174),y=c(y,f,g,m,v[t+0],k,3936430074),m=c(m,y,f,g,v[t+3],R,3572445317),g=c(g,m,y,f,v[t+6],$,76029189),f=c(f,g,m,y,v[t+9],T,3654602809),y=c(y,f,g,m,v[t+12],k,3873151461),m=c(m,y,f,g,v[t+15],R,530742520),g=c(g,m,y,f,v[t+2],$,3299628645),f=p(f,g,m,y,v[t+0],L,4096336452),y=p(y,f,g,m,v[t+7],A,1126891415),m=p(m,y,f,g,v[t+14],E,2878612391),g=p(g,m,y,f,v[t+5],P,4237533241),f=p(f,g,m,y,v[t+12],L,1700485571),y=p(y,f,g,m,v[t+3],A,2399980690),m=p(m,y,f,g,v[t+10],E,4293915773),g=p(g,m,y,f,v[t+1],P,2240044497),f=p(f,g,m,y,v[t+8],L,1873313359),y=p(y,f,g,m,v[t+15],A,4264355552),m=p(m,y,f,g,v[t+6],E,2734768916),g=p(g,m,y,f,v[t+13],P,1309151649),f=p(f,g,m,y,v[t+4],L,4149444226),y=p(y,f,g,m,v[t+11],A,3174756917),m=p(m,y,f,g,v[t+2],E,718787259),g=p(g,m,y,f,v[t+9],P,3951481745),f=i(f,n),g=i(g,a),m=i(m,o),y=i(y,s);var M=h(f)+h(g)+h(m)+h(y);return M.toLowerCase()}}),define("utils",["md5"],function(e){function t(e){return"%"==e.substring(e.length-1)||"auto"==e}function i(e,t){e=parseInt(e);var i=t.width/w.baseSize.width;return i=i>1.5?1.5:i,t.width>1e3&&(i=1),parseInt(i*e)}function n(e,t){e=parseInt(e);var i=t.height/w.baseSize.height;return i=i<1?1:i,i=i>1.5?1.5:i,parseInt(i*e)}function a(e,t,a,o,s,r){if(1===o){if("fontSize"==e||"font-size"==e){t=parseInt(t);var l=s.width/w.baseSize.width;return l=l>1.5?1.5:l,s.width>1e3&&(l=1),l=l<1?1:l,parseInt(l*t)}return"width"==e||"left"==e||"right"==e||"maxWidth"==e||"marginLeft"==e||"marginRight"==e||"max-width"==e||"minWidth"==e||"min-width"==e?i(t,s):"height"==e||"top"==e||"marginBottom"==e||"marginTop"==e||"bottom"==e||"maxHeight"==e||"max-height"==e||"lineHeight"==e||"line-height"==e||"minHeight"==e||"min-height"==e?n(t,s):i(t,s)}return 0===a||2===a?n(t,s):1===a||3===a?i(t,s):i(t,s)}function o(e,i,n,o){var s=[];if(i.length>1&&i.length<4||"padding"==e||"margin"==e)if(1==i.length){var r=i[0];i=[r,r,r,r]}else i[2]?i[3]||(i[3]=i[1]):(i[2]=i[0],i[3]=i[1]);for(var l=0,c=i.length;l<c;l++){var p=i[l];t(p)||(p=a(e,p,l,c,n,o)+"px"),s.push(p)}return s.join(" ")}var s,r,l,c,p,d={},h={},u={},f={w:!0,borderRadius:!0,maxHeight:!0,lineHeight:!0,"line-height":!0,"max-height":!0,maxWidth:!0,"max-width":!0,minWidth:!0,"min-width":!0,minHeight:!0,"min-height":!0,fs:!0,top:!0,left:!0,right:!0,bottom:!0,fontSize:!0,"font-size":!0,width:!0,height:!0,padding:!0,paddingTop:!0,paddingRight:!0,paddingLeft:!0,paddingBottom:!0,"padding-bottom":!0,"padding-top":!0,"padding-left":!0,"padding-right":!0,margin:!0,marginTop:!0,marginRight:!0,marginLeft:!0,marginBottom:!0,"margin-bottom":!0,"margin-top":!0,"margin-left":!0,"margin-right":!0},g={flexShrink:"yy-fs-",flexDirection:"yy-fd-","flex-direction":"yy-fd-","flex-shrink":"yy-fs-",justifyContent:"yy-jc-","justify-content":"yy-jc-","align-items":"yy-ai-",alignItems:"yy-ai-",alignContent:"yy-ac-","align-content":"yy-ac-",alignSelf:"yy-as-","align-self":"yy-as-","flex-wrap":"yy-fw-",flexWrap:"yy-fw-",flex:"yy-flex-"},m=null,y=null,v={},w={isSupportFlexWrap:function(){return c||(c=document.createElement("p"),p=c.style.flexWrap||c.style.webkitFlexWrap,p=""===p),p},fontSize:function(e){return v[e.toString()]||(v[e.toString()]=this.getRealWidth(e)),v[e.toString()]},fontSize12:function(){return y||(y=this.getRealWidth(12)),y},fontSize13:function(){return s||(s=this.getRealWidth(13)),s},fontSize14:function(){return r||(r=this.getRealWidth(14)),r},fontSize15:function(){return l||(l=this.getRealWidth(15)),l},AutoResizeImage:function(e,t,i,n){var a=new Image;a.src=i.src,a.onload=function(){var o,s,r=1,l=a.width,c=a.height;if(s=e/l,o=t/c,0===e&&0===t?r=1:0===e?o<1&&(r=o):0===t?s<1&&(r=s):(s<1||o<1)&&(r=s<=o?s:o),"1"===n){r<1&&(l>=c?(l="auto",c="100%"):(l="100%",c="auto"));var p={w:"100%"===l||"auto"===l?l:l+"px",h:"100%"===c||"auto"===c?c:c+"px"};i.style.width=p.w,i.style.height=p.h}else r<1&&(l*=r,c*=r),i.height=c,i.width=l}},getImgBg:function(t){if(t=t||"",t in u)return u[t];var i=e(t).charAt(0).toLowerCase(),n=["#29d4ff","#1594ff","#ffa92f","#b587fa","#06cf86","#fa6771","#73d51c","#8991ff"],a=n["abcdefghijklmnopqrstuvwxyz0123456789".indexOf(i)%n.length];return u[t]=a,a},getImgTitle:function(e){try{return e=e||"",/[\u4e00-\u9fa5]/.test(e)?e.substr(-2):e.substr(0,2)}catch(t){return e}},deviceInfo:function(){if(void 0!==this._deviceInfo)return this._deviceInfo;var e=navigator.userAgent,t=e.indexOf("Android")>-1||e.indexOf("Adr")>-1,i=!!e.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/);return this._deviceInfo={isAndroid:t,isIOS:i},this._deviceInfo},getPicSize:function(e,t,i,n){var a,o,s=1;return o=e/i,a=t/n,0===e&&0===t?s=1:0===e?a<1&&(s=a):0===t?o<1&&(s=o):(o<1||a<1)&&(s=o<=a?o:a),s<1&&(i>=n?(i="auto",n="100%"):(i="100%",n="auto")),{w:"100%"===i||"auto"===i?i:i+"px",h:"100%"===n||"auto"===n?n:n+"px"}},convertStrToDate:function(e){if(!e)return new Date;var t=e.split(" "),i=t[0],n=t[1]||"",a=n.split(":"),o=i.split("-");return 3!=o.length&&(o=i.split("/")),3!=o.length?new Date:n?new Date(o[0],parseInt(o[1])-1,o[2],a[0]||0,a[1]||0,a[2]||0):new Date(o[0],parseInt(o[1])-1,o[2])},getPreMonth:function(e){var t=this.getDateInfo(e),i=new Date(t.year,t.month-1,0);return i},getCurMonthFirstDay:function(e){e=this.convertToDate(e);var t=this.getDateInfo(e);return new Date(t.year,t.month-1,1)},getPreYear:function(e){var t=this.getDateInfo(e),i=new Date(t.year-1,t.month-1,1);return i},setDateToYear:function(e,t){var i=this.getDateInfo(e),n=new Date(t,i.month-1,1);return n},setMonthToDate:function(e,t){t=parseInt(t);var i=this.getDateInfo(e);return new Date(i.year,t-1,1)},getNextYear:function(e){var t=this.getDateInfo(e),i=new Date(t.year+1,t.month-1,1);return i},getNextMonth:function(e){var t=this.getDateInfo(e),i=new Date(t.year,t.month+1,0);return i},getMonthFirstDayWhicDayInWeek:function(e){e=this.convertToDate(e);var t=new Date(e.getFullYear(),e.getMonth(),1);return t.getDay()},getDateWhichDayInWeek:function(e){return e=this.convertToDate(e),e.getDay()},timestampToDate:function(e){return e?(10===e.length&&(e=1e3*e),new Date(parseInt(e))):new Date},ConvertDateToStr:function(e,t){e=this.convertToDate(e);var i=this.getDateInfo(e);return i.month=i.month<10?"0"+i.month:i.month,i.day=i.day<10?"0"+i.day:i.day,i.min=i.min<10?"0"+i.min:i.min,i.second=i.second<10?"0"+i.second:i.second,i.hour=i.hour<10?"0"+i.hour:i.hour,"yyyy-MM-dd"==t?i.year+"-"+i.month+"-"+i.day:"yyyy-MM"==t?i.year+"-"+i.month:"yyyy-MM-dd hh:mm:ss"==t?i.year+"-"+i.month+"-"+i.day+" "+i.hour+":"+i.min+":"+i.second:"MM-dd hh:mm"==t?i.month+"-"+i.day+" "+i.hour+":"+i.min:"hh:mm"==t?i.hour+":"+i.min:"hh:mm:ss"==t?i.hour+":"+i.min+":"+i.second:"MM-dd week"==t?i.month+"-"+i.day+" "+i.week:"yyyy-MM-dd weekFullStr"==t?i.year+"-"+i.month+"-"+i.day+" "+i.weekFullStr:"yyyy-MM-dd week"==t?i.year+"-"+i.month+"-"+i.day+" "+i.week:"yyyy-MM-dd hh:mm"==t?i.year+"-"+i.month+"-"+i.day+" "+i.hour+":"+i.min:"yyyy年MM月dd日"==t?i.year+"年"+i.month+"月"+i.day+"日":"all"===t?{"yyyy-MM-dd":i.year+"-"+i.month+"-"+i.day,"yyyy年MM月dd日":i.year+"年"+i.month+"月"+i.day+"日"}:i.year+"-"+i.month+"-"+i.day},getMonthDayCount:function(e){e=this.convertToDate(e);var t=new Date(e.getFullYear(),e.getMonth()+1,0);return t.getDate()},convertToDate:function(e){try{if(e instanceof Date)return e;if(!isNaN(e))return this.timestampToDate(e);if("string"==typeof e)return this.convertStrToDate(e)}catch(e){return new Date}return new Date},_processtime:function(e){return e<10?"0"+e:e},weekArr:["日","一","二","三","四","五","六"],getDateInfo:function(e){e=this.convertToDate(e);var t=e.getMonth()+1,i=e.getDate(),n=e.getHours(),a=e.getMinutes(),o=e.getSeconds(),s=e.getDay(),r=e.getTime();return{year:e.getFullYear(),month:t,weekStr:this.weekArr[s],week:this.weekArr[s],weekFullStr:"星期"+this.weekArr[s],monthStr:this._processtime(t),day:i,dayStr:this._processtime(i),hour:n,hourStr:this._processtime(n),min:a,minStr:this._processtime(a),second:o,secondStr:this._processtime(o),timestamp:r}},viewport:{width:null,height:null},getUrl:function(e){if(e.indexOf("http")>=0||e.indexOf("https")>=0)return e;var t=this.appConfig.host;return t||console.error("请在app.js中指定host属性"),t=$.trim(t),e=$.trim(e),"/"==t.substring(t.length-1)&&(t=t.substring(0,t.length-1)),"/"==e.substring(0,1)&&(e=e.substring(1)),t+"/"+e},createStyleSheet:function(e,t){if(!document.getElementById(e)){var i=document.createElement("style");i.type="text/css",i.id=e,i.innerHTML=t,document.getElementsByTagName("head")[0].appendChild(i)}},timestampToDateInfo:function(e){var t;try{e=parseFloat(e),t=new Date(e)}catch(e){t=new Date}return this.getDateInfo(t)},timestampToTimeStr:function(e,t){var i="";try{e=parseFloat(e);var n=new Date(e),a=new Date,o=a.getTime(),s=this.getDateInfo(n),r=this.getDateInfo(a);o=parseInt((o-e)/1e3);var l;o<10?i="刚刚":10<o&&o<60?i=o+"秒前":o<3600&&o>=60?(l=Math.floor(o/60),i=l+"分钟前"):i=r.year===s.year&&r.day===s.day&&r.month===s.month?"今天 "+s.hourStr+":"+s.minStr:t?r.year===s.year?s.monthStr+"."+s.dayStr:s.year+"."+s.monthStr+"."+s.dayStr:r.year===s.year?s.monthStr+"-"+s.dayStr+" "+s.hourStr+":"+s.minStr:s.year+"-"+s.monthStr+"-"+s.dayStr+" "+s.hourStr+":"+s.minStr}catch(e){}return i},_isBadAndroid:null,isBadAndroid:function(){if(null!==this._isBadAndroid)return this._isBadAndroid;var e=window.navigator.appVersion;if(/Android/.test(e)&&!/Chrome\/\d/.test(e)){var t=e.match(/Safari\/(\d+.\d)/);t&&"object"==typeof t&&t.length>=2?this._isBadAndroid=parseFloat(t[1])<535.19:this._isBadAndroid=!0}else this._isBadAndroid=!1;return this._isBadAndroid},processHTMLMethod2:function(e){var t=$("<div></div>");t.html(e);var i=t.find("img"),n=t.html();i.replaceWith("");var a=t.text();return{originalText:n,imageDoms:i,curText:a}},processHTML:function(e,t){var i=$("<div></div>");i.html(e);var n=i.find("img"),a=$("<div></div>");a.html(e);var o=a.find("img");t&&(t(o),t(n)),n.replaceWith("");var s=i.text();return{dom:a,originalTextDom:i,imageDoms:n,curText:s}},ajax:function(e){var t=this,i=(e.pageviewInstance,t.appConfig.beforeSendAjax);i&&i(e);var n={type:e.type,url:this.getUrl(e.url),timeout:e.timeout||7e3,data:e.data,success:function(i){var n=t.appConfig.onAjaxResponse;n&&n({isSuccess:!0,data:i,config:e}),e.success&&e.success(i)},error:function(i){var n=t.appConfig.onAjaxResponse;n&&n({isSuccess:!1,e:i,config:e,data:{code:-1e3,msg:"服务器错误"}}),e.error&&e.error(i)}};e.contentType?(n.contentType=e.contentType,n.dataType="json"):n.contentType="application/x-www-form-urlencoded",e.xhrFields&&(n.xhrFields={withCredentials:!0}),$.ajax(n)},concat:function(e,t,i){i||console.error("合并页面配置的时候没有指定namespace"),e.components=e.components||{};for(var n in t){var a=i+n;e.components[a]&&console.error(a+" 已经存在原有的页面中 请不要重复控件的Key");var o=t[n],s=o.root;if(s)for(var r=0,l=s.length;r<l;r++)s[r]=i+s[r];e.components[a]=t[n]}return e},getTransitionKeys:function(){if(m)return m;var e=document.createElement("DIV").style,t={};return"-webkit-transform"in e?(t.transitionend="webkitTransitionEnd",t.transform="-webkit-transform",t.transition="-webkit-transition"):(t.transitionend="transitionend",t.transform="transform",t.transition="transition"),m=t,t},baseSize:{width:375,height:667},getRealWidth:function(e){e=parseInt(e);var t=this.viewport.width/this.baseSize.width;return t=t>1.5?1.5:t,this.viewport.width>1e3&&(t=1),parseInt(t*e)},getRealHeight:function(e){e=parseInt(e);var t=this.viewport.height/this.baseSize.height;return t=t<1?1:t,t=t>1.5?1.5:t,parseInt(t*e)},_initScrennSize:function(){this.viewport.width||(this.viewport.width=window.screen.width>700?document.body.offsetWidth:window.screen.width,window.screen.width>700?this.viewport.height=document.body.offsetHeight:this.viewport.height=window.screen.height)},processStyle:function(e,t){e=this.clone(e),this._initScrennSize(),t||(t=this.viewport),e=e||{};for(var n in e){var a=e[n].toString();if(f[n]){var s=a.split(" ");"fs"==n?(e.fontSize=parseInt(a)+"px",delete e.fs):"w"==n?(delete e.width,delete e.height,e.height=e.width=i(e.w,t)+"px",delete e.w):e[n]=o(n,s,t,e)}}return e},processPageConfig:function(e){var t;if(this.viewport.width||this._initScrennSize(),e.showPageStyle){var i=e.showPageStyle.width||"100%",n=e.showPageStyle.height||"100%";i=i.toString(),n=n.toString(),i="%"==i.substring(i.length-1)?parseInt(i)/100*this.viewport.width:parseInt(i)*this.viewport.width,n="%"==n.substring(n.length-1)?parseInt(n)/100*this.viewport.height:parseInt(n)*this.viewport.height,t={width:i,height:n}}else t=this.viewport;if(e.style&&(e.style=this.processStyle(e.style,t)),e.components)for(var a in e.components){var o=this.clone(e.components[a]);for(var s in o)s.length>=5&&"STYLE"==s.substring(s.length-5).toUpperCase()&&(o[s]=this.processStyle(o[s],t));e.components[a]=o}return e},setPageConfigByPagePath:function(e,t){return t.isNoAdaptScreen||(t=this.processPageConfig(t)),h[e]=t,t},getPageConfigByPagePath:function(e){return h[e]},getComponentInstance:function(e){return d[e]},customerComponents:{},getComponentClass:function(e,t,i){var n=e.type,a=d[n];if(a)return void t(a);var o=w.customerComponents[n];o||(o="../../components/"+n.toLowerCase()),require([o],function(e){d[n]=e,t(e)},function(){i(e)})},clone:function(e){var t=JSON.stringify(e);return JSON.parse(t)},getClassByStyle:function(e){var t=[];for(var i in e){var n=g[i];if(n){var a=e[i];t.push(n+a)}}return t},css:function(e,t,i){if(t){var n=this.getClassByStyle(t);n.length>0&&e.addClass(n.join(" ")),i&&(t=this.processStyle(t)),e.css(t)}},simpleExtendObj:function(e,t){e=e||{},t=t||{};for(var i in t)e[i]=t[i];return e},processTransitionStyle:function(e){return{transition:e,"-webkit-transition":e}},processTransformStyle:function(e){return{transform:e,"-webkit-transform":e}},processTransitionTanformStyle:function(e,t){return{"-webkit-transition":e,"-webkit-transform":t}},addDay:function(e,t){return e=this.convertToDate(e),new Date(e.setDate(e.getDate()+t))},compareDate:function(e,t,i){return i=i||"yyyy-MM-dd",e=this.ConvertDateToStr(e,i),t=this.ConvertDateToStr(t,i),this.compareTime(e,t)},compareTime:function(e,t){return e=this.convertToDate(e),t=this.convertToDate(t),e>t?1:e-t===0?0:-1},deleteEmoji:function(e){return e.replace(/\uD83C[\uDF00-\uDFFF]|\uD83D[\uDC00-\uDE4F]/g,"")},copy:function(e,t){if(null===e||void 0===e||"object"!=typeof e)return e;if(e.constructor!=Object&&e.constructor!=Array)return e;if(e.constructor==Date||e.constructor==RegExp||e.constructor==Function||e.constructor==String||e.constructor==Number||e.constructor==Boolean)return new e.constructor(e);t=t||new e.constructor;for(var i in e)t[i]="undefined"==typeof t[i]?this.copy(e[i],null):t[i];return t},extends:function(e,t){function i(){}i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e,e.baseConstructor=t,e.superClass=t.prototype},isEmail:function(e){var t=/^[a-z0-9]+([._\\-]*[a-z0-9])*@([a-z0-9]+[-a-z0-9]*[a-z0-9]+.){1,63}[a-z0-9]+$/;return!!t.test(e)},isMobile:function(e){if(!e)return"请输入座机号";var t=/^0\d{2,3}-?[2-9]\d{6,7}$/,i=/^0\d{2,3}-?[2-9]\d{6,7}-?\d{1,4}$/,n=/^\d{7,8}$/;return!!(t.test(e)||n.test(e)||i.test(e))},isPhone:function(e){if(!e)return"请输入手机号";var t=/(^0{0,1}1[3|4|5|6|7|8|9][0-9]{9}$)/;return!!t.test(e)},isRealURL:function(e){var t=/(^(https?:\/\/)?(\w+\.)+[a-zA-Z])/;return!!t.test(e)}};return w}),define("app",["utils"],function(e){var t="开发",i="http://121.42.30.191:8880/approve-app";return"正式"===t?i="https://sp.upesn.com/approve/api":"生产测试"===t?i="https://sp.upesn.com/approve/api":"gz"===t&&(i="http://localhost:8080/approve-app"),{init:function(e){e.start({host:i,version:"1.2.0",versionkey:"approveversionkey",feature:"<div style='text-align:left'><div style='color:#666;font-size:15px;padding-bottom:2px'>新版本更新：</div><div class='feature-item'>1.支持多种应用场景的审批</div><div class='feature-item'>2.一键提交审批单据，快速了解审批流转情况</div><div class='feature-item'>3.审批消息推送，防止漏审</div></div>",customerComponents:{ApproveSearchView:"./components/ApproveSearchView"},root:"index",baseSize:{width:375,height:667},beforeSendAjax:function(e){var t=e.pageviewInstance;e.data=e.data||{},e.data.token=t.params.token,e.xhrFields=!0},beforeGo:function(e){var t=e.pageviewInstance;e.params.token=t.params.token||""},onAjaxResponse:function(t){if(t.isSuccess&&t.data){var i=t.data.success;if(i===!0?t.data.code=0:t.data.code=500,"100010008"===t.data.code.toString()){e.showTip({text:"操作过期,两秒后会自动退出",duration:3500,clickNoHide:!0});try{window.setTimeout(function(){window.yyesn.client.closePage()},3500)}catch(e){}}}}})}}}),define("tip",["utils"],function(e){var t=function(e){var t=this;e=e||$(document.body),this.tipWrapper=$("<div class='yy-tip displayflex jc-center ai-center displaynone'></div>"),this.textDom=$('<div class="yy-tip-text displaynone"></div>'),this.backCover=$('<div class="yy-tip-backcover displaynone"></div>'),this.backCover.bind("click",function(){t.clickBackCover()}),this.tipWrapper.append(this.textDom),e.append(this.tipWrapper).append(this.backCover),this.hideTimeoutId=null};return t.prototype={show:function(t){var i=this;this.textPos=t.textPos||"bottom","left"==this.textPos||"right"==this.textPos?this.tipWrapper.addClass("flex-h"):this.tipWrapper.addClass("flex-v");var n=t.pos||"center";this.config=t,this.hideTimeoutId&&window.clearTimeout(this.hideTimeoutId),t=t||{};var a=t.style;a&&this.tipWrapper.css(e.processStyle(a)),this._setText(t.text,t.textStyle),this._setIcon(t.font,t.iconStyle),this.config.withoutBackCover||this.backCover.removeClass("displaynone"),this.startClass="yy-tip-ani-"+n+"-start",this.tipWrapper.removeClass("displaynone").addClass(this.startClass),window.setTimeout(function(){i.endClass="yy-tip-ani-"+n+"-end",i.tipWrapper.addClass(i.endClass)},3),t.duration&&!isNaN(t.duration)&&(this.hideTimeoutId=window.setTimeout(function(){i.hide()},parseInt(t.duration)))},_setText:function(t,i){t?(this.textDom.removeClass("displaynone"),i&&this.textDom.css(e.processStyle(i)),this.textDom.html(t)):this.textDom.addClass("displaynone")},_setIcon:function(t,i){this.iconDom&&this.iconDom.remove();var n,a;t=t||"";var o=t.split("_");2==o.length?(n=o[0],a=o[1],this.iconDom=$('<i class="yy-tip-icon displayflex jc-center ai-center yy-icon-code displaynone" data-icon="&#x'+a+';"></i>'),i&&this.iconDom.css(e.processStyle(i)),this.iconDom.removeClass("displaynone"),this.iconDom.css({"font-family":n}),"top"==this.textPos||"left"==this.textPos?this.iconDom.appendTo(this.tipWrapper):this.iconDom.insertBefore(this.textDom)):this.icomDom&&this.iconDom.addClass("displaynone")},clickBackCover:function(){this.config.clickNoHide||(this.hideTimeoutId&&window.clearTimeout(this.hideTimeoutId),this.hide())},hide:function(){var e=this;this.tipWrapper.removeClass(this.endClass),window.setTimeout(function(){e.tipWrapper.addClass("displaynone").removeClass(e.startClass),e.tipWrapper.remove(),e.backCover.remove()},300),e.backCover.addClass("displaynone")}},t}),define("base",["utils","tip"],function(e,t){function i(e,t){if(!e)return null;for(var i=e,n=0,a=t.length;n<a;n++){var o=t[n];if(i=i[o],!i&&0!=i){i=null;break}}return i}var n=function(t){var i=this;this.pageview=t.$$pageview||this,this.loaderHtml="<div class='spinner center'><div class='spinner-blade'></div><div class='spinner-blade'></div><div class='spinner-blade'></div><div class='spinner-blade'></div><div class='spinner-blade'></div><div class='spinner-blade'></div><div class='spinner-blade'></div><div class='spinner-blade'></div><div class='spinner-blade'></div><div class='spinner-blade'></div><div class='spinner-blade'></div><div class='spinner-blade'></div></div>",this.disabled=!1,this.parent=t.$$parent,this.datasource=t.$$datasource||[],this.rowInstance=t.$$rowInstance,t.ref&&(this.rowInstance?(this.rowInstance.refs=this.rowInstance.refs||{},this.rowInstance.refs[t.comKey]=this):this.pageview.refs[t.comKey]=this);var n=t.className||"";this.selectedClassName=t.selectedClassName,t.tagName=t.tagName||"DIV";var a=t.activeClassName?"data-activecn='"+t.activeClassName+"'":"";this.$el=$("<"+t.tagName+" "+a+" data-comname='"+t.comKey+"' class='"+n+"'></"+t.tagName+">"),t=this._processConfig(t),this.config=t,this.components={},"repeat"!=t.type&&"listview"!=t.type||(this.components=[]),t.comKey&&this.$el.addClass(t.comKey);var o=this.config.comKey+"_init";if("repeatitem"===t.type?o=this.parent.config.comKey+"_iteminit":"listrow"===t.type&&(o=this.parent.config.comKey+"_rowinit"),"pageview"===this.config.type){var s=this.config.children;if(s&&s instanceof Array)for(var r=0,l=s.length;r<l;r++){var c=s[r].components;if(c)for(var p in c){var d=e.copy(c[p]);for(var h in d)h.length>=5&&"STYLE"==h.substring(h.length-5).toUpperCase()&&(d[h]=this.processStyle(d[h],BaseSize));this.config.components[p]=d}}}if(this.pageview.plugin&&this.pageview.plugin[o]){var u=this.pageview.plugin[o];u&&u.call(this.pageview.plugin,this)}var f=t.style;if(t.noNeedSetStyle||f&&"pageview"!=t.type&&"segment"!=t.type&&e.css(this.$el,f),this.disabledClassName=t.disabledClassName||"yy-disabled",this.disabled&&this.setDisabled(!0),t.comKey){var g=t.comKey+"_click",m=i.pageview.plugin[g];m&&this.$el.bind("click",function(e){e.preventDefault(),e.stopPropagation(),!i.disabled&&m&&m.call(i.pageview.plugin,i,{e:e})});var y=t.comKey+"_tap",v=i.pageview.plugin[y];v&&this.$el.bind("singleTap",function(e){e.preventDefault(),e.stopPropagation(),!i.disabled&&v&&v.call(i.pageview.plugin,i,{e:e})})}};return n.prototype.setDisabled=function(e){this.disabled=e,this.disabled?this.$el.addClass(this.disabledClassName):this.$el.removeClass(this.disabledClassName)},n.prototype._processConfig=function(e){for(var t in e){var n=t.split("_");if(2==n.length&&"bind"==n[1]){var a=e[t],o=n[0],s=typeof a;if("string"==s)e[o]=i(this.datasource,a.split("."));else if("object"==s)for(var r in a){var l=r,c=i(this.datasource,a[r].split("."));e[o]=e[o]||{},e[o][l]=c}}}return e},n.prototype.selected=function(e){if(!e||!this.config.disableParentSelect){this.isSelected=!0,this.selectedClassName&&""!==this.selectedClassName&&this.$el.addClass(this.selectedClassName);for(var t in this.components)this.components[t].selected(!0)}},n.prototype.unSelected=function(e){if(!e||!this.config.disableParentSelect){this.isSelected=!1,this.selectedClassName&&""!==this.selectedClassName&&this.$el.removeClass(this.selectedClassName);for(var t in this.components)this.components[t].unSelected(!0)}},n.prototype.getUniqueKey=function(){return this.pageview.config.pageKey+""+this.config.comKey},n.prototype.showTip=function(e){this.Tip=new t(this.$el),this.Tip.show(e)},n.prototype._prepareComponent=function(t,i,n){var a=e.clone(this.pageview.config.components[t]),o=a.type,s=e.getComponentInstance(o);a.$$pageview=this.pageview,a.$$rowInstance=n,a.$$parent=this,a.comKey=t,a.$$datasource=i;var r=null;try{r=new s(a,null)}catch(e){console.log(e),console.log(a)}var l=t+"_didmount";if(this.pageview.plugin){var c=this.pageview.plugin[l];c&&c.call(this.pageview.plugin,r)}return this.pageview.componentsInitActions[t]&&(this.pageview.componentsInitActions[t](r),delete this.pageview.componentsInitActions[t]),r},n.prototype._initComponents=function(e,t,i,n){for(var a=0,o=e.root.length;a<o;a++){var s=e.root[a],r=this._prepareComponent(s,t,n);e.isContainer||"repeat"==e.type?(this.components.push=r,i(r)):"tabbarview"==e.type?(this.components[s]=r,i(r)):this.components[s]=r}return this.components},n.prototype.getClientRect=function(){return this.$el[0].getBoundingClientRect()},n.prototype.getComponentInstanceByComKey=function(e,t,i,n,a){var o=this;this.loadFiles([e],this.pageview||this,function(){var a=o._prepareComponent(e,t,i);n(a)},function(){a&&a()})},n.prototype.initLayout=function(t,i,n,a){var o=this;this.config.root&&this.config.root.length>0&&this.loadFiles(this.config.root,this.pageview||this,function(){if(i)o._initComponents(o.config,t,i,n);else{o._initComponents(o.config,t,null,n);for(var s=0,r=o.config.root.length;s<r;s++){var l=o.components[o.config.root[s]],c=o.$$childrenWrapper||o.$el;null===l&&(console.log(o.config.root[s]),console.log(o.config.root),console.log(o.components)),"checklist"===l.config.type||"radiolist"===l.config.type?o.pageview.$el.append(l.$el):c.append(l.$el);var p;o.config.splitStyle&&o.config.root.length>1&&s!=o.config.root.length-1&&(p=$("<div></div>"),l.splitLine=p,e.css(p,o.config.splitStyle,!0),c.append(p))}}if(a&&a(),"pageview"==o.config.type){var d=o.plugin.onPageLoad;d&&d.call(o.plugin,o)}},function(){})},n.prototype.setBadge=function(t,i){if(!this.$$badge){this.$$badge=$("<div class='displayflex jc-center ai-center yy-badge displaynone'></div>"),i=i||{};var n=i.width||i.height||16;i["min-width"]=i.height=n,delete i.width,i=e.processStyle(i),i["border-radius"]=parseInt(i.height)/2+"px",e.css(this.$$badge,i),this.$el.append(this.$$badge)}t?this.$$badge.html(t).removeClass("displaynone"):this.$$badge.addClass("displaynone")},n.prototype.showLoading=function(t){if(t=t||{},this.loadingConfig=t,!this.$$loadingWrapper){t.timeout&&!isNaN(t.timeout)||(t.timeout=7e3),this.loadingtimeout=parseInt(t.timeout)||7e3;var i="displaynone yy-loading-bk displayflex yy-jc-center yy-ai-center ";t.style&&(t.style.alignItems||t.style["align-items"]||(i+="yy-ai-center")),this.$$loadingWrapper=$("<div class='"+i+"'></div>"),t.style&&e.css(this.$$loadingWrapper,t.style);var n=$("<div class='yy-loading-wrapper yy-fd-column displayflex yy-jc-center yy-ai-center'>"+this.loaderHtml+"</div>");this.loadingText=$("<span class='yy-loading-text'></span>"),n.append(this.loadingText),this.$$loadingWrapper.append(n),this.$el.append(this.$$loadingWrapper)}this.loadingText.html(t.text||"正在努力加载"),this.startLoadingTimeout(t),this.$$loadingWrapper.removeClass("displaynone")},n.prototype.showLoadingError=function(){var e=this;if(this.$$loadingWrapper){if(this.loadingTimeId&&window.clearTimeout(this.loadingTimeId),!e.loadingConfig.reLoadCallBack)return void e.hideLoading(!0);e.loadingErrorWrapper||(e.loadingErrorWrapper=e._createErrorDom(function(){e.$$loadingWrapper.removeClass("yy-loading-wrapper-error"),e.loadingErrorWrapper.addClass("displaynone"),e.loadingTimeId=null,e.startLoadingTimeout(e.loadingConfig),e.loadingConfig.reLoadCallBack&&e.loadingConfig.reLoadCallBack()}),e.loadingErrorWrapper.appendTo(e.$$loadingWrapper)),e.$$loadingWrapper.addClass("yy-loading-wrapper-error"),e.loadingErrorWrapper.removeClass("displaynone")}},n.prototype.startLoadingTimeout=function(e){var t=this;this.loadingTimeId||(this.loadingTimeId=window.setTimeout(function(){t.hideLoading()},this.loadingtimeout))},n.prototype._createErrorDom=function(t){var i=e.getRealWidth(11),n=e.getRealWidth(20),a=$("<div style='height:100px' class='yy-loadmore-wrapper displayflex jc-center ai-center flex-h displaynone'></div>"),o=$("<i style='font-size:"+n+"px' class='yy-icommon yy-loadmore-erroricon'></i>"),s=$("<span style='font-size:"+i+"px' class='yy-pull-meslabel'>网络异常,点击</span>"),r=$("<span style='font-size:"+i+"px' class='yy-loadmore-reload-babel'>重新加载</span>");return r.bind("click",function(){t()}),a.append(o).append(s).append(r),a},n.prototype.hideLoading=function(e){return e===!1?void this.showLoadingError():(this.loadingTimeId&&(window.clearTimeout(this.loadingTimeId),this.loadingTimeId=null),void(this.$$loadingWrapper&&this.$$loadingWrapper.addClass("displaynone")))},n.prototype.loadFiles=function(t,i,n,a){for(var o=t.length,s=0,r=0;r<o;r++)!function(t,o,r){var l=i.config.components[r];e.getComponentClass(l,function(e){s+=1,s==t&&n()},function(){a()})}(o,r,t[r])},n}),define("pageview",["utils","base"],function(e,t){function i(e){var t=this;if(this.refs={},this.dialogsBks={},this.dialogs={},this.componentsInitActions={},i.baseConstructor.call(this,e),this.viewpagerParams=e.viewpagerParams,e.root=e.root||[],this.params=e.$$params,this.showPageParams=e.showPageParams||{},this.prePageView=e.prePageView,this.pageManager=e.$$pageManager,this.config=e,this.innerPages={},this.innerPagesWrappers={},e.pluginClass)try{this._preparePlugin(e.pluginClass)}catch(e){console.log(e)}this.components={};var n=e.style;this.$el.addClass("yy-pageview displayflex"),this.showPageBackCover=$("<div role='showPageBackCover' class='yy-backcover displaynone'></div>"),this.innerWrapper=$("<div class='displayflex yy-page-inner'></div>"),this.$$childrenWrapper=this.innerWrapper,this.$el.append(this.innerWrapper).append(this.showPageBackCover),n&&this.innerWrapper.css(n),this.showPageBackCover.bind("click",function(){t.hideCurShowPage()}),this.initLayout()}var n={fromLeft1:{zIndex:5,left:"0",top:0,transform:"translate3d(-100%,0,0)","-webkit-transform":"translate3d(-100%,0,0)"},fromLeft2:{zIndex:101,left:"0",top:0,transform:"translate3d(-100%,0,0)","-webkit-transform":"translate3d(-100%,0,0)"},fromLeft3:{left:0,top:0,zIndex:5,transform:"translate3d(0,0,0)","-webkit-transform":"translate3d(0,0,0)"},fromRight1:{zIndex:5,right:"0",top:0,transform:"translate3d(100%,0,0)","-webkit-transform":"translate3d(100%,0,0)"},fromRight2:{zIndex:101,right:"0",top:0,transform:"translate3d(100%,0,0)","-webkit-transform":"translate3d(100%,0,0)"},fromRight3:{zIndex:5,right:0,top:0,transform:"translate3d(0,0,0)","-webkit-transform":"translate3d(0,0,0)"},opacity:{left:"0",top:0},fromBottom:{zIndex:101,left:"0",bottom:"0",transform:"translate3d(0,100%,0)","-webkit-transform":"translate3d(0,100%,0)"
}},a={fromLeft1:"yy-init-left",fromLeft2:"yy-init-left",fromLeft3:"yy-init-left",fromRight1:"yy-init-right",fromRight2:"yy-init-right",fromRight3:"yy-init-right",opacity:"yy-init-left",fromBottom:"yy-init-bottom"};return e.extends(i,t),i.prototype._preparePlugin=function(e){this.plugin=new e({pageview:this});var t=this.config.children;if(t&&t instanceof Array&&t.length>0)for(var i=0,n=t.length;i<n;i++){var a=t[i].pluginClass;if(a){var o=new a;this.plugin=$.extend(!0,this.plugin,o)}}},i.prototype.regeistPageDestory=function(){},i.prototype.destory=function(){this.$el.remove()},i.prototype.showDialog=function(e,t){var i=this;t=t||{};var n=this.dialogs[e];if(n)return this.dialogs[e].addClass("yy-dialog-show"),this.dialogsBks[e].removeClass("displaynone"),void window.setTimeout(function(){i.dialogs[e].css({visibility:"visible"})},20);var a=t.datasource;this.getComponentInstanceByComKey(e,a,null,function(n){var a=$("<div style='visibility: hidden;' class='yy-dialog-out-wrap displayflex yy-ai-center yy-jc-center'></div>");t.zIndex&&a.css({zIndex:t.zIndex+1});var o=$("<div class='yy-dialog-inner-wrap'></div>");i.dialogs[e]=a,o.append(n.$el),a.append(o),a.appendTo(document.body);var s=$("<div class='yy-page-dialog-bk'></div>");t.zIndex&&s.css({zIndex:t.zIndex}),i.dialogsBks[e]=s,s.appendTo(document.body),window.setTimeout(function(){a.css({visibility:"visible"}),a.addClass("yy-dialog-show")},20)},function(e){})},i.prototype.hideDialog=function(e){var t=this;this.dialogsBks[e].addClass("displaynone"),this.dialogs[e].removeClass("yy-dialog-show"),window.setTimeout(function(){t.dialogs[e].css({visibility:"hidden"})},200)},i.prototype.ajax=function(t){t.pageviewInstance=this,e.ajax(t)},i.prototype.Enter=function(e,t){var i=this;if(this.$el[0].className=e,t){if(i.pageManager.getPageNameFromUrl()===i.config.pageKey){var n=i.plugin.onPageEnter;n&&n.call(i.plugin)}}else this.$el[0].addEventListener("webkitAnimationEnd",function(){if(i.pageManager.getPageNameFromUrl()===i.config.pageKey){var e=i.plugin.onPageEnter;e&&e.call(i.plugin)}})},i.prototype.bindShowPageEnterEvent=function(){var e=this;this.$el[0].parentNode.addEventListener("webkitTransitionEnd",function(){if(e.$$isshow){var t=e.plugin.onPageEnter;t&&t.call(e.plugin)}})},i.prototype.hideCurShowPage=function(){var t=this;if(this.pageManager.blur(),this.showpageInstance.showpageInstance)return this.showpageInstance.hideCurShowPage(),!0;if(this.showpage_wrapper){var i=this.showpageInstance.plugin.onPageBeforeLeave||this.showpageInstance.plugin.onPageClose;if(i){var o=i.call(this.showpageInstance.plugin);if(o===!1)return!0}this.showpageInstance.$$isshow=!1;var s=this.showpage_wrapper.attr("data-mode");if(this.showPageBackCover.addClass("displaynone"),this.innerWrapper[0].className="displayflex yy-page-inner "+a[s]+"-im ",window.setTimeout(function(){t.innerWrapper.css(e.processTransitionTanformStyle("none","translate3d(0,0,0)"))},300),"fromLeft1"==s||"fromLeft2"==s)this.showpage_wrapper.css(e.processTransformStyle("translate3d(-100%,0,0)"));else if("fromRight1"==s||"fromRight2"==s)this.showpage_wrapper.css(e.processTransformStyle("translate3d(100%,0,0)"));else{var r=n[s]||{};"fromRight3"!=s&&"fromLeft3"!=s||(r.display="none"),this.showpage_wrapper.css(r)}}var l=this.plugin.onPageResume;return l&&l.call(this.plugin),this.showpage_wrapper=null,this.showpageInstance=null,!1},i.prototype.do=function(e,t){var i=this.refs[e];i?t(i):(this.config.components[e].ref||console.error("请务必在"+e+"控件上设置ref:true"),this.componentsInitActions[e]=t)},i.prototype.delegate=function(e,t){this.do(e,t)},i.prototype.showLoadingProgressbar=function(){var e=this;this.loadingProgreessbar||(this.loadingProgreessbarWrapper=$("<div class='yy-loading-pbw displaynone'></div>"),this.loadingProgreessbar=$("<div class='yy-loading-pb'></div>"),this.loadingProgreessbarWrapper.append(this.loadingProgreessbar),this.loadingProgreessbarWrapper.appendTo(this.$el)),this.loadingProgreessbarWrapper.removeClass("displaynone"),window.setTimeout(function(){e.loadingProgreessbar.css({width:"90%"})},6)},i.prototype.hideLoadingProgressbar=function(){this.loadingProgreessbar&&(this.loadingProgreessbar.css({width:"0%"}),this.loadingProgreessbarWrapper.addClass("displaynone"))},i.prototype.close=function(){this.ownerPage&&this.ownerPage.hideCurShowPage()},i.prototype.showPage=function(t){if(t&&t.pageKey){this.pageManager.blur(),t.inRouter!==!1&&this.pageManager.regeistShowPageInRouter(this.config.pageKey);var i=this,a=t.mode||"fromLeft1";this.showpage_wrapper=this.innerPagesWrappers[t.pageKey],this.showpageInstance=this.innerPages[t.pageKey],this.showLoadingProgressbar(),!this.showpage_wrapper||void 0!==t.nocache&&t.nocache?this.pageview.pageManager.getPageConfigByPageKey(t.pageKey,function(o){var s=t.params||{};o.showPageParams=s;var r=i.pageview.pageManager.createPageView(o);r.$el.addClass("yy-pageview-show"),r.ownerPage=i,i.hideLoadingProgressbar(),i.showpageInstance=r,i.innerPages[t.pageKey]=r,i.showpage_wrapper=$("<div class='yy-showpage'></div>");var l=o.showPageStyle||{width:"100%",height:"100%"};l&&(delete l.top,delete l.right,delete l.left,delete l.bottom),i.showpage_wrapper.attr("data-mode",a);var c=l.width||"100%",p=l.height||"100%";l=l||{};var d=n[a]||n.fromLeft1;d=e.clone(d),i.showpage_wrapper.attr("data-width",c),i.showpage_wrapper.attr("data-height",p);var h=e.simpleExtendObj(l,d)||{};"fromLeft3"!==a&&"fromRight3"!==a||(h.display="block"),i.showpage_wrapper.css(h),i.innerPagesWrappers[t.pageKey]=i.showpage_wrapper,i.showpage_wrapper.append(r.$el),i.$el.append(i.showpage_wrapper),r.bindShowPageEnterEvent(),i._showpageAnimate(t,i.showpage_wrapper,r)},function(){}):(this.hideLoadingProgressbar(),"fromLeft3"!==a&&"fromRight3"!==a||this.showpage_wrapper.css({display:"block"}),this._showpageAnimate(t,this.showpage_wrapper,this.showpageInstance))}},i.prototype.goBack=function(e){this.pageManager.goBack(e)},i.prototype.go=function(e,t){t=t||{};var i=this.pageManager.appConfig.beforeGo;i&&i({params:t,pageviewInstance:this}),this.pageManager.go(e,t)},i.prototype.replaceGo=function(e,t){t=t||{};var i=this.pageManager.appConfig.beforeGo;i&&i({params:t,pageviewInstance:this}),this.pageManager.replaceGo(e,t)},i.prototype._showpageAnimate=function(t,i,n){var o=this,s=12;n.$$isshow=!0;var r=i.attr("data-width"),l=i.attr("data-mode");if(this.innerWrapper[0].className="displayflex yy-page-inner "+a[l],"fromLeft1"!=l&&"fromLeft2"!=l||(this.showPageBackCover.removeClass("displaynone").css({left:r,right:0}),window.setTimeout(function(){if("fromLeft1"==l){var t=e.processTransitionTanformStyle("transform .3s cubic-bezier(.05, .69, .14, 1)","translate3d("+r+",0,0)");t["box-shadow"]="0px 0px 13px 1px #929292",o.innerWrapper.css(t)}i.css(e.processTransitionTanformStyle("transform .3s cubic-bezier(.05, .69, .14, 1)","translate3d(0,0,0)"))},s)),"fromLeft3"==l){this.showPageBackCover.removeClass("displaynone").css({left:r,right:0});var c=e.processTransitionTanformStyle("transform .3s cubic-bezier(.05, .69, .14, 1)","translate3d("+r+",0,0)");c["box-shadow"]="0px 0px 13px 1px #929292",window.setTimeout(function(){o.innerWrapper.css(c)},s)}if("fromRight1"!=l&&"fromRight2"!=l||(this.showPageBackCover.removeClass("displaynone").css({right:r,left:0}),window.setTimeout(function(){var t=e.processTransitionTanformStyle("transform .3s cubic-bezier(.05, .69, .14, 1)","translate3d(-"+r+",0,0)");t["box-shadow"]="0px 0px 13px 1px #929292","fromRight1"==l&&o.innerWrapper.css(t),i.css(e.processTransitionTanformStyle("transform .3s cubic-bezier(.05, .69, .14, 1)","translate3d(0,0,0)"))},s)),"fromRight3"==l){this.showPageBackCover.removeClass("displaynone").css({right:r,left:0});var c=e.processTransitionTanformStyle("transform .3s cubic-bezier(.05, .69, .14, 1)","translate3d(-"+r+",0,0)");c["box-shadow"]="0px 0px 13px 1px #929292",window.setTimeout(function(){o.innerWrapper.css(c)},s)}if("fromBottom"==l){i.attr("data-height");this.showPageBackCover.removeClass("displaynone").css({left:"0",top:"0"}),window.setTimeout(function(){i.css(e.processTransitionTanformStyle("transform .2s cubic-bezier(.05, .69, .14, 1)","translate3d(0,0,0)"))},s)}},i}),function(e,t){"function"==typeof define&&define.amd?define("$",[],function(){return t(e)}):t(e)}(this,function(e){var t=function(){function t(e){return null==e?String(e):q[X.call(e)]||"object"}function i(e){return"function"==t(e)}function n(e){return null!=e&&e==e.window}function a(e){return null!=e&&e.nodeType==e.DOCUMENT_NODE}function o(e){return"object"==t(e)}function s(e){return o(e)&&!n(e)&&Object.getPrototypeOf(e)==Object.prototype}function r(e){var t=!!e&&"length"in e&&e.length,i=S.type(e);return"function"!=i&&!n(e)&&("array"==i||0===t||"number"==typeof t&&t>0&&t-1 in e)}function l(e){return L.call(e,function(e){return null!=e})}function c(e){return e.length>0?S.fn.concat.apply([],e):e}function p(e){return e.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}function d(e){return e in M?M[e]:M[e]=new RegExp("(^|\\s)"+e+"(\\s|$)")}function h(e,t){return"number"!=typeof t||N[p(e)]?t:t+"px"}function u(e){var t,i;return P[e]||(t=E.createElement(e),E.body.appendChild(t),i=getComputedStyle(t,"").getPropertyValue("display"),t.parentNode.removeChild(t),"none"==i&&(i="block"),P[e]=i),P[e]}function f(e){return"children"in e?A.call(e.children):S.map(e.childNodes,function(e){if(1==e.nodeType)return e})}function g(e,t){var i,n=e?e.length:0;for(i=0;i<n;i++)this[i]=e[i];this.length=n,this.selector=t||""}function m(e,t,i){for(I in t)i&&(s(t[I])||ee(t[I]))?(s(t[I])&&!s(e[I])&&(e[I]={}),ee(t[I])&&!ee(e[I])&&(e[I]=[]),m(e[I],t[I],i)):t[I]!==D&&(e[I]=t[I])}function y(e,t){return null==t?S(e):S(e).filter(t)}function v(e,t,n,a){return i(t)?t.call(e,n,a):t}function w(e,t,i){null==i?e.removeAttribute(t):e.setAttribute(t,i)}function x(e,t){var i=e.className||"",n=i&&i.baseVal!==D;return t===D?n?i.baseVal:i:void(n?i.baseVal=t:e.className=t)}function b(e){try{return e?"true"==e||"false"!=e&&("null"==e?null:+e+""==e?+e:/^[\[\{]/.test(e)?S.parseJSON(e):e):e}catch(t){return e}}function _(e,t){t(e);for(var i=0,n=e.childNodes.length;i<n;i++)_(e.childNodes[i],t)}var D,I,S,C,T,k,R=[],$=R.concat,L=R.filter,A=R.slice,E=e.document,P={},M={},N={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},F=/^\s*<(\w+|!)[^>]*>/,W=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,O=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,B=/^(?:body|html)$/i,z=/([A-Z])/g,H=["val","css","html","text","data","width","height","offset"],K=["after","prepend","before","append"],V=E.createElement("table"),j=E.createElement("tr"),U={tr:E.createElement("tbody"),tbody:V,thead:V,tfoot:V,td:j,th:j,"*":E.createElement("div")},G=/complete|loaded|interactive/,Y=/^[\w-]*$/,q={},X=q.toString,J={},Z=E.createElement("div"),Q={tabindex:"tabIndex",readonly:"readOnly",for:"htmlFor",class:"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},ee=Array.isArray||function(e){return e instanceof Array};return J.matches=function(e,t){if(!t||!e||1!==e.nodeType)return!1;var i=e.matches||e.webkitMatchesSelector||e.mozMatchesSelector||e.oMatchesSelector||e.matchesSelector;if(i)return i.call(e,t);var n,a=e.parentNode,o=!a;return o&&(a=Z).appendChild(e),n=~J.qsa(a,t).indexOf(e),o&&Z.removeChild(e),n},T=function(e){return e.replace(/-+(.)?/g,function(e,t){return t?t.toUpperCase():""})},k=function(e){return L.call(e,function(t,i){return e.indexOf(t)==i})},J.fragment=function(e,t,i){var n,a,o;return W.test(e)&&(n=S(E.createElement(RegExp.$1))),n||(e.replace&&(e=e.replace(O,"<$1></$2>")),t===D&&(t=F.test(e)&&RegExp.$1),t in U||(t="*"),o=U[t],o.innerHTML=""+e,n=S.each(A.call(o.childNodes),function(){o.removeChild(this)})),s(i)&&(a=S(n),S.each(i,function(e,t){H.indexOf(e)>-1?a[e](t):a.attr(e,t)})),n},J.Z=function(e,t){return new g(e,t)},J.isZ=function(e){return e instanceof J.Z},J.init=function(e,t){var n;if(!e)return J.Z();if("string"==typeof e)if(e=e.trim(),"<"==e[0]&&F.test(e))n=J.fragment(e,RegExp.$1,t),e=null;else{if(t!==D)return S(t).find(e);n=J.qsa(E,e)}else{if(i(e))return S(E).ready(e);if(J.isZ(e))return e;if(ee(e))n=l(e);else if(o(e))n=[e],e=null;else if(F.test(e))n=J.fragment(e.trim(),RegExp.$1,t),e=null;else{if(t!==D)return S(t).find(e);n=J.qsa(E,e)}}return J.Z(n,e)},S=function(e,t){return J.init(e,t)},S.extend=function(e){var t,i=A.call(arguments,1);return"boolean"==typeof e&&(t=e,e=i.shift()),i.forEach(function(i){m(e,i,t)}),e},J.qsa=function(e,t){var i,n="#"==t[0],a=!n&&"."==t[0],o=n||a?t.slice(1):t,s=Y.test(o);return e.getElementById&&s&&n?(i=e.getElementById(o))?[i]:[]:1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType?[]:A.call(s&&!n&&e.getElementsByClassName?a?e.getElementsByClassName(o):e.getElementsByTagName(t):e.querySelectorAll(t))},S.contains=E.documentElement.contains?function(e,t){return e!==t&&e.contains(t)}:function(e,t){for(;t&&(t=t.parentNode);)if(t===e)return!0;return!1},S.type=t,S.isFunction=i,S.isWindow=n,S.isArray=ee,S.isPlainObject=s,S.isEmptyObject=function(e){var t;for(t in e)return!1;return!0},S.isNumeric=function(e){var t=Number(e),i=typeof e;return null!=e&&"boolean"!=i&&("string"!=i||e.length)&&!isNaN(t)&&isFinite(t)||!1},S.inArray=function(e,t,i){return R.indexOf.call(t,e,i)},S.camelCase=T,S.trim=function(e){return null==e?"":String.prototype.trim.call(e)},S.uuid=0,S.support={},S.expr={},S.noop=function(){},S.map=function(e,t){var i,n,a,o=[];if(r(e))for(n=0;n<e.length;n++)i=t(e[n],n),null!=i&&o.push(i);else for(a in e)i=t(e[a],a),null!=i&&o.push(i);return c(o)},S.each=function(e,t){var i,n;if(r(e)){for(i=0;i<e.length;i++)if(t.call(e[i],i,e[i])===!1)return e}else for(n in e)if(t.call(e[n],n,e[n])===!1)return e;return e},S.grep=function(e,t){return L.call(e,t)},e.JSON&&(S.parseJSON=JSON.parse),S.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){q["[object "+t+"]"]=t.toLowerCase()}),S.fn={constructor:J.Z,length:0,forEach:R.forEach,reduce:R.reduce,push:R.push,sort:R.sort,splice:R.splice,indexOf:R.indexOf,concat:function(){var e,t,i=[];for(e=0;e<arguments.length;e++)t=arguments[e],i[e]=J.isZ(t)?t.toArray():t;return $.apply(J.isZ(this)?this.toArray():this,i)},map:function(e){return S(S.map(this,function(t,i){return e.call(t,i,t)}))},slice:function(){return S(A.apply(this,arguments))},ready:function(e){return G.test(E.readyState)&&E.body?e(S):E.addEventListener("DOMContentLoaded",function(){e(S)},!1),this},get:function(e){return e===D?A.call(this):this[e>=0?e:e+this.length]},toArray:function(){return this.get()},size:function(){return this.length},remove:function(){return this.each(function(){null!=this.parentNode&&this.parentNode.removeChild(this)})},each:function(e){return R.every.call(this,function(t,i){return e.call(t,i,t)!==!1}),this},filter:function(e){return i(e)?this.not(this.not(e)):S(L.call(this,function(t){return J.matches(t,e)}))},add:function(e,t){return S(k(this.concat(S(e,t))))},is:function(e){return this.length>0&&J.matches(this[0],e)},not:function(e){var t=[];if(i(e)&&e.call!==D)this.each(function(i){e.call(this,i)||t.push(this)});else{var n="string"==typeof e?this.filter(e):r(e)&&i(e.item)?A.call(e):S(e);this.forEach(function(e){n.indexOf(e)<0&&t.push(e)})}return S(t)},has:function(e){return this.filter(function(){return o(e)?S.contains(this,e):S(this).find(e).size()})},eq:function(e){return e===-1?this.slice(e):this.slice(e,+e+1)},first:function(){var e=this[0];return e&&!o(e)?e:S(e)},last:function(){var e=this[this.length-1];return e&&!o(e)?e:S(e)},find:function(e){var t,i=this;return t=e?"object"==typeof e?S(e).filter(function(){var e=this;return R.some.call(i,function(t){return S.contains(t,e)})}):1==this.length?S(J.qsa(this[0],e)):this.map(function(){return J.qsa(this,e)}):S()},closest:function(e,t){var i=[],n="object"==typeof e&&S(e);return this.each(function(o,s){for(;s&&!(n?n.indexOf(s)>=0:J.matches(s,e));)s=s!==t&&!a(s)&&s.parentNode;s&&i.indexOf(s)<0&&i.push(s)}),S(i)},parents:function(e){for(var t=[],i=this;i.length>0;)i=S.map(i,function(e){if((e=e.parentNode)&&!a(e)&&t.indexOf(e)<0)return t.push(e),e});return y(t,e)},parent:function(e){return y(k(this.pluck("parentNode")),e)},children:function(e){return y(this.map(function(){return f(this)}),e)},contents:function(){return this.map(function(){return this.contentDocument||A.call(this.childNodes)})},siblings:function(e){return y(this.map(function(e,t){return L.call(f(t.parentNode),function(e){return e!==t})}),e)},empty:function(){return this.each(function(){this.innerHTML=""})},pluck:function(e){return S.map(this,function(t){return t[e]})},show:function(){return this.each(function(){"none"==this.style.display&&(this.style.display=""),"none"==getComputedStyle(this,"").getPropertyValue("display")&&(this.style.display=u(this.nodeName))})},replaceWith:function(e){return this.before(e).remove()},wrap:function(e){var t=i(e);if(this[0]&&!t)var n=S(e).get(0),a=n.parentNode||this.length>1;return this.each(function(i){S(this).wrapAll(t?e.call(this,i):a?n.cloneNode(!0):n)})},wrapAll:function(e){if(this[0]){S(this[0]).before(e=S(e));for(var t;(t=e.children()).length;)e=t.first();S(e).append(this)}return this},wrapInner:function(e){var t=i(e);return this.each(function(i){var n=S(this),a=n.contents(),o=t?e.call(this,i):e;a.length?a.wrapAll(o):n.append(o)})},unwrap:function(){return this.parent().each(function(){S(this).replaceWith(S(this).children())}),this},clone:function(){return this.map(function(){return this.cloneNode(!0)})},hide:function(){return this.css("display","none")},toggle:function(e){return this.each(function(){var t=S(this);(e===D?"none"==t.css("display"):e)?t.show():t.hide()})},prev:function(e){return S(this.pluck("previousElementSibling")).filter(e||"*")},next:function(e){return S(this.pluck("nextElementSibling")).filter(e||"*")},html:function(e){return 0 in arguments?this.each(function(t){var i=this.innerHTML;S(this).empty().append(v(this,e,t,i))}):0 in this?this[0].innerHTML:null},text:function(e){return 0 in arguments?this.each(function(t){var i=v(this,e,t,this.textContent);this.textContent=null==i?"":""+i}):0 in this?this.pluck("textContent").join(""):null},attr:function(e,t){var i;return"string"!=typeof e||1 in arguments?this.each(function(i){if(1===this.nodeType)if(o(e))for(I in e)w(this,I,e[I]);else w(this,e,v(this,t,i,this.getAttribute(e)))}):0 in this&&1==this[0].nodeType&&null!=(i=this[0].getAttribute(e))?i:D},removeAttr:function(e){return this.each(function(){1===this.nodeType&&e.split(" ").forEach(function(e){w(this,e)},this)})},prop:function(e,t){return e=Q[e]||e,1 in arguments?this.each(function(i){this[e]=v(this,t,i,this[e])}):this[0]&&this[0][e]},removeProp:function(e){return e=Q[e]||e,this.each(function(){delete this[e]})},data:function(e,t){var i="data-"+e.replace(z,"-$1").toLowerCase(),n=1 in arguments?this.attr(i,t):this.attr(i);return null!==n?b(n):D},val:function(e){return 0 in arguments?(null==e&&(e=""),this.each(function(t){this.value=v(this,e,t,this.value)})):this[0]&&(this[0].multiple?S(this[0]).find("option").filter(function(){return this.selected}).pluck("value"):this[0].value)},offset:function(t){if(t)return this.each(function(e){var i=S(this),n=v(this,t,e,i.offset()),a=i.offsetParent().offset(),o={top:n.top-a.top,left:n.left-a.left};"static"==i.css("position")&&(o.position="relative"),i.css(o)});if(!this.length)return null;if(E.documentElement!==this[0]&&!S.contains(E.documentElement,this[0]))return{top:0,left:0};var i=this[0].getBoundingClientRect();return{left:i.left+e.pageXOffset,top:i.top+e.pageYOffset,width:Math.round(i.width),height:Math.round(i.height)}},css:function(e,i){if(arguments.length<2){var n=this[0];if("string"==typeof e){if(!n)return;return n.style[T(e)]||getComputedStyle(n,"").getPropertyValue(e)}if(ee(e)){if(!n)return;var a={},o=getComputedStyle(n,"");return S.each(e,function(e,t){a[t]=n.style[T(t)]||o.getPropertyValue(t)}),a}}var s="";if("string"==t(e))i||0===i?s=p(e)+":"+h(e,i):this.each(function(){this.style.removeProperty(p(e))});else for(I in e)e[I]||0===e[I]?s+=p(I)+":"+h(I,e[I])+";":this.each(function(){this.style.removeProperty(p(I))});return this.each(function(){this.style.cssText+=";"+s})},index:function(e){return e?this.indexOf(S(e)[0]):this.parent().children().indexOf(this[0])},hasClass:function(e){return!!e&&R.some.call(this,function(e){return this.test(x(e))},d(e))},addClass:function(e){return e?this.each(function(t){if("className"in this){C=[];var i=x(this),n=v(this,e,t,i);n.split(/\s+/g).forEach(function(e){S(this).hasClass(e)||C.push(e)},this),C.length&&x(this,i+(i?" ":"")+C.join(" "))}}):this},removeClass:function(e){return this.each(function(t){if("className"in this){if(e===D)return x(this,"");C=x(this),v(this,e,t,C).split(/\s+/g).forEach(function(e){C=C.replace(d(e)," ")}),x(this,C.trim())}})},toggleClass:function(e,t){return e?this.each(function(i){var n=S(this),a=v(this,e,i,x(this));a.split(/\s+/g).forEach(function(e){(t===D?!n.hasClass(e):t)?n.addClass(e):n.removeClass(e)})}):this},scrollTop:function(e){if(this.length){var t="scrollTop"in this[0];return e===D?t?this[0].scrollTop:this[0].pageYOffset:this.each(t?function(){this.scrollTop=e}:function(){this.scrollTo(this.scrollX,e)})}},scrollLeft:function(e){if(this.length){var t="scrollLeft"in this[0];return e===D?t?this[0].scrollLeft:this[0].pageXOffset:this.each(t?function(){this.scrollLeft=e}:function(){this.scrollTo(e,this.scrollY)})}},position:function(){if(this.length){var e=this[0],t=this.offsetParent(),i=this.offset(),n=B.test(t[0].nodeName)?{top:0,left:0}:t.offset();return i.top-=parseFloat(S(e).css("margin-top"))||0,i.left-=parseFloat(S(e).css("margin-left"))||0,n.top+=parseFloat(S(t[0]).css("border-top-width"))||0,n.left+=parseFloat(S(t[0]).css("border-left-width"))||0,{top:i.top-n.top,left:i.left-n.left}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||E.body;e&&!B.test(e.nodeName)&&"static"==S(e).css("position");)e=e.offsetParent;return e})}},S.fn.detach=S.fn.remove,["width","height"].forEach(function(e){var t=e.replace(/./,function(e){return e[0].toUpperCase()});S.fn[e]=function(i){var o,s=this[0];return i===D?n(s)?s["inner"+t]:a(s)?s.documentElement["scroll"+t]:(o=this.offset())&&o[e]:this.each(function(t){s=S(this),s.css(e,v(this,i,t,s[e]()))})}}),K.forEach(function(i,n){var a=n%2;S.fn[i]=function(){var i,o,s=S.map(arguments,function(e){var n=[];return i=t(e),"array"==i?(e.forEach(function(e){return e.nodeType!==D?n.push(e):S.zepto.isZ(e)?n=n.concat(e.get()):void(n=n.concat(J.fragment(e)))}),n):"object"==i||null==e?e:J.fragment(e)}),r=this.length>1;return s.length<1?this:this.each(function(t,i){o=a?i:i.parentNode,i=0==n?i.nextSibling:1==n?i.firstChild:2==n?i:null;var l=S.contains(E.documentElement,o);s.forEach(function(t){if(r)t=t.cloneNode(!0);else if(!o)return S(t).remove();o.insertBefore(t,i),l&&_(t,function(t){if(!(null==t.nodeName||"SCRIPT"!==t.nodeName.toUpperCase()||t.type&&"text/javascript"!==t.type||t.src)){var i=t.ownerDocument?t.ownerDocument.defaultView:e;i.eval.call(i,t.innerHTML)}})})})},S.fn[a?i+"To":"insert"+(n?"Before":"After")]=function(e){return S(e)[i](this),this}}),J.Z.prototype=g.prototype=S.fn,J.uniq=k,J.deserializeValue=b,S.zepto=J,S}();return e.Zepto=t,void 0===e.$&&(e.$=t),function(t){function i(e){return e._zid||(e._zid=u++)}function n(e,t,n,s){if(t=a(t),t.ns)var r=o(t.ns);return(y[i(e)]||[]).filter(function(e){return e&&(!t.e||e.e==t.e)&&(!t.ns||r.test(e.ns))&&(!n||i(e.fn)===i(n))&&(!s||e.sel==s)})}function a(e){var t=(""+e).split(".");return{e:t[0],ns:t.slice(1).sort().join(" ")}}function o(e){return new RegExp("(?:^| )"+e.replace(" "," .* ?")+"(?: |$)")}function s(e,t){return e.del&&!w&&e.e in x||!!t}function r(e){return b[e]||w&&x[e]||e}function l(e,n,o,l,c,d,u){var f=i(e),g=y[f]||(y[f]=[]);n.split(/\s/).forEach(function(i){if("ready"==i)return t(document).ready(o);var n=a(i);n.fn=o,n.sel=c,n.e in b&&(o=function(e){var i=e.relatedTarget;if(!i||i!==this&&!t.contains(this,i))return n.fn.apply(this,arguments)}),n.del=d;var f=d||o;n.proxy=function(t){if(t=p(t),!t.isImmediatePropagationStopped()){t.data=l;var i=f.apply(e,t._args==h?[t]:[t].concat(t._args));return i===!1&&(t.preventDefault(),t.stopPropagation()),i}},n.i=g.length,g.push(n),"addEventListener"in e&&e.addEventListener(r(n.e),n.proxy,s(n,u))})}function c(e,t,a,o,l){var c=i(e);(t||"").split(/\s/).forEach(function(t){n(e,t,a,o).forEach(function(t){delete y[c][t.i],"removeEventListener"in e&&e.removeEventListener(r(t.e),t.proxy,s(t,l))})})}function p(e,i){return!i&&e.isDefaultPrevented||(i||(i=e),t.each(S,function(t,n){var a=i[t];e[t]=function(){return this[n]=_,a&&a.apply(i,arguments)},e[n]=D}),e.timeStamp||(e.timeStamp=Date.now()),(i.defaultPrevented!==h?i.defaultPrevented:"returnValue"in i?i.returnValue===!1:i.getPreventDefault&&i.getPreventDefault())&&(e.isDefaultPrevented=_)),e}function d(e){var t,i={originalEvent:e};for(t in e)I.test(t)||e[t]===h||(i[t]=e[t]);return p(i,e)}var h,u=1,f=Array.prototype.slice,g=t.isFunction,m=function(e){return"string"==typeof e},y={},v={},w="onfocusin"in e,x={focus:"focusin",blur:"focusout"},b={mouseenter:"mouseover",mouseleave:"mouseout"};v.click=v.mousedown=v.mouseup=v.mousemove="MouseEvents",t.event={add:l,remove:c},t.proxy=function(e,n){var a=2 in arguments&&f.call(arguments,2);if(g(e)){var o=function(){return e.apply(n,a?a.concat(f.call(arguments)):arguments)};return o._zid=i(e),o}if(m(n))return a?(a.unshift(e[n],e),t.proxy.apply(null,a)):t.proxy(e[n],e);throw new TypeError("expected function")},t.fn.bind=function(e,t,i){return this.on(e,t,i)},t.fn.unbind=function(e,t){return this.off(e,t)},t.fn.one=function(e,t,i,n){return this.on(e,t,i,n,1)};var _=function(){return!0},D=function(){return!1},I=/^([A-Z]|returnValue$|layer[XY]$|webkitMovement[XY]$)/,S={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};t.fn.delegate=function(e,t,i){return this.on(t,e,i)},t.fn.undelegate=function(e,t,i){return this.off(t,e,i)},t.fn.live=function(e,i){return t(document.body).delegate(this.selector,e,i),this},t.fn.die=function(e,i){return t(document.body).undelegate(this.selector,e,i),this},t.fn.on=function(e,i,n,a,o){var s,r,p=this;return e&&!m(e)?(t.each(e,function(e,t){p.on(e,i,n,t,o)}),p):(m(i)||g(a)||a===!1||(a=n,n=i,i=h),a!==h&&n!==!1||(a=n,n=h),a===!1&&(a=D),p.each(function(p,h){o&&(s=function(e){return c(h,e.type,a),a.apply(this,arguments)}),i&&(r=function(e){var n,o=t(e.target).closest(i,h).get(0);if(o&&o!==h)return n=t.extend(d(e),{currentTarget:o,liveFired:h}),(s||a).apply(o,[n].concat(f.call(arguments,1)))}),l(h,e,a,n,i,r||s)}))},t.fn.off=function(e,i,n){var a=this;return e&&!m(e)?(t.each(e,function(e,t){a.off(e,i,t)}),a):(m(i)||g(n)||n===!1||(n=i,i=h),n===!1&&(n=D),a.each(function(){c(this,e,n,i)}))},t.fn.trigger=function(e,i){return e=m(e)||t.isPlainObject(e)?t.Event(e):p(e),e._args=i,this.each(function(){e.type in x&&"function"==typeof this[e.type]?this[e.type]():"dispatchEvent"in this?this.dispatchEvent(e):t(this).triggerHandler(e,i)})},t.fn.triggerHandler=function(e,i){var a,o;return this.each(function(s,r){a=d(m(e)?t.Event(e):e),a._args=i,a.target=r,t.each(n(r,e.type||e),function(e,t){if(o=t.proxy(a),a.isImmediatePropagationStopped())return!1})}),o},"focusin focusout focus blur load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select keydown keypress keyup error".split(" ").forEach(function(e){t.fn[e]=function(t){return 0 in arguments?this.bind(e,t):this.trigger(e)}}),t.Event=function(e,t){m(e)||(t=e,e=t.type);var i=document.createEvent(v[e]||"Events"),n=!0;if(t)for(var a in t)"bubbles"==a?n=!!t[a]:i[a]=t[a];return i.initEvent(e,n,!0),p(i)}}(t),function(t){function i(e,i,n){var a=t.Event(i);return t(e).trigger(a,n),!a.isDefaultPrevented()}function n(e,t,n,a){if(e.global)return i(t||x,n,a)}function a(e){e.global&&0===t.active++&&n(e,null,"ajaxStart")}function o(e){e.global&&!--t.active&&n(e,null,"ajaxStop")}function s(e,t){var i=t.context;return t.beforeSend.call(i,e,t)!==!1&&n(t,i,"ajaxBeforeSend",[e,t])!==!1&&void n(t,i,"ajaxSend",[e,t])}function r(e,t,i,a){var o=i.context,s="success";i.success.call(o,e,s,t),a&&a.resolveWith(o,[e,s,t]),n(i,o,"ajaxSuccess",[t,i,e]),c(s,t,i)}function l(e,t,i,a,o){var s=a.context;a.error.call(s,i,t,e),o&&o.rejectWith(s,[i,t,e]),n(a,s,"ajaxError",[i,a,e||t]),c(t,i,a)}function c(e,t,i){var a=i.context;i.complete.call(a,t,e),n(i,a,"ajaxComplete",[t,i]),o(i)}function p(e,t,i){if(i.dataFilter==d)return e;var n=i.context;return i.dataFilter.call(n,e,t)}function d(){}function h(e){return e&&(e=e.split(";",2)[0]),e&&(e==S?"html":e==I?"json":_.test(e)?"script":D.test(e)&&"xml")||"text"}function u(e,t){return""==t?e:(e+"&"+t).replace(/[&?]{1,2}/,"?")}function f(e){e.processData&&e.data&&"string"!=t.type(e.data)&&(e.data=t.param(e.data,e.traditional)),!e.data||e.type&&"GET"!=e.type.toUpperCase()&&"jsonp"!=e.dataType||(e.url=u(e.url,e.data),e.data=void 0)}function g(e,i,n,a){return t.isFunction(i)&&(a=n,n=i,i=void 0),t.isFunction(n)||(a=n,n=void 0),{url:e,data:i,success:n,dataType:a}}function m(e,i,n,a){var o,s=t.isArray(i),r=t.isPlainObject(i);t.each(i,function(i,l){o=t.type(l),a&&(i=n?a:a+"["+(r||"object"==o||"array"==o?i:"")+"]"),!a&&s?e.add(l.name,l.value):"array"==o||!n&&"object"==o?m(e,l,n,i):e.add(i,l)})}var y,v,w=+new Date,x=e.document,b=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,_=/^(?:text|application)\/javascript/i,D=/^(?:text|application)\/xml/i,I="application/json",S="text/html",C=/^\s*$/,T=x.createElement("a");T.href=e.location.href,t.active=0,t.ajaxJSONP=function(i,n){if(!("type"in i))return t.ajax(i);var a,o,c=i.jsonpCallback,p=(t.isFunction(c)?c():c)||"Zepto"+w++,d=x.createElement("script"),h=e[p],u=function(e){t(d).triggerHandler("error",e||"abort")},f={abort:u};return n&&n.promise(f),t(d).on("load error",function(s,c){clearTimeout(o),t(d).off().remove(),"error"!=s.type&&a?r(a[0],f,i,n):l(null,c||"error",f,i,n),e[p]=h,a&&t.isFunction(h)&&h(a[0]),h=a=void 0}),s(f,i)===!1?(u("abort"),f):(e[p]=function(){a=arguments},d.src=i.url.replace(/\?(.+)=\?/,"?$1="+p),x.head.appendChild(d),i.timeout>0&&(o=setTimeout(function(){u("timeout")},i.timeout)),f)},t.ajaxSettings={type:"GET",beforeSend:d,success:d,error:d,complete:d,context:null,global:!0,xhr:function(){return new e.XMLHttpRequest},accepts:{script:"text/javascript, application/javascript, application/x-javascript",json:I,xml:"application/xml, text/xml",html:S,text:"text/plain"},crossDomain:!1,timeout:0,processData:!0,cache:!0,dataFilter:d},t.ajax=function(i){var n,o,c=t.extend({},i||{}),g=t.Deferred&&t.Deferred();for(y in t.ajaxSettings)void 0===c[y]&&(c[y]=t.ajaxSettings[y]);a(c),c.crossDomain||(n=x.createElement("a"),n.href=c.url,n.href=n.href,c.crossDomain=T.protocol+"//"+T.host!=n.protocol+"//"+n.host),c.url||(c.url=e.location.toString()),(o=c.url.indexOf("#"))>-1&&(c.url=c.url.slice(0,o)),f(c);var m=c.dataType,w=/\?.+=\?/.test(c.url);if(w&&(m="jsonp"),c.cache!==!1&&(i&&i.cache===!0||"script"!=m&&"jsonp"!=m)||(c.url=u(c.url,"_="+Date.now())),"jsonp"==m)return w||(c.url=u(c.url,c.jsonp?c.jsonp+"=?":c.jsonp===!1?"":"callback=?")),t.ajaxJSONP(c,g);var b,_=c.accepts[m],D={},I=function(e,t){D[e.toLowerCase()]=[e,t]},S=/^([\w-]+:)\/\//.test(c.url)?RegExp.$1:e.location.protocol,k=c.xhr(),R=k.setRequestHeader;if(g&&g.promise(k),c.crossDomain||I("X-Requested-With","XMLHttpRequest"),I("Accept",_||"*/*"),(_=c.mimeType||_)&&(_.indexOf(",")>-1&&(_=_.split(",",2)[0]),k.overrideMimeType&&k.overrideMimeType(_)),(c.contentType||c.contentType!==!1&&c.data&&"GET"!=c.type.toUpperCase())&&I("Content-Type",c.contentType||"application/x-www-form-urlencoded"),c.headers)for(v in c.headers)I(v,c.headers[v]);if(k.setRequestHeader=I,k.onreadystatechange=function(){
if(4==k.readyState){k.onreadystatechange=d,clearTimeout(b);var e,i=!1;if(k.status>=200&&k.status<300||304==k.status||0==k.status&&"file:"==S){if(m=m||h(c.mimeType||k.getResponseHeader("content-type")),"arraybuffer"==k.responseType||"blob"==k.responseType)e=k.response;else{e=k.responseText;try{e=p(e,m,c),"script"==m?(0,eval)(e):"xml"==m?e=k.responseXML:"json"==m&&(e=C.test(e)?null:t.parseJSON(e))}catch(e){i=e}if(i)return l(i,"parsererror",k,c,g)}r(e,k,c,g)}else l(k.statusText||null,k.status?"error":"abort",k,c,g)}},s(k,c)===!1)return k.abort(),l(null,"abort",k,c,g),k;var $=!("async"in c)||c.async;if(k.open(c.type,c.url,$,c.username,c.password),c.xhrFields)for(v in c.xhrFields)k[v]=c.xhrFields[v];for(v in D)R.apply(k,D[v]);return c.timeout>0&&(b=setTimeout(function(){k.onreadystatechange=d,k.abort(),l(null,"timeout",k,c,g)},c.timeout)),k.send(c.data?c.data:null),k},t.get=function(){return t.ajax(g.apply(null,arguments))},t.post=function(){var e=g.apply(null,arguments);return e.type="POST",t.ajax(e)},t.getJSON=function(){var e=g.apply(null,arguments);return e.dataType="json",t.ajax(e)},t.fn.load=function(e,i,n){if(!this.length)return this;var a,o=this,s=e.split(/\s/),r=g(e,i,n),l=r.success;return s.length>1&&(r.url=s[0],a=s[1]),r.success=function(e){o.html(a?t("<div>").html(e.replace(b,"")).find(a):e),l&&l.apply(o,arguments)},t.ajax(r),this};var k=encodeURIComponent;t.param=function(e,i){var n=[];return n.add=function(e,i){t.isFunction(i)&&(i=i()),null==i&&(i=""),this.push(k(e)+"="+k(i))},m(n,e,i),n.join("&").replace(/%20/g,"+")}}(t),function(e){e.fn.serializeArray=function(){var t,i,n=[],a=function(e){return e.forEach?e.forEach(a):void n.push({name:t,value:e})};return this[0]&&e.each(this[0].elements,function(n,o){i=o.type,t=o.name,t&&"fieldset"!=o.nodeName.toLowerCase()&&!o.disabled&&"submit"!=i&&"reset"!=i&&"button"!=i&&"file"!=i&&("radio"!=i&&"checkbox"!=i||o.checked)&&a(e(o).val())}),n},e.fn.serialize=function(){var e=[];return this.serializeArray().forEach(function(t){e.push(encodeURIComponent(t.name)+"="+encodeURIComponent(t.value))}),e.join("&")},e.fn.submit=function(t){if(0 in arguments)this.bind("submit",t);else if(this.length){var i=e.Event("submit");this.eq(0).trigger(i),i.isDefaultPrevented()||this.get(0).submit()}return this}}(t),function(){try{getComputedStyle(void 0)}catch(i){var t=getComputedStyle;e.getComputedStyle=function(e,i){try{return t(e,i)}catch(e){return null}}}}(),function(t){function i(e,t,i,n){return Math.abs(e-t)>=Math.abs(i-n)?e-t>0?"Left":"Right":i-n>0?"Up":"Down"}function n(){d=null,u.last&&(u.el.trigger("longTap"),u={})}function a(){d&&clearTimeout(d),d=null}function o(){l&&clearTimeout(l),c&&clearTimeout(c),p&&clearTimeout(p),d&&clearTimeout(d),l=c=p=d=null,u={}}function s(e){return("touch"==e.pointerType||e.pointerType==e.MSPOINTER_TYPE_TOUCH)&&e.isPrimary}function r(e,t){return e.type=="pointer"+t||e.type.toLowerCase()=="mspointer"+t}var l,c,p,d,h,u={},f=750;t(document).ready(function(){var g,m,y,v,w=0,x=0;"MSGesture"in e&&(h=new MSGesture,h.target=document.body),t(document).bind("MSGestureEnd",function(e){var t=e.velocityX>1?"Right":e.velocityX<-1?"Left":e.velocityY>1?"Down":e.velocityY<-1?"Up":null;t&&(u.el.trigger("swipe"),u.el.trigger("swipe"+t))}).on("touchstart MSPointerDown pointerdown",function(e){(v=r(e,"down"))&&!s(e)||(y=v?e:e.touches[0],e.touches&&1===e.touches.length&&u.x2&&(u.x2=void 0,u.y2=void 0),g=Date.now(),m=g-(u.last||g),u.el=t("tagName"in y.target?y.target:y.target.parentNode),l&&clearTimeout(l),u.x1=y.pageX,u.y1=y.pageY,m>0&&m<=250&&(u.isDoubleTap=!0),u.last=g,d=setTimeout(n,f),h&&v&&h.addPointer(e.pointerId))}).on("touchmove MSPointerMove pointermove",function(e){(v=r(e,"move"))&&!s(e)||(y=v?e:e.touches[0],a(),u.x2=y.pageX,u.y2=y.pageY,w+=Math.abs(u.x1-u.x2),x+=Math.abs(u.y1-u.y2))}).on("touchend MSPointerUp pointerup",function(e){(v=r(e,"up"))&&!s(e)||(a(),u.x2&&Math.abs(u.x1-u.x2)>30||u.y2&&Math.abs(u.y1-u.y2)>30?p=setTimeout(function(){u.el&&(u.el.trigger("swipe"),u.el.trigger("swipe"+i(u.x1,u.x2,u.y1,u.y2))),u={}},0):"last"in u&&(w<30&&x<30?c=setTimeout(function(){var e=t.Event("tap");e.cancelTouch=o,u.el&&u.el.trigger(e),u.isDoubleTap?(u.el&&u.el.trigger("doubleTap"),u={}):l=setTimeout(function(){l=null,u.el&&u.el.trigger("singleTap"),u={}},250)},0):u={}),w=x=0)}).on("touchcancel MSPointerCancel pointercancel",o),t(e).on("scroll",o)}),["swipe","swipeLeft","swipeRight","swipeUp","swipeDown","doubleTap","tap","singleTap","longTap"].forEach(function(e){t.fn[e]=function(t){return this.on(e,t)}})}(t),t}),define("pm",["utils","pageview","$","tip"],function(e,t,i,n){function a(){var e=this;this.pages={},this.isForward=!0,this.isInit=!0,this.pagekeySeed=0,this.isPrevent=!1,this.$el=i("<div class='yy-root-view'></div>"),this.$el.appendTo(document.body),window.onhashchange=function(){e.hashChange()};var t=null,n=null;i(document.body).bind("touchstart",function(e){for(t=e.target,n=t.getAttribute("data-activecn");t&&!n&&"BODY"!=t.tagName.toUpperCase()&&(t=t.parentNode,!(n=t.getAttribute("data-activecn"))););t&&n&&i(t).addClass(n)}),i(document.body).bind("touchend",function(){t&&n&&i(t).removeClass(n),t=null})}var o=!1,s=!1,r=!1;return a.prototype={blur:function(){document.activeElement&&document.activeElement.blur()},showTip:function(e){this.Tip=new n(this.$el),this.Tip.show(e)},start:function(t){e.appConfig=t,this.appConfig=t,e.customerComponents=t.customerComponents||{},t.baseSize=t.baseSize||{width:375,height:667},e.baseSize.width=t.baseSize.width,e.baseSize.height=t.baseSize.height,this.config=t;var i=this.getPageNameFromUrl();if(i){this.hashChange();var n=i.split("$$");2==n.length&&(this.pagekeySeed=parseInt(n[1]))}else this.go(t.root,this.getParamsFromUrl())},showPageKeyDict:{},regeistShowPageInRouter:function(e){this.showPageKeyDict[e]=!0},preventHasChange:function(){r=!0},hashChange:function(){var e=this.getPageNameFromUrl(),t=this.pages[this.fromPage],i=this;if(o)return o=!1,void(this.firstLoadToChangeHash=!1);if(r===!0)return void(r=!1);if(this.isInit&&e===this.appConfig.root&&(this.firstLoadToChangeHash=!0),!this.isForward&&t&&this.showPageKeyDict[this.fromPage]===!0&&t.showpage_wrapper){var n=t.hideCurShowPage();if(!n){delete this.showPageKeyDict[this.fromPage];var a=t.plugin.onPageResume;a&&a.call(t.plugin,t,{isForward:!1})}return o=!0,void window.history.go(1)}if(t){var l=t.plugin.onPageBeforeLeave;if(l){var c=l.call(t.plugin,t,{isForward:this.isForward});if(c===!1)return o=!0,void window.history.go(1)}}if(this.config.routerChange){var p=this.config.routerChange({fromPage:this.fromPage,toPage:e,isForward:this.isForward,params:this.getParamsFromUrl()});if(p===!1)return o=!0,void window.history.go(1)}var d=this.pages[e];if(t&&!d&&t.showLoadingProgressbar(),this.blur(),this._renderNextPage(e,this.fromPage,this.isForward,t,function(t,n,a){n?(s&&(s=!1,i.pages[t].destory(),delete i.pages[t]),i.fromPage=e):window.setTimeout(function(){t&&i.pages[t]&&(i.pages[t].destory(),delete i.pages[t]),i.fromPage=e},300)},function(e){o=!0,window.history.go(-1),e&&e.hideLoadingProgressbar()}),this.firstLoadToChangeHash){var h=this.getParamsFromUrl()||{};h._r=(new Date).valueOf(),this.go(this.appConfig.root,h),o=!0}},_renderNextPage:function(e,t,i,n,a,o){var s=this,r=this.pages[e],l="yy-pageview displayflex "+(i?"left-out":"right-out");if(n&&n.hideLoadingProgressbar(),r){if(!this.isForward){var c="yy-pageview displayflex left-in";r.$el[0].className=c;var p=r.plugin.onPageResume;p&&p.call(r.plugin,r,{isForward:!1})}n&&(n.$el[0].className=l),a(t,i,n),this.isForward=!1}else s.getPageConfigByPageKey(e,function(o){o.prePageView=i?n:null;var r=s.createPageView(o);s.pages[e]=r,s.$el.append(r.$el),s.isInit?(s.isForward=!1,r.Enter("yy-pageview displayflex yy-pageview-show",s.isInit),s.isInit=!1):window.setTimeout(function(){r.Enter("yy-pageview displayflex "+(s.isForward?"right-in":"left-in"),s.isInit),n&&(n.$el[0].className=l),s.isForward=!1},40),a(t,i,n)},function(e){o&&o(n)})},createPageView:function(e){return new t(e)},getPageNameFromUrl:function(){var e=window.location.hash.split("#"),t=e[1];if(!t)return this.rootPageKey;var i=t.split("?");return i[0]},getParamsStrFromUrl:function(){var e=window.location.href.split("?"),t=e[e.length-1];if(!t)return null;var i=t.split("#");return i[0]},getParamsFromUrl:function(){var e=this.getParamsStrFromUrl();if(!e)return null;for(var t={},i=e.split("&"),n=0,a=i.length;n<a;n++){var o=i[n].split("=");if(2==o.length)t=t||{},t[o[0]]=o[1];else if(o.length>2){var s=o.shift();t[s]=o.join("=")}}return t},tabSeleced:function(e,t){t||(o=!0);var i=this.getParamsFromUrl()||{};i.$$pn=e;var n=[];for(var a in i)n.push(a+"="+i[a]);var s=this.getPageNameFromUrl();n.length>0?location.replace(location.href.split("#")[0]+"#"+s+"?"+n.join("&")):location.replace(location.href.split("#")[0]+"#"+s)},goBack:function(e){var t=e||-1;this.isForward=!1,window.history.go(t)},go:function(e,t){this.isForward=!0,o=!1,this.isInit&&(this.rootPageKey=e),t=t||{};var i=[];for(var n in t)i.push(n+"="+t[n]);e=this._getUniquePageKey(e),i.length>0?location.hash=e+"?"+i.join("&"):location.hash=e},replaceGo:function(e,t){this.isForward=!0,o=!1,this.isInit&&(this.rootPageKey=e),t=t||{};var i=[];for(var n in t)i.push(n+"="+t[n]);e=this._getUniquePageKey(e),s=!0,i.length>0?location.replace(location.href.split("#")[0]+"#"+e+"?"+i.join("&")):location.replace(location.href.split("#")[0]+"#"+e)},_getUniquePageKey:function(e){var t=!1;for(var i in this.pages){var n=i.split("$$");if(n[0]==e){this.pagekeySeed+=1,t=!0;break}}return t?e+"$$"+this.pagekeySeed:e},_getPageConfigSuccess:function(t,i,n){i=e.copy(i),i.type="pageview",i.pageKey=t,i.$$params=this.getParamsFromUrl(),i.$$pageManager=this,n(i)},getPageConfigByPageKey:function(t,i,n){var a=this,o="./pages/"+t.split("$$")[0],s=e.getPageConfigByPagePath(o);return s?void this._getPageConfigSuccess(t,s,i):void require([o],function(n){n=e.setPageConfigByPagePath(o,n),a._getPageConfigSuccess(t,n,i)},function(e){console.error(e),n&&n(t)})}},new a}),require.config({waitSeconds:0,baseUrl:"./",shim:{$:{exports:"zepto"}},paths:{$:"../../libs/zepto",md5:"../../libs/md5",utils:"../../js/utils",base:"../../components/base",pageview:"../../components/pageview",pm:"../../js/pageViewManager",swiper:"../../components/swiper",calendar:"../../../components/calendar",tip:"../../components/tip"}}),require(["app","pm","$"],function(e,t,i){e.init||console.error("app.js 未提供init方法"),e.init(t)}),define("../../js/main",function(){}),define("../../components/base",["utils","tip"],function(e,t){function i(e,t){if(!e)return null;for(var i=e,n=0,a=t.length;n<a;n++){var o=t[n];if(i=i[o],!i&&0!=i){i=null;break}}return i}var n=function(t){var i=this;this.pageview=t.$$pageview||this,this.loaderHtml="<div class='spinner center'><div class='spinner-blade'></div><div class='spinner-blade'></div><div class='spinner-blade'></div><div class='spinner-blade'></div><div class='spinner-blade'></div><div class='spinner-blade'></div><div class='spinner-blade'></div><div class='spinner-blade'></div><div class='spinner-blade'></div><div class='spinner-blade'></div><div class='spinner-blade'></div><div class='spinner-blade'></div></div>",this.disabled=!1,this.parent=t.$$parent,this.datasource=t.$$datasource||[],this.rowInstance=t.$$rowInstance,t.ref&&(this.rowInstance?(this.rowInstance.refs=this.rowInstance.refs||{},this.rowInstance.refs[t.comKey]=this):this.pageview.refs[t.comKey]=this);var n=t.className||"";this.selectedClassName=t.selectedClassName,t.tagName=t.tagName||"DIV";var a=t.activeClassName?"data-activecn='"+t.activeClassName+"'":"";this.$el=$("<"+t.tagName+" "+a+" data-comname='"+t.comKey+"' class='"+n+"'></"+t.tagName+">"),t=this._processConfig(t),this.config=t,this.components={},"repeat"!=t.type&&"listview"!=t.type||(this.components=[]),t.comKey&&this.$el.addClass(t.comKey);var o=this.config.comKey+"_init";if("repeatitem"===t.type?o=this.parent.config.comKey+"_iteminit":"listrow"===t.type&&(o=this.parent.config.comKey+"_rowinit"),"pageview"===this.config.type){var s=this.config.children;if(s&&s instanceof Array)for(var r=0,l=s.length;r<l;r++){var c=s[r].components;if(c)for(var p in c){var d=e.copy(c[p]);for(var h in d)h.length>=5&&"STYLE"==h.substring(h.length-5).toUpperCase()&&(d[h]=this.processStyle(d[h],BaseSize));this.config.components[p]=d}}}if(this.pageview.plugin&&this.pageview.plugin[o]){var u=this.pageview.plugin[o];u&&u.call(this.pageview.plugin,this)}var f=t.style;if(t.noNeedSetStyle||f&&"pageview"!=t.type&&"segment"!=t.type&&e.css(this.$el,f),this.disabledClassName=t.disabledClassName||"yy-disabled",this.disabled&&this.setDisabled(!0),t.comKey){var g=t.comKey+"_click",m=i.pageview.plugin[g];m&&this.$el.bind("click",function(e){e.preventDefault(),e.stopPropagation(),!i.disabled&&m&&m.call(i.pageview.plugin,i,{e:e})});var y=t.comKey+"_tap",v=i.pageview.plugin[y];v&&this.$el.bind("singleTap",function(e){e.preventDefault(),e.stopPropagation(),!i.disabled&&v&&v.call(i.pageview.plugin,i,{e:e})})}};return n.prototype.setDisabled=function(e){this.disabled=e,this.disabled?this.$el.addClass(this.disabledClassName):this.$el.removeClass(this.disabledClassName)},n.prototype._processConfig=function(e){for(var t in e){var n=t.split("_");if(2==n.length&&"bind"==n[1]){var a=e[t],o=n[0],s=typeof a;if("string"==s)e[o]=i(this.datasource,a.split("."));else if("object"==s)for(var r in a){var l=r,c=i(this.datasource,a[r].split("."));e[o]=e[o]||{},e[o][l]=c}}}return e},n.prototype.selected=function(e){if(!e||!this.config.disableParentSelect){this.isSelected=!0,this.selectedClassName&&""!==this.selectedClassName&&this.$el.addClass(this.selectedClassName);for(var t in this.components)this.components[t].selected(!0)}},n.prototype.unSelected=function(e){if(!e||!this.config.disableParentSelect){this.isSelected=!1,this.selectedClassName&&""!==this.selectedClassName&&this.$el.removeClass(this.selectedClassName);for(var t in this.components)this.components[t].unSelected(!0)}},n.prototype.getUniqueKey=function(){return this.pageview.config.pageKey+""+this.config.comKey},n.prototype.showTip=function(e){this.Tip=new t(this.$el),this.Tip.show(e)},n.prototype._prepareComponent=function(t,i,n){var a=e.clone(this.pageview.config.components[t]),o=a.type,s=e.getComponentInstance(o);a.$$pageview=this.pageview,a.$$rowInstance=n,a.$$parent=this,a.comKey=t,a.$$datasource=i;var r=null;try{r=new s(a,null)}catch(e){console.log(e),console.log(a)}var l=t+"_didmount";if(this.pageview.plugin){var c=this.pageview.plugin[l];c&&c.call(this.pageview.plugin,r)}return this.pageview.componentsInitActions[t]&&(this.pageview.componentsInitActions[t](r),delete this.pageview.componentsInitActions[t]),r},n.prototype._initComponents=function(e,t,i,n){for(var a=0,o=e.root.length;a<o;a++){var s=e.root[a],r=this._prepareComponent(s,t,n);e.isContainer||"repeat"==e.type?(this.components.push=r,i(r)):"tabbarview"==e.type?(this.components[s]=r,i(r)):this.components[s]=r}return this.components},n.prototype.getClientRect=function(){return this.$el[0].getBoundingClientRect()},n.prototype.getComponentInstanceByComKey=function(e,t,i,n,a){var o=this;this.loadFiles([e],this.pageview||this,function(){var a=o._prepareComponent(e,t,i);n(a)},function(){a&&a()})},n.prototype.initLayout=function(t,i,n,a){var o=this;this.config.root&&this.config.root.length>0&&this.loadFiles(this.config.root,this.pageview||this,function(){if(i)o._initComponents(o.config,t,i,n);else{o._initComponents(o.config,t,null,n);for(var s=0,r=o.config.root.length;s<r;s++){var l=o.components[o.config.root[s]],c=o.$$childrenWrapper||o.$el;null===l&&(console.log(o.config.root[s]),console.log(o.config.root),console.log(o.components)),"checklist"===l.config.type||"radiolist"===l.config.type?o.pageview.$el.append(l.$el):c.append(l.$el);var p;o.config.splitStyle&&o.config.root.length>1&&s!=o.config.root.length-1&&(p=$("<div></div>"),l.splitLine=p,e.css(p,o.config.splitStyle,!0),c.append(p))}}if(a&&a(),"pageview"==o.config.type){var d=o.plugin.onPageLoad;d&&d.call(o.plugin,o)}},function(){})},n.prototype.setBadge=function(t,i){if(!this.$$badge){this.$$badge=$("<div class='displayflex jc-center ai-center yy-badge displaynone'></div>"),i=i||{};var n=i.width||i.height||16;i["min-width"]=i.height=n,delete i.width,i=e.processStyle(i),i["border-radius"]=parseInt(i.height)/2+"px",e.css(this.$$badge,i),this.$el.append(this.$$badge)}t?this.$$badge.html(t).removeClass("displaynone"):this.$$badge.addClass("displaynone")},n.prototype.showLoading=function(t){if(t=t||{},this.loadingConfig=t,!this.$$loadingWrapper){t.timeout&&!isNaN(t.timeout)||(t.timeout=7e3),this.loadingtimeout=parseInt(t.timeout)||7e3;var i="displaynone yy-loading-bk displayflex yy-jc-center yy-ai-center ";t.style&&(t.style.alignItems||t.style["align-items"]||(i+="yy-ai-center")),this.$$loadingWrapper=$("<div class='"+i+"'></div>"),t.style&&e.css(this.$$loadingWrapper,t.style);var n=$("<div class='yy-loading-wrapper yy-fd-column displayflex yy-jc-center yy-ai-center'>"+this.loaderHtml+"</div>");this.loadingText=$("<span class='yy-loading-text'></span>"),n.append(this.loadingText),this.$$loadingWrapper.append(n),this.$el.append(this.$$loadingWrapper)}this.loadingText.html(t.text||"正在努力加载"),this.startLoadingTimeout(t),this.$$loadingWrapper.removeClass("displaynone")},n.prototype.showLoadingError=function(){var e=this;if(this.$$loadingWrapper){if(this.loadingTimeId&&window.clearTimeout(this.loadingTimeId),!e.loadingConfig.reLoadCallBack)return void e.hideLoading(!0);e.loadingErrorWrapper||(e.loadingErrorWrapper=e._createErrorDom(function(){e.$$loadingWrapper.removeClass("yy-loading-wrapper-error"),e.loadingErrorWrapper.addClass("displaynone"),e.loadingTimeId=null,e.startLoadingTimeout(e.loadingConfig),e.loadingConfig.reLoadCallBack&&e.loadingConfig.reLoadCallBack()}),e.loadingErrorWrapper.appendTo(e.$$loadingWrapper)),e.$$loadingWrapper.addClass("yy-loading-wrapper-error"),e.loadingErrorWrapper.removeClass("displaynone")}},n.prototype.startLoadingTimeout=function(e){var t=this;this.loadingTimeId||(this.loadingTimeId=window.setTimeout(function(){t.hideLoading()},this.loadingtimeout))},n.prototype._createErrorDom=function(t){var i=e.getRealWidth(11),n=e.getRealWidth(20),a=$("<div style='height:100px' class='yy-loadmore-wrapper displayflex jc-center ai-center flex-h displaynone'></div>"),o=$("<i style='font-size:"+n+"px' class='yy-icommon yy-loadmore-erroricon'></i>"),s=$("<span style='font-size:"+i+"px' class='yy-pull-meslabel'>网络异常,点击</span>"),r=$("<span style='font-size:"+i+"px' class='yy-loadmore-reload-babel'>重新加载</span>");return r.bind("click",function(){t()}),a.append(o).append(s).append(r),a},n.prototype.hideLoading=function(e){return e===!1?void this.showLoadingError():(this.loadingTimeId&&(window.clearTimeout(this.loadingTimeId),this.loadingTimeId=null),void(this.$$loadingWrapper&&this.$$loadingWrapper.addClass("displaynone")))},n.prototype.loadFiles=function(t,i,n,a){for(var o=t.length,s=0,r=0;r<o;r++)!function(t,o,r){var l=i.config.components[r];e.getComponentClass(l,function(e){s+=1,s==t&&n()},function(){a()})}(o,r,t[r])},n}),define("../../components/button",["utils","base"],function(e,t){var i=function(e){i.baseConstructor.call(this,e);var t=e.text||e.title||"按钮",n=e.mode||"1",a="displayflex yy-btn yy-btn-"+n;this.$el.addClass(a),this.$el.html(t)};return e.extends(i,t),i}),define("swiper",["utils","base"],function(e,t){var i=function(e){this.config=e,this.$el=$("<div style='"+e.style+"' class='yy-swiper-item-wrapper'></div>")};i.prototype={css:function(t){e.css(this.$el,t)}};var n=function(t){this.config=t||{},this.$el=$("<div class='yy-swiper-wrapper flex-1'></div>"),this.itemWrappers=[],this.posArr=[0,1,2],this.limit=e.getRealWidth(90),this.minOffsetX=t.minOffsetX||0,this.tanKeys=e.getTransitionKeys(),this.initLayout(),this.direction="h",this.config.init&&this.config.init(this)};return n.prototype={_posArrGoNext:function(){var e=this.posArr[0];this.posArr[0]=this.posArr[1],this.posArr[1]=this.posArr[2],this.posArr[2]=e},_resetPosArr:function(){this.posArr=[0,1,2]},_posArrGoPre:function(){var e=this.posArr[2];this.posArr[2]=this.posArr[1],this.posArr[1]=this.posArr[0],this.posArr[0]=e},initLayout:function(){var t=this;this.initPos=[0-e.viewport.width,0,e.viewport.width];for(var n=0;n<3;n++){var a=this.tanKeys.transform+":translate3d("+this.initPos[n]+"px,0,0)",o=new i({style:a});this.itemWrappers.push(o),this.config.initItem&&this.config.initItem(o,n),this.$el.append(o.$el)}var s,r,l;t.isIntransition=!1,this.$el.bind("touchstart",function(e){l=t.isIntransition,t.isIntransition||(s=e.touches[0].pageX)}),this.$el.bind("touchmove",function(e){if(!t.isIntransition&&!l){var i=e.touches[0];r=i.pageX-s,"h"===t.direction&&Math.abs(r)>4&&(e.preventDefault(),e.stopPropagation()),t.setPos("move",r)}}),this.$el.bind("touchend",function(e){if(!t.isIntransition&&!l&&r&&0!=r){if(Math.abs(r)<t.limit)return t.setPos(),void(t.isIntransition=!1);r>0?t.goPre():t.goNext(),r=0}})},transitionEnd:function(e){this.isIntransition=!1},goPre:function(){if(this.config.beforeGoPre){var e=this.config.beforeGoPre();if(e===!1)return this.setPos(),void(this.isIntransition=!1)}var t=this;this.isIntransition=!0,this._posArrGoPre(),this.setPos("gopre"),this.config.onChange&&this.config.onChange({swiper:this,action:"gopre",itemWrapper:this.itemWrappers[this.posArr[0]]}),window.setTimeout(function(){t.transitionEnd("gopre")},280)},goNext:function(){if(this.config.beforeGoNext){var e=this.config.beforeGoNext();if(e===!1)return this.setPos(),void(this.isIntransition=!1)}var t=this;this.isIntransition=!0,this._posArrGoNext(),this.setPos("gonext"),this.config.onChange&&this.config.onChange({swiper:this,action:"gonext",itemWrapper:this.itemWrappers[this.posArr[2]]}),window.setTimeout(function(){t.transitionEnd("gonext")},280)},reset:function(){this._resetPosArr(),this.setPos("move",0)},getMidWrapper:function(){return this.itemWrappers[this.posArr[1]]},getPreWrapper:function(){return this.itemWrappers[this.posArr[0]]},getNextWrapper:function(){return this.itemWrappers[this.posArr[2]]},setPos:function(e,t){var i=this;t=t||0;for(var n=0;n<3;n++){var a=i.posArr[n],o=i.itemWrappers[a],s={};s[i.tanKeys.transition]="move"==e?"none":this.tanKeys.transform+" .35s ease","gopre"==e&&0==n&&(s[i.tanKeys.transition]="none"),"gonext"==e&&2==n&&(s[i.tanKeys.transition]="none"),s[i.tanKeys.transform]="translate3d("+(this.initPos[n]+t)+"px,0,0)",o.css(s)}}},n}),define("../../components/calendar",["utils","base","swiper"],function(e,t,i){function n(t,i,n,a){var o=this;o.dateInfo=t,this.calendar=a,this.$el=$("<div date-seed='"+t.dateStr+"' date-mark='"+t.mark+"' date-day='"+t.day+"'  date-month='"+t.month+"' date-year='"+t.year+"' class='yy-calendar-day-item displayflex jc-center ai-center yy-calendar-day-item-"+t.mark+"'></div>");var s=e.ConvertDateToStr(a.selectedTime)==o.dateInfo.dateStr;this.dayLabel=$("<div style='font-size:"+e.fontSize12()+"px;width:"+n+"px;height:"+n+"px;line-height:"+n+"px' class='yy-calendar-day'>"+t.day+"</div>"),s&&this.selected(),this.$el.append(this.dayLabel),e.css(this.$el,i)}function a(e){this.config=e,this.yearItems={},this.itemWrapper=e.itemWrapper,this.calendar=e.calendar}function o(t){this.config=t,this.itemWrapper=t.itemWrapper,this.calendar=t.calendar,this.SumDay=42,this.dayInnerWidth=e.getRealWidth(23),this.dayItems={}}n.prototype={selected:function(){this.dayLabel.addClass("yy-calendar-day-selected")},unSelected:function(){this.dayLabel.removeClass("yy-calendar-day-selected")}},a.prototype={createLaytout:function(e){this.yearItems={},this.itemWrapper.$el.empty();for(var t=0;t<12;t++){var i=e+t,n=new s({calendar:this.calendar,year:i,itemHeight:this.config.itemHeight});this.yearItems[i]=n,this.itemWrapper.$el.append(n.$el)}}};var s=function(t){this.config=t,this.calendar=t.calendar;var i=e.convertToDate(this.calendar.curDate),n=i.getFullYear()==this.config.year;this.$el=$("<div  date-year-seed='"+t.year+"' style='height:"+this.config.itemHeight+";line-height:"+this.config.itemHeight+"' class='yy-calendar-year-item'></div>"),this.innnerYear=$("<span style='font-size:"+e.fontSize15()+"px' class='yy-calendar-year'>"+this.config.year+"</span>"),n&&this.selected(),this.$el.append(this.innnerYear)};s.prototype={selected:function(){this.innnerYear.addClass("yy-calendar-year-selected")},unSelected:function(){this.innnerYear.removeClass("yy-calendar-year-selected")}},o.prototype={createLaytout:function(t){this.dayItems={},this.date=e.convertToDate(t),this.itemWrapper.$el.empty();for(var i=this.getDaysArr(),a={height:this.config.itemHeight+"px","font-size":e.getRealWidth(14)+"px"},o=document.createDocumentFragment(),s=0;s<this.SumDay;s++){var r=i[s],l=new n(r,a,this.dayInnerWidth,this.calendar);this.dayItems[r.dateStr]=l,o.appendChild(l.$el[0])}this.itemWrapper.$el[0].appendChild(o)},getDaysArr:function(){var t=[],i=e.getMonthDayCount(this.date),n=e.getDateInfo(this.date),a=e.getMonthFirstDayWhicDayInWeek(this.date),o=this.SumDay-a-i;if(a>0)for(var s=e.getPreMonth(this.date),r=e.getMonthDayCount(s),l=e.getDateInfo(s),c=0;c<a;c++){var p=r-a+c+1,d=new Date(l.year,l.month-1,p);t.push({date:d,dateStr:e.ConvertDateToStr(d),year:l.year,month:l.month,day:p,mark:"premonth"})}for(var c=1;c<=i;c++){var d=new Date(n.year,n.month-1,c);t.push({date:d,dateStr:e.ConvertDateToStr(d),year:n.year,month:n.month,day:c,mark:"curmonth"})}if(o>0)for(var h=e.getNextMonth(this.date),u=e.getDateInfo(h),c=1;c<=o;c++){var d=new Date(u.year,u.month-1,c);t.push({date:d,dateStr:e.ConvertDateToStr(d),year:u.year,month:u.month,day:c,mark:"nextmonth"})}return t}};var r=["一","二","三","四","五","六","七","八","九","十","十一","十二"],l=function(t){var i=this;l.baseConstructor.call(this,t),this.$el.addClass("yy-calendar-wrapper");var n=this.config.itemHeight;isNaN(n)&&(n=45),this.curDate=t.date||new Date,this.selectedTime=new Date(e.convertToDate(this.curDate).getTime()),n=parseInt(n),this.itemHeight=e.getRealHeight(n);var a=t.comKey+"_change";this.pageview&&this.pageview.plugin&&(this.pluginChangeMethod=this.pageview.plugin[a]),this.labelBarHeight=e.getRealHeight(27);var o=6*this.itemHeight+this.labelBarHeight;this.innerWrapper=$("<div style='height:"+o+"px' class='yy-calendar-inner'></div>");var s=this.config.isShowYearAndMonthPicker||!0;if(s){var r=e.getRealHeight(36);o+=r,this.initYearAndMonthPicker(r,o)}this.mode=t.mode||"年月日","年月"==this.mode?(this.curShow="year",this.createYearWrapper(o-r),this.triggerChange()):(this.curShow="day",i.createDayWraper()),this.$el.append(this.innerWrapper)};return e.extends(l,t),l.prototype.setDateSelected=function(t,i){var t=e.convertToDate(t),n=(t.getFullYear(),e.ConvertDateToStr(t));this.selectedTime=t;for(var a=0;a<3;a++){var o=this.Swiper.itemWrappers[a].daysCreator;for(var s in o.dayItems){var r=o.dayItems[s];r.dateInfo.dateStr==n?r.selected():r.unSelected()}}if(i){var l=i.getAttribute("date-mark");"premonth"==l?this.goPre():"nextmonth"==l&&this.goNext()}},l.prototype.setYearSelected=function(){var t,i=this,n=e.getDateInfo(this.curDate),a=!1,o=n.year;if(this.yearSwiper){for(var s=0;s<3;s++){var r=this.yearSwiper.itemWrappers[this.yearSwiper.posArr[s]].yearCreator;for(var l in r.yearItems){var c=r.yearItems[l];t=c.config.year,c.config.year==o?(a=!0,c.selected(),0==s?this.yearSwiper.goPre():2==s&&this.yearSwiper.goNext()):c.unSelected()}}a||(t>o?(this.initYearWrapper(o-3+12),window.setTimeout(function(){i.yearSwiper.goPre()},0)):(this.initYearWrapper(o-3-12),window.setTimeout(function(){i.yearSwiper.goNext()},0)))}},l.prototype.createDayWraper=function(){var t=this;new i({onChange:function(i){if("gopre"==i.action){var n=e.getPreMonth(t.curDate),a=e.getPreMonth(n);t.curDate=e.getCurMonthFirstDay(n),t.triggerChange(),i.itemWrapper.daysCreator.createLaytout(a)}else if("gonext"==i.action){var n=e.getNextMonth(t.curDate),o=e.getNextMonth(n);t.curDate=e.getCurMonthFirstDay(n),t.triggerChange(),i.itemWrapper.daysCreator.createLaytout(o)}},initItem:function(e,i){e.daysCreator=new o({calendar:t,itemWrapper:e,itemHeight:t.itemHeight})},init:function(e){t.Swiper=e}});var n=e.getRealWidth(13),a="style='line-height:"+this.labelBarHeight+"px;font-size:"+n+"px'",s=$("<div style='height:"+this.labelBarHeight+"px' class='yy-calendar-bar'><div "+a+" class='yy-c-bar-item'>日</div><div "+a+" class='yy-c-bar-item'>一</div><div "+a+" class='yy-c-bar-item'>二</div><div "+a+" class='yy-c-bar-item'>三</div><div "+a+" class='yy-c-bar-item'>四</div><div "+a+" class='yy-c-bar-item'>五</div><div "+a+" class='yy-c-bar-item'>六</div></div>");this.dayWrapper=$("<div class='yy-calendar-ymd-wrapper displayflex flex-v'></div>"),this.dayWrapper.append(s).append(this.Swiper.$el),this.Swiper.$el.bind("click",function(e){for(var i=e.target,n=i.getAttribute("date-seed");null==n&&(i=i.parentNode,!(n=i.getAttribute("date-seed")))&&"BODY"!=i.tagName.toUpperCase(););t.setDateSelected(n,i)}),this.innerWrapper.append(this.dayWrapper),this.show()},l.prototype.createYearWrapper=function(t){var n=t/4+"px",o=this,s="year"==this.curShow?"":"displaynone";this.yearWrapper=$("<div class='yy-calendar-ymd-wrapper "+s+"'></div>"),new i({onChange:function(e){"gopre"==e.action?(o.curYearWrapperStartYear-=12,e.itemWrapper.yearCreator.createLaytout(o.curYearWrapperStartYear-12)):"gonext"==e.action&&(o.curYearWrapperStartYear+=12,e.itemWrapper.yearCreator.createLaytout(o.curYearWrapperStartYear+12))},initItem:function(e,t){e.yearCreator=new a({itemWrapper:e,itemHeight:n,calendar:o})},init:function(t){o.yearSwiper=t,t.$el.appendTo(o.yearWrapper);var i=e.getDateInfo(o.curDate);o.initYearWrapper(i.year)}}),this.yearWrapper.bind("click",function(t){for(var i=t.target,n=i.getAttribute("date-year-seed");null==n&&(i=i.parentNode,!(n=i.getAttribute("date-year-seed")))&&"BODY"!=i.tagName.toUpperCase(););var a=parseInt(n);o.curDate=e.setDateToYear(o.curDate,a),o.show(o.curDate,!1),o.curShow="day",o.dayWrapper&&o.dayWrapper.removeClass("displaynone"),o.yearWrapper.addClass("displaynone"),o.setYearSelected()}),this.innerWrapper.append(this.yearWrapper)},l.prototype.initYearWrapper=function(e){this.yearSwiper.reset(),this.curYearWrapperStartYear=e-4,this.yearSwiper.itemWrappers[0].yearCreator.createLaytout(e-4-12),this.yearSwiper.itemWrappers[1].yearCreator.createLaytout(e-4),this.yearSwiper.itemWrappers[2].yearCreator.createLaytout(e-4+12)},l.prototype.initYearAndMonthPicker=function(t,i){var n=e.getRealWidth(18),a=this,o=$("<div style='height:"+t+"px' class='yy-calendar-ym-picker displayflex flex-h'></div>");this.yearLeftIcon=$("<div class='yy-calendar-picker-lefticon' style='width:"+t+"px;height:"+t+"px;line-height:"+t+"px'></div>"),this.yearLabel=$("<div style='font-size:"+n+"px' class='yy-calendar-picker-label displayflex ai-center jc-center flex-1'>2013</div>"),this.yearLabel.bind("click",function(){a.yearWrapper||a.createYearWrapper(i-t),"day"==a.curShow?(a.curShow="year",a.yearWrapper.removeClass("displaynone"),a.dayWrapper&&a.dayWrapper.addClass("displaynone")):"year"==a.curShow?(a.curShow="day",a.dayWrapper&&a.dayWrapper.removeClass("displaynone"),a.yearWrapper.addClass("displaynone")):"month"==a.curShow&&(a.curShow="year",a.monthWrapper&&a.monthWrapper.addClass("displaynone"),a.yearWrapper.removeClass("displaynone"))}),this.yearLeftIcon.bind("click",function(){a.goTo(e.getPreYear(a.curDate)),a.setYearSelected()}),this.yearRightIcon=$("<div class='yy-calendar-picker-righticon' style='width:"+t+"px;height:"+t+"px;line-height:"+t+"px'></div>"),this.yearRightIcon.bind("click",function(){a.goTo(e.getNextYear(a.curDate)),a.setYearSelected()}),this.monthLeftIcon=$("<div class='yy-calendar-picker-lefticon' style='width:"+t+"px;height:"+t+"px;line-height:"+t+"px'></div>"),this.monthLeftIcon.bind("click",function(){a.goPre(),a.setMonthSelected()}),this.monthLabel=$("<div style='font-size:"+n+"px' class='yy-calendar-picker-label displayflex ai-center jc-center flex-1'>2013</div>"),this.monthLabel.bind("click",function(){a.monthWrapper||a.createMonthWrapper(i-t),"day"==a.curShow?(a.setMonthSelected(),a.curShow="month",
a.monthWrapper.removeClass("displaynone"),a.dayWrapper&&a.dayWrapper.addClass("displaynone")):"year"==a.curShow?(a.setMonthSelected(),a.curShow="month",a.monthWrapper.removeClass("displaynone"),a.yearWrapper&&a.yearWrapper.addClass("displaynone")):"month"==a.curShow&&(a.curShow="day",a.monthWrapper&&a.monthWrapper.addClass("displaynone"),a.dayWrapper&&a.dayWrapper.removeClass("displaynone"))}),this.monthRightIcon=$("<div class='yy-calendar-picker-righticon' style='width:"+t+"px;height:"+t+"px;line-height:"+t+"px'></div>"),this.monthRightIcon.bind("click",function(){a.goNext(),a.setMonthSelected()}),o.append(this.yearLeftIcon).append(this.yearLabel).append(this.yearRightIcon).append(this.monthLeftIcon).append(this.monthLabel).append(this.monthRightIcon),this.$el.append(o)},l.prototype.createMonthWrapper=function(t){var i=t/4+"px",n=this;this.monthDict={},this.monthWrapper=$("<div class='yy-calendar-ymd-wrapper displaynone'></div>");for(var a=0;a<12;a++){var o=$("<div data-month-seed='"+(a+1)+"' style='height:"+i+";line-height:"+i+"' class='yy-calendar-month-item'></div>"),s=$("<span class='yy-calendar-month' style='font-size:"+e.fontSize15()+"px'>"+r[a]+"</span>");o.append(s),a+1==this.curDate.getMonth()+1&&s.addClass("yy-calendar-month-selected"),this.monthDict[(a+1).toString()]=s,this.monthWrapper.append(o)}this.monthWrapper.bind("click",function(t){for(var i=t.target,a=i.getAttribute("data-month-seed");null==a&&(i=i.parentNode,!(a=i.getAttribute("data-month-seed")))&&"BODY"!=i.tagName.toUpperCase(););a&&(n.curDate=e.setMonthToDate(n.curDate,a),n.show(n.curDate,!1),n.curShow="day",n.dayWrapper&&n.dayWrapper.removeClass("displaynone"),n.monthWrapper.addClass("displaynone"),n.setMonthSelected())}),this.innerWrapper.append(this.monthWrapper)},l.prototype.setMonthSelected=function(){var t=e.convertToDate(this.curDate).getMonth()+1;this.setYearSelected();for(var i in this.monthDict)t==parseInt(i)?this.monthDict[i].addClass("yy-calendar-month-selected"):this.monthDict[i].removeClass("yy-calendar-month-selected")},l.prototype.show=function(t,i){t=t||this.curDate||new Date,this.curDate=e.convertToDate(t),this.Swiper.reset();var n=e.getPreMonth(this.curDate);this.Swiper.itemWrappers[0].daysCreator.createLaytout(n),this.Swiper.itemWrappers[1].daysCreator.createLaytout(this.curDate);var a=e.getNextMonth(this.curDate);this.Swiper.itemWrappers[2].daysCreator.createLaytout(a),i||this.triggerChange()},l.prototype.triggerChange=function(){var t=e.getDateInfo(this.curDate);this.monthLabel.html(t.month+"月"),this.yearLabel.html(t.year),this.pluginChangeMethod&&this.pluginChangeMethod.call(this.pageview.plugin,this,{})},l.prototype.goPre=function(){this.Swiper.goPre()},l.prototype.goNext=function(){this.Swiper.goNext()},l.prototype.setValue=function(t){t=t||new Date,t=e.convertToDate(t),this.selectedTime=t,this.goTo(t)},l.prototype.goTo=function(t){var i=this;if(t=t||new Date,t=e.convertToDate(t),e.ConvertDateToStr(this.curDate)!=e.ConvertDateToStr(t)){if(e.ConvertDateToStr(this.curDate,"yyyy-MM")==e.ConvertDateToStr(t,"yyyy-MM"))return void this.setDateSelected(t);this.curDate=t,this.curDate>t?(this.show(e.getNextMonth(t),!0),window.setTimeout(function(){i.goPre()},0)):(this.show(e.getPreMonth(t),!0),window.setTimeout(function(){i.goNext()},0))}},l}),define("calendar",["utils","base","swiper"],function(e,t,i){function n(t,i,n,a){var o=this;o.dateInfo=t,this.calendar=a,this.$el=$("<div date-seed='"+t.dateStr+"' date-mark='"+t.mark+"' date-day='"+t.day+"'  date-month='"+t.month+"' date-year='"+t.year+"' class='yy-calendar-day-item displayflex jc-center ai-center yy-calendar-day-item-"+t.mark+"'></div>");var s=e.ConvertDateToStr(a.selectedTime)==o.dateInfo.dateStr;this.dayLabel=$("<div style='font-size:"+e.fontSize12()+"px;width:"+n+"px;height:"+n+"px;line-height:"+n+"px' class='yy-calendar-day'>"+t.day+"</div>"),s&&this.selected(),this.$el.append(this.dayLabel),e.css(this.$el,i)}function a(e){this.config=e,this.yearItems={},this.itemWrapper=e.itemWrapper,this.calendar=e.calendar}function o(t){this.config=t,this.itemWrapper=t.itemWrapper,this.calendar=t.calendar,this.SumDay=42,this.dayInnerWidth=e.getRealWidth(23),this.dayItems={}}n.prototype={selected:function(){this.dayLabel.addClass("yy-calendar-day-selected")},unSelected:function(){this.dayLabel.removeClass("yy-calendar-day-selected")}},a.prototype={createLaytout:function(e){this.yearItems={},this.itemWrapper.$el.empty();for(var t=0;t<12;t++){var i=e+t,n=new s({calendar:this.calendar,year:i,itemHeight:this.config.itemHeight});this.yearItems[i]=n,this.itemWrapper.$el.append(n.$el)}}};var s=function(t){this.config=t,this.calendar=t.calendar;var i=e.convertToDate(this.calendar.curDate),n=i.getFullYear()==this.config.year;this.$el=$("<div  date-year-seed='"+t.year+"' style='height:"+this.config.itemHeight+";line-height:"+this.config.itemHeight+"' class='yy-calendar-year-item'></div>"),this.innnerYear=$("<span style='font-size:"+e.fontSize15()+"px' class='yy-calendar-year'>"+this.config.year+"</span>"),n&&this.selected(),this.$el.append(this.innnerYear)};s.prototype={selected:function(){this.innnerYear.addClass("yy-calendar-year-selected")},unSelected:function(){this.innnerYear.removeClass("yy-calendar-year-selected")}},o.prototype={createLaytout:function(t){this.dayItems={},this.date=e.convertToDate(t),this.itemWrapper.$el.empty();for(var i=this.getDaysArr(),a={height:this.config.itemHeight+"px","font-size":e.getRealWidth(14)+"px"},o=document.createDocumentFragment(),s=0;s<this.SumDay;s++){var r=i[s],l=new n(r,a,this.dayInnerWidth,this.calendar);this.dayItems[r.dateStr]=l,o.appendChild(l.$el[0])}this.itemWrapper.$el[0].appendChild(o)},getDaysArr:function(){var t=[],i=e.getMonthDayCount(this.date),n=e.getDateInfo(this.date),a=e.getMonthFirstDayWhicDayInWeek(this.date),o=this.SumDay-a-i;if(a>0)for(var s=e.getPreMonth(this.date),r=e.getMonthDayCount(s),l=e.getDateInfo(s),c=0;c<a;c++){var p=r-a+c+1,d=new Date(l.year,l.month-1,p);t.push({date:d,dateStr:e.ConvertDateToStr(d),year:l.year,month:l.month,day:p,mark:"premonth"})}for(var c=1;c<=i;c++){var d=new Date(n.year,n.month-1,c);t.push({date:d,dateStr:e.ConvertDateToStr(d),year:n.year,month:n.month,day:c,mark:"curmonth"})}if(o>0)for(var h=e.getNextMonth(this.date),u=e.getDateInfo(h),c=1;c<=o;c++){var d=new Date(u.year,u.month-1,c);t.push({date:d,dateStr:e.ConvertDateToStr(d),year:u.year,month:u.month,day:c,mark:"nextmonth"})}return t}};var r=["一","二","三","四","五","六","七","八","九","十","十一","十二"],l=function(t){var i=this;l.baseConstructor.call(this,t),this.$el.addClass("yy-calendar-wrapper");var n=this.config.itemHeight;isNaN(n)&&(n=45),this.curDate=t.date||new Date,this.selectedTime=new Date(e.convertToDate(this.curDate).getTime()),n=parseInt(n),this.itemHeight=e.getRealHeight(n);var a=t.comKey+"_change";this.pageview&&this.pageview.plugin&&(this.pluginChangeMethod=this.pageview.plugin[a]),this.labelBarHeight=e.getRealHeight(27);var o=6*this.itemHeight+this.labelBarHeight;this.innerWrapper=$("<div style='height:"+o+"px' class='yy-calendar-inner'></div>");var s=this.config.isShowYearAndMonthPicker||!0;if(s){var r=e.getRealHeight(36);o+=r,this.initYearAndMonthPicker(r,o)}this.mode=t.mode||"年月日","年月"==this.mode?(this.curShow="year",this.createYearWrapper(o-r),this.triggerChange()):(this.curShow="day",i.createDayWraper()),this.$el.append(this.innerWrapper)};return e.extends(l,t),l.prototype.setDateSelected=function(t,i){var t=e.convertToDate(t),n=(t.getFullYear(),e.ConvertDateToStr(t));this.selectedTime=t;for(var a=0;a<3;a++){var o=this.Swiper.itemWrappers[a].daysCreator;for(var s in o.dayItems){var r=o.dayItems[s];r.dateInfo.dateStr==n?r.selected():r.unSelected()}}if(i){var l=i.getAttribute("date-mark");"premonth"==l?this.goPre():"nextmonth"==l&&this.goNext()}},l.prototype.setYearSelected=function(){var t,i=this,n=e.getDateInfo(this.curDate),a=!1,o=n.year;if(this.yearSwiper){for(var s=0;s<3;s++){var r=this.yearSwiper.itemWrappers[this.yearSwiper.posArr[s]].yearCreator;for(var l in r.yearItems){var c=r.yearItems[l];t=c.config.year,c.config.year==o?(a=!0,c.selected(),0==s?this.yearSwiper.goPre():2==s&&this.yearSwiper.goNext()):c.unSelected()}}a||(t>o?(this.initYearWrapper(o-3+12),window.setTimeout(function(){i.yearSwiper.goPre()},0)):(this.initYearWrapper(o-3-12),window.setTimeout(function(){i.yearSwiper.goNext()},0)))}},l.prototype.createDayWraper=function(){var t=this;new i({onChange:function(i){if("gopre"==i.action){var n=e.getPreMonth(t.curDate),a=e.getPreMonth(n);t.curDate=e.getCurMonthFirstDay(n),t.triggerChange(),i.itemWrapper.daysCreator.createLaytout(a)}else if("gonext"==i.action){var n=e.getNextMonth(t.curDate),o=e.getNextMonth(n);t.curDate=e.getCurMonthFirstDay(n),t.triggerChange(),i.itemWrapper.daysCreator.createLaytout(o)}},initItem:function(e,i){e.daysCreator=new o({calendar:t,itemWrapper:e,itemHeight:t.itemHeight})},init:function(e){t.Swiper=e}});var n=e.getRealWidth(13),a="style='line-height:"+this.labelBarHeight+"px;font-size:"+n+"px'",s=$("<div style='height:"+this.labelBarHeight+"px' class='yy-calendar-bar'><div "+a+" class='yy-c-bar-item'>日</div><div "+a+" class='yy-c-bar-item'>一</div><div "+a+" class='yy-c-bar-item'>二</div><div "+a+" class='yy-c-bar-item'>三</div><div "+a+" class='yy-c-bar-item'>四</div><div "+a+" class='yy-c-bar-item'>五</div><div "+a+" class='yy-c-bar-item'>六</div></div>");this.dayWrapper=$("<div class='yy-calendar-ymd-wrapper displayflex flex-v'></div>"),this.dayWrapper.append(s).append(this.Swiper.$el),this.Swiper.$el.bind("click",function(e){for(var i=e.target,n=i.getAttribute("date-seed");null==n&&(i=i.parentNode,!(n=i.getAttribute("date-seed")))&&"BODY"!=i.tagName.toUpperCase(););t.setDateSelected(n,i)}),this.innerWrapper.append(this.dayWrapper),this.show()},l.prototype.createYearWrapper=function(t){var n=t/4+"px",o=this,s="year"==this.curShow?"":"displaynone";this.yearWrapper=$("<div class='yy-calendar-ymd-wrapper "+s+"'></div>"),new i({onChange:function(e){"gopre"==e.action?(o.curYearWrapperStartYear-=12,e.itemWrapper.yearCreator.createLaytout(o.curYearWrapperStartYear-12)):"gonext"==e.action&&(o.curYearWrapperStartYear+=12,e.itemWrapper.yearCreator.createLaytout(o.curYearWrapperStartYear+12))},initItem:function(e,t){e.yearCreator=new a({itemWrapper:e,itemHeight:n,calendar:o})},init:function(t){o.yearSwiper=t,t.$el.appendTo(o.yearWrapper);var i=e.getDateInfo(o.curDate);o.initYearWrapper(i.year)}}),this.yearWrapper.bind("click",function(t){for(var i=t.target,n=i.getAttribute("date-year-seed");null==n&&(i=i.parentNode,!(n=i.getAttribute("date-year-seed")))&&"BODY"!=i.tagName.toUpperCase(););var a=parseInt(n);o.curDate=e.setDateToYear(o.curDate,a),o.show(o.curDate,!1),o.curShow="day",o.dayWrapper&&o.dayWrapper.removeClass("displaynone"),o.yearWrapper.addClass("displaynone"),o.setYearSelected()}),this.innerWrapper.append(this.yearWrapper)},l.prototype.initYearWrapper=function(e){this.yearSwiper.reset(),this.curYearWrapperStartYear=e-4,this.yearSwiper.itemWrappers[0].yearCreator.createLaytout(e-4-12),this.yearSwiper.itemWrappers[1].yearCreator.createLaytout(e-4),this.yearSwiper.itemWrappers[2].yearCreator.createLaytout(e-4+12)},l.prototype.initYearAndMonthPicker=function(t,i){var n=e.getRealWidth(18),a=this,o=$("<div style='height:"+t+"px' class='yy-calendar-ym-picker displayflex flex-h'></div>");this.yearLeftIcon=$("<div class='yy-calendar-picker-lefticon' style='width:"+t+"px;height:"+t+"px;line-height:"+t+"px'></div>"),this.yearLabel=$("<div style='font-size:"+n+"px' class='yy-calendar-picker-label displayflex ai-center jc-center flex-1'>2013</div>"),this.yearLabel.bind("click",function(){a.yearWrapper||a.createYearWrapper(i-t),"day"==a.curShow?(a.curShow="year",a.yearWrapper.removeClass("displaynone"),a.dayWrapper&&a.dayWrapper.addClass("displaynone")):"year"==a.curShow?(a.curShow="day",a.dayWrapper&&a.dayWrapper.removeClass("displaynone"),a.yearWrapper.addClass("displaynone")):"month"==a.curShow&&(a.curShow="year",a.monthWrapper&&a.monthWrapper.addClass("displaynone"),a.yearWrapper.removeClass("displaynone"))}),this.yearLeftIcon.bind("click",function(){a.goTo(e.getPreYear(a.curDate)),a.setYearSelected()}),this.yearRightIcon=$("<div class='yy-calendar-picker-righticon' style='width:"+t+"px;height:"+t+"px;line-height:"+t+"px'></div>"),this.yearRightIcon.bind("click",function(){a.goTo(e.getNextYear(a.curDate)),a.setYearSelected()}),this.monthLeftIcon=$("<div class='yy-calendar-picker-lefticon' style='width:"+t+"px;height:"+t+"px;line-height:"+t+"px'></div>"),this.monthLeftIcon.bind("click",function(){a.goPre(),a.setMonthSelected()}),this.monthLabel=$("<div style='font-size:"+n+"px' class='yy-calendar-picker-label displayflex ai-center jc-center flex-1'>2013</div>"),this.monthLabel.bind("click",function(){a.monthWrapper||a.createMonthWrapper(i-t),"day"==a.curShow?(a.setMonthSelected(),a.curShow="month",a.monthWrapper.removeClass("displaynone"),a.dayWrapper&&a.dayWrapper.addClass("displaynone")):"year"==a.curShow?(a.setMonthSelected(),a.curShow="month",a.monthWrapper.removeClass("displaynone"),a.yearWrapper&&a.yearWrapper.addClass("displaynone")):"month"==a.curShow&&(a.curShow="day",a.monthWrapper&&a.monthWrapper.addClass("displaynone"),a.dayWrapper&&a.dayWrapper.removeClass("displaynone"))}),this.monthRightIcon=$("<div class='yy-calendar-picker-righticon' style='width:"+t+"px;height:"+t+"px;line-height:"+t+"px'></div>"),this.monthRightIcon.bind("click",function(){a.goNext(),a.setMonthSelected()}),o.append(this.yearLeftIcon).append(this.yearLabel).append(this.yearRightIcon).append(this.monthLeftIcon).append(this.monthLabel).append(this.monthRightIcon),this.$el.append(o)},l.prototype.createMonthWrapper=function(t){var i=t/4+"px",n=this;this.monthDict={},this.monthWrapper=$("<div class='yy-calendar-ymd-wrapper displaynone'></div>");for(var a=0;a<12;a++){var o=$("<div data-month-seed='"+(a+1)+"' style='height:"+i+";line-height:"+i+"' class='yy-calendar-month-item'></div>"),s=$("<span class='yy-calendar-month' style='font-size:"+e.fontSize15()+"px'>"+r[a]+"</span>");o.append(s),a+1==this.curDate.getMonth()+1&&s.addClass("yy-calendar-month-selected"),this.monthDict[(a+1).toString()]=s,this.monthWrapper.append(o)}this.monthWrapper.bind("click",function(t){for(var i=t.target,a=i.getAttribute("data-month-seed");null==a&&(i=i.parentNode,!(a=i.getAttribute("data-month-seed")))&&"BODY"!=i.tagName.toUpperCase(););a&&(n.curDate=e.setMonthToDate(n.curDate,a),n.show(n.curDate,!1),n.curShow="day",n.dayWrapper&&n.dayWrapper.removeClass("displaynone"),n.monthWrapper.addClass("displaynone"),n.setMonthSelected())}),this.innerWrapper.append(this.monthWrapper)},l.prototype.setMonthSelected=function(){var t=e.convertToDate(this.curDate).getMonth()+1;this.setYearSelected();for(var i in this.monthDict)t==parseInt(i)?this.monthDict[i].addClass("yy-calendar-month-selected"):this.monthDict[i].removeClass("yy-calendar-month-selected")},l.prototype.show=function(t,i){t=t||this.curDate||new Date,this.curDate=e.convertToDate(t),this.Swiper.reset();var n=e.getPreMonth(this.curDate);this.Swiper.itemWrappers[0].daysCreator.createLaytout(n),this.Swiper.itemWrappers[1].daysCreator.createLaytout(this.curDate);var a=e.getNextMonth(this.curDate);this.Swiper.itemWrappers[2].daysCreator.createLaytout(a),i||this.triggerChange()},l.prototype.triggerChange=function(){var t=e.getDateInfo(this.curDate);this.monthLabel.html(t.month+"月"),this.yearLabel.html(t.year),this.pluginChangeMethod&&this.pluginChangeMethod.call(this.pageview.plugin,this,{})},l.prototype.goPre=function(){this.Swiper.goPre()},l.prototype.goNext=function(){this.Swiper.goNext()},l.prototype.setValue=function(t){t=t||new Date,t=e.convertToDate(t),this.selectedTime=t,this.goTo(t)},l.prototype.goTo=function(t){var i=this;if(t=t||new Date,t=e.convertToDate(t),e.ConvertDateToStr(this.curDate)!=e.ConvertDateToStr(t)){if(e.ConvertDateToStr(this.curDate,"yyyy-MM")==e.ConvertDateToStr(t,"yyyy-MM"))return void this.setDateSelected(t);this.curDate=t,this.curDate>t?(this.show(e.getNextMonth(t),!0),window.setTimeout(function(){i.goPre()},0)):(this.show(e.getPreMonth(t),!0),window.setTimeout(function(){i.goNext()},0))}},l}),define("../../components/calendarpicker",["utils","calendar"],function(e,t){var i=function(i){var n=this;i=i||{};var a=i.wrapper||document.body;this.$el=$("<div class='yy-calendar-picker'></div>"),this.calendar=new t({itemHeight:38}),this.backCover=$("<div class='yy-calendar-picker-bk displaynone'></div>"),this.backCover.bind("click",function(){n.hide()});var o=e.getRealHeight("36"),s=$("<div style='height:"+o+"px' class='yy-calendar-picker-btns'></div>"),r=$("<div style='font-size:"+e.fontSize15()+"px;line-height:"+o+"px' class='yy-calendar-picker-cancelbtn'>取消</div>"),l=$("<div style='font-size:"+e.fontSize15()+"px;line-height:"+o+"px' class='yy-calendar-picker-okbtn'>确定</div>");l.bind("click",function(){i.ok&&i.ok({date:n.calendar.selectedTime,dateStr:e.ConvertDateToStr(n.calendar.selectedTime)}),n.hide()}),r.bind("click",function(){n.hide()}),s.append(r).append(l),this.$el.append(s).append(this.calendar.$el),$(a).append(this.backCover[0]).append(this.$el)};return i.prototype.show=function(e){this.calendar.setValue(e);var t=this;window.setTimeout(function(){t.$el.addClass("yy-calendar-picker-show"),t.backCover.removeClass("displaynone")},0)},i.prototype.hide=function(e){this.$el.removeClass("yy-calendar-picker-show"),this.backCover.addClass("displaynone")},i}),define("../../components/calendarrange",["utils","base","./calendar"],function(e,t,i){var n=function(e){n.baseConstructor.call(this,e)};return e.extends(n,t),n}),define("../../components/checkbox",["utils","base"],function(e,t){var i=e.getRealWidth(20),n=e.getRealWidth(4),a=e.getRealWidth(14),o={width:i,height:i,borderRadius:n,border:"1px solid rgb(229, 229, 229)",backgroundColor:"#fff",fontSize:a},s={width:i,height:i,borderRadius:n,border:"1px solid #0093ff",color:"#fff",backgroundColor:"#0093ff",fontSize:a},r=function(t){var i=this;t.style=t.style||{},this.uss=e.simpleExtendObj(e.clone(o),t.style),this.uss=e.simpleExtendObj(this.uss,t.unSelectedStyle||{}),this.ss=e.simpleExtendObj(e.clone(s),t.selectedStyle||{}),this.ss=e.simpleExtendObj(this.ss,t.selectedStyle||{}),this.value=t.value,r.baseConstructor.call(this,t),this.$el.addClass("yy-checkbox yy-icommon"),this.setValue(this.value),this.$el.bind("click",function(){i.change()});var n=this.config.comKey+"_change";this.changeMethod=this.pageview.plugin[n]};return e.extends(r,t),r.prototype.change=function(){this.changeMethod&&this.changeMethod.call(this.pageview.plugin,this,{value:!this.value})},r.prototype.selected=function(t){t&&this.config.disableParentSelect||(this.value=!0,e.css(this.$el,this.ss),this.$el.addClass("yy-checkbox-selected"))},r.prototype.unSelected=function(t){t&&this.config.disableParentSelect||(this.value=!1,e.css(this.$el,this.uss),this.$el.removeClass("yy-checkbox-selected"))},r.prototype.setValue=function(t){this.value=t,t?(this.$el.addClass("yy-checkbox-selected"),e.css(this.$el,this.ss)):(this.$el.removeClass("yy-checkbox-selected"),e.css(this.$el,this.uss))},r}),define("../../components/checklist",["utils","base"],function(e,t){var i=function(t){if(this.itemData=t.itemData,this.parent=t.parent,"string"==typeof this.parent.primaryKey)this.key=this.itemData[this.parent.primaryKey];else if(this.parent.primaryKey instanceof Array){for(var i=[],n=0,a=this.parent.primaryKey.length;n<a;n++)i.push(this.itemData[this.parent.primaryKey[n]]);this.key=i.join("_")}else console.error("checklist控件primaryKey属性 错误的数据类型");this.$el=$("<div data-key='"+this.key+"' class='yy-checklist-item yy-icommon' style='height:"+t.parent.itemHeight+"px;line-height:"+t.parent.itemHeight+"px;font-size:"+e.fontSize13()+"px'>"+(t.itemData[t.parent.labelKey]||"")+"</div>")};i.prototype={selected:function(){this.$el.addClass("yy-checklist-item-selected")},unSelected:function(){this.$el.removeClass("yy-checklist-item-selected")}};var n=function(t){var i=this;n.baseConstructor.call(this,t);var a=e.getRealHeight("38");this.itemHeight=e.getRealHeight("48"),this.canbeNull=t.canbeNull||!1,this.selectedValue=[],this.$el.addClass("yy-checklist"),this.items=[],this.selectedValue=this.config.selectedValue||[],this.primaryKey=this.config.primaryKey,this.primaryKey||console.error(this.config.comKey+"控件没有指定primaryKey数据的主键"),this.loadWrapper=$("<div class='yy-cs-loading-wrapper displayflex jc-center ai-center'><div class='preloader'></div></div>"),this.backCoverLayer=$("<div class='yy-cl-coverlayer displaynone'></div>");var o=$("<div style='height:"+a+"px;font-size:"+e.fontSize(16)+"px;line-height:"+a+"px' class='displayflex jc-between ai-center yy-cl-title-wrapper'></div>");this.backCoverLayer.bind("touchmove",function(e){e.preventDefault(),e.stopPropagation()}),this.CancelBtn=$("<div  class='yy-checklist-btn'>取消</div>"),this.OkBtn=$("<div class='yy-checklist-btn yy-checklist-okbtn'>确定</div>"),o.append(this.CancelBtn).append(this.OkBtn),this.CancelBtn.bind("click",function(){i.cancel()}),this.OkBtn.bind("click",function(){i.OK()}),this.listWrapper=$("<div style='max-height:"+6.7*this.itemHeight+"px;' class='yy-cl-list-wrapper'></div>"),this.listWrapper.append(this.loadWrapper),this.pageview.$el.append(this.backCoverLayer),this.$el.append(o).append(this.listWrapper),this.labelKey=this.config.labelKey||"text",this.backCoverLayer.bind("click",function(){i.cancel()}),e.deviceInfo().isIOS?this.listWrapper.bind("singleTap",function(e){i.itemClick(e)}):this.listWrapper.bind("click",function(e){i.itemClick(e)});var s=this.config.comKey+"_selected";this.selectedMethod=this.pageview.plugin[s]};return e.extends(n,t),n.prototype.OK=function(){(0!=this.selectedValue.length||this.canbeNull)&&(this.originalSelectedValue=e.copy(this.selectedValue),this.hide(),this.selectedMethod&&this.selectedMethod.call(this.pageview.plugin,this,{selectedValue:this.selectedValue}))},n.prototype.cancel=function(){this.hide(),this.originalSelectedValue&&this.setItemSelected(this.originalSelectedValue,!0)},n.prototype._getPrimaryValue=function(e){var t="";if("string"==typeof this.primaryKey)t=e[this.primaryKey];else if(this.primaryKey instanceof Array){for(var i=[],n=0,a=this.primaryKey.length;n<a;n++)i.push(e[this.primaryKey[n]]);t=i.join("_")}else console.error("checklist控件primaryKey属性 错误的数据类型");return t},n.prototype.itemClick=function(e){var t=e.target.getAttribute("data-key");if(t){for(var i=null,n=0,a=this.items.length;n<a;n++)if(t==this.items[n].key){i=this.items[n];break}if(i){var o=this.selectedValue.indexOf(i.itemData);o>=0?this.selectedValue.splice(o,1):this.selectedValue.push(i.itemData),0!=this.selectedValue.length||this.canbeNull?this.OkBtn.removeClass("yy-disabled"):this.OkBtn.addClass("yy-disabled"),this.setItemSelected(this.selectedValue)}}},n.prototype.show=function(){this.$el.addClass("yy-checklist-show"),this.backCoverLayer.removeClass("displaynone"),this.init()},n.prototype.setItemSelected=function(t,i){for(var n=0,a=this.items.length;n<a;n++){var o=this.items[n];o.unSelected()}if(this.selectedValue=[],t.length>0)for(var s=0,r=t.length;s<r;s++)for(var l=this._getPrimaryValue(t[s]),n=0,a=this.items.length;n<a;n++){var o=this.items[n];o.key==l&&(o.selected(),this.OkBtn.removeClass("yy-disabled"),this.selectedValue.push(o.itemData))}i&&(this.originalSelectedValue=e.copy(this.selectedValue))},n.prototype.setSelectedValue=function(e){this.selectedValue=[],e instanceof Array||console.error("checklist setSelectedValue方法必须是数组"),this.items?this.setItemSelected(e,!0):this._midSelectedValue=e},n.prototype.createItems=function(e){this.dataSource=e,this.items=[],this.selectedValue=this.config.selectedValue||[],this.listWrapper.empty();for(var t=this.dataSource.length,n=0,a=t;n<a;n++){var o=this.dataSource[n],s=new i({itemData:o,parent:this});this.listWrapper.append(s.$el),this.items.push(s),t>1&&n!=t-1&&this.listWrapper.append("<div class='yy-checklist-line'></div>")}this._midSelectedValue&&(this.setItemSelected(this._midSelectedValue,!0),this._midSelectedValue=null),this.selectedValue.length>0?this.OkBtn.removeClass("yy-disabled"):this.OkBtn.addClass("yy-disabled"),this.setSelectedValue(this.config.selectedValue||[])},n.prototype.init=function(){var e=this;this.dataSource||(e.loadWrapper.removeClass("displaynone"),e.loadErrorWrapper&&e.loadErrorWrapper.addClass("displaynone"),e.OkBtn.addClass("yy-disabled"),this.loadData(function(t){e.OkBtn.removeClass("yy-disabled"),e.loadWrapper.addClass("displaynone"),e.loadErrorWrapper&&e.loadErrorWrapper.addClass("displaynone"),e.createItems(t)},function(){e.loadErrorWrapper||e.initLoadErrorDom(),e.loadErrorWrapper.removeClass("displaynone"),e.loadWrapper.addClass("displaynone")}))},n.prototype.loadData=function(e,t){if(this.dataSource)return void e(this.dataSource);var i=this.config.comKey+"_loaddata",n=this.pageview.plugin[i];n&&n.call(this.pageview.plugin,this,{success:e,error:t})},n.prototype.initLoadErrorDom=function(){var t=this,i=e.getRealWidth(11),n=e.getRealWidth(20);this.loadErrorWrapper=$("<div style='height:100px' class='yy-loadmore-wrapper displayflex jc-center ai-center flex-h'></div>");var a=$("<i style='font-size:"+n+"px' class='yy-icommon yy-loadmore-erroricon'></i>"),o=$("<span style='font-size:"+i+"px' class='yy-pull-meslabel'>网络异常,点击</span>"),s=$("<span style='font-size:"+i+"px' class='yy-loadmore-reload-babel'>重新加载</span>");s.bind("click",function(){t.init()}),this.loadErrorWrapper.append(a).append(o).append(s),this.listWrapper.append(this.loadErrorWrapper)},n.prototype.hide=function(){this.$el.removeClass("yy-checklist-show"),this.backCoverLayer.addClass("displaynone")},n}),define("../../components/conditionselector",["utils","base"],function(e,t){var i=function(e){var t=this;this.rootInstance=e.parent,this.index=e.index,this.item=e.item,this.$el=$("<div class='displayflex yy-cs-item'></div>"),this.titleDom=$("<span style='font-size:"+this.rootInstance.itemFontSize+"'>"+this.item+"</span>"),this.itemDom=$("<div></div>"),1===this.rootInstance.config.mode?(this.itemDom.append(this.titleDom).append("<i></i>"),this.itemDom.addClass("yy-conditionselector-approve"),this.$el.append(this.itemDom)):this.$el.append(this.titleDom).append("<i></i>"),this.$el.appendTo(this.rootInstance.$el),this.$el.bind("click",function(){t.rootInstance.itemClick(t)})};i.prototype={selected:function(){this.$el.addClass("yy-cs-item-selected")},unSelected:function(){this.$el.removeClass("yy-cs-item-selected")}};var n=function(e){var t=this;this.isMulti=e.isMulti,this.parent=e.parent,this.barItemInstance=e.barItemInstance,this.rootInstance=e.rootInstance,this.index=this.barItemInstance.index,this.data=e.itemData;var i="menu"+this.index+"LabelKey",n=this.rootInstance.config[i];n||alert("程序配置错误"+this.rootInstance.config.comKey+"未配置 :"+i);var a="yy-cs-selector-item";if(this.isMulti){var o="menu"+this.index+"Col",s=this.rootInstance.config[o];a="yy-cs-muselector-item",s&&(s=parseInt(s),2==s&&(a="yy-cs-muselector-item yy-cs-muselector-item2"))}this.$el=$("<div class='"+a+" bottom-half-line'><span class='yy-cs-selector-span' style='font-size:"+this.rootInstance.itemFontSize+"'>"+(this.data[n]||"")+"</span></div>"),this.$el.css({height:this.rootInstance.itemHeight,lineHeight:this.rootInstance.itemHeight}),this.$el.bind("click",function(){t.parent.itemClick(t)})};n.prototype={selected:function(){var e=this.isMulti?"yy-cs-muselector-item-selected":"yy-cs-selector-item-selected";this.$el.addClass(e)},unSelected:function(){var e=this.isMulti?"yy-cs-muselector-item-selected":"yy-cs-selector-item-selected";this.$el.removeClass(e)}};var a=function(e){var t=this;this.parent=e.parent,this.index=e.index,this.title=e.title,this.rootInstance=e.rootInstance,this.$el=$("<div style='font-size:"+this.rootInstance.itemFontSize+"' class='displayflex yy-cs-selector-leftitem flex-h jc-start ai-center'>"+this.title+"</div>"),this.$el.css({height:this.rootInstance.itemHeight}),this.$el.bind("touchstart",function(){t.parent.leftItemClick(t)})};a.prototype={selected:function(){this.$el.addClass("yy-cs-selector-leftitem-selected")},unSelected:function(){this.$el.removeClass("yy-cs-selector-leftitem-selected")}};var o=function(t){this.$el=$("<div class='displayflex yy-cs-multiselector flex-v'></div>"),this.listWrapper=$("<div class='displayflex yy-cs-multiselector-list flex-h'></div>"),this.btnWrapper=$("<div class='displayflex yy-cs-multiselector-bottom flex-h'></div>"),this.btnWrapper.css({height:e.getRealHeight(40)+"px"});var i=this;this.rootInstance=t.rootInstance,this.barItemInstance=t.barItemInstance,this.dropDownInstance=t.dropDownInstance,this.index=this.barItemInstance.index,this.data=t.data,this.items=[],this.selectedItems=[];var a=this.rootInstance.config["menu"+this.index+"Style"];if(a){var o=a.maxHeight||a["max-height"];o&&this.listWrapper.css({maxHeight:o})}for(var s=0,r=this.data.length;s<r;s++){var l=this.data[s],c=new n({rootInstance:this.rootInstance,barItemInstance:this.barItemInstance,dropDownInstance:this.dropDownInstance,parent:this,itemData:l,isMulti:!0});this.items.push(c),this.listWrapper.append(c.$el)}var p=$("<div class='displayflex yy-cs-btn jc-center ai-center'>重置</div>"),d=$("<div class='displayflex yy-cs-btn yy-cs-ok-btn jc-center ai-center'>确定</div>");this.btnWrapper.append(p).append(d),p.bind("click",function(){i.reset()}),this.$el.append(this.listWrapper).append(this.btnWrapper)};o.prototype={reset:function(){for(var e=0,t=this.selectedItems.length;e<t;e++)this.selectedItems[e].unSelected();this.selectedItems=[]},itemClick:function(e){var t=this.selectedItems.indexOf(e);t>=0?(e.unSelected(),this.selectedItems.splice(t,1)):(e.selected(),this.selectedItems.push(e))}};var s=function(e){this.$el=$("<div class='displayflex yy-cs-selector flex-v'></div>");this.rootInstance=e.rootInstance,this.barItemInstance=e.barItemInstance,this.dropDownInstance=e.dropDownInstance,this.index=this.barItemInstance.index,this.data=e.data,this.items=[];var t=e.dropDownInstance.rootInstance.config["menu"+e.index+"selectedKey"],i=this.rootInstance.config["menu"+this.index+"Style"];if(i){var a=i.maxHeight||i["max-height"];a&&this.$el.css({maxHeight:a})}for(var o=0,s=this.data.length;o<s;o++){var r=this.data[o],l=new n({rootInstance:this.rootInstance,barItemInstance:this.barItemInstance,dropDownInstance:this.dropDownInstance,parent:this,itemData:r});void 0!==t&&t===o&&(l.selected(),this.curSelectedItem=l),this.items.push(l),this.$el.append(l.$el)}};s.prototype={itemClick:function(e){var t=this.rootInstance.config.comKey+"_menu"+this.index+"_itemClick",i=this.rootInstance.pageview.plugin[t];this.curSelectedItem&&this.curSelectedItem.unSelected(),this.curSelectedItem=e,this.curSelectedItem.selected(),this.barItemInstance.titleDom.html(e.data.name),i&&i.call(this.rootInstance.pageview.plugin,this)}};var r=function(t){this.config=t,this.rootInstance=t.rootInstance,this.barItemInstance=t.barItemInstance,this.index=this.barItemInstance.index,this.dropDownInstance=t.dropDownInstance,this.$el=$("<div class='displayflex yy-cs-selector flex-h'></div>"),this.leftWrapper=$("<div class='displayflex yy-cs-selector-left flex-v'></div>"),this.rightWrapper=$("<div class='yy-cs-selector-right'></div>");var i=this.rootInstance.config["menu"+this.index+"Style"];if(i){var n=i.maxHeight||i["max-height"];n&&(this.$el.css({maxHeight:n}),this.rightWrapper.css({maxHeight:n}),this.leftWrapper.css({maxHeight:n}))}var a="menu"+t.index+"LeftStyle",o=t.rootInstance.config[a],s="menu"+t.index+"GroupKey";this.groupKey=t.rootInstance.config[s],this.groupKey||alert("程序配置错误"+this.rootInstance.config.comKey+"未配置 :"+s),o&&e.css(this.leftWrapper,o),this.leftItems=[],this.$el.append(this.leftWrapper).append(this.rightWrapper),this._processData(this.config.data),this.rightMenuWrapperDict={},this._initLeftLayout()};r.prototype={leftItemClick:function(e){this.curLeftSelectedItem&&this.curLeftSelectedItem.unSelected(),this.curLeftSelectedItem=e,e.selected(),this.showRightMenu()},itemClick:function(e){this.curSelectedItem&&this.curSelectedItem.unSelected(),
this.curSelectedItem=e,this.curSelectedItem.selected()},showRightMenu:function(){var e=this.curLeftSelectedItem.index.toString(),t=this.rightMenuWrapperDict[e];t||(t=this._initRightMenuWrapper(parseInt(e)-1),this.rightMenuWrapperDict[e]=t),this.curRightMenuWrapper&&this.curRightMenuWrapper.addClass("displaynone"),this.curRightMenuWrapper=t,this.curRightMenuWrapper.removeClass("displaynone")},_initRightMenuWrapper:function(e){var t=$("<div class='displayflex flex-v yy-cs-selector-right-menuwrapper displaynone'></div>"),i=this.rightDataArrArr[e];if(i)for(var a=0,o=i.length;a<o;a++){var s=i[a],r=new n({rootInstance:this.rootInstance,barItemInstance:this.barItemInstance,dropDownInstance:this.dropDownInstance,parent:this,itemData:s});t.append(r.$el)}return this.rightWrapper.append(t),t},_initLeftLayout:function(){for(var e=["全部"].concat(this.leftDataArr),t=0,i=e.length;t<i;t++){var n=e[t],o=new a({rootInstance:this.rootInstance,barItemInstance:this.barItemInstance,dropDownInstance:this.dropDownInstance,parent:this,index:t,title:n});this.leftItems.push(o),this.leftWrapper.append(o.$el)}this.leftItemClick(this.leftItems[0])},_processData:function(e){this.leftDataArr=[],this.rightDataArrArr=[];for(var t=0,i=e.length;t<i;t++){var n=e[t],a=n[this.groupKey];if(!a){alert("程序配置错误"+this.rootInstance.config.comKey+" 数据源中 没有相关的分类字段:"+this.groupKey);break}var o=this.leftDataArr.indexOf(a);o<0&&(this.leftDataArr.push(a),o=this.leftDataArr.length-1,this.rightDataArrArr.push([]));var s=this.rightDataArrArr[o];s||(s=[],this.rightDataArrArr[o]=s),s.push(n)}}};var l=function(t){this.rootInstance=t.rootInstance,this.barItemInstance=t.barItemInstance,this.index=this.barItemInstance.index.toString(),this.DropDownWrapper=t.parent,this.hasInit=!1,this.isLoading=!1,this.$el=$("<div class='yy-cs-item-dropdown' style='min-height:100px'></div>"),this.loadWrapper=$("<div class='yy-cs-loading-wrapper displayflex jc-center ai-center displaynone'><div class='preloader'></div></div>"),this.$el.append(this.loadWrapper);var i=this.rootInstance.config["menu"+this.index+"Style"];i?e.css(this.$el,i):this.$el.css({height:"100px"}),this.DropDownWrapper.$innerWrapper.append(this.$el)};l.prototype={show:function(t){var i=this,n=t?e.processTransitionTanformStyle("transform .3s ease","translate3d(0,0,0)"):e.processTransitionTanformStyle("none","translate3d(0,0,0)");t?window.setTimeout(function(){i.$el.css(n)},0):this.$el.css(n),this.hasInit||this.isLoading||this.init()},initLoadErrorDom:function(){var e=this;this.loadErrorWrapper=this.rootInstance._createErrorDom(function(){e.init()}),this.$el.append(this.loadErrorWrapper)},init:function(){var e=this;this.isLoading||(this.isLoading=!0,this.loadWrapper.removeClass("displaynone"),e.loadErrorWrapper&&e.loadErrorWrapper.addClass("displaynone"),this.loadData(function(t){e.loadWrapper.addClass("displaynone"),e.dataSource=t,e.isLoading=!1,e.initLayout(e.dataSource)},function(t){e.loadErrorWrapper||e.initLoadErrorDom(),e.loadWrapper.addClass("displaynone"),e.loadErrorWrapper.removeClass("displaynone"),e.isLoading=!1}))},initLayout:function(e){var t="menu"+this.index+"Mode",i=this.rootInstance.config[t]||"single",n={data:e,index:this.index,rootInstance:this.rootInstance,dropDownInstance:this,barItemInstance:this.barItemInstance};"single"==i?this.selector=new s(n):"group"==i?this.selector=new r(n):"multi"==i?this.selector=new o(n):this.selector=new s(n),this.$el.append(this.selector.$el),this.hasInit=!0},loadData:function(e,t){if(this.dataSource)return void e(this.dataSource);var i=this.rootInstance.config.comKey+"_menu"+this.index+"_loaddata",n=this.rootInstance.pageview.plugin[i];n&&n.call(this.rootInstance.pageview.plugin,this,{success:e,error:t})},hide:function(t){var i=t?e.processTransitionTanformStyle("transform .3s ease","translate3d(0,-100%,0)"):e.processTransitionTanformStyle("none","translate3d(0,-100%,0)");this.$el.css(i)}};var c=function(e){var t=this;this.parent=e.parent,this.isShow=!1,this.DropDowns={},this.$el=$("<div class='yy-cs-dropdown'></div>"),this.$innerWrapper=$("<div class='yy-cs-dropdown-inner'></div>"),this.$el.append(this.$innerWrapper),this.curDropDown=null,this.$innerWrapper.bind("click",function(e){t._hideSelf(e)}),this.parent.pageview.$el.closest(".yy-root-view").children(".yy-pageview:last-child").append(this.$el)};c.prototype={_hideSelf:function(e){"yy-cs-dropdown-inner"==e.target.className&&this.hide()},show:function(e){if(!this.isShow){var t=this.parent.$el[0].getBoundingClientRect(),i={top:t.bottom,left:0,bottom:0,right:0,display:"block"};this.$el.css(i),this.isShow=!0}var n=e.index.toString(),a=this.DropDowns[n];a||(a=new l({parent:this,rootInstance:this.parent,barItemInstance:e}),this.DropDowns[n]=a),this.curDropDown?this.curDropDown===a?(this.curDropDown.barItemInstance.unSelected(),this.curDropDown.hide(!0),this.curDropDown=null,this.hide()):(this.curDropDown.hide(!1),this.curDropDown.barItemInstance.unSelected(),this.curDropDown=a,this.curDropDown.show(!1),this.curDropDown.barItemInstance.selected()):(this.curDropDown=a,this.curDropDown.barItemInstance.selected(),this.curDropDown.show(!0))},hide:function(){var e=this;this.isShow&&(this.isShow=!1,this.curDropDown&&(this.curDropDown.barItemInstance.unSelected(),this.curDropDown.hide(!0)),this.curDropDown=null,window.setTimeout(function(){e.$el.css({display:"none"})},300))}};var p=function(t){p.baseConstructor.call(this,t),this.itemHeight=t.itemHeight||e.getRealHeight(40)+"px",this.itemFontSize=t.itemFontSize||e.getRealWidth(12)+"px",this.$el.addClass("displayflex yy-condition-selector flex-h"),this.items=t.items||["全部"],this.initBarItem()};return e.extends(p,t),p.prototype.hideDropDown=function(){void 0!==this.dpdWrapper&&this.dpdWrapper.hide()},p.prototype.showDropDown=function(e){this.dpdWrapper||(this.dpdWrapper=new c({parent:this})),this.dpdWrapper.show(e)},p.prototype.itemClick=function(e){this.showDropDown(e)},p.prototype.initBarItem=function(){for(var e=(this.config.barItemStyle,0),t=this.items.length;e<t;e++){new i({parent:this,item:this.items[e],index:e})}},p}),define("../../components/dialog",["utils","base"],function(e,t){var i=function(t){var i=this,n=t.wrapper||$(document.body),a=t.mode||1,o=t.className;this.dialogBackCover=$("<div style='visibility: hidden;' class='yy-dialog-bk'></div>"),this.dialogWrapper=$("<div class='yy-dialog-wrapper yy-dialog-effect-"+a+" yy-dialog-hide + "+o+"'></div>");var s=$("<div class='yy-dialog-inner'></div>"),r=$("<div class='yy-dialog-body'></div>"),l="row"===t.btnDirection?"yy-fd-row":"yy-fd-column",c=$("<div class='yy-dialog-btn-wrapper displayflex "+l+"'></div>");this.dialogBackCover.bind("click",function(){i.hide()});var p=t.title||"";this.titleDom=$("<div class='yy-dialog-title'>"+p+"</div>"),this.bodyContentDom=$("<div class='yy-dialog-content'></div>");var d=t.createContent;if(d)d(this.bodyContentDom);else{var h=t.contentText;this.contentTextDom=$("<div class='yy-dialog-content-text'>"+h+"</div>"),this.bodyContentDom.append(this.contentTextDom)}if(r.append(this.titleDom).append(this.bodyContentDom),t.buttons)for(var u=0,f=t.buttons.length;u<f;u++){var g=t.buttons[u],p=g.title||"按钮",m=g.style,y=g.onClick;!function(t,i,n,a,o){var s=$("<div class='yy-dialog-btn yy-flex-1 displayflex yy-jc-center yy-ai-center'>"+t+"</div>");i&&e.css(s,i),a&&s.bind("click",function(e){a()}),n.append(s)}(p,m,c,y,this)}s.append(r).append(c),this.dialogWrapper.append(s),n.append(this.dialogWrapper).append(this.dialogBackCover)};return i.prototype.show=function(){var e=this;this.dialogWrapper.css({visibility:"visible"}),this.dialogBackCover.css({visibility:"visible"}),this.dialogBackCover.addClass("yy-dialog-bk-show"),window.setTimeout(function(){e.dialogWrapper.removeClass("yy-dialog-hide").addClass("yy-dialog-show")},1)},i.prototype.hide=function(){var e=this;this.dialogWrapper.removeClass("yy-dialog-show").addClass("yy-dialog-hide"),this.dialogBackCover.removeClass("yy-dialog-bk-show"),window.setTimeout(function(){e.dialogWrapper.css({visibility:"hidden"}),e.dialogBackCover.css({visibility:"hidden"})},200)},i}),define("../../components/icon",["utils","base"],function(e,t){var i=function(t){var n=this;i.baseConstructor.call(this,t),this.$el.addClass("displayflex yy-icon yy-ai-center yy-jc-center");var a=this.config.font||"",o=a.split("_");this.text=this.config.text;var s=(this.config.style,this.config.iconStyle),r=this.config.iconClassName,l=this.config.textStyle,c=this.config.textPos||"right";this.iconDom=null,this.textDom=null,this.title=this.config.title||"";var p,d;if(2==o.length&&(p=o[0],d=o[1],e.css(this.$el,{fontFamily:p}),this.iconDom=$('<i class="yy-icon-code" data-code="'+d+'" data-icon="&#x'+d+';"></i>'),s&&e.css(this.iconDom,s),r&&this.iconDom.addClass(r)),null!==this.config.src&&void 0!==this.config.src){var h="",u=new Image;this.iconDom=$('<div class="yy-icon-img"></div>'),s&&e.css(this.iconDom,s),r&&this.iconDom.addClass(r),u.onerror=function(){var i=n.config.comKey+"_error",a=n.pageview.plugin[i];if(n.title.length>0){var o=e.getImgTitle(n.title);return n.iconDom.html(o),n.iconDom.addClass("displayflex yy-ai-center yy-jc-center"),n.iconDom.css({color:"#fff",fontSize:e.fontSize(13),backgroundColor:e.getImgBg(o)}),void(a&&a.call(n.pageview.plugin,n,{}))}if(t.defaultSrc){if(h===t.defaultSrc)return void n.img.classList.add("displaynone");h=t.defaultSrc,u.src=t.defaultSrc,a&&a.call(n.pageview.plugin,n,{})}},u.src=this.config.src,this.iconDom.append(u)}(this.text||0==this.text)&&(this.text=null===this.text||void 0===this.text?"":this.text,this.textDom=$("<span class='yy-icon-text yy-text-box'>"+this.text+"</span>"),this.config.numberofline&&(this.textDom[0].style["-webkit-line-clamp"]=this.config.numberofline),l&&e.css(this.textDom,l)),"left"==c||"top"==c?(this.textDom&&this.$el.append(this.textDom),this.iconDom&&this.$el.append(this.iconDom)):(this.iconDom&&this.$el.append(this.iconDom),this.textDom&&this.$el.append(this.textDom)),this.iconDom&&("left"==c||"right"==c?this.$el.addClass("flex-h"):this.$el.addClass("flex-v")),this.originalStatus={font:a,text:this.config.text}};return e.extends(i,t),i.prototype.changeStatus=function(t){var i=this.originalStatus;if(t&&""!==t&&this.config.status&&(i=this.config.status[t]||this.originalStatus),this.status=t,i.font){var n=i.font.split("_");if(2!=n.length)return;var a=n[0],o=n[1],s=$('<i class="yy-icon-code" data-code="'+o+'" data-icon="&#x'+o+';"></i>');e.css(s,{fontFamily:a}),this.iconDom.replaceWith(s),this.iconDom=s,this.config.iconStyle&&e.css(this.iconDom,this.config.iconStyle)}var r=i.text||"";this.setText(r)},i.prototype.setIcon=function(t,i){var n=t.split("_");if(2==n.length){var a=n[0],o=n[1],s=$('<i class="yy-icon-code" data-code="'+o+'" data-icon="&#x'+o+';"></i>');if(e.css(s,{fontFamily:a}),this.iconDom.replaceWith(s),this.iconDom=s,this.config.iconStyle){var r=e.clone(this.config.iconStyle);if(i)for(var l in i)r[l]=i[l];e.css(this.iconDom,r)}}},i.prototype.setText=function(e){this.text=e,this.textDom.html(e)},i.prototype.getText=function(e){return this.text},i.prototype.setAttribute=function(e,t){this.$el.attr(e,t),this.textDom&&this.textDom.attr(e,t),this.iconDom&&this.iconDom.attr(e,t)},i}),define("../../components/image",["utils","base"],function(e,t){var i=function(t){var n=this;i.baseConstructor.call(this,t),n.config.style=n.config.style||{};var a="yy-image displayflex yy-jc-center yy-ai-center";this.src=t.src||t.defaultSrc,this.title=this.config.title||"";var o=this.config.style.width;try{o=parseInt(o)}catch(e){o=null}var s=this.config.style.height;try{s=parseInt(s)}catch(e){s=null}this.img=new Image;var r="";this.img.onload=function(){var t={};if(s&&o){var i=e.getPicSize(o,s,n.img.width,n.img.height);t.width=i.w,t.height=i.h}else t.height="100%",t.width="100%";n.config.style.borderRadius&&(t.borderRadius=n.config.style.borderRadius),e.css($(n.img),t)},this.img.onerror=function(){var i=n.config.comKey+"_error",a=n.pageview.plugin[i];if(a&&a.call(n.pageview.plugin,n,{}),n.title.length>0){var o=e.getImgTitle(n.title);return n.$el.html(o),void n.$el.css({color:"#fff",fontSize:e.fontSize(n.config.style.fontSize||13),backgroundColor:e.getImgBg(o)})}if(t.defaultSrc){if(r===t.defaultSrc)return void n.img.classList.add("displaynone");r=t.defaultSrc,n.img.src=t.defaultSrc}},this.src=this.src||"",this.img.src=this.src,n.$el.append(n.img),this.$el.addClass(a)};return e.extends(i,t),i.prototype.setSrc=function(e){this.$el.find("img").length>0?this.$el.find("img").attr("src",e):(this.img.src=e,this.$el.html(this.img))},i.prototype.setTitle=function(t){var i=this,n=e.getImgTitle(t);this.$el.html(n),this.$el.css({color:"#fff",fontSize:e.fontSize(i.config.style.fontSize||13),backgroundColor:e.getImgBg(n)})},i}),define("../../components/input",["utils","base"],function(e,t){var i=function(t){var n=this;i.baseConstructor.call(this,t),this.config.style=this.config.style||{},this.$el.addClass("displayflex yy-input flex-h");var a=this.config.mode||"text",o=this.config.placeholder||"",s=t.isInForm,r="number"===a?"text":a;this.input=$("<input class='yy-flex-1' placeholder='"+o+"' type='"+r+"' />");var l={fontSize:this.config.style.fontSize||"13px",color:this.config.style.color||"#262626",textAlign:this.config.style.textAlign||"left"};(this.config.value||0===this.config.value)&&this.input.val(this.config.value),e.css(this.input,l),this.config.disabled&&this.setDisabled(!0),s===!0?(this.Form=$("<form action=''></form>"),this.Form.bind("submit",function(e){var i=t.comKey+"_formsubmit",a=n.pageview.plugin[i];return a&&!n.disabled&&a&&a.call(n.pageview.plugin,n,{e:e}),e.preventDefault(),!1}),this.Form.append(this.input),this.$el.append(this.Form)):this.$el.append(this.input);var c=t.comKey+"_compositionend",p=n.pageview.plugin[c];p&&this.$el.on("input",function(e){n.$el.prop("comStart")||!n.disabled&&p&&p.call(n.pageview.plugin,n,{e:e})}).on("compositionstart",function(){n.$el.prop("comStart",!0)}).on("compositionend",function(e){n.$el.prop("comStart",!1),!n.disabled&&p&&p.call(n.pageview.plugin,n,{e:e})});var d=t.comKey+"_compositionstart",h=n.pageview.plugin[d];h&&this.input.bind("compositionstart",function(e){!n.disabled&&h&&h.call(n.pageview.plugin,n,{e:e})});var u=t.comKey+"_keydown",f=n.pageview.plugin[u];"number"===a&&(this.$el.on("input",function(e){var t=n.input.val(),i=n.input.val();return 190===e.keyCode&&t.indexOf(".")>=0?(e.stopPropagation(),e.preventDefault(),void(e.returnValue=!1)):void(isNaN(t)&&(i=t.replace(/[^0-9\.]/g,""),0===t.indexOf("-")&&(i="-"+i),n.setValue(i)))}),this.$el.bind("keydown",function(e){var t=n.input.val();return 190===e.keyCode&&t.indexOf(".")>=0?(e.stopPropagation(),e.preventDefault(),void(e.returnValue=!1)):189==e.keyCode||190==e.keyCode||46==e.keyCode||8==e.keyCode||37==e.keyCode||39==e.keyCode||e.keyCode>=48&&e.keyCode<=57||e.keyCode>=96&&e.keyCode<=105?void(!n.disabled&&f&&f.call(n.pageview.plugin,n,{e:e})):(e.stopPropagation(),e.preventDefault(),void(e.returnValue=!1))}),this.input.on("compositionstart",function(e){var t=n.input.val();isNaN(t)&&(t=t.replace(/[^0-9\.]/g,""),n.setValue(t))}),this.input.on("compositionend",function(e){var t=n.input.val();isNaN(t)&&(t=t.replace(/[^0-9\.]/g,""),n.setValue(t))})),f&&"number"!==a&&this.$el.bind("keydown",function(e){!n.disabled&&f&&f.call(n.pageview.plugin,n,{e:e})});var g=t.comKey+"_keyup",m=n.pageview.plugin[g];m&&this.$el.bind("keyup",function(e){!n.disabled&&m&&m.call(n.pageview.plugin,n,{e:e})});var y=t.comKey+"_focus",v=n.pageview.plugin[y];v&&this.input.bind("focus",function(e){!n.disabled&&v&&v.call(n.pageview.plugin,n,{e:e})});var w=t.comKey+"_blur",x=n.pageview.plugin[w];x&&this.input.bind("blur",function(e){!n.disabled&&x&&x.call(n.pageview.plugin,n,{e:e})});var b=t.comKey+"_input",_=n.pageview.plugin[b];_&&this.input.bind("input",function(e){!n.disabled&&_&&_.call(n.pageview.plugin,n,{e:e})});var D=t.comKey+"_change",I=n.pageview.plugin[D];I&&this.input.bind("change",function(e){!n.disabled&&I&&I.call(n.pageview.plugin,n,{e:e})})};return e.extends(i,t),i.prototype.getValue=function(){var e=$.trim(this.input.val());return"number"!==this.config.mode&&(e=e.replace(/\uD83C[\uDF00-\uDFFF]|\uD83D[\uDC00-\uDE4F]|[\uD800-\uDBFF]|[\uDC00-\uDFFF]/g,""),this.setValue(e)),$.trim(e)},i.prototype.setValue=function(e){this.input.val(e)},i.prototype.setDisabled=function(e){this.disabled=e,this.disabled?(this.input.attr("disabled","disabled"),this.$el.addClass(this.disabledClassName)):(this.input.removeAttr("disabled"),this.$el.remove(this.disabledClassName))},i.prototype.focus=function(e){var t=this;t.input.focus()},i.prototype.blur=function(){var e=this;e.input.blur()},i}),define("../../components/listview",["utils","base"],function(e,t){var i=function(t){var n=this;t.style&&(t.style.flexDirection||t.style["flex-direction"]||(t.style.flexDirection="column",t.style.webkitFlexDirection="column")),t.noNeedSetStyle=!0,i.baseConstructor.call(this,t),this.parent.rowMarkSeed||(this.parent.rowMarkSeed=0),this.listview=t.listview,this.parent.rowMarkSeed+=1,this.rowindex=this.parent.rowMarkSeed,this.rowMark="row"+this.rowindex,this.contentWrapper=$("<div class='displayflex yy-row-content'></div>"),e.css(this.contentWrapper,t.style),this.SwipeDomWrapper=null,this.$$childrenWrapper=this.contentWrapper,this.$el.addClass("yy-listrow"),t.itemClassName&&this.$el.addClass(t.itemClassName),this.defaultSwipIconWidth=e.getRealWidth(70),this.$el.attr("row-mark",this.rowMark),this.selectedMode=t.listview.selectedMode||"m",this.contentWrapper.appendTo(this.$el),this.initLayout(t.$$datasource,null,this),this.$el.bind("click",function(e){if("edit"===n.config.listview.status)return void n.select();if(n.pageview.plugin){var t=n.config.listview.config.comKey+"_rowclick",i=n.pageview.plugin[t];i&&i.call(n.pageview.plugin,n,{e:e})}});var a=n.config.listview.config.comKey+"_getrowswipeicons";this.pliginInitSwipeIconMethod=n.pageview.plugin[a];var o=this.config.listview.config.comKey+"_selectChange";this.selectChangeMethod=this.pageview.plugin[o]};e.extends(i,t),i.prototype.select=function(){if("m"===this.selectedMode){var e=this.config.listview.selectedRows.indexOf(this);e>=0?(this.config.listview.selectedRows.splice(e,1),this.unSelected()):(this.config.listview.selectedRows.push(this),this.selected())}else{var t=this.config.listview.selectedRows[0];t&&t.unSelected(),this.config.listview.selectedRows[0]=this,this.selected()}this.selectChangeMethod&&this.selectChangeMethod.call(this.pageview.plugin,this.config.listview,{})},i.prototype.rebind=function(e){this.contentWrapper.empty(),this.datasource=e,this.initLayout(e,null,this)},i.prototype.render=function(){},i.prototype.initSwipeDom=function(){var e=this,t=this.parent.config.rowSwipeIcons;this.pliginInitSwipeIconMethod&&(t=this.pliginInitSwipeIconMethod.call(e.pageview.plugin,e,{})),this.SwipeDomWrapper||(this.SwipeDomWrapper=$("<div class='yy-row-swipwrapper displayflex flex-h'></div>"),this.SwipeDomWrapper.appendTo(this.$el),this.recreateSwipe(t))},i.prototype.recreateSwipe=function(e){var t=this;if(this.SwipeDomWrapper.empty(),!e||0==e.length)return void(this.SwipeIconsSumWidth=0);this.SwipeIconsSumWidth=0;for(var i=0,n=e.length;i<n;i++){var a=e[i],o=this.pageview.config.components[a];o.style=o.style||{};var s=o.style.width||this.defaultSwipIconWidth;s=parseInt(s),this.SwipeIconsSumWidth+=s,o.style.width=s+"px",o.style.height="100%",this.getComponentInstanceByComKey(a,this.datasource,this,function(e){e.setAttribute&&e.setAttribute("data-swipeicon","1"),t.SwipeDomWrapper.append(e.$el)},function(){})}},i.prototype.remove=function(){this.delete(!0)},i.prototype.delete=function(e){var t=this,i=this.parent.rows.indexOf(this);i>=0&&this.parent.rows.splice(i,1);var n=this.listview.selectedRows.indexOf(this);return n>=0&&this.listview.selectedRows.splice(n,1),e?(t.$el.remove(),void(t.config.listview.isGroupList&&0==t.parent.rows.length&&t.parent.remove())):(this.$el.css({height:this.$el.height()+1+"px"}),window.setTimeout(function(){t.$el.css({transition:"height .12s linear","-webkit-transition":"height .12s linear",height:"0px"})},40),void window.setTimeout(function(){t.$el.remove(),t.config.listview.isGroupList&&0==t.parent.rows.length&&t.parent.remove()},345))},i.prototype.swipeToLeft=function(t){this.contentWrapper.css(e.processTransitionTanformStyle("none","translate3d("+t+"px,0,0)"))},i.prototype.closeSwipe=function(){this.contentWrapper.css(e.processTransitionTanformStyle("transform .2s ease","translate3d(0,0,0)"))},i.prototype.setSwipeOpenPos=function(){this.contentWrapper.css(e.processTransitionTanformStyle("transform .2s ease","translate3d(-"+this.SwipeIconsSumWidth+"px,0,0)"))};var n=function(e){var t=this;n.baseConstructor.call(this,e);var i=e.isCanCollapse,a="yy-sticky displayflex";i===!0&&(this.isCollapse=!1,a+=" yy-icommon yy-listgroup-colheader",this.$el.bind("click",function(){t.isCollapse?(t.parent.expand(),t.isCollapse=!1,t.$el.removeClass("yy-listgroup-header-collapse")):(t.isCollapse=!0,t.parent.collapse(),t.$el.addClass("yy-listgroup-header-collapse"))})),this.$el.addClass(a),this.initLayout(e.$$datasource,null,this)};e.extends(n,t);var a=function(e){a.baseConstructor.call(this,e);var t=this.parent.config.isCanCollapse;this.$el.attr("data-gval",e.groupValue);var i=$("<div class='yy-listgroup-body'></div>");this.groupBodyInner=$("<div class='yy-listgroup-body-inner'></div>"),i.append(this.groupBodyInner),this.groupHeader=new n({$$datasource:e.groupHeaderData,type:"listgroupheader",isCanCollapse:t,root:this.config.rootConfig.groupHeader,style:this.config.rootConfig.groupHeaderStyle,$$pageview:this.pageview,groupValue:e.groupValue,$$parent:this}),this.display="block",this.groupValue=e.groupValue,this.$el.append(this.groupHeader.$el).append(i),this.rows=[]};e.extends(a,t),a.prototype.expand=function(){this.groupBodyInner.removeClass("displaynone")},a.prototype.collapse=function(){this.groupBodyInner.addClass("displaynone")},a.prototype.insertRow=function(e,t){this.show();var i=this.rows[t];return i?(e.$el.insertBefore(i.$el),this.rows.splice(t,0,e)):(this.rows.push(e),this.groupBodyInner.append(e.$el)),e},a.prototype.append=function(e){this.show(),this.groupBodyInner.append(e)},a.prototype.show=function(){"block"!=this.display&&"none"==this.display&&(this.$el.removeClass("displaynone"),this.display="block")},a.prototype.remove=function(e){this.parent.groups[this.groupValue]&&delete this.parent.groups[this.groupValue],e&&this.$el.remove(),this.display="none",this.$el.addClass("displaynone")};var o=function(t){t.style||(t.style={}),t.style.flexDirection||t.style["flex-direction"]||(t.style.flexDirection="column"),this.config=t,this.ajaxConfig=t.ajaxConfig,o.baseConstructor.call(this,t),this.ajaxConfig=this.ajaxConfig||t.ajaxConfig,this.initAjaxConfig(this.ajaxConfig),this.groupKey=this.config.groupKey,this.isGroupList=null!=this.groupKey,this.groups={},this.autoLoadData=t.autoLoadData||!1,this.$el.addClass("displayflex yy-listview"),this.selectedMode=t.selectedMode,this.swipeOffsetX=e.getRealWidth(25),this.selectedRows=[],this.rows=[],this.canOpenOffsetRight=e.getRealWidth(70),this.splitStyle=t.splitStyle,this.showBlockClassNameDict={};var i=this.config.comKey+"_parsedata";this.pluginParseDataMethod=this.pageview.plugin[i];var n=this.config.comKey+"_beforeload";this.pluginBeforeLoadDataMethod=this.pageview.plugin[n];var a=this.config.comKey+"_afterload";this.pluginAfterLoadDataMethod=this.pageview.plugin[a];var s=this.config.comKey+"_demo演示";this.DemoMethod=this.pageview.plugin[s],this.init()};return e.extends(o,t),o.prototype.setLeftOpen=function(){return"edit"===this.status?void this.setLeftClose():(this.status="edit",void this.$el.addClass(this.showBlockClassNameDict.left))},o.prototype.setLeftRightOpen=function(){return"edit"===this.status?void this.setLeftRightClose():(this.status="edit",void this.$el.addClass((this.showBlockClassNameDict.left||"")+" "+(this.showBlockClassNameDict.right||"")))},o.prototype.setLeftRightClose=function(){this.status="",this.$el.removeClass((this.showBlockClassNameDict.left||"")+" "+(this.showBlockClassNameDict.right||""))},o.prototype.setLeftClose=function(){this.status="",this.$el.removeClass(this.showBlockClassNameDict.left)},o.prototype.setRightOpen=function(){return"edit"===this.status?void this.setRightClose():(this.status="edit",void this.$el.addClass(this.showBlockClassNameDict.right))},o.prototype.setRightClose=function(){this.status="",this.$el.removeClass(this.showBlockClassNameDict.right)},o.prototype.initLeftRightBlock=function(){this.initBlock(this.config.leftBlock,"left"),this.initBlock(this.config.rightBlock,"right")},o.prototype.initBlock=function(t,i){if(t){t.key&&t.width||console.error("listview 的"+i+"Block配置需要包括key和widt属性");try{t.width=parseInt(t.width)}catch(e){}isNaN(t.width)&&console.error("listview 的"+i+"Block的widt属性必须为数值"),t.width=e.getRealWidth(t.width);var n=this.getUniqueKey()+i;this.$el.addClass(n),this.showBlockClassNameDict||(this.showBlockClassNameDict={}),this.showBlockClassNameDict[i]=n+"_show"+i,e.createStyleSheet(n,"."+t.key+" {transition:width .12s ease;-webkit-transition:width .12s ease;} ."+this.showBlockClassNameDict[i]+" ."+t.key+" {width:"+t.width+"px !important;}")}},o.prototype.init=function(){var e=this;this.config.nodata&&this.getComponentInstanceByComKey(this.config.nodata,null,null,function(t){e.$el.append(t.$el),t.$el.addClass("displaynone"),e.noDataDom=t},function(){}),this.initEvent(),this.initLeftRightBlock(),this.autoLoadData&&window.setTimeout(function(){e.parent&&e.parent.setCanLoadMore&&e.parent.setPullLoadingState(),e.loadFirstPageData()},430)},o.prototype.getTargetRow=function(e){for(var t=e.target;"yy-listrow"!=t.className&&"yy-listview"!=t.className&&"BODY"!=t.tagName;)t=t.parentNode;var i=t.getAttribute("row-mark"),n=null;if(i)for(var a=0,o=this.rows.length;a<o;a++){var s=this.rows[a];if(s.rowMark===i){n=s;break}}return n},o.prototype.initEvent=function(){var t=this;this.curSwipRow=null;var i=e.getRealWidth(280);if(this.config.rowSwipeIcons){var n,a,o,s=!1;this.$el.bind("touchstart",function(a){if("edit"!==t.status){var r=a.touches[0];"1"!==a.target.getAttribute("data-swipeicon")?(t.curSwipRow&&t.curSwipRow.closeSwipe(),n=r.pageX,o=r.pageY,s=e.viewport.width-n<i,s&&(t.curSwipRow=t.getTargetRow(a),t.curSwipRow&&t.curSwipRow.initSwipeDom())):s=!1}}),this.$el.bind("touchmove",function(e){if("edit"!==t.status){if(!s||!t.curSwipRow||0==t.curSwipRow.SwipeIconsSumWidth)return void(s=!1);var i=e.touches[0],r=i.pageX;a=r-n;var l=Math.abs(a),c=o-i.pageY;return Math.abs(c)>30&&l>0?void(a=10):void(a<-10&&(l>10&&(e.preventDefault(),e.stopPropagation()),a=l>t.curSwipRow.SwipeIconsSumWidth+t.swipeOffsetX?0-t.curSwipRow.SwipeIconsSumWidth-t.swipeOffsetX:a,t.curSwipRow.swipeToLeft(a)))}}),this.$el.bind("touchend",function(){if("edit"!==t.status){if(!s||a>=0)return void(a=0);s=!1,Math.abs(a)>t.canOpenOffsetRight?t.curSwipRow&&t.curSwipRow.setSwipeOpenPos():0!=a&&t.curSwipRow&&t.curSwipRow.closeSwipe(),a=0}})}},o.prototype.getRowCount=function(){if(this.isGroupList){var e=0;return this.eachRow(function(t){e+=1}),e}return this.rows.length},o.prototype.eachRow=function(e){if(this.isGroupList)for(var t in this.groups)for(var i=this.groups[t],n=0,a=i.rows.length;n<a;n++)e(i.rows[n],n,i);else for(var o=0,s=this.rows.length;o<s;o++)e(this.rows[o],o)},o.prototype.empty=function(){if(this.isGroupList)for(var e in this.groups)this.groups[e].remove(!0),delete this.groups[e];else{for(var t=this.rows.length-1;t>=0;t--)this.rows[t].remove();this.rows=[]}},o.prototype.selectAll=function(){var e=this;"m"===this.config.selectedMode&&(this.selectedRows=[],this.eachRow(function(t){e.selectedRows.push(t),t.selected()}))},o.prototype.clearSelectAll=function(){"m"===this.config.selectedMode&&(this.selectedRows=[],this.eachRow(function(e){e.unSelected()}))},o.prototype.loadFirstPageData=function(e){var t=this;e=e||{},t.parent.setInitLoadMessage&&t.parent.setInitLoadMessage(),this.pageNumKey||(this.pageNumKey=this.ajaxConfig.pageNumKey,this.pageNumKey||console.error("listview 配置没有设置页码字段属性pageNumKey")),this.parentAnimate=e.parentAnimate,e.parentAnimate!==!1&&this.parent.setPullLoadingState();var i=this.ajaxConfig.firstPageIndex||0===this.ajaxConfig.firstPageIndex?this.ajaxConfig.firstPageIndex:1;this.ajaxConfig.data[this.pageNumKey]=i,this.loadData({success:function(e,i){t.rowMarkSeed=0,t.empty(),t.bindData(e,!0),e&&0!=e.length||t.showNodata(!0)},isAutoLoad:!1,isFirstLoad:!0})},o.prototype._loadNextPageData=function(e){var t=this;this.pageNumKey||(this.pageNumKey=this.ajaxConfig.pageNumKey,this.pageNumKey||console.error("listview 配置没有设置页码字段属性pageNumKey"));var i=this.ajaxConfig.data[this.pageNumKey];if(i&&!isNaN(i)||0===i)e===!0||(i=parseInt(i)+1);else{var n=this.ajaxConfig.firstPageIndex||0===this.ajaxConfig.firstPageIndex?this.ajaxConfig.firstPageIndex:1;i=n}this.ajaxConfig.data[this.pageNumKey]=i,this.loadData({success:function(e){t.bindData(e)},isAutoLoad:!1,isFirstLoad:!1})},o.prototype.loadNextPageData=function(){this._loadNextPageData(!1)},o.prototype.reload=function(){this._loadNextPageData(!0),this.parent.setCanLoadMore({isReload:!0})},o.prototype.showNodata=function(e){this.noDataDom&&(e?this.noDataDom.$el.removeClass("displaynone"):this.noDataDom.$el.addClass("displaynone"))},o.prototype.loadData=function(t){var i=this,n=t.isFirstLoad;if(this.pluginBeforeLoadDataMethod&&this.pluginBeforeLoadDataMethod.call(this.pageview.plugin,this,{ajaxConfig:this.ajaxConfig,isAutoLoad:t.isAutoLoad}),this.config.isStatic){var a=[];return i.pluginParseDataMethod&&(a=i.pluginParseDataMethod.call(i.pageview.plugin,i,{params:this.ajaxConfig,data:a,cancel:!1}),void 0===a&&console.error("程序错误："+i.config.comKey+"_parsedata 方法没有返回值或者返回值错误"),a===!1)?void i.setError(t):void t.success(a)}this.beforeAjaxConfig=e.copy(this.ajaxConfig);var o=this.ajaxConfig.data||{};e.ajax({type:this.ajaxConfig.type||"get",url:this.ajaxConfig.url,pageviewInstance:this.config.$$pageview,timeout:this.ajaxConfig.timeout||7e3,data:o,success:function(e){return i.showNodata(!1),i.pluginParseDataMethod&&(e=i.pluginParseDataMethod.call(i.pageview.plugin,i,{params:o,data:e,isFirstLoad:n}),void 0===e&&console.error("程序错误："+i.config.comKey+"_parsedata 方法没有返回值或者返回值错误"),e===!1)?void i.setError(t):(e instanceof Array||console.error(i.config.comKey+"返回的数据不是数组类型,或者在"+i.config.comKey+"_parsedata方法中进行预处理 "),t.success(e,n),void(i.pluginAfterLoadDataMethod&&i.pluginAfterLoadDataMethod.call(i.pageview.plugin,i,{isSuccess:!0,params:o,data:e,isFirstLoad:t.isFirstLoad})))},error:function(e){if(i.DemoMethod){var a=i.DemoMethod.call(i.pageview.plugin,i,{params:o,isFirstLoad:t.isFirstLoad});null===a?(i.setError(t),t.error&&t.error(e)):t.success(a,n)}else i.setError(t),t.error&&t.error(e)}})},o.prototype.setError=function(e){var t=this;window.setTimeout(function(){e.isFirstLoad?t.parent.setLoadFirstError&&t.parent.setLoadFirstError():t.parent.setLoadMoreErrorState&&t.parent.setLoadMoreErrorState(),t.ajaxConfig=t.beforeAjaxConfig,t.pluginAfterLoadDataMethod&&t.pluginAfterLoadDataMethod.call(t.pageview.plugin,t,{isSuccess:!1})},100)},o.prototype.createFragmentByDataSource=function(e){for(var t=document.createDocumentFragment(),i=0,n=e.length;i<n;i++){var a=this.createRow(e[i]);this.rows.push(a),t.appendChild(a.$el[0])}return t},o.prototype.bindData=function(e,t){var i=this;if(this.isGroupList)return void this.bindGroupListData(e,t);var n=this.createFragmentByDataSource(e);window.setTimeout(function(){i.$el[0].appendChild(n),i.setLoadStateWhenBindDone(e,t)},16)},o.prototype.setLoadStateWhenBindDone=function(e,t){var i=this;this.parentAnimate!==!1&&(e.length<i.ajaxConfig.pageSize?i.parent.setHasLoadDone&&i.parent.setHasLoadDone():i.parent.setCanLoadMore&&i.parent.setCanLoadMore()),t&&(i.parent.resetPullLoadState&&i.parent.resetPullLoadState(),e&&0!==e.length||i.parent.setInitLoadMessage&&i.parent.setInitLoadMessage()),0===i.getRowCount()&&(i.showNodata(!0),i.parent.hideLoadMore&&i.parent.hideLoadMore())},o.prototype.groupBy=function(e){
this.empty();var t=this;e?(this.groupKey=e,this.isGroupList=!0,this.groups={}):(this.isGroupList=!1,this.groupKey=null,this.groups={}),t.parent&&t.parent.setCanLoadMore&&t.parent.setPullLoadingState(),t.loadFirstPageData()},o.prototype.bindGroupListData=function(e,t){for(var i=this,n={},o={},s=0,r=e.length;s<r;s++){var l=e[s],c=l[this.groupKey];c||(l[this.groupKey]=this.config.otherGroupName||"其他",c=this.config.otherGroupName||"其他"),n[c]||(n[c]=document.createDocumentFragment()),this.groups[c]||(this.groups[c]=new a({type:"listgroup",rootConfig:this.config,style:this.config.groupStyle,$$pageview:this.pageview,groupValue:c,groupHeaderData:l,$$parent:this}),o[c]=this.groups[c]);var p=this.createGroupListRow(l,this.groups[c]);n[c].appendChild(p.$el[0]),this.groups[c].rows.push(p)}window.setTimeout(function(){for(var a in n)i.groups[a].append(n[a]),o[a]&&i.$el.append(o[a].$el);i.setLoadStateWhenBindDone(e,t)},16)},o.prototype.createGroupListRow=function(e,t){var n=new i({type:"listrow",listview:this,root:this.config.root,style:this.config.rowStyle,$$pageview:this.pageview,$$datasource:e,$$parent:t,itemClassName:this.config.itemClassName});return n},o.prototype.setAjaxConfigParams=function(e){this.ajaxConfig||console.error("ListView未配置ajaxConfig属性"),this.ajaxConfig.data=this.ajaxConfig.data||{};for(var t in e)this.ajaxConfig.data[t]=e[t]},o.prototype.initAjaxConfig=function(e){return this.config.isStatic?void(this.ajaxConfig={}):(e||console.error("ListView未配置ajaxConfig属性"),e.pageSize||console.warn("ajaxConfig配置需要指定pageSize属性"),isNaN(e.pageSize)&&console.warn("ajaxConfig配置需要指定pageSize属性为number类型"),void(e.pageSize=parseInt(e.pageSize)))},o.prototype.createRow=function(e){var t=new i({type:"listrow",listview:this,root:this.config.root,style:this.config.rowStyle,$$pageview:this.pageview,$$datasource:e,$$parent:this,itemClassName:this.config.itemClassName});return t},o.prototype.insertGroup=function(e,t){if(!this.isGroupList)return this;var i=e[this.groupKey],n=this.groups[i];if(n)return this;n=new a({type:"listgroup",rootConfig:this.config,style:this.config.groupStyle,$$pageview:this.pageview,groupValue:i,groupHeaderData:e,$$parent:this}),this.groups[i]=n;var o=this.getGroupByIndex(t);return o?n.$el.insertBefore(o.$el):this.$el.append(n.$el),this},o.prototype.getGroupByIndex=function(e){var t,i=this.$el.children(),n=i[e];if(n){var a=n.getAttribute("data-gval");t=this.groups[a]}return t},o.prototype.insertRow=function(e,t){if(this.isGroupList){var i=e[this.groupKey],n=this.groups[i];if(n){var a=this.createGroupListRow(e,n);return this.showNodata(!1),n.insertRow(a,t)}return this.insertGroup(e,0),void this.insertRow(e,t)}var a=this.rows[t],o=this.createRow(e);this.showNodata(!1),void 0!==t&&null!=t&&t>=0&&t<this.rows.length?this.rows.splice(t,0,o):this.rows.push(o),a?o.$el.insertBefore(a.$el):this.$el.append(o.$el)},o.prototype.deleteRowByPrimaryKey=function(e){},o}),define("../../components/pageview",["utils","base"],function(e,t){function i(e){var t=this;if(this.refs={},this.dialogsBks={},this.dialogs={},this.componentsInitActions={},i.baseConstructor.call(this,e),this.viewpagerParams=e.viewpagerParams,e.root=e.root||[],this.params=e.$$params,this.showPageParams=e.showPageParams||{},this.prePageView=e.prePageView,this.pageManager=e.$$pageManager,this.config=e,this.innerPages={},this.innerPagesWrappers={},e.pluginClass)try{this._preparePlugin(e.pluginClass)}catch(e){console.log(e)}this.components={};var n=e.style;this.$el.addClass("yy-pageview displayflex"),this.showPageBackCover=$("<div role='showPageBackCover' class='yy-backcover displaynone'></div>"),this.innerWrapper=$("<div class='displayflex yy-page-inner'></div>"),this.$$childrenWrapper=this.innerWrapper,this.$el.append(this.innerWrapper).append(this.showPageBackCover),n&&this.innerWrapper.css(n),this.showPageBackCover.bind("click",function(){t.hideCurShowPage()}),this.initLayout()}var n={fromLeft1:{zIndex:5,left:"0",top:0,transform:"translate3d(-100%,0,0)","-webkit-transform":"translate3d(-100%,0,0)"},fromLeft2:{zIndex:101,left:"0",top:0,transform:"translate3d(-100%,0,0)","-webkit-transform":"translate3d(-100%,0,0)"},fromLeft3:{left:0,top:0,zIndex:5,transform:"translate3d(0,0,0)","-webkit-transform":"translate3d(0,0,0)"},fromRight1:{zIndex:5,right:"0",top:0,transform:"translate3d(100%,0,0)","-webkit-transform":"translate3d(100%,0,0)"},fromRight2:{zIndex:101,right:"0",top:0,transform:"translate3d(100%,0,0)","-webkit-transform":"translate3d(100%,0,0)"},fromRight3:{zIndex:5,right:0,top:0,transform:"translate3d(0,0,0)","-webkit-transform":"translate3d(0,0,0)"},opacity:{left:"0",top:0},fromBottom:{zIndex:101,left:"0",bottom:"0",transform:"translate3d(0,100%,0)","-webkit-transform":"translate3d(0,100%,0)"}},a={fromLeft1:"yy-init-left",fromLeft2:"yy-init-left",fromLeft3:"yy-init-left",fromRight1:"yy-init-right",fromRight2:"yy-init-right",fromRight3:"yy-init-right",opacity:"yy-init-left",fromBottom:"yy-init-bottom"};return e.extends(i,t),i.prototype._preparePlugin=function(e){this.plugin=new e({pageview:this});var t=this.config.children;if(t&&t instanceof Array&&t.length>0)for(var i=0,n=t.length;i<n;i++){var a=t[i].pluginClass;if(a){var o=new a;this.plugin=$.extend(!0,this.plugin,o)}}},i.prototype.regeistPageDestory=function(){},i.prototype.destory=function(){this.$el.remove()},i.prototype.showDialog=function(e,t){var i=this;t=t||{};var n=this.dialogs[e];if(n)return this.dialogs[e].addClass("yy-dialog-show"),this.dialogsBks[e].removeClass("displaynone"),void window.setTimeout(function(){i.dialogs[e].css({visibility:"visible"})},20);var a=t.datasource;this.getComponentInstanceByComKey(e,a,null,function(n){var a=$("<div style='visibility: hidden;' class='yy-dialog-out-wrap displayflex yy-ai-center yy-jc-center'></div>");t.zIndex&&a.css({zIndex:t.zIndex+1});var o=$("<div class='yy-dialog-inner-wrap'></div>");i.dialogs[e]=a,o.append(n.$el),a.append(o),a.appendTo(document.body);var s=$("<div class='yy-page-dialog-bk'></div>");t.zIndex&&s.css({zIndex:t.zIndex}),i.dialogsBks[e]=s,s.appendTo(document.body),window.setTimeout(function(){a.css({visibility:"visible"}),a.addClass("yy-dialog-show")},20)},function(e){})},i.prototype.hideDialog=function(e){var t=this;this.dialogsBks[e].addClass("displaynone"),this.dialogs[e].removeClass("yy-dialog-show"),window.setTimeout(function(){t.dialogs[e].css({visibility:"hidden"})},200)},i.prototype.ajax=function(t){t.pageviewInstance=this,e.ajax(t)},i.prototype.Enter=function(e,t){var i=this;if(this.$el[0].className=e,t){if(i.pageManager.getPageNameFromUrl()===i.config.pageKey){var n=i.plugin.onPageEnter;n&&n.call(i.plugin)}}else this.$el[0].addEventListener("webkitAnimationEnd",function(){if(i.pageManager.getPageNameFromUrl()===i.config.pageKey){var e=i.plugin.onPageEnter;e&&e.call(i.plugin)}})},i.prototype.bindShowPageEnterEvent=function(){var e=this;this.$el[0].parentNode.addEventListener("webkitTransitionEnd",function(){if(e.$$isshow){var t=e.plugin.onPageEnter;t&&t.call(e.plugin)}})},i.prototype.hideCurShowPage=function(){var t=this;if(this.pageManager.blur(),this.showpageInstance.showpageInstance)return this.showpageInstance.hideCurShowPage(),!0;if(this.showpage_wrapper){var i=this.showpageInstance.plugin.onPageBeforeLeave||this.showpageInstance.plugin.onPageClose;if(i){var o=i.call(this.showpageInstance.plugin);if(o===!1)return!0}this.showpageInstance.$$isshow=!1;var s=this.showpage_wrapper.attr("data-mode");if(this.showPageBackCover.addClass("displaynone"),this.innerWrapper[0].className="displayflex yy-page-inner "+a[s]+"-im ",window.setTimeout(function(){t.innerWrapper.css(e.processTransitionTanformStyle("none","translate3d(0,0,0)"))},300),"fromLeft1"==s||"fromLeft2"==s)this.showpage_wrapper.css(e.processTransformStyle("translate3d(-100%,0,0)"));else if("fromRight1"==s||"fromRight2"==s)this.showpage_wrapper.css(e.processTransformStyle("translate3d(100%,0,0)"));else{var r=n[s]||{};"fromRight3"!=s&&"fromLeft3"!=s||(r.display="none"),this.showpage_wrapper.css(r)}}var l=this.plugin.onPageResume;return l&&l.call(this.plugin),this.showpage_wrapper=null,this.showpageInstance=null,!1},i.prototype.do=function(e,t){var i=this.refs[e];i?t(i):(this.config.components[e].ref||console.error("请务必在"+e+"控件上设置ref:true"),this.componentsInitActions[e]=t)},i.prototype.delegate=function(e,t){this.do(e,t)},i.prototype.showLoadingProgressbar=function(){var e=this;this.loadingProgreessbar||(this.loadingProgreessbarWrapper=$("<div class='yy-loading-pbw displaynone'></div>"),this.loadingProgreessbar=$("<div class='yy-loading-pb'></div>"),this.loadingProgreessbarWrapper.append(this.loadingProgreessbar),this.loadingProgreessbarWrapper.appendTo(this.$el)),this.loadingProgreessbarWrapper.removeClass("displaynone"),window.setTimeout(function(){e.loadingProgreessbar.css({width:"90%"})},6)},i.prototype.hideLoadingProgressbar=function(){this.loadingProgreessbar&&(this.loadingProgreessbar.css({width:"0%"}),this.loadingProgreessbarWrapper.addClass("displaynone"))},i.prototype.close=function(){this.ownerPage&&this.ownerPage.hideCurShowPage()},i.prototype.showPage=function(t){if(t&&t.pageKey){this.pageManager.blur(),t.inRouter!==!1&&this.pageManager.regeistShowPageInRouter(this.config.pageKey);var i=this,a=t.mode||"fromLeft1";this.showpage_wrapper=this.innerPagesWrappers[t.pageKey],this.showpageInstance=this.innerPages[t.pageKey],this.showLoadingProgressbar(),!this.showpage_wrapper||void 0!==t.nocache&&t.nocache?this.pageview.pageManager.getPageConfigByPageKey(t.pageKey,function(o){var s=t.params||{};o.showPageParams=s;var r=i.pageview.pageManager.createPageView(o);r.$el.addClass("yy-pageview-show"),r.ownerPage=i,i.hideLoadingProgressbar(),i.showpageInstance=r,i.innerPages[t.pageKey]=r,i.showpage_wrapper=$("<div class='yy-showpage'></div>");var l=o.showPageStyle||{width:"100%",height:"100%"};l&&(delete l.top,delete l.right,delete l.left,delete l.bottom),i.showpage_wrapper.attr("data-mode",a);var c=l.width||"100%",p=l.height||"100%";l=l||{};var d=n[a]||n.fromLeft1;d=e.clone(d),i.showpage_wrapper.attr("data-width",c),i.showpage_wrapper.attr("data-height",p);var h=e.simpleExtendObj(l,d)||{};"fromLeft3"!==a&&"fromRight3"!==a||(h.display="block"),i.showpage_wrapper.css(h),i.innerPagesWrappers[t.pageKey]=i.showpage_wrapper,i.showpage_wrapper.append(r.$el),i.$el.append(i.showpage_wrapper),r.bindShowPageEnterEvent(),i._showpageAnimate(t,i.showpage_wrapper,r)},function(){}):(this.hideLoadingProgressbar(),"fromLeft3"!==a&&"fromRight3"!==a||this.showpage_wrapper.css({display:"block"}),this._showpageAnimate(t,this.showpage_wrapper,this.showpageInstance))}},i.prototype.goBack=function(e){this.pageManager.goBack(e)},i.prototype.go=function(e,t){t=t||{};var i=this.pageManager.appConfig.beforeGo;i&&i({params:t,pageviewInstance:this}),this.pageManager.go(e,t)},i.prototype.replaceGo=function(e,t){t=t||{};var i=this.pageManager.appConfig.beforeGo;i&&i({params:t,pageviewInstance:this}),this.pageManager.replaceGo(e,t)},i.prototype._showpageAnimate=function(t,i,n){var o=this,s=12;n.$$isshow=!0;var r=i.attr("data-width"),l=i.attr("data-mode");if(this.innerWrapper[0].className="displayflex yy-page-inner "+a[l],"fromLeft1"!=l&&"fromLeft2"!=l||(this.showPageBackCover.removeClass("displaynone").css({left:r,right:0}),window.setTimeout(function(){if("fromLeft1"==l){var t=e.processTransitionTanformStyle("transform .3s cubic-bezier(.05, .69, .14, 1)","translate3d("+r+",0,0)");t["box-shadow"]="0px 0px 13px 1px #929292",o.innerWrapper.css(t)}i.css(e.processTransitionTanformStyle("transform .3s cubic-bezier(.05, .69, .14, 1)","translate3d(0,0,0)"))},s)),"fromLeft3"==l){this.showPageBackCover.removeClass("displaynone").css({left:r,right:0});var c=e.processTransitionTanformStyle("transform .3s cubic-bezier(.05, .69, .14, 1)","translate3d("+r+",0,0)");c["box-shadow"]="0px 0px 13px 1px #929292",window.setTimeout(function(){o.innerWrapper.css(c)},s)}if("fromRight1"!=l&&"fromRight2"!=l||(this.showPageBackCover.removeClass("displaynone").css({right:r,left:0}),window.setTimeout(function(){var t=e.processTransitionTanformStyle("transform .3s cubic-bezier(.05, .69, .14, 1)","translate3d(-"+r+",0,0)");t["box-shadow"]="0px 0px 13px 1px #929292","fromRight1"==l&&o.innerWrapper.css(t),i.css(e.processTransitionTanformStyle("transform .3s cubic-bezier(.05, .69, .14, 1)","translate3d(0,0,0)"))},s)),"fromRight3"==l){this.showPageBackCover.removeClass("displaynone").css({right:r,left:0});var c=e.processTransitionTanformStyle("transform .3s cubic-bezier(.05, .69, .14, 1)","translate3d(-"+r+",0,0)");c["box-shadow"]="0px 0px 13px 1px #929292",window.setTimeout(function(){o.innerWrapper.css(c)},s)}if("fromBottom"==l){i.attr("data-height");this.showPageBackCover.removeClass("displaynone").css({left:"0",top:"0"}),window.setTimeout(function(){i.css(e.processTransitionTanformStyle("transform .2s cubic-bezier(.05, .69, .14, 1)","translate3d(0,0,0)"))},s)}},i}),define("../../components/poplayer",["utils","base"],function(e,t){var i=function(e){var t=this;i.baseConstructor.call(this,e),this.mode=e.mode||"bottom";var n="displayflex yy-poplayer yy-poplayer-"+this.mode;this.showClassName="yy-poplayer-"+this.mode+"-show",this.hideClassName="yy-poplayer-"+this.mode+"-hide",this.bkCover=$("<div class='yy-poplayer-bk displaynone'></div>"),e.bkCoverStyle&&this.bkCover.css(e.bkCoverStyle),this.bkCover.appendTo(this.pageview.$$childrenWrapper),this.bkCover.bind("click",function(){t.hide()}),this.$el.addClass(n),this.initLayout(this.datasource)};return e.extends(i,t),i.prototype.show=function(){this.bkCover.removeClass("displaynone"),this.$el.removeClass(this.hideClassName).addClass(this.showClassName)},i.prototype.hide=function(){this.bkCover.addClass("displaynone"),this.$el.removeClass(this.showClassName).addClass(this.hideClassName)},i}),define("../../components/popover",["utils","base"],function(e,t){var i=function(t){var n=this;t.noNeedSetStyle=!0,t.style=t.style||{},t.arrowStyle=t.arrowStyle||{},t.arrowStyle=t.arrowStyle||"16px",t.arrowStyle.backgroundColor=t.arrowStyle.backgroundColor||"rgba(0,0,0,.9)",t.arrowStyle.height=t.arrowStyle.height||"14px",t.arrowStyle.width=t.arrowStyle.height,t.style.width||(t.style.width="120px"),t.style.height||(t.style.height="200px"),i.baseConstructor.call(this,t),this.width_int=parseInt(this.config.style.width),this.height_int=parseInt(this.config.style.height),this.$el.addClass("yy-popover"),t.arrowStyle.transform="rotate(45deg)",t.arrowStyle["-webkit-transform"]="rotate(45deg)",this.animateAction="0",t.animate&&(this.animateAction=t.animate.mode),this.offset=t.offset||{x:0,y:0};var a=this.offset.x||0,o=this.offset.y||0;this.offset.x=parseInt(a),this.offset.y=parseInt(o),this.arrow_width_int=parseInt(t.arrowStyle.width),this.arrow=$("<div class='yy-pop-arrow'></div>"),this.bkCover=$("<div class='yy-pop-bk displaynone'></div>"),e.css(this.arrow,t.arrowStyle),this.contentWrapper=$("<div class='displayflex yy-pop-content'></div>"),this.$$childrenWrapper=this.contentWrapper,e.css(this.contentWrapper,this.config.style),this.$el.append(this.arrow).append(this.contentWrapper),t.bkCoverStyle&&e.css(this.bkCover,t.bkCoverStyle),this.bkCover.appendTo(this.pageview.$$childrenWrapper),this.bkCover.bind("click",function(){n.hide()}),this.initLayout(t.$$datasource)};return e.extends(i,t),i.prototype.getHeight=function(){return this.$el.height()},i.prototype.hide=function(){var e=this;"0"!=this.animateAction&&"1"!=this.animateAction?(this.$el.css({opacity:0}),window.setTimeout(function(){e.$el.css({visibility:"hidden"})},300)):this.$el.css(this.hidePos),e.bkCover.addClass("displaynone")},i.prototype.show=function(t,i){i=i||{};var n=this,a=i.direction;if(t){var o=t.getClientRect();a||(o.top>this.getHeight()+this.arrow_width_int?a="top":e.viewport.height-o.bottom>this.getHeight()+this.arrow_width_int&&(a="bottom"));var s={visibility:"visible",transition:"transform .3s ease"};if(this.hidePos={},"top"==a){var r=o.top-this.getHeight()-this.arrow_width_int;s.top=r+"px","0"==this.animateAction?this.hidePos.visibility="hidden":"1"==this.animateAction?(this.hidePos.transform="translate3d(0,"+(e.viewport.height-r)+"px,0)",s.transform="translate3d(0,"+(e.viewport.height-r)+"px,0)"):(s.transition="opacity .3s ease",this.hidePos.visibility="hidden",s.opacity="0",s.transform="translate3d(0,0,0)")}else if("bottom"==a){var r=o.bottom+this.arrow_width_int/2;s.top=r+"px","0"==this.animateAction?this.hidePos.visibility="hidden":"1"==this.animateAction?(this.hidePos.transform="translate3d(0,"+(0-this.getHeight()-r-10)+"px,0)",s.transform="translate3d(0,"+(0-this.getHeight()-r-10)+"px,0)"):(s.transition="opacity .3s ease",this.hidePos.visibility="hidden",s.opacity="0",s.transform="translate3d(0,0,0)")}s.left=o.left+o.width/2-this.width_int/2+this.offset.x;var l=s.left+this.width_int-e.viewport.width;l>0&&(s.left=s.left-l-6),s.left<0&&(s.left=6);var c={left:o.left+o.width/2-this.arrow_width_int/2-s.left+"px"};"bottom"==a?(c["border-top-left-radius"]="4px",c.top="-"+this.arrow_width_int/2+"px"):(c["border-bottom-right-radius"]="4px",c.bottom="-"+this.arrow_width_int/2+"px"),e.css(this.arrow,c),e.css(this.$el,s),this.bkCover.removeClass("displaynone"),"0"==this.animateAction?n.$el.css({visibility:"visible"}):"1"==this.animateAction?window.setTimeout(function(){n.$el.css({transform:"translate3d(0,0,0)"})},0):window.setTimeout(function(){n.$el.css({opacity:"1"})},0)}},i}),define("../../components/radiobox",["utils","base"],function(e,t){var i=e.getRealWidth(22),n=e.getRealWidth(14),a={width:i,height:i,border:"1px solid rgb(229, 229, 229)",backgroundColor:"#fff",fontSize:n},o={width:i,height:i,color:"#fff",border:"1px solid rgb(144, 151, 255)",backgroundColor:"rgb(144, 151, 255)",fontSize:n},s=function(t){var i=this;t.style=t.style||{},this.uss=e.simpleExtendObj(e.clone(a),t.radioStyle),this.uss=e.simpleExtendObj(this.uss,t.unSelectedRadioStyle||{}),this.ss=e.simpleExtendObj(e.clone(o),t.radioStyle||{}),this.ss=e.simpleExtendObj(this.ss,t.selectedRadioStyle||{}),this.selectedBackgroundColor=this.ss.backgroundColor||"#0093ff",s.baseConstructor.call(this,t),this.value=!!this.config.value,this.$el.addClass("yy-icommon"),this.$el.addClass("yy-radio-warpper displayflex yy-fd-row yy-jc-center yy-ai-center"),this.radioDom=$("<div class='yy-radio'></div>"),this.textDom=$("<div class='yy-radio-text'>"+(this.config.text||"")+"</div>"),this.config.textStyle&&e.css(this.textDom,this.config.textStyle),this.$el.append(this.radioDom).append(this.textDom),this.setValue(this.value),this.$el.bind("click",function(){i.change()});var n=this.config.comKey+"_change";this.changeMethod=this.pageview.plugin[n],this.config.selectedRadioStyle&&this.config.selectedRadioStyle.fontSize&&(this.config.selectedRadioStyle.fontSize+="",this.config.selectedRadioStyle.fontSize.indexOf("px")===-1&&(this.config.selectedRadioStyle.fontSize=this.config.selectedRadioStyle.fontSize+"px"),$("head").find("style.yy-radio-head").remove(),$('<style class="yy-radio-head">.yy-radio-selected .yy-radio:before {font-size: '+this.config.selectedRadioStyle.fontSize+"!important;}</style>").appendTo("head"))};return e.extends(s,t),s.prototype.change=function(){this.changeMethod&&this.changeMethod.call(this.pageview.plugin,this,{value:!this.value})},s.prototype.selected=function(t){t&&this.config.disableParentSelect||(this.value=!0,e.css(this.radioDom,this.ss),this.$el.addClass("yy-radio-selected"))},s.prototype.unSelected=function(t){t&&this.config.disableParentSelect||(this.value=!1,e.css(this.radioDom,this.uss),this.$el.removeClass("yy-radio-selected"))},s.prototype.setValue=function(t){this.value=t,t?(this.$el.addClass("yy-radio-selected"),e.css(this.radioDom,this.ss)):(this.$el.removeClass("yy-radio-selected"),e.css(this.radioDom,this.uss))},s}),define("../../components/radiolist",["utils","base"],function(e,t){var i=function(t){this.itemData=t.itemData,this.parent=t.parent;this.key=this.itemData[this.parent.primaryKey],this.$el=$("<div data-key='"+this.key+"' class='yy-radiolist-item yy-icommon' style='height:"+t.parent.itemHeight+"px;line-height:"+t.parent.itemHeight+"px;font-size:"+e.fontSize13()+"px'>"+(t.itemData[t.parent.labelKey]||"")+"</div>")};i.prototype={selected:function(){this.$el.addClass("yy-radiolist-item-selected")},unSelected:function(){this.$el.removeClass("yy-radiolist-item-selected")}};var n=function(t){var i=this;n.baseConstructor.call(this,t);var a=e.getRealHeight("36");this.itemHeight=e.getRealHeight("48"),this.$el.addClass("yy-checklist"),this.items=[],this.selectedValue=this.config.selectedValue||[],this.primaryKey=this.config.primaryKey,this.primaryKey||console.error(this.config.comKey+"控件没有指定primaryKey数据的主键"),this.loadWrapper=$("<div class='yy-cs-loading-wrapper displayflex jc-center ai-center'><div class='preloader'></div></div>"),this.backCoverLayer=$("<div class='yy-cl-coverlayer displaynone'></div>"),this.backCoverLayer.bind("touchmove",function(e){e.preventDefault(),e.stopPropagation()});var o=$("<div style='height:"+a+"px;font-size:"+e.fontSize(14)+"px;line-height:"+a+"px' class='yy-rl-title-wrapper'>"+(t.title||"请选择")+"</div>");this.listWrapper=$("<div style='max-height:"+6.7*this.itemHeight+"px;' class='yy-cl-list-wrapper'></div>"),this.listWrapper.append(this.loadWrapper),this.$el.append(o).append(this.listWrapper),this.labelKey=this.config.labelKey||"text",this.backCoverLayer.bind("click",function(){i.hide()}),this.listWrapper.bind("click",function(e){i.itemClick(e)});var s=this.config.comKey+"_selected";this.selectedMethod=this.pageview.plugin[s],this.pageview.$el.append(this.backCoverLayer)};return e.extends(n,t),n.prototype._getPrimaryValue=function(e){var t="";if("string"==typeof this.primaryKey)t=e[this.primaryKey];else if(this.primaryKey instanceof Array){for(var i=[],n=0,a=this.primaryKey.length;n<a;n++)i.push(e[this.primaryKey[n]]);t=i.join("_")}else console.error("radiolist控件primaryKey属性 错误的数据类型");return t},n.prototype.itemClick=function(e){var t=e.target.getAttribute("data-key");if(t){for(var i=null,n=0,a=this.items.length;n<a;n++)if(t==this.items[n].key){i=this.items[n];break}i&&(this.selectedValue=[i.itemData],this.setItemSelected(this.selectedValue),this.selectedMethod&&this.selectedMethod.call(this.pageview.plugin,this,{selectedValue:this.selectedValue}),this.hide())}},n.prototype.show=function(){this.$el.addClass("yy-checklist-show"),this.backCoverLayer.removeClass("displaynone"),this.init()},n.prototype.setItemSelected=function(e){for(var t=0,i=this.items.length;t<i;t++){var n=this.items[t];n.unSelected()}if(e.length>0){this.selectedValue=[];for(var a=0;a<1;a++)if(void 0!==e[a])for(var o=this._getPrimaryValue(e[a]),t=0,i=this.items.length;t<i;t++){var n=this.items[t];n.key==o&&(n.selected(),this.selectedValue.push(n.itemData))}}},n.prototype.setSelectedValue=function(e){e instanceof Array||console.error("radiolist setSelectedValue方法必须是数组"),this.items&&this.items.length>0?this.setItemSelected(e):this._midSelectedValue=e},n.prototype.createItems=function(e){this.dataSource=e,this.items=[],this.listWrapper.empty();for(var t=this.dataSource.length,n=0,a=t;n<a;n++){var o=this.dataSource[n],s=new i({itemData:o,parent:this});this.listWrapper.append(s.$el),this.items.push(s),t>1&&n!=t-1&&this.listWrapper.append("<div class='yy-checklist-line'></div>")}this._midSelectedValue&&(this.setItemSelected(this._midSelectedValue),this.config.selectedValue=this._midSelectedValue,this._midSelectedValue=null),this.setSelectedValue(this.config.selectedValue||[])},n.prototype.init=function(){var e=this;this.dataSource||(e.loadWrapper.removeClass("displaynone"),e.loadErrorWrapper&&e.loadErrorWrapper.addClass("displaynone"),this.loadData(function(t){e.loadWrapper.addClass("displaynone"),e.loadErrorWrapper&&e.loadErrorWrapper.addClass("displaynone"),e.createItems(t)},function(){e.loadErrorWrapper||e.initLoadErrorDom(),e.loadErrorWrapper.removeClass("displaynone"),e.loadWrapper.addClass("displaynone")}))},n.prototype.loadData=function(e,t){if(this.dataSource)return void e(this.dataSource);var i=this.config.comKey+"_loaddata",n=this.pageview.plugin[i];n&&n.call(this.pageview.plugin,this,{success:e,error:t})},n.prototype.initLoadErrorDom=function(){var t=this,i=e.getRealWidth(11),n=e.getRealWidth(20);this.loadErrorWrapper=$("<div style='height:100px' class='yy-loadmore-wrapper displayflex jc-center ai-center flex-h'></div>");var a=$("<i style='font-size:"+n+"px' class='yy-icommon yy-loadmore-erroricon'></i>"),o=$("<span style='font-size:"+i+"px' class='yy-pull-meslabel'>网络异常,点击</span>"),s=$("<span style='font-size:"+i+"px' class='yy-loadmore-reload-babel'>重新加载</span>");s.bind("click",function(){t.init()}),this.loadErrorWrapper.append(a).append(o).append(s),this.listWrapper.append(this.loadErrorWrapper)},n.prototype.hide=function(){this.$el.removeClass("yy-checklist-show"),this.backCoverLayer.addClass("displaynone")},n}),define("../../components/repeat",["utils","base"],function(e,t){var i=function(e){var t=this;this.datasource=e.$$datasource,this.parent=e.$$parent,e.style&&(e.style.flexDirection||e.style["flex-direction"]||(e.style.flexDirection="column",e.style.webkitFlexDirection="column")),this.parent.useFloatToWrap&&(e.style.float="left",e.style.display="inline-block"),i.baseConstructor.call(this,e),this.parent.rowMarkSeed||(this.parent.rowMarkSeed=0),this.parent.rowMarkSeed+=1,this.itemMark="item"+this.parent.rowMarkSeed,this.$el.attr("data-role","repeatitem"),this.$el.attr("item-mark",this.itemMark);var n=this.parent.useFloatToWrap?"yy-repeatitem":"displayflex yy-repeatitem";this.$el.addClass(n),this.$el.bind("click",function(){"edit"!==t.parent.status&&t.parent._itemClick(t)}),e.itemClassName&&this.$el.addClass(e.itemClassName),this.initLayout(e.$$datasource,null,this)};e.extends(i,t),i.prototype.select=function(){if("m"===this.parent.selectedMode){var e=this.parent.selectedItems.indexOf(this);e>=0?(this.parent.selectedItems.splice(e,1),this.unSelected()):(this.parent.selectedItems.push(this),this.selected())}else{var t=this.parent.selectedItems[0];t&&t.unSelected(),this.parent.selectedItems[0]=this,this.selected()}},i.prototype.delegate=function(e,t){var i=this.refs[e];i?t(i):(this.config.components[e].ref||console.log("请务必在"+e+"控件上设置ref:true"),this.componentsInitActions[e]=t)},i.prototype.showPlaceHolder=function(){this.placeHolder||(this.placeHolder=$("<div class='yy-repeat-placeholder displaynone'></div>"),this.$el.append(this.placeHolder)),this.placeHolder.removeClass("displaynone")},i.prototype.moveTo=function(e){if(null!==e&&void 0!==e){var t=this.parent.components.indexOf(this);if(t!=e){var i=this.parent.components[e];if(i){this.$el.insertBefore(i.$el),this.parent.components.splice(t,1),this.parent.datasource.splice(t,1);var n=e;t<e&&(n-=1),this.parent.components.splice(n,0,this),this.parent.datasource.splice(n,0,this.datasource)}else this.parent.components.splice(t,1),this.parent.datasource.splice(t,1),this.parent.components.push(this),this.parent.datasource.push(this.datasource),this.parent.subComponent?this.$el.insertBefore(this.parent.subComponent.$el):this.$el.appendTo(this.parent.$el)}}},i.prototype.hidePlaceHolder=function(){this.placeHolder.addClass("displaynone")},i.prototype.remove=function(e){var t=this,i=this.parent.datasource.indexOf(this.datasource),n=this.parent.components.indexOf(this);i>=0&&this.parent.datasource.splice(i,1),n>=0&&this.parent.components.splice(n,1),this.splitLine&&this.splitLine.remove(),e?(this.$el.css({height:this.$el.height()+1+"px"}),window.setTimeout(function(){t.$el.css({transition:"height .12s linear","-webkit-transition":"height .12s linear",height:"0px"})},40),window.setTimeout(function(){t.$el.remove()},345)):t.$el.remove()},i.prototype.rebind=function(e){this.$el.empty(),this.datasource=e,this.initLayout(e,null,this)};var n=function(t){this.initSourceLength=0;var i=t.style||{};this.useFloatToWrap=!e.isSupportFlexWrap()&&("wrap"==i.flexWrap||"wrap"==i["flex-wrap"]),this.selectedItems=[],this.splitStyle=t.splitStyle,t.subComponent&&(t.$$pageview.config.components[t.subComponent].ref=!0),n.baseConstructor.call(this,t),this.subComponentInBefore=this.config.subComponentInBefore===!0,this.datasource=[];var a=this.useFloatToWrap?"yy-repeat ":"displayflex yy-repeat ";this.$el.addClass(a),this.selectedMode=t.selectedMode,this.subComponent=null,this.init(),this.hasAttachSortEvent=!1};return e.extends(n,t),n.prototype.setLeftOpen=function(){return"edit"===this.status?(this.setLeftClose(),void this.showOrHideSubComponent(!0)):(this.status="edit",this.showOrHideSubComponent(!1),void this.$el.addClass(this.showBlockClassNameDict.left))},n.prototype.eachItem=function(e){for(var t=0,i=this.components.length;t<i;t++){var n=e(this.components[t],t);if(n===!1)break}},n.prototype.clearSelectAll=function(){this.selectedItems=[],this.eachItem(function(e){e.unSelected()})},n.prototype.selectAllItems=function(){var e=this;this.selectedItems=[],this.eachItem(function(t){t.selected(),e.selectedItems.push(t)})},n.prototype.setLeftRightOpen=function(){return"edit"===this.status?(this.setLeftRightClose(),void this.showOrHideSubComponent(!0)):(this.status="edit",this.showOrHideSubComponent(!1),void this.$el.addClass((this.showBlockClassNameDict.left||"")+" "+(this.showBlockClassNameDict.right||"")))},n.prototype.setLeftRightClose=function(){this.status="",this.$el.removeClass((this.showBlockClassNameDict.left||"")+" "+(this.showBlockClassNameDict.right||""))},n.prototype.setLeftClose=function(){this.status="",this.$el.removeClass(this.showBlockClassNameDict.left)},n.prototype.setRightOpen=function(){return"edit"===this.status?(this.setRightClose(),void this.showOrHideSubComponent(!0)):(this.status="edit",this.showOrHideSubComponent(!1),void this.$el.addClass(this.showBlockClassNameDict.right))},n.prototype.setRightClose=function(){this.status="",this.$el.removeClass(this.showBlockClassNameDict.right)},n.prototype.initLeftRightBlock=function(){this.initBlock(this.config.leftBlock,"left"),this.initBlock(this.config.rightBlock,"right")},n.prototype.initBlock=function(t,i){if(t){t.key&&t.width||console.error("listview 的"+i+"Block配置需要包括key和widt属性");try{t.width=parseInt(t.width)}catch(e){}isNaN(t.width)&&console.error("listview 的"+i+"Block的widt属性必须为数值"),t.width=e.getRealWidth(t.width);var n=this.getUniqueKey()+i;this.$el.addClass(n),this.showBlockClassNameDict||(this.showBlockClassNameDict={}),this.showBlockClassNameDict[i]=n+"_show"+i,e.createStyleSheet(n,"."+t.key+" {transition:width .3s ease;-webkit-transition:width .3s ease;} ."+this.showBlockClassNameDict[i]+" ."+t.key+" {width:"+t.width+"px !important;}")}},n.prototype.init=function(){var e=this,t=this.config.items||[];this.initSourceLength=t.length;for(var i=0,n=t.length;i<n;i++)this.addItem(t[i],i,n);this.config.subComponent&&this.getComponentInstanceByComKey(this.config.subComponent,this.datasource,null,function(t){e.$el.append(t.$el),e.subComponent=t},function(){}),this.config.nodata&&this.getComponentInstanceByComKey(this.config.nodata,null,null,function(t){e.$el.append(t.$el),e.components.length>0&&t.$el.addClass("displaynone"),e.noDataDom=t},function(){}),this.initLeftRightBlock()},n.prototype.showOrHideSubComponent=function(e){this.config.subComponent&&this.pageview.do(this.config.subComponent,function(t){e?t.$el.removeClass("displaynone"):t.$el.addClass("displaynone")})},n.prototype.empty=function(){for(var e=this.components.length-1;e>=0;e--)this.components[e].remove();this.datasource=[],this.components=[]},n.prototype.bindData=function(e){if(this.empty(),e&&e instanceof Array&&e.length>0){this.noDataDom?(this.noDataDom.$el.addClass("displaynone"),this.showOrHideSubComponent(!0)):this.showOrHideSubComponent(!0),this.initSourceLength=e.length;for(var t=0,i=e.length;t<i;t++)this.addItem(e[t],t,i)}else this.noDataDom&&this.noDataDom.$el.removeClass("displaynone"),this.config.subComponentAlwaysShow?this.showOrHideSubComponent(!0):this.showOrHideSubComponent(!1)},n.prototype.getItem=function(e){for(var t=0,i=this.components.length;t<i;t++){var n=this.components[t];
if(e(n))return n}return null},n.prototype.insertItem=function(e,t){this.noDataDom&&this.noDataDom.$el.addClass("displaynone"),this.addItem(e,t)},n.prototype.getTargetItem=function(e,t){var i=e.target,n=this.config.sortHandle,a=!1,o=i.getAttribute("item-mark");for(n&&(i.getAttribute("data-comname")!=n?o=null:a=!0);!o&&"BODY"!==i.tagName.toUpperCase();)if(i=i.parentNode,n&&i.getAttribute("data-comname")==n&&(a=!0),o=i.getAttribute("item-mark")){n&&(a||(o=null));break}var s=null;if(o)for(var r=0,l=this.components.length;r<l;r++){var c=this.components[r];if(c.itemMark===o){s=c;break}}return s},n.prototype.startSort=function(){var e,t,i=this,n=this.parent;if(this.pageview.plugin){var a=this.config.comKey+"_sortend";t=this.pageview.plugin[a]}this.isInSort=!0;var o,s,r,l,c,p=null;this.hasAttachSortEvent||(this.hasAttachSortEvent=!0,this.$el.bind("touchstart",function(t){if(e=i.getTargetItem(t,!0),i.repeatOffsetY=i.$el.offset().top,r=0,l=0,e&&i.isInSort){p=e.$el.position();var a=t.touches[0];o=a.pageX,s=a.pageY,c=e.$el.clone(),n&&(scrollTop=n.$el[0].scrollTop),c.css({position:"absolute",zIndex:50,left:p.left+"px",top:p.top+"px"}),e.showPlaceHolder(),i.$el.append(c)}}),this.$el.bind("touchmove",function(t){if(e&&i.isInSort){var a=t.touches[0];t.preventDefault(),t.stopPropagation();var d=a.pageX,h=a.pageY;r=d-o,l=h-s;var u=0;if(n&&(u=n.$el[0].scrollTop),Math.abs(parseInt(h))%3==1){var f=i.getItemIndexByPosY(h+u-(u+i.repeatOffsetY));e.moveTo(f)}var g=l+p.top;g=g<0?0:g,c.css({position:"absolute",zIndex:50,top:g+"px"})}}),this.$el.bind("touchend",function(n){e&&i.isInSort&&(t&&t.call(i.pageview.plugin,this,{}),e.hidePlaceHolder(),c.remove(),c=null)}))},n.prototype.endSort=function(){this.isInSort=!1},n.prototype.getItemIndexByPosY=function(e){for(var t,i=0,n=this.components.length,a=0,o=n;a<o;a++){var s=this.components[a],r=s.$el.height();if(e>i&&e<i+r/2){t=a;break}if(e>=i+r/2&&e<i+r){t=a+1;break}i+=r}return t},n.prototype.addItem=function(t,n,a){var o=!1;void 0===n||null===n||n<0||n>=this.datasource.length?(n=this.datasource.length,this.datasource.push(t)):(this.datasource.splice(n,0,t),o=!0);var s,r=new i({type:"repeatitem",root:this.config.root,style:this.config.itemStyle,$$pageview:this.pageview,$$datasource:t,$$parent:this,index:n,itemClassName:this.config.itemClassName,selectedClassName:this.config.itemSelectedClassName});if(this.splitStyle&&this.components.length>0){var l="repeat-splitline-"+n;s=$("<div class='"+l+"'></div>"),r.splitLine=s,e.css(s,this.splitStyle)}if(o?this.components.splice(n,0,r):this.components.push(r),o){var c=this.components[n+1];0!==n&&s&&s.insertBefore(c.$el),r.$el.insertBefore(c.$el),0===n&&s&&s.insertBefore(c.$el)}else this.subComponent?this.subComponentInBefore?(s&&this.$el.append(s),this.$el.append(r.$el)):(s&&s.insertBefore(this.subComponent.$el),r.$el.insertBefore(this.subComponent.$el)):(s&&this.$el.append(s),this.$el.append(r.$el))},n.prototype._itemClick=function(e){var t=this.config.comKey+"_itemclick";if(this.pageview.plugin){var i=this.pageview.plugin[t];if(e.disabled)return;i&&i.call(this.pageview.plugin,e,{index:e.$el.index()})}this.config.$$itemClick&&this.config.$$itemClick(e)},n}),define("../../components/searchview",["utils","base"],function(e,t){var i=function(t){var n=this;i.baseConstructor.call(this,t);var a="displayflex yy-seachview yy-fd-column";this.$el.addClass(a),this.cancelBtnWidth=e.getRealWidth(60),this.inputWidth=e.getRealWidth(355);var o=e.getRealHeight(30),s=e.getRealHeight(10),r=e.getRealWidth(30);this.inputFocusWidth=this.inputWidth-this.cancelBtnWidth+s,this.searchBarClassName="yy-sv-bar yy-fd-row displayflex yy-ai-center",this.searchBar=$("<div class='"+this.searchBarClassName+" yy-sv-defalut'></div>"),this.config.searchBarStyle&&(this.config.searchBarStyle.paddingLeft||(this.config.searchBarStyle.paddingLeft=e.getRealWidth(10)),this.config.searchBarStyle.paddingRight||(this.config.searchBarStyle.paddingRight=e.getRealWidth(10)),e.css(this.searchBar,this.config.searchBarStyle)),this.form=$("<form class='yy-sv-form' style='height:"+o+"px;width:"+this.inputWidth+"px'></form>");var l=$("<div class='yy-sv-input-div' style=''></div>");this.clearBtn=$("<div class='yy-sv-clear yy-icommon displaynone' style='height:"+o+"px;width:"+o+"px'></div>");var c=this.config.placeholder||"搜索";this.input=$("<input style='font-size:"+e.fontSize(14)+"px;padding-left:"+r+"px' placeholder='"+c+"' type='search'/>"),this.input.bind("focus",function(){n._focus()}),this.input.bind("input",function(){n.inputChange()}),this.clearBtn.bind("click",function(){n.input.val(""),n.input.focus(),n.inputChange()}),l.append(this.clearBtn).append(this.input),this.form.append(l),this.form.bind("submit",function(e){return e.preventDefault(),!1});var p=$("<div style='width:"+this.cancelBtnWidth+"px;height:"+o+"px;font-size:"+e.fontSize(16)+"px' class='yy-sv-cancel displayflex yy-jc-center yy-ai-center'>取消</div>");p.bind("click",function(){n._cancelSearch()}),this.body=$("<div class='yy-flex-1 yy-sv-body'></div>"),this.config.bodyStyle&&e.css(this.body,this.config.bodyStyle);var d=this.config.comKey+"_change";this.changePluginMethod=this.pageview.plugin[d],this._init(),this.time=this.config.time,!this.time||isNaN(this.time)?this.time=1e3:this.time=parseInt(this.time),this.input.bind("keydown",function(e){13===e.keyCode&&n.input.blur()}),this.searchBar.append(this.form).append(p),this.$el.append(this.searchBar).append(this.body)};return e.extends(i,t),i.prototype.inputChange=function(e){var t=this,i=this.input.val();return""==i?this.clearBtn.addClass("displaynone"):this.clearBtn.removeClass("displaynone"),0==this.time?void(t.changePluginMethod&&t.changePluginMethod.call(t.pageview.plugin,t.input,{searchview:t,value:i})):(this.timeid&&window.clearTimeout(this.timeid),void(e?t.changePluginMethod&&t.changePluginMethod.call(t.pageview.plugin,t.input,{searchview:t,value:i}):this.timeid=window.setTimeout(function(){t.changePluginMethod&&t.changePluginMethod.call(t.pageview.plugin,t.input,{searchview:t,value:i})},this.time)))},i.prototype._cancelSearch=function(){this.form.css({width:this.inputWidth+"px"}),this.clearBtn.addClass("displaynone"),this.searchBar[0].className=this.searchBarClassName+" yy-sv-defalut",this.defaultComyWrapper&&(this.defaultComyWrapper.removeClass("displaynone"),this.resultComWrapper&&this.resultComWrapper.addClass("displaynone"))},i.prototype.search=function(e,t){this._focus(),this.input.val(e),this.inputChange(t)},i.prototype.value=function(){return $.trim(this.input.val())},i.prototype.blur=function(e){this.input.blur()},i.prototype.focus=function(e){this.input.focus()},i.prototype._focus=function(){this.form.css({width:this.inputFocusWidth+"px"}),this.input.val().length>0&&this.clearBtn.removeClass("displaynone"),this.searchBar[0].className=this.searchBarClassName+" yy-sv-active",this.resultComWrapper&&(this.resultComWrapper.removeClass("displaynone"),this.defaultComyWrapper&&this.defaultComyWrapper.addClass("displaynone"))},i.prototype._init=function(){var e=this,t=this.config.defaultComponent;t&&(this.defaultComyWrapper=$("<div class='yy-sv-body-wrapper displayflex yy-fd-column'></div>"),this.body.append(this.defaultComyWrapper),this.getComponentInstanceByComKey(t,null,null,function(t){e.defaultComyWrapper.append(t.$el)},function(){}));var i=this.config.resultComponent;i&&(this.resultComWrapper=$("<div class='yy-sv-body-wrapper displayflex yy-fd-column displaynone'></div>"),this.body.append(this.resultComWrapper),this.getComponentInstanceByComKey(i,null,null,function(t){e.resultComWrapper.append(t.$el)},function(){}))},i}),define("../../components/segment_android",["utils","base"],function(e,t){var i=function(e){var t=this;this.index=e.index,e.style=e.style||{},e.style.flexDirection||e.style["flex-direction"]||(e.style.flexDirection="column",e.style.webkitFlexDirection="column"),e.style.alignItems||e.style["align-items"]||(e.style.alignItems="center",e.style.webkitAlignItems="center"),e.style.justifyContent||e.style["justify-content"]||(e.style.justifyContent="center",e.style.webkitJustifyContent="center"),e.style.width||(e.style.flex=1,e.style.webkitFlex=1),e.style.height=e.style.height||"25px",i.baseConstructor.call(this,e),this.$el.addClass("displayflex yy-segmentitem-android"),this.$el.bind("click",function(){t.disabled||t.parent._itemClick(t)}),this.childHasInited=!1,this.initLayout(e.$$datasource,null,null,function(){t.childHasInited=!0,t.wantToSelected===!0&&(t.selected(),t.wantToSelected=!1)})};e.extends(i,t),i.prototype.initSetSelected=function(){this.childHasInited?this.selected():this.wantToSelected=!0};var n=function(e){e.itemStyle=e.itemStyle||{},e.style=e.style||{},e.style.width=e.style.width||"100%";var t=e.itemStyle.height||e.style.height||"25px";e.itemStyle.height=t,delete e.style.height,n.baseConstructor.call(this,e),this.$el.css({height:t}),this.$el.addClass("yy-sgm-android"),this.$innerWraper=$("<div class='displayflex yy-sgm-android-inner flex-h'></div>"),this.indicator=$("<div class='yy-sgm-indicator'></div>"),this.selectedMode=e.selectedMode,this.selectedIndex=parseInt(e.selectedIndex)||0,this.selectedItems,this.components=[],this.dataSource=[],this.splitStyle=e.splitStyle,this.offsetX=0,this.$innerWraper.appendTo(this.$el),this.init()};return e.extends(n,t),n.prototype.init=function(){var e=this;this.getdata(function(t){e.createItems(t)},function(){})},n.prototype.createItems=function(e){var t=this.config.indicatorStyle||{};this.itemCount=e.length,this.config.itemStyle.width?(this.itemWidth_int=parseFloat(this.config.itemStyle.width),this.itemWidth=this.itemWidth_int+"px",t.left=this.itemWidth_int*this.selectedIndex+"px",t.width=this.itemWidth_int+"px",this.maxWidth=this.itemWidth_int*this.itemCount,this.$innerWraper.css({width:this.maxWidth+3+"px"}),this.initEvent()):(this.itemWidth_int=100/e.length,this.itemWidth=this.itemWidth_int+"%",t.left=this.itemWidth_int*this.selectedIndex+"%",t.width=this.itemWidth_int+"%",this.$innerWraper.css({width:"100%"})),this.indicator.css(t),this.$innerWraper.append(this.indicator);for(var i=0,n=e.length;i<n;i++)this.addItem(e[i])},n.prototype.getdata=function(e,t){if(this.config.items)return void e(this.config.items);var i=this.config.comKey+"_getdata",n=this.pageview.plugin[i];n&&n.call(this.pageview.plugin,this,{success:function(t){e(t)},error:function(){t()}})},n.prototype.addItem=function(t){this.dataSource.push(t);var n=new i({type:"segmentitem",root:this.config.root,style:this.config.itemStyle,$$pageview:this.pageview,$$datasource:t,$$parent:this,index:this.components.length,selectedClassName:this.config.itemSelectedClassName});if(this.components.push(n),this.components.length==this.selectedIndex+1&&(this.selectedItems=n,n.initSetSelected()),this.$innerWraper.append(n.$el),this.splitStyle&&this.components.length>0&&this.components.length<this.config.items.length){var a=$("<div></div>");e.css(a,this.splitStyle),this.$innerWraper.append(a)}},n.prototype._itemClick=function(t){var i=this.selectedItems===t,n=this.config.comKey+"_change";if(this.pageview.plugin&&this.pageview.plugin[n]){var a=this.pageview.plugin[n];if(a){var o=a.call(this.pageview.plugin,this,{item:t,nochange:i});if(o)return}}if(i);else if(this.selectedItems&&this.selectedItems.unSelected(),this.selectedItems=t,this.selectedItems.selected(),this.config.itemStyle.width){if(this.indicator.css({left:this.itemWidth_int*t.index+"px"}),t.index!=this.itemCount-1){var s=this.itemWidth_int*(t.index-2);s=s<0?0:s,0!=t.index?s+=30:s=0,this.offsetX=0-s,this.$innerWraper.css(e.processTransformStyle("translate3d(-"+s+"px,0,0)"))}}else this.indicator.css({left:this.itemWidth_int*t.index+"%"});var r=t.datasource,l=r.key,c=this.pageview.refs[this.config.viewpager];c&&l&&c.showItem(l)},n.prototype.initEvent=function(){var t,i=0,n=0,a=0,o=this,s=e.viewport.width,r=this.maxWidth-s;r=r<=0?0:r,this.$el.bind("touchstart",function(e){var a=e.touches[0];i=a.pageX,n=0,t=(new Date).valueOf()}),this.$el.bind("touchmove",function(t){var s=t.touches[0],r=s.pageX;n=r-i,a=n+o.offsetX;var l=e.processTransformStyle("translate3d("+a+"px,0,0)");l.transition="none",l.webkitTransition="none",o.$innerWraper.css(l)}),this.$el.bind("touchend",function(i){var l=(new Date).valueOf(),c=l-t,p=0;c<400&&(p=r*(1-Math.abs(n)/s)),n>0?a+=p:a-=p,a>0&&(a=0),a<0-r&&(a=0-r),o.offsetX=a,c+=200;var d=e.processTransformStyle("translate3d("+a+"px,0,0)");d.transition="transform "+c+"ms ease",d.webkitTransition="transform "+c+"ms ease",o.$innerWraper.css(d)})},n}),define("../../components/segment_ios",["utils","base"],function(e,t){var i=function(e){var t=this;e.style=e.style||{},e.style.flexDirection||e.style["flex-direction"]||(e.style.flexDirection="column"),e.style.alignItems||e.style["align-items"]||(e.style.alignItems="center"),e.style.justifyContent||e.style["justify-content"]||(e.style.justifyContent="center"),e.style.flex=1,e.style.height=e.style.height||"25px",i.baseConstructor.call(this,e),this.$el.addClass("displayflex yy-segmentitem"),this.$el.bind("click",function(){t.parent._itemClick(t)}),this.initLayout(e.$$datasource)};e.extends(i,t),i.prototype.render=function(){};var n=function(e){e.itemStyle=e.itemStyle||{},e.style=e.style||{},e.style.width=e.style.width||"300px",e.style.border=e.style.border||"1px solid rgb(0, 147, 255)",e.style.borderRadius=e.style.borderRadius||"4px";var t=e.itemStyle.height||e.style.height||"25px";e.itemStyle.height=t,delete e.style.height,n.baseConstructor.call(this,e),this.$el.addClass("displayflex yy-sgm-ios flex-h"),this.selectedMode=e.selectedMode,this.selectedIndex=e.selectedIndex||0,this.selectedItems,this.components=[],this.dataSource=[],this.splitStyle=e.splitStyle||{borderLeft:"1px solid rgb(0, 147, 255)",height:t,width:0},this.init()};return e.extends(n,t),n.prototype.init=function(){for(var e=this.config.items||[],t=0,i=e.length;t<i;t++)this.addItem(e[t])},n.prototype.addItem=function(t){this.dataSource.push(t);var n=new i({type:"segmentitem",root:this.config.root,style:this.config.itemStyle,$$pageview:this.pageview,$$datasource:t,$$parent:this,selectedClassName:this.config.itemSelectedClassName||"yy-sgm-ios-selected"});if(this.components.push(n),this.components.length==this.selectedIndex+1&&(this.selectedItems=n,n.selected()),this.$el.append(n.$el),this.components.length>0&&this.components.length<this.config.items.length){var a=$("<div></div>");e.css(a,this.splitStyle),this.$el.append(a)}},n.prototype._itemClick=function(e){if(this.selectedItems===e){var t=this.config.comKey+"_selectedagin";if(this.pageview.plugin&&this.pageview.plugin[t]){var i=this.pageview.plugin[t];i&&i.call(this.pageview.plugin,this,{item:e})}}else{this.selectedItems&&this.selectedItems.unSelected(),this.selectedItems=e,this.selectedItems.selected();var t=this.config.comKey+"_change";if(this.pageview.plugin&&this.pageview.plugin[t]){var i=this.pageview.plugin[t];i&&i.call(this.pageview.plugin,this,{item:e})}var n=e.datasource,a=n.key,o=this.pageview.refs[this.config.viewpager];o&&a&&o.showItem(a)}},n}),define("../../components/simplesearchview",["utils","base"],function(e,t){var i=function(t){var n=this;i.baseConstructor.call(this,t);var a="displayflex yy-seachview yy-fd-column";this.$el.addClass(a),this.cancelBtnWidth=e.getRealWidth(60),this.inputWidth=e.getRealWidth(355);var o=e.getRealWidth(10),s=e.getRealHeight(30),r=e.getRealHeight(10),l=e.getRealWidth(30);this.inputFocusWidth=this.inputWidth-this.cancelBtnWidth+r,this.searchBarClassName="yy-sv-bar yy-fd-row displayflex yy-ai-center",this.searchBar=$("<div class='"+this.searchBarClassName+" yy-sv-defalut'></div>"),this.config.searchBarStyle&&(this.config.searchBarStyle.paddingLeft||(this.config.searchBarStyle.paddingLeft=e.getRealWidth(10)),this.config.searchBarStyle.paddingRight||(this.config.searchBarStyle.paddingRight=e.getRealWidth(10)),e.css(this.searchBar,this.config.searchBarStyle)),this.form=$("<form class='yy-sv-form' style='margin-left:"+o+"px;height:"+s+"px;width:"+this.inputWidth+"px'></form>");var c=$("<div class='yy-sv-input-div' style=''></div>");this.clearBtn=$("<div class='yy-sv-clear yy-icommon displaynone' style='height:"+s+"px;width:"+s+"px'></div>");var p=this.config.placeholder||"搜索";this.input=$("<input style='font-size:"+e.fontSize(14)+"px;padding-left:"+l+"px' placeholder='"+p+"' type='search'/>"),this.input.bind("focus",function(){n._focus()}),this.input.bind("input",function(){n.inputChange()}),this.clearBtn.bind("click",function(){n.input.val(""),n.input.focus(),g&&g.call(n.pageview.plugin,n,{value:n.input.val()})}),c.append(this.clearBtn).append(this.input),this.form.append(c),this.form.bind("submit",function(e){return e.preventDefault(),!1});var d=$("<div style='width:"+this.cancelBtnWidth+"px;height:"+s+"px;font-size:"+e.fontSize(16)+"px' class='yy-sv-cancel displayflex yy-jc-center yy-ai-center'>取消</div>");this.config.cancelBtnStyle&&e.css(d,this.config.cancelBtnStyle);var h=this.config.comKey+"_cancel",u=this.pageview.plugin[h];d.bind("click",function(){n._cancelSearch(),u&&u.call(n.pageview.plugin,n,{value:n.input.val()})});var f=this.config.comKey+"_search",g=this.pageview.plugin[f];this.input.bind("keydown",function(e){13===e.keyCode&&(n.input.blur(),g&&g.call(n.pageview.plugin,n,{value:n.input.val()}))}),this.searchBar.append(this.form).append(d),this.$el.append(this.searchBar)};return e.extends(i,t),i.prototype.inputChange=function(e){var t=this.input.val();""==t?this.clearBtn.addClass("displaynone"):this.clearBtn.removeClass("displaynone")},i.prototype._cancelSearch=function(){this.form.css({width:this.inputWidth+"px"}),this.clearBtn.addClass("displaynone"),this.searchBar[0].className=this.searchBarClassName+" yy-sv-defalut",this.defaultComyWrapper&&(this.defaultComyWrapper.removeClass("displaynone"),this.resultComWrapper&&this.resultComWrapper.addClass("displaynone"))},i.prototype._focus=function(){this.form.css({width:this.inputFocusWidth+"px"}),this.input.val().length>0&&this.clearBtn.removeClass("displaynone"),this.searchBar[0].className=this.searchBarClassName+" yy-sv-active",this.resultComWrapper&&(this.resultComWrapper.removeClass("displaynone"),this.defaultComyWrapper&&this.defaultComyWrapper.addClass("displaynone"))},i}),define("../../components/statusview",["utils","base"],function(e,t){var i=function(e){i.baseConstructor.call(this,e),this.$el.addClass("yy-statusview displayflex"),this.selectedKey=e.selectedKey||e.defaultKey,this.components={},this.change(this.selectedKey)};return e.extends(i,t),i.prototype.change=function(e){var t=this;t.curComponent&&t.curComponent.$el.addClass("displaynone");var i=t.components[e];return i?(i.$el.removeClass("displaynone"),void(t.curComponent=i)):void(e&&"null"!=e&&(this.curStatusKey=e,this.getComponentInstanceByComKey(e,this.datasource,this.rowInstance,function(i){t.components[e]=i,t.curComponent=i,e!==t.curStatusKey&&i.$el.addClass("displaynone"),t.$el.append(i.$el)},function(){})))},i}),define("../../components/swiper",["utils","base"],function(e,t){var i=function(e){this.config=e,this.$el=$("<div style='"+e.style+"' class='yy-swiper-item-wrapper'></div>")};i.prototype={css:function(t){e.css(this.$el,t)}};var n=function(t){this.config=t||{},this.$el=$("<div class='yy-swiper-wrapper flex-1'></div>"),this.itemWrappers=[],this.posArr=[0,1,2],this.limit=e.getRealWidth(90),this.minOffsetX=t.minOffsetX||0,this.tanKeys=e.getTransitionKeys(),this.initLayout(),this.direction="h",this.config.init&&this.config.init(this)};return n.prototype={_posArrGoNext:function(){var e=this.posArr[0];this.posArr[0]=this.posArr[1],this.posArr[1]=this.posArr[2],this.posArr[2]=e},_resetPosArr:function(){this.posArr=[0,1,2]},_posArrGoPre:function(){var e=this.posArr[2];this.posArr[2]=this.posArr[1],this.posArr[1]=this.posArr[0],this.posArr[0]=e},initLayout:function(){var t=this;this.initPos=[0-e.viewport.width,0,e.viewport.width];for(var n=0;n<3;n++){var a=this.tanKeys.transform+":translate3d("+this.initPos[n]+"px,0,0)",o=new i({style:a});this.itemWrappers.push(o),this.config.initItem&&this.config.initItem(o,n),this.$el.append(o.$el)}var s,r,l;t.isIntransition=!1,this.$el.bind("touchstart",function(e){l=t.isIntransition,t.isIntransition||(s=e.touches[0].pageX)}),this.$el.bind("touchmove",function(e){if(!t.isIntransition&&!l){var i=e.touches[0];r=i.pageX-s,"h"===t.direction&&Math.abs(r)>4&&(e.preventDefault(),e.stopPropagation()),t.setPos("move",r)}}),this.$el.bind("touchend",function(e){if(!t.isIntransition&&!l&&r&&0!=r){if(Math.abs(r)<t.limit)return t.setPos(),void(t.isIntransition=!1);r>0?t.goPre():t.goNext(),r=0}})},transitionEnd:function(e){this.isIntransition=!1},goPre:function(){if(this.config.beforeGoPre){var e=this.config.beforeGoPre();if(e===!1)return this.setPos(),void(this.isIntransition=!1)}var t=this;this.isIntransition=!0,this._posArrGoPre(),this.setPos("gopre"),this.config.onChange&&this.config.onChange({swiper:this,action:"gopre",itemWrapper:this.itemWrappers[this.posArr[0]]}),window.setTimeout(function(){t.transitionEnd("gopre")},280)},goNext:function(){if(this.config.beforeGoNext){var e=this.config.beforeGoNext();if(e===!1)return this.setPos(),void(this.isIntransition=!1)}var t=this;this.isIntransition=!0,this._posArrGoNext(),this.setPos("gonext"),this.config.onChange&&this.config.onChange({swiper:this,action:"gonext",itemWrapper:this.itemWrappers[this.posArr[2]]}),window.setTimeout(function(){t.transitionEnd("gonext")},280)},reset:function(){this._resetPosArr(),this.setPos("move",0)},getMidWrapper:function(){return this.itemWrappers[this.posArr[1]]},getPreWrapper:function(){return this.itemWrappers[this.posArr[0]]},getNextWrapper:function(){return this.itemWrappers[this.posArr[2]]},setPos:function(e,t){var i=this;t=t||0;for(var n=0;n<3;n++){var a=i.posArr[n],o=i.itemWrappers[a],s={};s[i.tanKeys.transition]="move"==e?"none":this.tanKeys.transform+" .35s ease","gopre"==e&&0==n&&(s[i.tanKeys.transition]="none"),"gonext"==e&&2==n&&(s[i.tanKeys.transition]="none"),s[i.tanKeys.transform]="translate3d("+(this.initPos[n]+t)+"px,0,0)",o.css(s)}}},n}),define("../../components/switch",["utils","base"],function(e,t){var i=function(t){var n=this;t.style=t.style||{};var a=e.getRealHeight(28),o=e.getRealWidth(48),s=t.style.height||a,r=t.style.width||o;this.height=isNaN(s)?a:parseInt(s),this.width=isNaN(r)?o:parseInt(r),t.style.height=this.height+"px",t.style.width=this.width+"px",t.style.borderRadius=this.height/2+"px";var l=this.height-2;this.switchPoint=$("<div class='yy-swith-pointer'></div>"),this.pointerStartStyle={top:"1px",left:"1px",right:this.width-l-1+"px",bottom:"1px"},this.pointerEndStyle={top:"1px",left:this.width-l-1+"px",right:"1px",bottom:"1px"},i.baseConstructor.call(this,t),this.value=this.config.value,this.switchPoint.appendTo(this.$el),this.$el.addClass("yy-swith"),this.setValue(this.value),this.$el.bind("click",function(){n.change()});var c=this.config.comKey+"_change";this.changeMethod=this.pageview.plugin[c]};return e.extends(i,t),i.prototype.change=function(){this.changeMethod&&this.changeMethod.call(this.pageview.plugin,this,{value:!this.value})},i.prototype.getValue=function(){return this.value},i.prototype.setValue=function(e){this.value=e,e?(this.switchPoint.css(this.pointerEndStyle),this.$el.addClass("yy-swith-selected")):(this.switchPoint.css(this.pointerStartStyle),this.$el.removeClass("yy-swith-selected"))},i}),define("../../components/tabbarview",["utils","base"],function(e,t){var i=function(t){var n=this;i.baseConstructor.call(this,t),this.tabPages={},this.$el.addClass("yy-tabbarview"),this.tabbarWrapper=$("<div class='yy-tabbar flex-h displayflex'></div>"),this.pageWrapper=$("<div class='yy-tabbbar-pages'></div>");var a=t.tabbarStyle;a&&e.css(this.tabbarWrapper,a),this.selectedItem=null,this.curPageInstance=null;var o=this.config.root.length,s=0;this.initLayout(this.datasource,function(e){e.$el.bind("click",function(){n._itemClick(e)}),s+=1,s==o&&n.tabdidmount(),n.tabbarWrapper.append(e.$el)}),this.$el.append(this.pageWrapper),this.tabbarWrapper.appendTo(this.$el)};return e.extends(i,t),i.prototype.tabdidmount=function(){var e=this.config.root[0],t=this.pageview.params.$$pn,i=t||e,n=this.components[i]||this.components[e];this._itemClick(n,!!t)},i.prototype._itemClick=function(e,t){var i=this;if(this.selectedItem===e)return void alert("点了又点");if(this.selectedItem&&this.selectedItem.unSelected(),this.selectedItem=e,this.selectedItem.selected(),this.curPageInstance&&this.curPageInstance.$el.css({left:"-100%"}),this.curPageInstance=this.tabPages[e.config.comKey],this.pageview.showLoadingProgressbar(),this.curPageInstance){this.curPageInstance.$el.css({left:"0"});var n=this.curPageInstance.plugin.onPageResume;n&&n.call(this.curPageInstance.plugin,this.curPageInstance,{isForward:!1}),this.pageview.hideLoadingProgressbar()}else this.pageview.pageManager.getPageConfigByPageKey(e.config.comKey,function(t){i.curPageInstance=i.pageview.pageManager.createPageView(t),i.tabPages[e.config.comKey]=i.curPageInstance,i.pageWrapper.append(i.curPageInstance.$el),i.pageview.hideLoadingProgressbar()});this.pageview.pageManager.tabSeleced(e.config.comKey,t)},i}),define("../../components/text",["utils","base"],function(e,t){var i=function(t){t.style=t.style||{},t.numberofline&&(n=t.numberofline||1),i.baseConstructor.call(this,t);var n,a=this.$el[0].className;a.indexOf("yy-ai")>=0?this.$el.addClass("yy-text displayflex "):this.$el.addClass("yy-text displayflex yy-ai-center"),this.preText=this.config.preText||"",this.preTextDom=$("<span class='yy-pretext'>"+this.preText+"</span>"),this.config.preTextStyle&&e.css(this.preTextDom,this.config.preTextStyle),this.nextText=this.config.nextText||"",this.nextTextDom=$("<span class='yy-nexttext'>"+this.nextText+"</span>"),this.config.nextTextStyle&&e.css(this.nextTextDom,this.config.nextTextStyle),t.text=0===t.text?"0":t.text,this.innerText=$("<span class='yy-inner-text yy-text-box'>"+(t.text||"")+"</span>"),n&&(this.innerText[0].style["-webkit-line-clamp"]=n,this.innerText[0].style["word-break"]="break-all"),t.textStyle&&this.innerText.css(t.textStyle),this.$el.append(this.preTextDom).append(this.innerText).append(this.nextTextDom)};return e.extends(i,t),i.prototype.setText=function(e){this.innerText.html(e)},i.prototype.getText=function(){return this.innerText.html()},i.prototype.setPreText=function(e){this.preTextDom.html(e)},i.prototype.setNextText=function(e){this.nextTextDom.html(e)},i.prototype.hideLoading=function(){this.loadingDom&&this.loadingDom.addClass("displaynone")},i.prototype.showLoading=function(){this.loadingDom||(this.loadingDom=$("<div class='preloader yy-text-loading displaynone'></div>"),this.loadingDom.insertBefore(this.preTextDom)),this.loadingDom.removeClass("displaynone")},i}),define("../../components/textarea",["utils","base"],function(e,t){var i=function(t){var n=this;i.baseConstructor.call(this,t);var a=t.placeholder||"";this.input=$("<textarea placeholder='"+a+"'></textarea>"),this.max=this.config.max,(this.config.value||0===this.config.value)&&this.input.val(this.config.value),isNaN(this.max)?this.max=null:this.max=parseInt(this.max),this.$el.addClass("yy-textarea");var o={fontSize:this.config.style.fontSize||this.config.style["font-size"]||"15px",color:this.config.style.color||this.config.style.color||"#262626",backgroundColor:this.config.style.backgroundColor||this.config.style["background-color"]||"white"};if(this.input.css(o),this.input.bind("input",function(e){if(n.max){var t=n.input.val(),i=t.length;i>n.max&&(t=t.substring(0,n.max),i=n.max,n.input.val(t)),n.numDom.html(i)}}),this.max){this.limitDom=$("<span class='yy-textarea-limit'></span>"),this.numDom=$("<span>0</span>"),this.config.numStyle&&e.css(this.numDom,this.config.numStyle);var s=$("<span>/</span>"),r=$("<span>"+this.max+"</span>");this.config.maxStyle&&e.css(r,this.config.maxStyle),this.config.limitStyle&&e.css(this.limitDom,this.config.limitStyle),this.limitDom.append(this.numDom).append(s).append(r),this.$el.append(this.limitDom)}this.$el.append(this.input);var l=t.comKey+"_compositionend",c=n.pageview.plugin[l];c&&this.$el.on("input",function(e){n.$el.prop("comStart")||!n.disabled&&c&&c.call(n.pageview.plugin,n,{e:e})}).on("compositionstart",function(){n.$el.prop("comStart",!0)}).on("compositionend",function(e){n.$el.prop("comStart",!1),!n.disabled&&c&&c.call(n.pageview.plugin,n,{e:e})});var p=t.comKey+"_input",d=n.pageview.plugin[p];d&&this.input.bind("input",function(e){!n.disabled&&d&&d.call(n.pageview.plugin,n,{e:e})})};return e.extends(i,t),i.prototype.getValue=function(){var e=$.trim(this.input.val().replace(/\uD83C[\uDF00-\uDFFF]|\uD83D[\uDC00-\uDE4F]|[\uD800-\uDBFF]|[\uDC00-\uDFFF]/g,""));return this.setValue(e),$.trim(e)},i.prototype.setDisabled=function(e){this.disabled=e,this.disabled?(this.input.attr("disabled","disabled"),this.$el.addClass(this.disabledClassName)):(this.input.removeAttr("disabled"),this.$el.remove(this.disabledClassName))},i.prototype.setValue=function(e){if(this.max){var t=e.length;t>this.max&&(e=e.substring(this.max),t=this.max),this.numDom.html(t)}this.input.val(e)},i.prototype.blur=function(){this.input.blur()},i.prototype.focus=function(e){var t=this;t.input&&t.input.focus()},i}),define("../../components/timepicker",["utils"],function(e){var t=function(e){var t=e.root.itemHeight;this.$el=$("<div style='height:"+t+"px' class='yy-tp-cell'>1</div>")},i=function(t){this.config=t,this.itemHeight=t.root.itemHeight,this.$el=$("<div class='yy-tp-column yy-flex-1'></div>"),this.innerWrapper=$("<div data-math='"+10*Math.random()+"' class='yy-tp-column-inner'></div>"),this.innerWrapper.appendTo(this.$el),this.tanKeys=e.getTransitionKeys(),this.initLayout(),this.diff=0,this.startPosY=0,this.posY=0,this.selectedIndex=0};i.prototype={initLayout:function(){for(var e=0;e<20;e++){var i=new t(this.config);this.innerWrapper.append(i.$el)}},touchStart:function(e){this.startPosY=e.touches[0].pageY,this.diff=0},touchMove:function(e){e.preventDefault(),e.stopPropagation();var t=e.touches[0];this.diff=t.pageY-this.startPosY,this.curY=this.posY+this.diff;var i={};i[this.tanKeys.transition]="none",i[this.tanKeys.transform]="translate3d(0,"+this.curY+"px,0)",this.innerWrapper.css(i)},touchEnd:function(){this.posY=this.curY,this.diff>0?console.log("向下"):console.log("向上")}};var n=function(t){var n=t.wrapper||$(document.body);this.$el=$("<div class='yy-tp-wrapper'></div>"),this.itemHeight=parseInt(e.getRealHeight(36));var a=4*this.itemHeight;this.body=$("<div style='height:"+a+"px' class='yy-tp-body displayflex yy-fd-row'></div>"),this.columns=[];for(var o=0;o<3;o++){var s=new i({root:this});this.columns.push(s),this.body.append(s.$el)}var r=$("<div style='height:"+this.itemHeight+"px;top:"+this.itemHeight+"px' class='yy-tp-indicator'></div>");this.body.append(r),this.$el.append(this.body),n.append(this.$el),this.initEvent()};return n.prototype={initEvent:function(){var t=this;this.body.bind("touchstart",function(i){t.curTouchColumnIndex=Math.floor(i.touches[0].pageX*t.columns.length/e.viewport.width),t.columns[t.curTouchColumnIndex].touchStart(i)}),this.body.bind("touchmove",function(e){t.columns[t.curTouchColumnIndex].touchMove(e)}),this.body.bind("touchend",function(){t.columns[t.curTouchColumnIndex].touchEnd()})}},n}),define("../../components/tip",["utils"],function(e){var t=function(e){var t=this;e=e||$(document.body),this.tipWrapper=$("<div class='yy-tip displayflex jc-center ai-center displaynone'></div>"),this.textDom=$('<div class="yy-tip-text displaynone"></div>'),this.backCover=$('<div class="yy-tip-backcover displaynone"></div>'),this.backCover.bind("click",function(){t.clickBackCover()}),this.tipWrapper.append(this.textDom),e.append(this.tipWrapper).append(this.backCover),this.hideTimeoutId=null};return t.prototype={show:function(t){var i=this;this.textPos=t.textPos||"bottom","left"==this.textPos||"right"==this.textPos?this.tipWrapper.addClass("flex-h"):this.tipWrapper.addClass("flex-v");var n=t.pos||"center";this.config=t,this.hideTimeoutId&&window.clearTimeout(this.hideTimeoutId),
t=t||{};var a=t.style;a&&this.tipWrapper.css(e.processStyle(a)),this._setText(t.text,t.textStyle),this._setIcon(t.font,t.iconStyle),this.config.withoutBackCover||this.backCover.removeClass("displaynone"),this.startClass="yy-tip-ani-"+n+"-start",this.tipWrapper.removeClass("displaynone").addClass(this.startClass),window.setTimeout(function(){i.endClass="yy-tip-ani-"+n+"-end",i.tipWrapper.addClass(i.endClass)},3),t.duration&&!isNaN(t.duration)&&(this.hideTimeoutId=window.setTimeout(function(){i.hide()},parseInt(t.duration)))},_setText:function(t,i){t?(this.textDom.removeClass("displaynone"),i&&this.textDom.css(e.processStyle(i)),this.textDom.html(t)):this.textDom.addClass("displaynone")},_setIcon:function(t,i){this.iconDom&&this.iconDom.remove();var n,a;t=t||"";var o=t.split("_");2==o.length?(n=o[0],a=o[1],this.iconDom=$('<i class="yy-tip-icon displayflex jc-center ai-center yy-icon-code displaynone" data-icon="&#x'+a+';"></i>'),i&&this.iconDom.css(e.processStyle(i)),this.iconDom.removeClass("displaynone"),this.iconDom.css({"font-family":n}),"top"==this.textPos||"left"==this.textPos?this.iconDom.appendTo(this.tipWrapper):this.iconDom.insertBefore(this.textDom)):this.icomDom&&this.iconDom.addClass("displaynone")},clickBackCover:function(){this.config.clickNoHide||(this.hideTimeoutId&&window.clearTimeout(this.hideTimeoutId),this.hide())},hide:function(){var e=this;this.tipWrapper.removeClass(this.endClass),window.setTimeout(function(){e.tipWrapper.addClass("displaynone").removeClass(e.startClass),e.tipWrapper.remove(),e.backCover.remove()},300),e.backCover.addClass("displaynone")}},t}),define("../../components/view",["utils","base"],function(e,t){function i(){var e=window.navigator.userAgent,t=e.match(/(iPad|iPhone|iPod)\s+OS\s([\d_\.]+)/);return t&&t[2]&&parseInt(t[2].replace(/_/g,"."),10)>=6}function n(t){var i=this;this.isIOS=e.deviceInfo().isIOS,this.hasFixed=!1,this.isSticky=!1;var a="displayflex yy-view";t.style&&(!t.style.alignItems&&!t.style["align-items"],t.style.justifyContent||t.style["justify-content"]||(a+=" yy-jc-flex-start"),t.style.flexDirection||t.style["flex-direction"]||(a+=" yy-fd-column")),this.LoadMoreWrapper=$("<div style='height:"+e.getRealHeight(36)+"px' class='yy-loadmore-wrapper displayflex yy-jc-center yy-ai-center flex-h displaynone'></div>"),n.baseConstructor.call(this,t),this.stickyHeaderIndices=this.config.stickyHeaderIndices,i.isInLoading=!1,i.canRefresh=!1;var o=this.config.comKey+"_pulltorefresh",s=this.config.comKey+"_canpulltorefresh";this.pluginCanPullToRefreshMethod=this.pageview.plugin[s];var r=this.config.comKey+"_loadmore";this.pluginPullToRefreshMethod=this.pageview.plugin[o],this.pluginLoadMoreMethod=this.pageview.plugin[r];var l=this.config.comKey+"_reload";this.pluginLoadMoreErrorToReloadMethod=this.pageview.plugin[l],this.pluginPullToRefreshMethod&&(this.innerWrapper=$("<div class='yy-view-innerwrapper yy-fd-column"+a+"'></div>"),this.$el.css({zIndex:1}),this.$$childrenWrapper=this.innerWrapper,this._initLoadFirstErrorDom(),this._initPullToRefreshDom(),this.$el.append(this.innerWrapper)),this._initTouchEvent(),this.LoadMoreOffsetBottom=e.getRealHeight(120),this.$el.addClass(a),t.root=t.root||[],this.initLayout(t.$$datasource,null,this.rowInstance,function(){i.childInitOver()})}return e.extends(n,t),n.prototype.scrollTop=function(e){return e?void this.$el.scrollTop(e):this.$el.scrollTop()},n.prototype.hideLoadMore=function(){this.LoadMoreWrapper&&this.LoadMoreWrapper.addClass("displaynone")},n.prototype.showLoadMore=function(){this.LoadMoreWrapper&&this.LoadMoreWrapper.removeClass("displaynone")},n.prototype._initPullToRefreshDom=function(){var t=e.getRealHeight(40),i=e.getRealWidth(11),n=e.getRealWidth(15);this.pullLimitHeight=e.getRealHeight(40),this.pullToRefreshWrapper=$("<div style='height:"+t+"px;margin-top:-"+t+"px' class='yy-pull-wrapper'></div>"),this.pullMessWrapper=$("<div style='height:"+this.pullLimitHeight+"px' class='displayflex yy-jc-center yy-ai-center flex-h yy-pull-mes-wrapper'></div>"),this.pullArrowIcon=$("<i style='font-size:"+n+"px' class='yy-pull-arrow'></i>"),this.pullMesLabel=$("<span style='font-size:"+i+"px' class='yy-pull-meslabel'>下拉刷新</span>");var a=$("<div class='preloader yy-pull-loadingicon'></div>");this.pullMessWrapper.append(a).append(this.pullArrowIcon).append(this.pullMesLabel).appendTo(this.pullToRefreshWrapper),this.innerWrapper.append(this.pullToRefreshWrapper)},n.prototype._initLoadMoreDom=function(){var t=(e.getRealHeight(36),e.getRealWidth(11)),i=$("<div class='preloader yy-loadmore-loadingicon'></div>");this.loadMoreLabel=$("<span style='font-size:"+t+"px' class='yy-pull-meslabel'>正在加载</span>"),this.LoadMoreWrapper.append(i).append(this.loadMoreLabel),this.$el.append(this.LoadMoreWrapper)},n.prototype._initLoadMoreErrorDom=function(){var t=this,i=e.getRealHeight(42),n=e.getRealWidth(11),a=e.getRealWidth(15);this.LoadMoreErrorWrapper=$("<div style='height:"+i+"px' class='yy-loadmore-wrapper displayflex yy-jc-center yy-ai-center flex-h displaynone'></div>");var o=$("<i style='font-size:"+a+"px' class='yy-icommon yy-loadmore-erroricon'></i>");this.loadErrorLabel=$("<span style='font-size:"+n+"px' class='yy-pull-meslabel'>网络异常,点击</span>");var s=$("<span style='font-size:"+n+"px' class='yy-loadmore-reload-babel'>重新加载</span>");s.bind("click",function(){t.pluginLoadMoreErrorToReloadMethod&&t.pluginLoadMoreErrorToReloadMethod.call(t.pageview.plugin,t,{})}),this.LoadMoreErrorWrapper.append(o).append(this.loadErrorLabel).append(s),this.$el.append(this.LoadMoreErrorWrapper)},n.prototype._initLoadFirstErrorDom=function(){var t=e.getRealHeight(36),i=e.getRealWidth(11),n=e.getRealWidth(15);this.LoadFirstErrorWrapper=$("<div data-mark='loadfirsterror' style='height:"+t+"px' class='yy-loadfirsterror-wrapper displayflex yy-jc-center yy-ai-center flex-h displaynone'></div>");var a=$("<i style='font-size:"+n+"px' class='yy-icommon yy-loadmore-erroricon'></i>");this.loadFirstErrorLabel=$("<span style='font-size:"+i+"px' class='yy-pull-meslabel'>网络异常,尝试再次下拉刷新</span>"),this.LoadFirstErrorWrapper.append(a).append(this.loadFirstErrorLabel),this.$el.append(this.LoadFirstErrorWrapper)},n.prototype._initTouchEvent=function(){var t=this;if(this.pluginPullToRefreshMethod){var i,n=0;this.$el.bind("touchstart",function(e){if(t.config.onlyForSticky!==!0&&!t.isInLoading){t.isInLoading=!1,t.canRefresh=!1;var a=e.touches[0];n=a.pageY,i=t.$el.scrollTop()}}),this.$el.bind("touchmove",function(a){if(t.config.onlyForSticky!==!0&&!t.isInLoading){var o=a.touches[0],s=o.pageY,r=s-n;if(r>0){if(t.pluginCanPullToRefreshMethod){var l=t.pluginCanPullToRefreshMethod.call(t.pageview.plugin,t);if(l!==!0)return}var c=t.$el.scrollTop();if(c<=0){t.$el.css({overflow:"hidden"}),a.preventDefault(),a.stopPropagation();var p=r-i;p>4*t.pullLimitHeight?(t.pullMesLabel.html("释放更新"),t.pullToRefreshWrapper[0].className="yy-pull-wrapper yy-release-refresh",t.canRefresh=!0):(t.pullMesLabel.html("下拉刷新"),t.pullToRefreshWrapper[0].className="yy-pull-wrapper yy-push-refresh",t.canRefresh=!1),t.innerWrapper.css(e.processTransitionTanformStyle("none","translate3d(0,"+p/3+"px,0)"))}}}}),this.$el.bind("touchend",function(e){return t.config.onlyForSticky===!0?void t.resetPullLoadState():(t.config.noScroll===!0||t.$el.css({"overflow-y":"auto"}),void(t.isInLoading||(t.canRefresh?(t.setPullLoadingState(),t.pluginPullToRefreshMethod&&t.pluginPullToRefreshMethod.call(t.pageview.plugin,t,{})):t.resetPullLoadState())))})}},n.prototype.refreshStickyHeaderIndices=function(){var e=this;this.stickyHeaderIndicesComponent&&window.setTimeout(function(){e.navOffsetY=e.stickyHeaderIndicesComponent.$el[0].offsetTop},150)},n.prototype.childInitOver=function(){var e,t=this;this.stickyHeaderIndices&&(e=this.components[this.stickyHeaderIndices],this.stickyHeaderIndicesComponent=e,this.stickyHeaderIndicesIndex=e.$el.index()),this.pluginLoadMoreMethod&&(this._initLoadMoreDom(),this._initLoadMoreErrorDom(),this.scrollTimeId=null),null==e||this.pluginLoadMoreMethod?this.pluginLoadMoreMethod&&e?(this.stickyComHeight=e.$el.height(),this.isSupportSticky=i(),this.isSupportSticky?e.$el.addClass("sticky"):t.toFixedComponent(e),this.$el.bind("scroll",function(i){t.triggerLoadMore(),t.isSupportSticky||t.toFixedComponent(e)})):this.pluginLoadMoreMethod&&this.$el.bind("scroll",function(e){t.triggerLoadMore()}):(this.stickyComHeight=e.$el.height(),this.isSupportSticky=i(),this.isSupportSticky?e.$el.addClass("sticky"):t.toFixedComponent(e),this.$el.bind("scroll",function(i){this.isSupportSticky||t.toFixedComponent(e)}))},n.prototype.toFixedComponent=function(e){this.clientRect||(this.clientRect=this.$el[0].getBoundingClientRect()),this.hasFixed||(this.navOffsetY=e.$el[0].offsetTop),this.$el.scrollTop()>this.navOffsetY+20?(this.hasFixed=!0,e.$el.addClass("fixed")):e.$el.removeClass("fixed")},n.prototype.triggerLoadMore=function(e){var t=this;t.scrollTimeId&&window.clearTimeout(t.scrollTimeId),t.scrollTimeId=window.setTimeout(function(){t._onScroll(e)},80)},n.prototype.setPullLoadingState=function(){var t=this;t.pullMesLabel&&(t.isInLoading=!0,t.LoadMoreErrorWrapper&&t.LoadMoreErrorWrapper.addClass("displaynone"),t.LoadFirstErrorWrapper.addClass("displaynone"),this.loadErrorWrapWhenNoPullRefrsh&&this.loadErrorWrapWhenNoPullRefrsh.addClass("displaynone"),t.pullMesLabel.html("正在加载"),t.pullToRefreshWrapper[0].className="yy-pull-wrapper yy-push-refreshing",t.innerWrapper.css(e.processTransitionTanformStyle("transform .2s ease","translate3d(0,"+t.pullLimitHeight+"px,0)")))},n.prototype.resetPullLoadState=function(){var t=this;t.pullMesLabel&&(t.isInLoading=!1,t.canRefresh=!1,t.pullMesLabel.html("下拉刷新"),t.pullToRefreshWrapper[0].className="yy-pull-wrapper yy-push-refresh",t.innerWrapper.css(e.processTransitionTanformStyle("transform .3s ease","translate3d(0,0,0)")))},n.prototype.setLoadFirstError=function(){var t=this;if(this.LoadFirstErrorWrapper)this.LoadFirstErrorWrapper.removeClass("displaynone");else{if(!this.loadErrorWrapWhenNoPullRefrsh){var i=e.getRealHeight(42),n=e.getRealWidth(11),a=e.getRealWidth(15);this.loadErrorWrapWhenNoPullRefrsh=$("<div style='height:"+i+"px' class='yy-loadmore-wrapper displayflex yy-jc-center yy-ai-center flex-h displaynone'></div>");var o=$("<i style='font-size:"+a+"px' class='yy-icommon yy-loadmore-erroricon'></i>");this.loadErrorLabelWhenNoPullRefrsh=$("<span style='font-size:"+n+"px' class='yy-pull-meslabel'>网络异常,点击</span>");var s=$("<span style='font-size:"+n+"px' class='yy-loadmore-reload-babel'>重新加载</span>");s.bind("click",function(){t.pluginLoadMoreErrorToReloadMethod&&t.pluginLoadMoreErrorToReloadMethod.call(t.pageview.plugin,t,{})}),this.loadErrorWrapWhenNoPullRefrsh.append(o).append(this.loadErrorLabelWhenNoPullRefrsh).append(s),this.$el.append(this.loadErrorWrapWhenNoPullRefrsh)}this.loadErrorWrapWhenNoPullRefrsh.removeClass("displaynone")}this.resetPullLoadState()},n.prototype.setCanLoadMore=function(e){this.loadMoreLabel&&(e&&e.isReload?this.canLoadMore=!1:this.canLoadMore=!0,this.loadMoreLabel.html("正在加载"),this.LoadMoreErrorWrapper.addClass("displaynone"),this.LoadFirstErrorWrapper&&this.LoadFirstErrorWrapper.addClass("displaynone"),this.loadErrorWrapWhenNoPullRefrsh&&this.loadErrorWrapWhenNoPullRefrsh.addClass("displaynone"),this.LoadMoreWrapper.removeClass("displaynone yy-loaddone"))},n.prototype.setHasLoadDone=function(){this.loadMoreLabel&&(this.canLoadMore=!1,this.loadMoreLabel.html("已显示所有数据"),this.LoadFirstErrorWrapper&&this.LoadFirstErrorWrapper.addClass("displaynone"),this.loadErrorWrapWhenNoPullRefrsh&&this.loadErrorWrapWhenNoPullRefrsh.addClass("displaynone"),this.LoadMoreErrorWrapper.addClass("displaynone"),this.LoadMoreWrapper.addClass("yy-loaddone").removeClass("displaynone"))},n.prototype.setHasLoadDone1=function(){var e=this;e.pullToRefreshWrapper[0].className="yy-pull-wrapper"},n.prototype.setInitLoadMessage=function(){this.loadMoreLabel&&(this.LoadFirstErrorWrapper&&this.LoadFirstErrorWrapper.addClass("displaynone"),this.loadErrorWrapWhenNoPullRefrsh&&this.loadErrorWrapWhenNoPullRefrsh.addClass("displaynone"),this.LoadMoreErrorWrapper.addClass("displaynone"),this.LoadMoreWrapper.addClass("yy-loaddone displaynone"))},n.prototype.setLoadMoreErrorState=function(){this.canLoadMore=!1,this.resetPullLoadState(),this.LoadMoreWrapper.addClass("displaynone"),this.LoadMoreErrorWrapper.removeClass("displaynone"),this.scrollToBottom()},n.prototype.scrollToBottom=function(){this.$el.scrollTop(this.$el[0].scrollHeight)},n.prototype._onScroll=function(e){this.canLoadMore&&this.$el[0].offsetHeight+this.$el.scrollTop()+this.LoadMoreOffsetBottom>=this.$el[0].scrollHeight&&(this.canLoadMore=!1,this.pluginLoadMoreMethod.call(this.pageview.plugin,this,{}))},n}),define("../../components/viewpager",["utils","base"],function(e,t){function i(e){var t=this;i.baseConstructor.call(this,e),this.autoHeight=e.autoHeight,this.$el.addClass("yy-viewpager"),this.autoHeight&&this.$el.addClass("yy-autoheight-viewpager"),this.height=0,this.items={},this.paramsDict={};var n=e.defaultKey;n||console.error("viewpager控件为提供defalutKey属性"),this.curPageViewItem=null,this._getViewPagerItem(n,this.config.params||{},function(e){t.curPageViewItem=e},function(){})}var n=function(e){n.baseConstructor.call(this,e),this.$el.addClass("displayflex yy-viewpager-item"),this.contentInstance=e.contentInstance,this.$el.append(e.contentInstance.$el)};return e.extends(n,t),n.prototype.hide=function(){e.css(this.$el,{display:"none"})},n.prototype.show=function(){e.css(this.$el,{display:"block"})},e.extends(i,t),i.prototype._createViewPagerItem=function(e,t,i,a){var o=new n({type:"viewpageritem",contentType:t,contentInstance:i,$$pageview:this.pageview,$$datasource:this.datasource,$$parent:this});this.items[e]=o,this.$el.append(o.$el),a(o)},i.prototype.showItem=function(e,t){var i=this;this.paramsDict[e]=t,this._getViewPagerItem(e,t,function(e){i.curPageViewItem&&(i.curPageViewItem.contentInstance.plugin.onHideItem&&i.curPageViewItem.contentInstance.plugin.onHideItem(i,t),i.curPageViewItem.hide()),i.curPageViewItem=e,i.curPageViewItem.contentInstance.plugin.onShowItem&&i.curPageViewItem.contentInstance.plugin.onShowItem(i,t),i.curPageViewItem.show()},function(){})},i.prototype._getViewPagerItem=function(e,t,i,n){var a=this,o=this.items[e];if(o){if(o.contentInstance.plugin){o.contentInstance.viewpagerParams=t;var s=o.contentInstance.plugin.onPageResume;s&&s.call(o.contentInstance.plugin,o.contentInstance,{})}return void i(o)}var r=e.split("_")[0];this.pageview.config.components[r];this.pageview.pageManager.getPageConfigByPageKey(r,function(n){n.viewpagerParams=t,n.viewpager=a,n.fullPageKey=e;var o=a.pageview.pageManager.createPageView(n);a._createViewPagerItem(e,"pageview",o,i)},function(){n&&n()})},i}),define("components/ApplyBase",["utils"],function(e){function t(e){var t=this;this.components=e.components,this.itemData=e.itemData,this.plugin=e.plugin,this.id=(this.itemData.fieldId||this.itemData.subFormId).toString(),this.root=e.root,this.DetailInstance=e.DetailInstance,this.isInDetail=!0,this.DetailInstance||(this.isInDetail=!1),this.isSummaryField="1"===this.itemData.isSummaryField,this.pageRoot=this.plugin.pageview.config.root,this.isRequired=this.itemData.required,this.repeatKey=e.repeatKey,this.checkListSelectedData=[],this.verify=e.verify,this.verifyMsg=e.verifyMsg,this.authInfo=e.authInfo,this.plugin.keyFeatureIndex=0,t.plugin.calculateComponent="",e.plugin[this.id+"_init"]=function(e,i){t.isInDetail?(t.rowInstance=e.rowInstance,t.bindInitValueInRepeat(e)):(t.bindInitValue(e),t.bindInitAuth(e))}}return t.prototype={setAttribute:function(e,t){this[e]=t},parseInt:function(e){var t=e.toString(),i=t.length;if(i>=3){var n=t.substring(i-2,i);".0"===n&&(e=parseInt(t))}return e},scrollIntoView:function(t){var i=this;if(t===!0||e.deviceInfo().isAndroid)try{window.setTimeout(function(){i.isInDetail?i.rowInstance&&i.rowInstance.refs[i.id].$el[0].scrollIntoView():i.plugin.pageview.refs[i.id].$el[0].scrollIntoView()},40)}catch(e){}},bindInitValueInRepeat:function(e){e.config.value=e.datasource[this.id]},bindInitValue:function(e){e.config.value=this.itemData.values},bindInitAuth:function(e){this.authInfo&&this.authInfo.readonly&&setTimeout(function(){e.setDisabled(!0),e.$el.css({opacity:"1"})},10)},isEnabledConditionField:function(){if(!this.plugin.rule)return!1;var e=this.plugin.rule.activation||1;if(2!==e)return!1;var t=this.plugin.rule.type_2;if(!t)return!1;if(!(t instanceof Array))return!1;if(0===t.length)return!1;var n=!1;for(i=0,j=t.length;i<j;i++){var a=t[i],o=a.id.toString(),s=o.split(",");if(2===s.length&&(o=s[1]),o===this.id&&"1"===a.enabled.toString()){n=!0;break}}return n},convertText:function(e){return e.indexOf("请选择")>=0&&(e=null),e},getValue:function(){return this.plugin.pageview.refs[this.id].getValue()},getValueWhenItemInRepeat:function(e){return e.refs[this.id].getValue()},getConfigWhenItemInRepeat:function(e){return this.getConfig(e)},setValue:function(e){return this.plugin.pageview.refs[this.id].setValue(e)},setValueWhenItemInRepeat:function(e,t){return e.refs[this.id].setValue(t)},getConfigWhenItemInRepeatForSummary:function(t){var i=e.copy(this.itemData),n=this.getValueWhenItemInRepeat(t)||"";return i.value=n,i},getConfig:function(t){var i,n={},a=e.copy(this.itemData),o=this.itemData.componentKey;return i=t?this.getValueWhenItemInRepeat(t)||"":this.getValue()||"",this.isRequired&&0===i.length?(this.showRequiedTip(),!1):this.verify?(this.showVerifyTip(this.verifyMsg),!1):("Text"!==o&&"Paragraph"!==o||(i=this.limitTextLength(i)),!t&&this.itemData.crux&&(n.key=this.itemData.title||"未命名",n.value=i,n.code=this.itemData.columncode,n.index=this.plugin.keyFeatureIndex,this.plugin.keyFeatureIndex++),a.value=i,a.keyFeature=n,a)},showRequiedTip:function(e){this.scrollIntoView(!0),e=this.itemData.tips?this.itemData.tips:(e||this.itemData.title)+"为必填项！",this.plugin.pageview.showTip({text:e,duration:1100})},showVerifyTip:function(e){this.scrollIntoView(!0),this.plugin.pageview.showTip({text:e||this.itemData.title,duration:1100})},showTip:function(e){return e?void this.plugin.pageview.showTip({text:e,duration:1100}):"请输入有效text"},createCheckOrRadioList:function(t){var i=this;this.components[this.checkListID]={ref:!0,type:t,primaryKey:"id",labelKey:"name"},this.authInfo.readonly||(this.plugin[this.wrapKey+"_click"]=function(t,n){if(i.curFormRowInstance=t.rowInstance,this.pageview.refs[i.checkListID].show(),i.curFormRowInstance){var a=[],o=t.rowInstance.datasource[i.id],s=i.itemData.options||[];if(o instanceof Array)a=e.copy(o);else if(o)o.split(",").forEach(function(e){for(var t=0,i=s.length;t<i;t++)e===s[t].selectionId&&a.push(s[t])});else for(var r=0,l=s.length;r<l;r++)s[r].defOption&&a.push(s[r]);this.pageview.refs[i.checkListID].setSelectedValue(a)}});for(var n=this.itemData.options||[],a=0,o=n.length;a<o;a++)n[a].id=a,n[a].name=n[a].name;this.plugin[this.checkListID+"_loaddata"]=function(e,t){t.success(n)};var s=this.components[this.checkListID];e.getComponentClass(s,function(){var e=i.plugin.pageview._prepareComponent(i.checkListID,null,null);i.plugin.pageview.$el.append(e.$el)})},limitTextLength:function(e){var t=4e3,i=0,n="请控制在2000个字符以内";"Text"!==this.itemData.componentKey||this.itemData.isTextArea||(t=400,n="请控制在200个字符以内");var a=e.replace(/[^\x00-\xff]/g,"**").length;if(a>=t){for(var o=0;o<a;o++)e.charCodeAt(o)>255&&i++;return i>200&&400==t&&(i=200),i>2e3&&4e3==t&&(i=2e3),this.plugin.pageview.showTip({text:n,duration:1100}),e.substr(0,t-i)}return e},updateFormulaFieldState:function(e){var t=this;this.itemData.formula&&t.plugin.pageview.delegate(t.itemData.fieldId,function(e){e.setDisabled(!0),e.$el.css({opacity:1})})},updateFormulaFieldValue:function(){var e=[],t=this,i=this.itemData.moneyFields||this.itemData.numberFields,n="";if(i){n=JSON.parse(i),n.forEach(function(t){"field"===t.type&&e.push(t.value)});var a=!1;this.plugin.calculateComponent+=this.itemData.fieldId+";",n.forEach(function(e){"field"===e.type&&(a=t.plugin.calculateComponent.indexOf(e.value)>-1)}),n.forEach(function(i){if("field"===i.type&&a){var o=n[1],s=t.plugin.pageview.refs[n[1].value].$el.find("input");s.change(function(i){var n="",a="";n&&clearTimeout(n),n=setTimeout(function(){a=setInterval(function(){if(!window.calculateLock){clearInterval(a),window.calculateLock=!0;var i={};i.formula={},i.formula[o.value]=t.itemData.formula,i[o.value]=this.value||0,e.forEach(function(e){var n="";t.plugin.layoutData.forEach(function(t){t.fieldId===e&&(n=t.decimalPlace)}),i[e]={},i[e].decimalDigit=n,i[e].value=t.plugin.pageview.refs[e].getValue()||0}),i=JSON.stringify(i),t.plugin.pageview.ajax({url:"formula/calculation",type:"POST",contentType:"application/json; charset=UTF-8",data:i,success:function(e){if(window.calculateLock=!1,t.plugin.pageview.hideLoading(!0),e.success){var i=e.data[o.value];t.setValue(i)}else t.plugin.pageview.showTip({text:e.msg,duration:1e3})},error:function(e){window.calculateLock=!1,console.error("network error")}})}},50)},500)})}}),n.forEach(function(i,n){if("field"===i.type){var a=t.plugin.pageview.refs[i.value].$el.find("input");a.keyup(function(t,i){var n="",a="";return function(){n&&clearTimeout(n),n=setTimeout(function(){a=setInterval(function(){if(!window.calculateLock){clearInterval(a),window.calculateLock=!0;var n={};n.formula={},n.formula[t.value]=i.itemData.formula,n[t.value]=this.value||0,e.forEach(function(e){var t="";i.plugin.layoutData.forEach(function(i){i.fieldId===e&&(t=i.decimalPlace)}),n[e]={},n[e].decimalDigit=t,n[e].value=i.plugin.pageview.refs[e].getValue()||0}),n=JSON.stringify(n),i.plugin.pageview.ajax({url:"formula/calculation",type:"POST",contentType:"application/json; charset=UTF-8",data:n,success:function(e){if(window.calculateLock=!1,i.plugin.pageview.hideLoading(!0),e.success){var n=e.data[t.value];i.setValue(n),i.plugin.pageview.refs[i.id].$el.find("input").trigger("change")}else i.plugin.pageview.showTip({text:e.msg,duration:1e3})},error:function(e){window.calculateLock=!1,console.error("network error")}})}},50)},500)}}(i,t))}})}}},t}),define("parts/commonLayout",["utils"],function(e){"use strict";var t="#29B6F6",i={mainColor:t,switchLayout:function(t,i){var n=i||{},a="",o=n.mode||"",s=n.type||"input",r=n.title,l=n.singleLineStyle||{},c=n.multiLineFirStyle||{},p=n.multiLineSecFirStyle||{},d=n.multiLineSecSecStyle||{},h=!!t.itemData.inLeft;(t.itemData.inDataTable||t.isInDetail)&&(h=!0),h?(t.titleKey=t.id+"_title",t.wrapKey=t.id+"_warp",t.root.push(t.wrapKey),t.components[t.wrapKey]={type:"view",className:"form-row bottom-half-line",style:e.processStyle($.extend({backgroundColor:"#fff",height:50,fontSize:14,paddingLeft:13,flexDirection:"row"},c)),root:[t.titleKey,t.id]},a=t.itemData.tips||"请输入"+t.itemData.title,a=t.isRequired?a+" (必填)":a,t.components[t.titleKey]={type:"text",text:t.itemData.title||r,numberofline:2,style:e.processStyle($.extend({width:94},p))},t.components[t.id]={type:s,ref:!0,mode:o,placeholder:a,className:"form-row",style:e.processStyle($.extend({flex:1,paddingRight:16,height:"100%",fontSize:14,textAlign:"left"},d))}):(t.titleKey=t.id+"_title",t.root.push(t.titleKey),t.root.push(t.id),t.components[t.titleKey]=this.getCtlTitle(t.itemData.title||r),a=t.itemData.tips||"请输入"+t.itemData.title||r,a=t.isRequired?a+" (必填)":a,t.components[t.id]={type:s,ref:!0,mode:o,className:"form-row bottom-half-line",placeholder:a,style:e.processStyle($.extend({backgroundColor:"#fff",height:50,fontSize:14,paddingLeft:13},l))})},layoutForScore:function(t){var i=!!t.itemData.inLeft;t.itemData.inDataTable&&(i=!0),i?(t.titleKey=t.id+"_title",t.wrapKey=t.id+"_warp",t.scoreKey=t.id+"_score",t.root.push(t.wrapKey),t.components[t.wrapKey]={type:"view",className:"bottom-half-line",style:e.processStyle({backgroundColor:"#fff",height:50,fontSize:14,paddingLeft:13,flexDirection:"row"}),root:[t.titleKey,t.id]},t.components[t.titleKey]={type:"text",text:t.itemData.title||"评分",numberofline:2,style:e.processStyle({width:94})},t.components[t.id]={type:"repeat",root:[t.scoreKey],items:[],style:e.processStyle({flex:1,backgroundColor:"#fff",paddingRight:"15px",justifyContent:"flex-end"})},t.components[t.scoreKey]={type:"icon",font:"cap_e908",className:"star_icon all",style:e.processStyle({flexDirection:"row",flexWrap:"wrap",backgroundColor:"#fff",paddingLeft:"10px"}),iconStyle:{color:t.starColor}}):(t.titleKey=t.id+"_title",t.root.push(t.titleKey),t.root.push(t.id),t.scoreKey=t.id+"_score",t.components[t.titleKey]=this.getCtlTitle(t.itemData.title),t.components[t.id]={type:"repeat",root:[t.scoreKey],items:[],itemClassName:"bottom-half-line",style:e.processStyle({backgroundColor:"#fff",paddingLeft:"5px",height:"50px"})},t.components[t.scoreKey]={type:"icon",font:"cap_e908",className:"star_icon all",style:e.processStyle({flexDirection:"row",flexWrap:"wrap",backgroundColor:"#fff",paddingLeft:"10px"}),iconStyle:{color:t.starColor}})},createMoneyItemLayout:function(t,i){var n="",a=!!t.itemData.inLeft;(t.itemData.inDataTable||t.isInDetail)&&(a=!0),a?(t.titleKey=t.id+"_title",t.wrapKey=t.id+"_warp",t.root.push(t.wrapKey),t.components[t.wrapKey]={type:"view",className:"form-row bottom-half-line",style:e.processStyle({backgroundColor:"#fff",height:50,fontSize:14,paddingLeft:13,flexDirection:"row"}),root:[t.titleKey,t.id]},n=t.itemData.tips||"请输入"+t.itemData.title,n=t.isRequired?n+" (必填)":n,t.components[t.id]={type:"input",ref:!0,placeholder:n,mode:"number",style:e.processStyle({flex:1,paddingRight:16,height:"100%",fontSize:14,textAlign:"left"})},t.components[t.titleKey]={type:"text",text:t.itemData.title||i.title,numberofline:2,style:e.processStyle({width:94})}):(t.titleKey=t.id+"_title",t.root.push(t.titleKey),t.root.push(t.id),t.components[t.titleKey]=this.getCtlTitle(t.itemData.title||i.title),n=t.itemData.tips||"请输入"+t.itemData.title,n=t.isRequired?n+" (必填)":n,t.components[t.id]={type:"input",placeholder:n,mode:"number",ref:!0,className:"bottom-half-line",style:e.processStyle({backgroundColor:"#fff",paddingRight:12,paddingLeft:12,height:50,fontSize:14,textAlign:"left"})})},createItemLayout:function(t,i){t.titleKey=t.id+"_title",t.wrapKey=t.id+"_warp",t.root.push(t.wrapKey);var n=t.itemData.tips?t.itemData.tips:"请选择";t.components[t.wrapKey]={type:"view",className:"form-row bottom-half-line",style:e.processStyle({backgroundColor:"#fff",minHeight:50,paddingTop:4,paddingBottom:4,fontSize:14,paddingLeft:13,flexDirection:"row"}),root:[t.titleKey,t.id]},t.components[t.id]={type:"icon",textPos:"left",ref:!0,text:t.isRequired?n+" (必填)":n,font:"icomoon_e913",numberofline:5,textStyle:e.processStyle({color:"#b7b7b7",fontSize:14,marginRight:6,maxWidth:"100%"}),iconStyle:e.processStyle({color:"#ccc",fontSize:14}),style:e.processStyle({flex:1,justifyContent:"flex-end",paddingRight:16,paddingLeft:20})},t.components[t.titleKey]={type:"text",text:t.itemData.title||i.title,numberofline:2,style:{width:100}}},getDetailCtlTitle:function(t,i,n,a){var o=t.id+"_title",s=t.id+"_delbtn",r={type:"view",className:"bottom-half-line",style:{flexDirection:"row",background:"#fff",borderRadius:"5px 5px 0 0"},root:[o,s]};return i[o]={type:"text",ref:!0,text:t.title,style:e.processStyle({height:34,flex:"1",textIndent:13,fontSize:14,backgroundColor:"#FCFCFC",color:"#262626"})},i[s]={type:"text",text:"删除",titleKey:o,titleLabel:t.title,style:e.processStyle({flex:"1",justifyContent:"flex-end",paddingRight:20,textIndent:15,fontSize:14,backgroundColor:"#FCFCFC",color:"#37B7FD"})},n[s+"_init"]=function(e,t){this.detailItemDeleteInit(e,t)},n[s+"_click"]=function(e,t){t=t||{},t.DetailInstance=a,this.detailItemDeleteClick(e,t)},n[o+"_init"]=function(e,t){this.detailItemTitleInit(e,t)},r},getCtlTitle:function(t){return{type:"text",text:t,style:e.processStyle({height:30,width:"100%",paddingLeft:13,fontSize:14,color:"#9E9E9E"})}},layoutForSwitch:function(t){var i=!!t.itemData.inLeft;t.titleKey=t.id+"_title",t.itemData.inDataTable&&(i=!0),i?(t.wrapKey=t.id+"_warp",t.root.push(t.wrapKey),t.components[t.wrapKey]={type:"view",className:"bottom-half-line",style:e.processStyle({backgroundColor:"#fff",height:50,fontSize:14,paddingLeft:13,paddingRight:13,flexDirection:"row",justifyContent:"space-between",alignItems:"center"}),root:[t.titleKey,t.id]},t.components[t.titleKey]={type:"text",text:t.itemData.title||"开关",style:e.processStyle({width:94})},t.components[t.id]={type:"switch",ref:!0,selectedBackgroundColor:"#29B6F6",style:e.processStyle({width:50,paddingRight:16,height:"100%",fontSize:14,textAlign:"right"})}):(t.root.push(t.titleKey),t.root.push(t.id),t.components[t.titleKey]=this.getCtlTitle(t.itemData.title),t.components[t.id]={type:"text",ref:!0,className:"form-row bottom-half-line",style:e.processStyle({backgroundColor:"#fff",height:50,fontSize:14,paddingLeft:13})})},switchIdentifyCodeLayout:function(t,i){t.titleKey=t.id+"_title",t.btn=t.id+"_button",t.wrapKey=t.id+"_warp",t.root.push(t.wrapKey),t.components[t.wrapKey]={type:"view",className:"bottom-half-line",style:e.processStyle({backgroundColor:"#fff",height:50,fontSize:14,paddingLeft:13,flexDirection:"row",alignItems:"center"}),root:[t.titleKey,t.id,t.btn]},t.components[t.titleKey]={type:"text",text:"验证码",numberofline:2,style:e.processStyle({width:94})},t.components[t.id]={type:"input",ref:!0,mode:"number",placeholder:"请输入验证码",style:e.processStyle({flex:1,paddingRight:16,height:"100%",fontSize:14,textAlign:"left"})},t.components[t.btn]={type:"button",ref:!0,title:"获取验证码",style:e.processStyle({width:100,height:30,fontSize:14,marginRight:20,color:"#29b6f6",borderColor:"#29b6f6"})}}};return i}),define("components/ApplyBillMaker",["./ApplyBase","utils","../parts/commonLayout"],function(e,t,i){function n(e){var t={};n.baseConstructor.call(this,e),t.multiLineFirStyle={opacity:1,color:"#262626"},t.singleLineStyle={opacity:1,color:"#262626"},t.type="text",t.multiLineSecSecStyle={justifyContent:"flex-start",color:"#262626"},i.switchLayout(this,t),this.plugin[this.id+"_didmount"]=function(e,t){e.setText(window.currentUserInfo&&window.currentUserInfo.userName||"暂无")}}return t.extends(n,e),n.prototype.getValue=function(){return window.currentUserInfo&&window.currentUserInfo.userName||"暂无"},n}),define("components/ApplyBillMakerManager",["./ApplyBase","utils","../parts/commonLayout"],function(e,t,i){function n(e){var t=this,a={},o=e.form.deptMgr;this.deptMgrName=o?o.name:"暂无",n.baseConstructor.call(this,e),a.multiLineFirStyle={opacity:1,color:"#262626"},a.singleLineStyle={opacity:1,color:"#262626"},a.multiLineSecSecStyle={justifyContent:"flex-start",color:"#262626"},a.type="text",i.switchLayout(this,a),this.plugin[this.id+"_didmount"]=function(e,i){e.setText(t.deptMgrName)}}return t.extends(n,e),n.prototype.getValue=function(){return this.deptMgrName},n}),define("components/ApplyBillMakerOrg",["./ApplyBase","utils","../parts/commonLayout"],function(e,t,i){function n(e){var t=this,a={},o=e.form.org;this.orgName=o&&$.isArray(o)?o[0].name:"暂无",n.baseConstructor.call(this,e),a.multiLineFirStyle={opacity:1,color:"#262626"},a.singleLineStyle={opacity:1,color:"#262626"},a.multiLineSecSecStyle={justifyContent:"flex-start",color:"#262626"},a.type="text",i.switchLayout(this,a),this.plugin[this.id+"_didmount"]=function(e,i){e.setText(t.orgName)}}return t.extends(n,e),n.prototype.getValue=function(){return this.orgName},n}),define("components/ApplyBillMakerPost",["./ApplyBase","utils","../parts/commonLayout"],function(e,t,i){function n(e){var t=this,a={},o=e.form.duty;this.dutyName=o?o:"暂无",n.baseConstructor.call(this,e),a.multiLineFirStyle={opacity:1,color:"#262626"},a.singleLineStyle={opacity:1,color:"#262626"},a.multiLineSecSecStyle={justifyContent:"flex-start",color:"#262626"},a.type="text",i.switchLayout(this,a),this.plugin[this.id+"_didmount"]=function(e,i){e.setText(t.dutyName)}}return t.extends(n,e),n.prototype.getValue=function(){return this.dutyName},n}),define("components/ApplyCodeRule",["./ApplyBase","utils","../parts/commonLayout"],function(e,t,i){function n(e){var t=this,a={};n.baseConstructor.call(this,e),console.log(this.itemData),
this.itemData.tips="系统自动编号",a.multiLineFirStyle={opacity:1,color:"#262626"},a.singleLineStyle={opacity:1,color:"#262626"},a.type="text",a.multiLineSecSecStyle={justifyContent:"flex-start",color:"#262626"},i.switchLayout(this,a),this.plugin[this.id+"_didmount"]=function(e,i){e.setText(t.itemData.tips)},this.components[this.id].disabled=!0;var o={columncode:this.itemData.columncode,codeRuleTypeValue:this.itemData.codeRuleTypeValue};this.itemData.fieldValue&&$.extend(o,{fieldId:this.itemData.fieldValue,fieldValue:""}),this.plugin.autoFields.push(o)}return t.extends(n,e),n.prototype.getValue=function(){return"MODIFY"===this.plugin.mode?this.itemData.values:""},n}),define("parts/common",["utils","md5"],function(e,t){var i="#29B6F6",n="#333333",a="#999999",o="#666666",s="#f7f7f7",r="#37B7FD",l="ADDITIONAL_FORM_DATA",c=/(\.thumb\.jpg|\.middle\.jpg|\.big\.jpg)*$/,p={thumbImg:function(e){return e&&e.replace(c,".thumb.jpg")||"#"},descColor:o,backColor:s,mainColor:i,seTitleColor:a,labelColor:"#666666",titleColor:n,HeadColor:r,ADDITIONAL_FORM_DATA:l,replaceUrl:function(e,t,i){var n,a=window.location.href.split("taskId="+e);n=1===a.length?window.location.href+"&taskId="+t:window.location.href.split("taskId="+e).join("taskId="+t),i.pageManager.preventHasChange(),window.location.replace(n)},gotoDetail:function(e,t){var i=t.params.token,n=t.pageManager.appConfig.taskhost+"/dist/index.html#TaskDetailView?token="+i+"&taskId="+(e.datasource.mirrorId||e.datasource.id);window.location.href=n},MoneyDX:function(e){var t="",i="仟佰拾万仟佰拾亿仟佰拾万仟佰拾元角分",n="";e+="00";var a=e.indexOf(".");a>=0&&(e=e.substring(0,a)+e.substr(a+1,2)),i=i.substr(i.length-e.length);for(var o=0;o<e.length;o++)t+="零壹贰叁肆伍陆柒捌玖".substr(e.substr(o,1),1)+i.substr(o,1);return n=t.replace(/零角零分$/,"整").replace(/零[仟佰拾]/g,"零").replace(/零{2,}/g,"零").replace(/零([亿|万])/g,"$1").replace(/零+元/,"元").replace(/亿零{0,3}万/,"亿").replace(/^元/,"零元"),n.replace(/零./g,"")},createMoneyItemLayout:function(t){var i="";t.inLeft?(t.titleKey=t.id+"_title",t.root.push(t.titleKey),t.root.push(t.id),i=t.itemData.tips||"",i=t.isRequired?i+" (必填)":i,t.components[t.id]={type:"input",placeholder:i,mode:"number",ref:!0,style:e.processStyle({backgroundColor:"#fff",height:50,fontSize:15,marginBottom:10,paddingLeft:13})}):(t.titleKey=t.id+"_title",t.wrapKey=t.id+"_warp",t.root.push(t.wrapKey),t.components[t.wrapKey]={type:"view",className:"form-row",style:e.processStyle({backgroundColor:"#fff",height:50,marginBottom:t.isInDetail===!1&&"1"===t.itemData.uppercase?0:10,fontSize:15,paddingLeft:13,flexDirection:"row"}),root:[t.titleKey,t.id]},i=t.itemData.tips||"",i=t.isRequired?i+" (必填)":i,t.components[t.id]={type:"input",placeholder:i,mode:"number",ref:!0,style:e.processStyle({flex:1,paddingRight:16,height:"100%",fontSize:15,textAlign:"left"})},t.components[t.titleKey]={type:"text",text:t.itemData.title||"",numberofline:2,style:e.processStyle({width:94})})},createItemLayout:function(t,i){t.titleKey=t.id+"_title",t.wrapKey=t.id+"_warp",t.root.push(t.wrapKey),t.components[t.wrapKey]={type:"view",className:"form-row",style:e.processStyle({backgroundColor:"#fff",minHeight:50,borderBottom:"1px solid #ededed",paddingTop:4,paddingBottom:4,fontSize:15,paddingLeft:13,flexDirection:"row"}),root:[t.titleKey,t.id]},t.components[t.id]={type:"icon",textPos:"left",ref:!0,text:t.isRequired?"请选择 (必填)":"请选择",font:"icomoon_e913",numberofline:1,textStyle:e.processStyle({color:"#b7b7b7",fontSize:15,marginRight:6,maxWidth:"100%"}),iconStyle:e.processStyle({color:"#ccc",fontSize:14}),style:e.processStyle({flex:1,justifyContent:"flex-end",paddingRight:16,paddingLeft:20})},t.components[t.titleKey]={type:"text",text:t.itemData.title||i.title,numberofline:2,style:{width:100}}},getDetailCtlTitle:function(t,i,n,a){var o=t.id||t.fieldId+"_title",s=t.id||t.fieldId+"_delbtn",r={type:"view",style:{flexDirection:"row",background:"#fff",borderRadius:"5px 5px 0 0",borderBottom:"1px solid #ededed"},root:[o,s]};return"null"===t.displayTitle&&(t.displayTitle=""),i[o]={type:"text",ref:!0,text:t.title||t.displayTitle||"明细",style:e.processStyle({height:34,flex:"1",textIndent:13,fontSize:14,backgroundColor:"#FCFCFC",color:"#666",borderRadius:5})},i[s]={type:"icon",src:"./imgs/deitalDel.png",titleKey:o,titleLabel:t.title||t.displayTitle,iconStyle:e.processStyle({w:17,marginRight:10,lineHeight:"20px"}),style:e.processStyle({flex:"1",justifyContent:"flex-end",paddingRight:20,textIndent:15,fontSize:14,backgroundColor:"#FCFCFC",color:"#37B7FD"})},n[s+"_init"]=function(e,t){this.detailItemDeleteInit(e,t)},n[s+"_click"]=function(e,t){t=t||{},t.DetailInstance=a,this.detailItemDeleteClick(e,t)},n[o+"_init"]=function(e,t){this.detailItemTitleInit(e,t)},r},getCtlTitle:function(t){return{type:"text",text:t,style:e.processStyle({height:30,width:"100%",paddingLeft:13,fontSize:13,color:"#666"})}},customTimestamp:function(t,i,n){var a="";try{t=parseFloat(t);var o=new Date(t),s=new Date,r=s.getTime(),l=e.getDateInfo(o),c=e.getDateInfo(s);r=parseInt((r-t)/1e3),a=c.year===l.year&&c.day===l.day&&c.month===l.month&&n?"今天 "+this.formatTime(o,"hh:mm"):i?this.formatTime(o,i):this.formatTime(o,"yyyy-MM-dd hh:mm")}catch(e){}return a},formatTime:function(e,t){var i={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length)));for(var n in i)new RegExp("("+n+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?i[n]:("00"+i[n]).substr((""+i[n]).length)));return t},selectAttachment:function(e,t,i){var n=e,a=i||9;if(n.imagesRepeat.datasource.length>=a)return void n.pageview.showTip({text:"最多上传"+a+"张图片",duration:1e3,style:{width:"220px"}});try{var o=a-n.imagesRepeat.datasource.length;window.yyesn.client.selectAttachment(function(e){var t=e.data;t.length>o&&n.pageview.showTip({text:"最多上传"+a+"张图片",duration:1e3,style:{width:"220px"}});for(var i=0,s=o;i<s;i++)n.imagesRepeat.addItem({src:t[i].path})},{type:t||1,maxselectnum:o})}catch(e){}},parseAuthInfo:function(e,t,i,n){var a=t.fieldId||t.subFormId,o={readonly:!1};if(!e)return o.readonly=t.readonly,o;if("reAdd"!==i&&"NEW"!==i||!e.fillIn){var s=e[n]||[];s.every(function(e){return e.fieldid!==a||("0"===e.auth?o=!1:"2"===e.auth?o.readonly=!1:o.readonly=!0,!1)})}else{var r=e.fillIn||[];r.every(function(e){return e.fieldid!==a||("0"===e.auth?o=!1:"2"===e.auth?o.readonly=!1:o.readonly=!0,!1)})}return o}};return p}),define("components/ApplyDepartment",["./ApplyBase","utils","../parts/common"],function(e,t,i){function n(e){var i=this,a="部门";this.config=e,this.multiselect=!!this.config.itemData.multiselect,this.isCurrentEmployee=!!this.config.itemData.isCurrentEmployee,n.baseConstructor.call(this,e);var o=this.itemData.tips?this.itemData.tips:"请选择用户";this.wrapKey=this.id+"_wrap",this.titleKey=this.id+"_title",this.root.push(this.wrapKey),this.components[this.wrapKey]={type:"view",className:"form-row",style:t.processStyle({backgroundColor:"#fff",height:50,fontSize:15,paddingLeft:13,flexDirection:"row",borderBottom:"1px solid #ededed"}),root:[this.titleKey,this.id]},this.components[this.titleKey]={type:"text",text:this.config.itemData.title||a,numberofline:2,style:t.processStyle({width:80})},this.components[this.id]={type:"icon",textPos:"left",ref:!0,text:this.config.itemData.isRequired?o+" (必填)":o,font:"icomoon_e913",numberofline:5,textStyle:t.processStyle({color:"#B7B7B7",fontSize:15,marginRight:6,maxWidth:"100%"}),iconStyle:t.processStyle({color:"#ccc",fontSize:14}),style:t.processStyle({flex:1,justifyContent:"flex-end",paddingRight:16,paddingLeft:20})},this.plugin[this.wrapKey+"_click"]=function(e,t){var n=this,a=e;try{window.yyesn.enterprise.selectDepartmentForVerify(function(e){if("0"===e.error_code){var t=JSON.stringify(e),o=JSON.parse(t).data;console.log(o),i.employee_select_list=o;var s="";i.employee_select_list.forEach(function(e,t){s+=e.name+","}),s=s.substring(0,s.length-1),i.isInDetail?a.rowInstance.delegate(i.id,function(e){var t='<div class="displayflex yy-fd-column yy-jc-center yy-ai-center">'+s+"</div></div>";e.setText(t)}):n.pageview.delegate(i.id,function(e){var t='<div class="displayflex yy-fd-column yy-jc-center yy-ai-center">'+s+"</div></div>";e.setText(t)})}},{},function(e){})}catch(e){alert(JSON.stringify(e))}}}return t.extends(n,e),n.prototype.getValue=function(e){if(this.employee_select_list&&this.employee_select_list.length>0){var t="";return this.employee_select_list.forEach(function(e,i){t+=e.name+","}),t=t.substring(0,t.length-1)}return this.employee_select?this.employee_select.name:""},n.prototype.getConfig=function(e){var i,n=t.copy(this.itemData);return i=this.getValue()||"",this.isRequired&&0===i.length?(this.showRequiedTip(),!1):(n.value=i,n)},n}),define("components/ApplyDetail",["./ApplyBase","utils","../parts/common"],function(e,t,i){function n(e){var a=this;n.baseConstructor.call(this,e),this.isDetail=!0,this.rootTitleWrap=this.id+"_rootitle",this.titleWrap=this.id+"_titlewrap",this.itemInstanceArr=[],this.repeatKey=this.id,this.addBtn=this.id+"_addbtn",a.plugin.calculateDetailComponent="",this.components[this.rootTitleWrap]={type:"text",text:"明细表",style:t.processStyle({color:"#9E9E9E",fontSize:12,marginLeft:15,marginTop:6,marginBottom:6})};for(var o={type:"repeat",ref:!0,className:"form-repeat",style:t.processStyle({flexDirection:"column",marginLeft:15,marginRight:15}),itemStyle:t.processStyle({width:"100%",marginBottom:10,borderRadius:"5px 5px 0 0",border:"1px solid #ededed",borderBottom:"none"}),subComponent:this.addBtn,items:[{}],root:[this.titleWrap]},s=this.itemData.layoutDetail,r=0,l=s.length;r<l;r++){var c=this.plugin.addSubComponent(s[r],this.components,o.root,this.repeatKey,this);c&&this.itemInstanceArr.push(c)}this.components[this.titleWrap]=i.getDetailCtlTitle(this.itemData,this.components,this.plugin,this),this.components[this.repeatKey]=o,this.components[this.addBtn]={type:"icon",ref:!0,src:"./imgs/add.png",textPos:"right",iconStyle:t.processStyle({w:10,lineHeight:"2px"}),style:t.processStyle({height:40,width:"100%",backgroundColor:"#fff",margin:"0px auto 10px auto",borderRadius:5}),textStyle:{color:"rgb(2,199,255)",lineHeight:"15px",fontSize:14,marginLeft:5},text:this.itemData.actionname||"增加明细"},this.summaryRepeatKey=this.id+"_summaryrepeat",this.summaryRepeatLabelKey=this.id+"_summaryrepeatlabel",this.summaryRepeatLabelValue=this.id+"_summaryrepeatvalue";var p=this.id+"_itemtopview",d=this.id+"_itembottomview";this.components[this.summaryRepeatKey]={type:"repeat",className:"displaynone",items:[],style:t.processStyle({flexDirection:"column",fontSize:14,paddingBottom:10}),itemStyle:t.processStyle({flexDirection:"column",padding:"2px 0px 2px 13px"}),root:[p,d],ref:!0},this.components[p]={type:"view",style:t.processStyle({flexDirection:"row"}),root:[this.summaryRepeatLabelKey,this.summaryRepeatLabelValue]};var h=this.id+"_upperlabel",u=this.id+"_uppervalue";this.components[d]={type:"view",className:"displaynone",style:t.processStyle({marginTop:3,flexDirection:"row"}),root:[h,u]},this.components[h]={type:"text",text:"大写",style:t.processStyle({color:"#333"})},this.components[u]={type:"text",numberofline:2,style:t.processStyle({color:"#999",flex:1,paddingRight:10,marginLeft:30})},this.components[this.summaryRepeatLabelKey]={type:"text",text_bind:"label",style:t.processStyle({color:"#333"})},this.components[this.summaryRepeatLabelValue]={type:"text",text_bind:"value",style:t.processStyle({color:"#999",marginLeft:30})},this.plugin[d+"_init"]=function(e,t){"1"===e.datasource.uppercase&&e.$el.removeClass("displaynone")},this.plugin[u+"_init"]=function(e,t){"1"===e.datasource.uppercase&&(e.config.text=i.MoneyDX(e.datasource.value))},this.root.push(this.rootTitleWrap),this.root.push(this.repeatKey),this.root.push(this.summaryRepeatKey),this.plugin[this.addBtn+"_click"]=function(e,t){this.repeatAddMoreClick(e,t),a.repeatEachDetailInstance()}}return t.extends(n,e),n.prototype.bindInitValue=function(e){this.defaultRows=this.itemData.defaultRows;for(var t=this.itemData.layoutDetail||[],i=[{}],n=0,a=t.length;n<a;n++){var o=t[n],s=(o.fieldId||o.subFormId).toString(),r=o.values||[];if("NEW"===this.plugin.mode)for(var l=this.itemData.defaultRows,c=0;c<l;c++)i[c]||i.push({}),i[c][s]="";else for(var p=0,d=r.length;p<d;p++)i[p]||i.push({}),i[p][s]=r[p]}e.config.items=i},n.prototype.getSummaryData=function(e){var t={},i={},n={},a=this;this.plugin.pageview.refs[this.repeatKey].eachItem(function(o){for(var s={},r={},l=0,c=a.itemInstanceArr.length;l<c;l++){if(s=a.itemInstanceArr[l],r=s.itemData,r.isTotal||r.average||r.maxInGird||r.minInGird){t[s.id]||(t[s.id]=[]);var p=s.getConfigWhenItemInRepeatForSummary(o,!0),d=p.componentKey,h=0;n[s.id]=s,"DateInterval"===d?(h=a.getDateDiff(p.value,p.dateType),i[s.id]=p.autocalculatetitle+("2"===p.dateType.toString()?"(时)":"(天)"),t[s.id].push({value:h})):"Number"===d?(i[s.id]=p.title,t[s.id].push({value:p.value,label:p.title})):"Money"===d&&(i[s.id]=p.title,t[s.id].push({value:p.value,uppercase:p.uppercase}))}!e&&r.formula&&a.analysisBindRowItem(o,s)}});var o=[];for(var s in t){var r,l=t[s],c="(求和)",p=n[s].itemData;p.isTotal?(c="(求和)",r=this.sumVal(l)):p.average?(c="(平均)",r=this.avgVal(l)):p.maxInGird?(c="(最大)",r=this.maxVal(l)):p.minInGird&&(c="(最小)",r=this.minVal(l)),a.updateMainTableFieldValue(p,r),n[s].itemData.summaryvalue=r,p.isOperationRule&&p.showOperValueInGird&&o.push({label:(i[s]||"")+c,value:r,uppercase:l[0].uppercase||"0"})}return o},n.prototype.repeatEachDetailInstance=function(){var e=this,t=this.plugin.pageview.refs[this.repeatKey].components.length;this.plugin.pageview.refs[this.repeatKey].eachItem(function(i,n){var a={},o={};if(n===t-1)for(var s=0,r=e.itemInstanceArr.length;s<r;s++)a=e.itemInstanceArr[s],o=a.itemData,o.formula&&e.analysisBindRowItem(i,a)})},n.prototype.updateMainTableFieldValue=function(e,t){var i=this;e.mainTableField&&i.plugin.pageview.delegate(e.mainTableField,function(n){n.$el.find("input").trigger("change"),n.setDisabled(!0),n.$el.css({opacity:1}),n.setValue(t||0),i.plugin[e.mainTableField+"_money_setvalue"]&&i.plugin[e.mainTableField+"_money_setvalue"]()})},n.prototype.analysisBindRowItem=function(e,t){var i=this,n=t.itemData.moneyFields||t.itemData.numberFields,a=JSON.parse(n),o=[];e.delegate(t.itemData.fieldId,function(n){if(n.setDisabled(!0),n.$el.css({opacity:1}),a){a.forEach(function(e){"field"===e.type&&o.push(e.value)});var s=!1;i.plugin.calculateDetailComponent+=t.itemData.fieldId+";",a.forEach(function(e){"field"===e.type&&(s=i.plugin.calculateDetailComponent.indexOf(e.value)>-1)}),a.forEach(function(n,a){if("field"===n.type&&s){var r=e.refs[n.value].$el.find("input");r.change(function(a){var s="",r="";s&&clearTimeout(s),s=setTimeout(function(){r=setInterval(function(){if(!window.calculateLock){clearInterval(r),window.calculateLock=!0;var a={};a.formula={},a.formula[n.value]=t.itemData.formula,a[n.value]=this.value||0,o.forEach(function(t){var n="";i.itemData.layoutDetail.forEach(function(e){e.fieldId===t&&(n=e.decimalPlace)}),a[t]={},a[t].decimalDigit=n,a[t].value=e.refs[t].getValue()||0}),a=JSON.stringify(a),i.plugin.pageview.ajax({url:"formula/calculation",type:"POST",contentType:"application/json; charset=UTF-8",data:a,success:function(a){if(window.calculateLock=!1,i.plugin.pageview.hideLoading(!0),a.success){var o=a.data[n.value];t.setValueWhenItemInRepeat(e,o)}else i.plugin.pageview.showTip({text:a.msg,duration:1e3})},error:function(e){window.calculateLock=!1,console.error("network error")}})}},50)},500)})}}),a.forEach(function(n,a){if("field"===n.type){var s=e.refs[n.value].$el.find("input");s.keyup(function(e,t,i){var a="",s="";return function(){a&&clearTimeout(a),a=setTimeout(function(){s=setInterval(function(){if(!window.calculateLock){clearInterval(s),window.calculateLock=!0;var a={};a.formula={},a.formula[n.value]=t.itemData.formula,a[n.value]=this.value||0,o.forEach(function(t){var n="";i.itemData.layoutDetail.forEach(function(e){e.fieldId===t&&(n=e.decimalPlace)}),a[t]={},a[t].decimalDigit=n,a[t].value=e.refs[t].getValue()||0}),a=JSON.stringify(a),i.plugin.pageview.ajax({url:"formula/calculation",type:"POST",contentType:"application/json; charset=UTF-8",data:a,success:function(a){if(window.calculateLock=!1,i.plugin.pageview.hideLoading(!0),a.success){var o=a.data[n.value];t.setValueWhenItemInRepeat(e,o),i.plugin.pageview.refs[i.id].$el.find("input").trigger("change"),i.updateSummary(!0)}else i.plugin.pageview.showTip({text:a.msg,duration:1e3})},error:function(e){window.calculateLock=!1,console.error("network error")}})}},50)},500)}}(e,t,i))}})}})},n.prototype.bindValue=function(e){},Math.formatFloat=function(e,t){},n.prototype.sumVal=function(e){for(var t=[],i=0,n=0,a=0,o=0,s=e.length;o<s;o++){var r=e[o].value.toString(),l=r.split(".");2===l.length&&(n=l[1].length,n>a&&(a=n));try{r=parseFloat(r),isNaN(r)||t.push(r)}catch(e){}}if(a>0){for(var c=Math.pow(10,a),p=0,d=t.length;p<d;p++)i+=Math.round(t[p]*c*1e3)/1e3;i/=c}else for(var h=0,u=t.length;h<u;h++)i+=t[h];return this.parseInt(i)},n.prototype.avgVal=function(e){var t=this.sumVal(e),i=0;return e.length&&(i=t/e.length),this.parseInt(i)},n.prototype.maxVal=function(e){var t=[];return e.forEach(function(e){t.push(e.value)}),Math.max.apply(Math,t)},n.prototype.minVal=function(e){var t=[];return e.forEach(function(e){t.push(e.value)}),Math.min.apply(Math,t)},n.prototype.getDateDiff=function(e,i){if(!(e instanceof Array))return 0;if(2!=e.length)return 0;var n=e[0];if(!n||""===n)return 0;var a=e[1];if(!a||""===a)return 0;var o=t.convertToDate(n),s=t.convertToDate(a),r=s-o;return r="2"===i.toString()?(r/36e5).toFixed(1):r/864e5+1,r=this.parseInt(r)},n.prototype.updateSummary=function(e){var t=this;this.plugin.pageview.delegate(this.summaryRepeatKey,function(i){setTimeout(function(){i.bindData(t.getSummaryData(e))},900),i.$el.removeClass("displaynone")}),this.plugin.pageview.delegate(this.addBtn,function(e){e.$el.css({marginBottom:4})})},n.prototype.getConfig=function(){var e=this,i=t.copy(this.itemData),n=!1,a=i.tableName||"",o=(i.pk_sub_bo||"",[]),s="";return this.plugin.subFormPk&&this.plugin.subFormPk[this.itemData.tableName]&&(s=this.plugin.subFormPk[this.itemData.tableName]),this.plugin.pageview.refs[this.repeatKey].eachItem(function(t){var i={};$.isEmptyObject(t.datasource)?i.pkValue="":i.pkValue=s,i.tableName=a,i.formData=[];for(var r=0,l=e.itemInstanceArr.length;r<l;r++){var c=e.itemInstanceArr[r],p=c.getConfigWhenItemInRepeat(t),d={};if(p===!1){n=!0;break}d.name=p.columncode,d.type=p.componentKey,d.value=p.value,i.formData.push(d)}o.push(i)}),n!==!0&&o},n}),define("components/ApplyDividingLine",["./ApplyBase","utils","../parts/commonLayout"],function(e,t,i){function n(e){n.baseConstructor.call(this,e),this.root.push(this.id),this.components[this.id]={type:"text",text:"",style:t.processStyle({height:10,borderBottom:"1px solid #ddd",borderColor:"#ededed",marginBottom:10,paddingBottom:10})}}return t.extends(n,e),n.prototype.getValue=function(){return""},n}),define("components/ApplyEmployee",["./ApplyBase","utils","../parts/common"],function(e,t,i){function n(e){var i=this,a="用户";this.config=e,this.multiselect=!!this.config.itemData.multiselect,this.isCurrentEmployee=!!this.config.itemData.isCurrentEmployee,n.baseConstructor.call(this,e),this.wrapKey=this.id+"_wrap",this.titleKey=this.id+"_title";var o=this.itemData.tips?this.itemData.tips:"请选择用户";this.multiselect?(this.repeatKey=this.id+"_repeat",this.iconKey=this.id+"_icon",this.addIconKey=this.id+"_addIcon",this.root.push(this.wrapKey),this.components[this.wrapKey]={type:"view",ref:!0,style:t.processStyle({backgroundColor:"#fff",borderBottom:"1px solid #ededed"}),root:[this.titleKey,this.repeatKey]},this.components[this.titleKey]={type:"text",text:e.title||a,nextText:"（点击头像删除人员）",style:t.processStyle({marginTop:10,paddingBottom:10,color:"333333",fontSize:14,marginLeft:14}),nextTextStyle:t.processStyle({color:"#b7b7b7"})},this.components[this.repeatKey]={type:"repeat",className:"line-repeat",ref:!0,style:t.processStyle({minHeight:80,flexWrap:"wrap",paddingLeft:6,paddingBottom:10,flexDirection:"row"}),subComponent:this.addIconKey,itemStyle:t.processStyle({width:50}),root:[this.iconKey]},this.components[this.iconKey]={type:"icon",style:{paddingTop:10,zIndex:10},iconStyle:t.processStyle({w:32,backgroundColor:"#eee",borderRadius:"100%",overflow:"hidden"}),textStyle:t.processStyle({marginTop:3,color:"#b7b7b7",fontSize:12}),title_bind:"userName",src_bind:"headImgUrl",text_bind:"userName",textPos:"bottom"},this.components[this.addIconKey]={type:"image",src:"./imgs/addapprove.png",style:t.processStyle({w:32,marginTop:9,marginLeft:9,backgroundColor:"#fff"})},this.plugin[this.id+"_repeat_itemclick"]=function(e,t){var n=e.datasource.memberId.toString();if(i.employee_select_list)for(var a=i.employee_select_list.length-1;a>=0;a--)i.employee_select_list[a].member_id.toString()===n&&i.employee_select_list.splice(a,1);e.remove()},this.plugin[this.id+"_addIcon_click"]=function(e,t){this.sender=e;try{window.yyesn.enterprise.selectContacts(function(e){if("0"===e.error_code){var t=e.data;i.isIndetail?i.plugin.pageview.refs[i.DetailInstance.repeatKey].empty():i.plugin.pageview.refs[i.repeatKey].empty(),i.employee_select_list=[];for(var n=0,a=t.length;n<a;n++){var o=t[n];i.employee_select_list.push(o),i.plugin.pageview.refs[i.repeatKey].addItem({userName:o.name,headImgUrl:o.avatar,memberId:o.member_id})}}},{mode:1,multi:1,select_list:i.employee_select_list||[]},function(e){})}catch(e){alert(JSON.stringify(e))}}):(this.root.push(this.wrapKey),this.components[this.wrapKey]={type:"view",ref:!0,className:"form-row",style:t.processStyle({backgroundColor:"#fff",height:60,fontSize:15,paddingLeft:13,flexDirection:"row",borderBottom:"solid 1px #ededed"}),root:[this.titleKey,this.id]},this.components[this.titleKey]={type:"text",text:this.config.itemData.title||a,numberofline:2,style:t.processStyle({width:80})},this.components[this.id]={type:"icon",textPos:"left",ref:!0,text:this.config.itemData.isRequired?o+" (必填)":o,font:"icomoon_e913",numberofline:5,textStyle:t.processStyle({color:"#b7b7b7",fontSize:15,marginRight:6,maxWidth:"100%"}),iconStyle:t.processStyle({color:"#ccc",fontSize:14}),style:t.processStyle({flex:1,justifyContent:"flex-end",paddingRight:16,paddingLeft:20})},this.isCurrentEmployee?(this.plugin[this.wrapKey+"_init"]=function(e,t){this.pageview.delegate(i.id,function(e){var t='<div class="displayflex yy-fd-column yy-jc-center yy-ai-center"><image style="width: 30px;height: 30px;border-radius: 50%;margin-bottom: 2px;" src="'+(window.currentUserInfo&&window.currentUserInfo.userPic||"./imgs/unknow_person.png")+'" /><div style="font-size: 12px;">'+(window.currentUserInfo&&window.currentUserInfo.userName||"未知")+"</div></div>";e.setText(t)})},this.employee_select={userName:window.currentUserInfo&&window.currentUserInfo.userName,headImgUrl:window.currentUserInfo&&window.currentUserInfo.userPic,member_id:window.currentUserInfo&&window.currentUserInfo.userCode.split("esn")[1]}):this.plugin[this.wrapKey+"_click"]=function(e,t){var n=this,a=e;try{window.yyesn.enterprise.selectContacts(function(e){if("0"===e.error_code){var t=JSON.stringify(e),o=JSON.parse(t).data[0];i.employee_select=o,i.isInDetail?a.rowInstance.delegate(i.id,function(e){var t='<div class="displayflex yy-fd-column yy-jc-center yy-ai-center"><image style="width: 30px;height: 30px;border-radius: 50%;margin-bottom: 2px;" src="'+i.employee_select.avatar+'" /><div style="font-size: 12px;">'+i.employee_select.name+"</div></div>";e.setText(t)}):n.pageview.delegate(i.id,function(e){var t='<div class="displayflex yy-fd-column yy-jc-center yy-ai-center"><image style="width: 30px;height: 30px;border-radius: 50%;margin-bottom: 2px;" src="'+i.employee_select.avatar+'" /><div style="font-size: 12px;">'+i.employee_select.name+"</div></div>";e.setText(t)})}},{mode:1,multi:0},function(e){})}catch(e){alert(JSON.stringify(e))}})}return t.extends(n,e),n.prototype.getValue=function(e){if(this.employee_select_list&&this.employee_select_list.length>0){var t="";return this.employee_select_list.forEach(function(e,i){t+=e.member_id+","}),t=t.substring(0,t.length-1)}return this.employee_select?this.employee_select.member_id:""},n.prototype.getConfig=function(e){var i,n=t.copy(this.itemData);return i=this.getValue()||"",this.isRequired&&0===i.length?(this.showRequiedTip(),!1):(n.value=i,n)},n}),!function(e,t){"use strict";function i(e,t){for(var i,n=[],o=0;o<e.length;++o){if(i=s[e[o]]||a(e[o]),!i)throw"module definition dependecy not found: "+e[o];n.push(i)}t.apply(null,n)}function n(e,n,a){if("string"!=typeof e)throw"invalid module definition, module id must be defined and be a string";if(n===t)throw"invalid module definition, dependencies must be specified";if(a===t)throw"invalid module definition, definition function must be specified";i(n,function(){s[e]=a.apply(null,arguments)})}function a(t){for(var i=e,n=t.split(/[.\/]/),a=0;a<n.length;++a){if(!i[n[a]])return;i=i[n[a]]}return i}function o(i){for(var n=0;n<i.length;n++){for(var a=e,o=i[n],r=o.split(/[.\/]/),l=0;l<r.length-1;++l)a[r[l]]===t&&(a[r[l]]={}),a=a[r[l]];a[r[r.length-1]]=s[o]}}var s={},r="moxie/core/utils/Basic",l="moxie/core/I18n",c="moxie/core/utils/Mime",p="moxie/core/utils/Env",d="moxie/core/utils/Dom",h="moxie/core/Exceptions",u="moxie/core/EventTarget",f="moxie/core/utils/Encode",g="moxie/runtime/Runtime",m="moxie/runtime/RuntimeClient",y="moxie/file/Blob",v="moxie/file/File",w="moxie/file/FileInput",x="moxie/file/FileDrop",b="moxie/runtime/RuntimeTarget",_="moxie/file/FileReader",D="moxie/core/utils/Url",I="moxie/file/FileReaderSync",S="moxie/xhr/FormData",C="moxie/xhr/XMLHttpRequest",T="moxie/runtime/Transporter",k="moxie/image/Image",R="moxie/runtime/html5/Runtime",$="moxie/runtime/html5/file/Blob",L="moxie/core/utils/Events",A="moxie/runtime/html5/file/FileInput",E="moxie/runtime/html5/file/FileDrop",P="moxie/runtime/html5/file/FileReader",M="moxie/runtime/html5/xhr/XMLHttpRequest",N="moxie/runtime/html5/utils/BinaryReader",F="moxie/runtime/html5/image/JPEGHeaders",W="moxie/runtime/html5/image/ExifParser",O="moxie/runtime/html5/image/JPEG",B="moxie/runtime/html5/image/PNG",z="moxie/runtime/html5/image/ImageInfo",H="moxie/runtime/html5/image/MegaPixel",K="moxie/runtime/html5/image/Image",V="moxie/runtime/flash/Runtime",j="moxie/runtime/flash/file/Blob",U="moxie/runtime/flash/file/FileInput",G="moxie/runtime/flash/file/FileReader",Y="moxie/runtime/flash/file/FileReaderSync",q="moxie/runtime/flash/xhr/XMLHttpRequest",X="moxie/runtime/flash/runtime/Transporter",J="moxie/runtime/flash/image/Image",Z="moxie/runtime/silverlight/Runtime",Q="moxie/runtime/silverlight/file/Blob",ee="moxie/runtime/silverlight/file/FileInput",te="moxie/runtime/silverlight/file/FileDrop",ie="moxie/runtime/silverlight/file/FileReader",ne="moxie/runtime/silverlight/file/FileReaderSync",ae="moxie/runtime/silverlight/xhr/XMLHttpRequest",oe="moxie/runtime/silverlight/runtime/Transporter",se="moxie/runtime/silverlight/image/Image",re="moxie/runtime/html4/Runtime",le="moxie/runtime/html4/file/FileInput",ce="moxie/runtime/html4/file/FileReader",pe="moxie/runtime/html4/xhr/XMLHttpRequest",de="moxie/runtime/html4/image/Image";n(r,[],function(){var e=function(e){var t;return e===t?"undefined":null===e?"null":e.nodeType?"node":{}.toString.call(e).match(/\s([a-z|A-Z]+)/)[1].toLowerCase()},t=function(n){var a;return i(arguments,function(o,r){r>0&&i(o,function(i,o){i!==a&&(e(n[o])===e(i)&&~s(e(i),["array","object"])?t(n[o],i):n[o]=i)})}),n},i=function(e,t){var i,n,a,o;if(e){try{i=e.length}catch(e){i=o}if(i===o){for(n in e)if(e.hasOwnProperty(n)&&t(e[n],n)===!1)return}else for(a=0;i>a;a++)if(t(e[a],a)===!1)return}},n=function(t){var i;if(!t||"object"!==e(t))return!0;for(i in t)return!1;return!0},a=function(t,i){function n(a){"function"===e(t[a])&&t[a](function(e){++a<o&&!e?n(a):i(e)})}var a=0,o=t.length;"function"!==e(i)&&(i=function(){}),t&&t.length||i(),n(a)},o=function(e,t){var n=0,a=e.length,o=new Array(a);i(e,function(e,i){e(function(e){if(e)return t(e);var s=[].slice.call(arguments);s.shift(),o[i]=s,n++,n===a&&(o.unshift(null),t.apply(this,o))})})},s=function(e,t){if(t){if(Array.prototype.indexOf)return Array.prototype.indexOf.call(t,e);for(var i=0,n=t.length;n>i;i++)if(t[i]===e)return i}return-1},r=function(t,i){var n=[];"array"!==e(t)&&(t=[t]),"array"!==e(i)&&(i=[i]);for(var a in t)-1===s(t[a],i)&&n.push(t[a]);return!!n.length&&n},l=function(e,t){var n=[];return i(e,function(e){-1!==s(e,t)&&n.push(e)}),n.length?n:null},c=function(e){var t,i=[];for(t=0;t<e.length;t++)i[t]=e[t];return i},p=function(){var e=0;return function(t){var i,n=(new Date).getTime().toString(32);for(i=0;5>i;i++)n+=Math.floor(65535*Math.random()).toString(32);return(t||"o_")+n+(e++).toString(32)}}(),d=function(e){return e?String.prototype.trim?String.prototype.trim.call(e):e.toString().replace(/^\s*/,"").replace(/\s*$/,""):e},h=function(e){if("string"!=typeof e)return e;var t,i={t:1099511627776,g:1073741824,m:1048576,k:1024};return e=/^([0-9]+)([mgk]?)$/.exec(e.toLowerCase().replace(/[^0-9mkg]/g,"")),t=e[2],e=+e[1],i.hasOwnProperty(t)&&(e*=i[t]),e};return{guid:p,typeOf:e,extend:t,each:i,isEmptyObj:n,inSeries:a,inParallel:o,inArray:s,arrayDiff:r,arrayIntersect:l,toArray:c,trim:d,parseSizeStr:h}}),n(l,[r],function(e){var t={};return{addI18n:function(i){return e.extend(t,i)},translate:function(e){return t[e]||e},_:function(e){return this.translate(e)},sprintf:function(t){var i=[].slice.call(arguments,1);return t.replace(/%[a-z]/g,function(){var t=i.shift();return"undefined"!==e.typeOf(t)?t:""})}}}),n(c,[r,l],function(e,t){var i="application/msword,doc dot,application/pdf,pdf,application/pgp-signature,pgp,application/postscript,ps ai eps,application/rtf,rtf,application/vnd.ms-excel,xls xlb,application/vnd.ms-powerpoint,ppt pps pot,application/zip,zip,application/x-shockwave-flash,swf swfl,application/vnd.openxmlformats-officedocument.wordprocessingml.document,docx,application/vnd.openxmlformats-officedocument.wordprocessingml.template,dotx,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,xlsx,application/vnd.openxmlformats-officedocument.presentationml.presentation,pptx,application/vnd.openxmlformats-officedocument.presentationml.template,potx,application/vnd.openxmlformats-officedocument.presentationml.slideshow,ppsx,application/x-javascript,js,application/json,json,audio/mpeg,mp3 mpga mpega mp2,audio/x-wav,wav,audio/x-m4a,m4a,audio/ogg,oga ogg,audio/aiff,aiff aif,audio/flac,flac,audio/aac,aac,audio/ac3,ac3,audio/x-ms-wma,wma,image/bmp,bmp,image/gif,gif,image/jpeg,jpg jpeg jpe,image/photoshop,psd,image/png,png,image/svg+xml,svg svgz,image/tiff,tiff tif,text/plain,asc txt text diff log,text/html,htm html xhtml,text/css,css,text/csv,csv,text/rtf,rtf,video/mpeg,mpeg mpg mpe m2v,video/quicktime,qt mov,video/mp4,mp4,video/x-m4v,m4v,video/x-flv,flv,video/x-ms-wmv,wmv,video/avi,avi,video/webm,webm,video/3gpp,3gpp 3gp,video/3gpp2,3g2,video/vnd.rn-realvideo,rv,video/ogg,ogv,video/x-matroska,mkv,application/vnd.oasis.opendocument.formula-template,otf,application/octet-stream,exe",n={mimes:{},extensions:{},addMimeType:function(e){var t,i,n,a=e.split(/,/);for(t=0;t<a.length;t+=2){for(n=a[t+1].split(/ /),i=0;i<n.length;i++)this.mimes[n[i]]=a[t];this.extensions[a[t]]=n}},extList2mimes:function(t,i){var n,a,o,s,r=this,l=[];for(a=0;a<t.length;a++)for(n=t[a].extensions.split(/\s*,\s*/),o=0;o<n.length;o++){if("*"===n[o])return[];if(s=r.mimes[n[o]])-1===e.inArray(s,l)&&l.push(s);else{if(!i||!/^\w+$/.test(n[o]))return[];l.push("."+n[o])}}return l},mimes2exts:function(t){var i=this,n=[];return e.each(t,function(t){if("*"===t)return n=[],!1;var a=t.match(/^(\w+)\/(\*|\w+)$/);a&&("*"===a[2]?e.each(i.extensions,function(e,t){new RegExp("^"+a[1]+"/").test(t)&&[].push.apply(n,i.extensions[t])}):i.extensions[t]&&[].push.apply(n,i.extensions[t]))}),n},mimes2extList:function(i){var n=[],a=[];return"string"===e.typeOf(i)&&(i=e.trim(i).split(/\s*,\s*/)),
a=this.mimes2exts(i),n.push({title:t.translate("Files"),extensions:a.length?a.join(","):"*"}),n.mimes=i,n},getFileExtension:function(e){var t=e&&e.match(/\.([^.]+)$/);return t?t[1].toLowerCase():""},getFileMime:function(e){return this.mimes[this.getFileExtension(e)]||""}};return n.addMimeType(i),n}),n(p,[r],function(e){function t(e,t,i){var n=0,a=0,o=0,s={dev:-6,alpha:-5,a:-5,beta:-4,b:-4,RC:-3,rc:-3,"#":-2,p:1,pl:1},r=function(e){return e=(""+e).replace(/[_\-+]/g,"."),e=e.replace(/([^.\d]+)/g,".$1.").replace(/\.{2,}/g,"."),e.length?e.split("."):[-8]},l=function(e){return e?isNaN(e)?s[e]||-7:parseInt(e,10):0};for(e=r(e),t=r(t),a=Math.max(e.length,t.length),n=0;a>n;n++)if(e[n]!=t[n]){if(e[n]=l(e[n]),t[n]=l(t[n]),e[n]<t[n]){o=-1;break}if(e[n]>t[n]){o=1;break}}if(!i)return o;switch(i){case">":case"gt":return o>0;case">=":case"ge":return o>=0;case"<=":case"le":return 0>=o;case"==":case"=":case"eq":return 0===o;case"<>":case"!=":case"ne":return 0!==o;case"":case"<":case"lt":return 0>o;default:return null}}var i=function(e){var t="",i="?",n="function",a="undefined",o="object",s="major",r="name",l="version",c={has:function(e,t){return-1!==t.toLowerCase().indexOf(e.toLowerCase())},lowerize:function(e){return e.toLowerCase()}},p={rgx:function(){for(var t,i,s,r,l,c,p,d=0,h=arguments;d<h.length;d+=2){var u=h[d],f=h[d+1];if(typeof t===a){t={};for(r in f)l=f[r],typeof l===o?t[l[0]]=e:t[l]=e}for(i=s=0;i<u.length;i++)if(c=u[i].exec(this.getUA())){for(r=0;r<f.length;r++)p=c[++s],l=f[r],typeof l===o&&l.length>0?2==l.length?t[l[0]]=typeof l[1]==n?l[1].call(this,p):l[1]:3==l.length?t[l[0]]=typeof l[1]!==n||l[1].exec&&l[1].test?p?p.replace(l[1],l[2]):e:p?l[1].call(this,p,l[2]):e:4==l.length&&(t[l[0]]=p?l[3].call(this,p.replace(l[1],l[2])):e):t[l]=p?p:e;break}if(c)break}return t},str:function(t,n){for(var a in n)if(typeof n[a]===o&&n[a].length>0){for(var s=0;s<n[a].length;s++)if(c.has(n[a][s],t))return a===i?e:a}else if(c.has(n[a],t))return a===i?e:a;return t}},d={browser:{oldsafari:{major:{1:["/8","/1","/3"],2:"/4","?":"/"},version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",RT:"ARM"}}}},h={browser:[[/(opera\smini)\/((\d+)?[\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/((\d+)?[\w\.-]+)/i,/(opera).+version\/((\d+)?[\w\.]+)/i,/(opera)[\/\s]+((\d+)?[\w\.]+)/i],[r,l,s],[/\s(opr)\/((\d+)?[\w\.]+)/i],[[r,"Opera"],l,s],[/(kindle)\/((\d+)?[\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?((\d+)?[\w\.]+)*/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?((\d+)?[\w\.]*)/i,/(?:ms|\()(ie)\s((\d+)?[\w\.]+)/i,/(rekonq)((?:\/)[\w\.]+)*/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron)\/((\d+)?[\w\.-]+)/i],[r,l,s],[/(trident).+rv[:\s]((\d+)?[\w\.]+).+like\sgecko/i],[[r,"IE"],l,s],[/(yabrowser)\/((\d+)?[\w\.]+)/i],[[r,"Yandex"],l,s],[/(comodo_dragon)\/((\d+)?[\w\.]+)/i],[[r,/_/g," "],l,s],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?((\d+)?[\w\.]+)/i],[r,l,s],[/(dolfin)\/((\d+)?[\w\.]+)/i],[[r,"Dolphin"],l,s],[/((?:android.+)crmo|crios)\/((\d+)?[\w\.]+)/i],[[r,"Chrome"],l,s],[/((?:android.+))version\/((\d+)?[\w\.]+)\smobile\ssafari/i],[[r,"Android Browser"],l,s],[/version\/((\d+)?[\w\.]+).+?mobile\/\w+\s(safari)/i],[l,s,[r,"Mobile Safari"]],[/version\/((\d+)?[\w\.]+).+?(mobile\s?safari|safari)/i],[l,s,r],[/webkit.+?(mobile\s?safari|safari)((\/[\w\.]+))/i],[r,[s,p.str,d.browser.oldsafari.major],[l,p.str,d.browser.oldsafari.version]],[/(konqueror)\/((\d+)?[\w\.]+)/i,/(webkit|khtml)\/((\d+)?[\w\.]+)/i],[r,l,s],[/(navigator|netscape)\/((\d+)?[\w\.-]+)/i],[[r,"Netscape"],l,s],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?((\d+)?[\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\/((\d+)?[\w\.-]+)/i,/(mozilla)\/((\d+)?[\w\.]+).+rv\:.+gecko\/\d+/i,/(uc\s?browser|polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|qqbrowser)[\/\s]?((\d+)?[\w\.]+)/i,/(links)\s\(((\d+)?[\w\.]+)/i,/(gobrowser)\/?((\d+)?[\w\.]+)*/i,/(ice\s?browser)\/v?((\d+)?[\w\._]+)/i,/(mosaic)[\/\s]((\d+)?[\w\.]+)/i],[r,l,s]],engine:[[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[r,l],[/rv\:([\w\.]+).*(gecko)/i],[l,r]],os:[[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*|windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[r,[l,p.str,d.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[r,"Windows"],[l,p.str,d.os.windows.version]],[/\((bb)(10);/i],[[r,"BlackBerry"],l],[/(blackberry)\w*\/?([\w\.]+)*/i,/(tizen)\/([\w\.]+)/i,/(android|webos|palm\os|qnx|bada|rim\stablet\sos|meego)[\/\s-]?([\w\.]+)*/i],[r,l],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]+)*/i],[[r,"Symbian"],l],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[r,"Firefox OS"],l],[/(nintendo|playstation)\s([wids3portablevu]+)/i,/(mint)[\/\s\(]?(\w+)*/i,/(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)[\/\s-]?([\w\.-]+)*/i,/(hurd|linux)\s?([\w\.]+)*/i,/(gnu)\s?([\w\.]+)*/i],[r,l],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[r,"Chromium OS"],l],[/(sunos)\s?([\w\.]+\d)*/i],[[r,"Solaris"],l],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]+)*/i],[r,l],[/(ip[honead]+)(?:.*os\s*([\w]+)*\slike\smac|;\sopera)/i],[[r,"iOS"],[l,/_/g,"."]],[/(mac\sos\sx)\s?([\w\s\.]+\w)*/i],[r,[l,/_/g,"."]],[/(haiku)\s(\w+)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.]*)*/i,/(macintosh|mac(?=_powerpc)|plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos)/i,/(unix)\s?([\w\.]+)*/i],[r,l]]},u=function(e){var i=e||(window&&window.navigator&&window.navigator.userAgent?window.navigator.userAgent:t);this.getBrowser=function(){return p.rgx.apply(this,h.browser)},this.getEngine=function(){return p.rgx.apply(this,h.engine)},this.getOS=function(){return p.rgx.apply(this,h.os)},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS()}},this.getUA=function(){return i},this.setUA=function(e){return i=e,this},this.setUA(i)};return(new u).getResult()}(),n=function(){var t={define_property:function(){return!1}(),create_canvas:function(){var e=document.createElement("canvas");return!(!e.getContext||!e.getContext("2d"))}(),return_response_type:function(t){try{if(-1!==e.inArray(t,["","text","document"]))return!0;if(window.XMLHttpRequest){var i=new XMLHttpRequest;if(i.open("get","/"),"responseType"in i)return i.responseType=t,i.responseType===t}}catch(e){}return!1},use_data_uri:function(){var e=new Image;return e.onload=function(){t.use_data_uri=1===e.width&&1===e.height},setTimeout(function(){e.src="data:image/gif;base64,R0lGODlhAQABAIAAAP8AAAAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw=="},1),!1}(),use_data_uri_over32kb:function(){return t.use_data_uri&&("IE"!==a.browser||a.version>=9)},use_data_uri_of:function(e){return t.use_data_uri&&33e3>e||t.use_data_uri_over32kb()},use_fileinput:function(){var e=document.createElement("input");return e.setAttribute("type","file"),!e.disabled}};return function(i){var n=[].slice.call(arguments);return n.shift(),"function"===e.typeOf(t[i])?t[i].apply(this,n):!!t[i]}}(),a={can:n,browser:i.browser.name,version:parseFloat(i.browser.major),os:i.os.name,osVersion:i.os.version,verComp:t,swf_url:"../flash/Moxie.swf",xap_url:"../silverlight/Moxie.xap",global_event_dispatcher:"moxie.core.EventTarget.instance.dispatchEvent"};return a.OS=a.os,a}),n(d,[p],function(e){var t=function(e){return"string"!=typeof e?e:document.getElementById(e)},i=function(e,t){if(!e.className)return!1;var i=new RegExp("(^|\\s+)"+t+"(\\s+|$)");return i.test(e.className)},n=function(e,t){i(e,t)||(e.className=e.className?e.className.replace(/\s+$/,"")+" "+t:t)},a=function(e,t){if(e.className){var i=new RegExp("(^|\\s+)"+t+"(\\s+|$)");e.className=e.className.replace(i,function(e,t,i){return" "===t&&" "===i?" ":""})}},o=function(e,t){return e.currentStyle?e.currentStyle[t]:window.getComputedStyle?window.getComputedStyle(e,null)[t]:void 0},s=function(t,i){function n(e){var t,i,n=0,a=0;return e&&(i=e.getBoundingClientRect(),t="CSS1Compat"===c.compatMode?c.documentElement:c.body,n=i.left+t.scrollLeft,a=i.top+t.scrollTop),{x:n,y:a}}var a,o,s,r=0,l=0,c=document;if(t=t,i=i||c.body,t&&t.getBoundingClientRect&&"IE"===e.browser&&(!c.documentMode||c.documentMode<8))return o=n(t),s=n(i),{x:o.x-s.x,y:o.y-s.y};for(a=t;a&&a!=i&&a.nodeType;)r+=a.offsetLeft||0,l+=a.offsetTop||0,a=a.offsetParent;for(a=t.parentNode;a&&a!=i&&a.nodeType;)r-=a.scrollLeft||0,l-=a.scrollTop||0,a=a.parentNode;return{x:r,y:l}},r=function(e){return{w:e.offsetWidth||e.clientWidth,h:e.offsetHeight||e.clientHeight}};return{get:t,hasClass:i,addClass:n,removeClass:a,getStyle:o,getPos:s,getSize:r}}),n(h,[r],function(e){function t(e,t){var i;for(i in e)if(e[i]===t)return i;return null}return{RuntimeError:function(){function i(e){this.code=e,this.name=t(n,e),this.message=this.name+": RuntimeError "+this.code}var n={NOT_INIT_ERR:1,NOT_SUPPORTED_ERR:9,JS_ERR:4};return e.extend(i,n),i.prototype=Error.prototype,i}(),OperationNotAllowedException:function(){function t(e){this.code=e,this.name="OperationNotAllowedException"}return e.extend(t,{NOT_ALLOWED_ERR:1}),t.prototype=Error.prototype,t}(),ImageError:function(){function i(e){this.code=e,this.name=t(n,e),this.message=this.name+": ImageError "+this.code}var n={WRONG_FORMAT:1,MAX_RESOLUTION_ERR:2};return e.extend(i,n),i.prototype=Error.prototype,i}(),FileException:function(){function i(e){this.code=e,this.name=t(n,e),this.message=this.name+": FileException "+this.code}var n={NOT_FOUND_ERR:1,SECURITY_ERR:2,ABORT_ERR:3,NOT_READABLE_ERR:4,ENCODING_ERR:5,NO_MODIFICATION_ALLOWED_ERR:6,INVALID_STATE_ERR:7,SYNTAX_ERR:8};return e.extend(i,n),i.prototype=Error.prototype,i}(),DOMException:function(){function i(e){this.code=e,this.name=t(n,e),this.message=this.name+": DOMException "+this.code}var n={INDEX_SIZE_ERR:1,DOMSTRING_SIZE_ERR:2,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,INVALID_CHARACTER_ERR:5,NO_DATA_ALLOWED_ERR:6,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INUSE_ATTRIBUTE_ERR:10,INVALID_STATE_ERR:11,SYNTAX_ERR:12,INVALID_MODIFICATION_ERR:13,NAMESPACE_ERR:14,INVALID_ACCESS_ERR:15,VALIDATION_ERR:16,TYPE_MISMATCH_ERR:17,SECURITY_ERR:18,NETWORK_ERR:19,ABORT_ERR:20,URL_MISMATCH_ERR:21,QUOTA_EXCEEDED_ERR:22,TIMEOUT_ERR:23,INVALID_NODE_TYPE_ERR:24,DATA_CLONE_ERR:25};return e.extend(i,n),i.prototype=Error.prototype,i}(),EventException:function(){function t(e){this.code=e,this.name="EventException"}return e.extend(t,{UNSPECIFIED_EVENT_TYPE_ERR:0}),t.prototype=Error.prototype,t}()}}),n(u,[h,r],function(e,t){function i(){var i={};t.extend(this,{uid:null,init:function(){this.uid||(this.uid=t.guid("uid_"))},addEventListener:function(e,n,a,o){var s,r=this;return e=t.trim(e),/\s/.test(e)?void t.each(e.split(/\s+/),function(e){r.addEventListener(e,n,a,o)}):(e=e.toLowerCase(),a=parseInt(a,10)||0,s=i[this.uid]&&i[this.uid][e]||[],s.push({fn:n,priority:a,scope:o||this}),i[this.uid]||(i[this.uid]={}),void(i[this.uid][e]=s))},hasEventListener:function(e){return e?!(!i[this.uid]||!i[this.uid][e]):!!i[this.uid]},removeEventListener:function(e,n){e=e.toLowerCase();var a,o=i[this.uid]&&i[this.uid][e];if(o){if(n){for(a=o.length-1;a>=0;a--)if(o[a].fn===n){o.splice(a,1);break}}else o=[];o.length||(delete i[this.uid][e],t.isEmptyObj(i[this.uid])&&delete i[this.uid])}},removeAllEventListeners:function(){i[this.uid]&&delete i[this.uid]},dispatchEvent:function(n){var a,o,s,r,l,c={},p=!0;if("string"!==t.typeOf(n)){if(r=n,"string"!==t.typeOf(r.type))throw new e.EventException(e.EventException.UNSPECIFIED_EVENT_TYPE_ERR);n=r.type,r.total!==l&&r.loaded!==l&&(c.total=r.total,c.loaded=r.loaded),c.async=r.async||!1}if(-1!==n.indexOf("::")?!function(e){a=e[0],n=e[1]}(n.split("::")):a=this.uid,n=n.toLowerCase(),o=i[a]&&i[a][n]){o.sort(function(e,t){return t.priority-e.priority}),s=[].slice.call(arguments),s.shift(),c.type=n,s.unshift(c);var d=[];t.each(o,function(e){s[0].target=e.scope,d.push(c.async?function(t){setTimeout(function(){t(e.fn.apply(e.scope,s)===!1)},1)}:function(t){t(e.fn.apply(e.scope,s)===!1)})}),d.length&&t.inSeries(d,function(e){p=!e})}return p},bind:function(){this.addEventListener.apply(this,arguments)},unbind:function(){this.removeEventListener.apply(this,arguments)},unbindAll:function(){this.removeAllEventListeners.apply(this,arguments)},trigger:function(){return this.dispatchEvent.apply(this,arguments)},convertEventPropsToHandlers:function(e){var i;"array"!==t.typeOf(e)&&(e=[e]);for(var n=0;n<e.length;n++)i="on"+e[n],"function"===t.typeOf(this[i])?this.addEventListener(e[n],this[i]):"undefined"===t.typeOf(this[i])&&(this[i]=null)}})}return i.instance=new i,i}),n(f,[],function(){var e=function(e){return unescape(encodeURIComponent(e))},t=function(e){return decodeURIComponent(escape(e))},i=function(e,i){if("function"==typeof window.atob)return i?t(window.atob(e)):window.atob(e);var n,a,o,s,r,l,c,p,d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",h=0,u=0,f="",g=[];if(!e)return e;e+="";do s=d.indexOf(e.charAt(h++)),r=d.indexOf(e.charAt(h++)),l=d.indexOf(e.charAt(h++)),c=d.indexOf(e.charAt(h++)),p=s<<18|r<<12|l<<6|c,n=p>>16&255,a=p>>8&255,o=255&p,g[u++]=64==l?String.fromCharCode(n):64==c?String.fromCharCode(n,a):String.fromCharCode(n,a,o);while(h<e.length);return f=g.join(""),i?t(f):f},n=function(t,i){if(i&&e(t),"function"==typeof window.btoa)return window.btoa(t);var n,a,o,s,r,l,c,p,d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",h=0,u=0,f="",g=[];if(!t)return t;do n=t.charCodeAt(h++),a=t.charCodeAt(h++),o=t.charCodeAt(h++),p=n<<16|a<<8|o,s=p>>18&63,r=p>>12&63,l=p>>6&63,c=63&p,g[u++]=d.charAt(s)+d.charAt(r)+d.charAt(l)+d.charAt(c);while(h<t.length);f=g.join("");var m=t.length%3;return(m?f.slice(0,m-3):f)+"===".slice(m||3)};return{utf8_encode:e,utf8_decode:t,atob:i,btoa:n}}),n(g,[r,d,u],function(e,t,i){function n(i,a,s,r,l){var c,p=this,d=e.guid(a+"_"),h=l||"browser";i=i||{},o[d]=this,s=e.extend({access_binary:!1,access_image_binary:!1,display_media:!1,do_cors:!1,drag_and_drop:!1,filter_by_extension:!0,resize_image:!1,report_upload_progress:!1,return_response_headers:!1,return_response_type:!1,return_status_code:!0,send_custom_headers:!1,select_file:!1,select_folder:!1,select_multiple:!0,send_binary_string:!1,send_browser_cookies:!0,send_multipart:!0,slice_blob:!1,stream_upload:!1,summon_file_dialog:!1,upload_filesize:!0,use_http_method:!0},s),i.preferred_caps&&(h=n.getMode(r,i.preferred_caps,h)),c=function(){var t={};return{exec:function(e,i,n,a){return c[i]&&(t[e]||(t[e]={context:this,instance:new c[i]}),t[e].instance[n])?t[e].instance[n].apply(this,a):void 0},removeInstance:function(e){delete t[e]},removeAllInstances:function(){var i=this;e.each(t,function(t,n){"function"===e.typeOf(t.instance.destroy)&&t.instance.destroy.call(t.context),i.removeInstance(n)})}}}(),e.extend(this,{initialized:!1,uid:d,type:a,mode:n.getMode(r,i.required_caps,h),shimid:d+"_container",clients:0,options:i,can:function(t,i){var a=arguments[2]||s;if("string"===e.typeOf(t)&&"undefined"===e.typeOf(i)&&(t=n.parseCaps(t)),"object"===e.typeOf(t)){for(var o in t)if(!this.can(o,t[o],a))return!1;return!0}return"function"===e.typeOf(a[t])?a[t].call(this,i):i===a[t]},getShimContainer:function(){var i,n=t.get(this.shimid);return n||(i=this.options.container?t.get(this.options.container):document.body,n=document.createElement("div"),n.id=this.shimid,n.className="moxie-shim moxie-shim-"+this.type,e.extend(n.style,{position:"absolute",top:"0px",left:"0px",width:"1px",height:"1px",overflow:"hidden"}),i.appendChild(n),i=null),n},getShim:function(){return c},shimExec:function(e,t){var i=[].slice.call(arguments,2);return p.getShim().exec.call(this,this.uid,e,t,i)},exec:function(e,t){var i=[].slice.call(arguments,2);return p[e]&&p[e][t]?p[e][t].apply(this,i):p.shimExec.apply(this,arguments)},destroy:function(){if(p){var e=t.get(this.shimid);e&&e.parentNode.removeChild(e),c&&c.removeAllInstances(),this.unbindAll(),delete o[this.uid],this.uid=null,d=p=c=e=null}}}),this.mode&&i.required_caps&&!this.can(i.required_caps)&&(this.mode=!1)}var a={},o={};return n.order="html5,flash,silverlight,html4",n.getRuntime=function(e){return!!o[e]&&o[e]},n.addConstructor=function(e,t){t.prototype=i.instance,a[e]=t},n.getConstructor=function(e){return a[e]||null},n.getInfo=function(e){var t=n.getRuntime(e);return t?{uid:t.uid,type:t.type,mode:t.mode,can:function(){return t.can.apply(t,arguments)}}:null},n.parseCaps=function(t){var i={};return"string"!==e.typeOf(t)?t||{}:(e.each(t.split(","),function(e){i[e]=!0}),i)},n.can=function(e,t){var i,a,o=n.getConstructor(e);return!!o&&(i=new o({required_caps:t}),a=i.mode,i.destroy(),!!a)},n.thatCan=function(e,t){var i=(t||n.order).split(/\s*,\s*/);for(var a in i)if(n.can(i[a],e))return i[a];return null},n.getMode=function(t,i,n){var a=null;if("undefined"===e.typeOf(n)&&(n="browser"),i&&!e.isEmptyObj(t)){if(e.each(i,function(i,n){if(t.hasOwnProperty(n)){var o=t[n](i);if("string"==typeof o&&(o=[o]),a){if(!(a=e.arrayIntersect(a,o)))return a=!1}else a=o}}),a)return-1!==e.inArray(n,a)?n:a[0];if(a===!1)return!1}return n},n.capTrue=function(){return!0},n.capFalse=function(){return!1},n.capTest=function(e){return function(){return!!e}},n}),n(m,[h,r,g],function(e,t,i){return function n(){var n;t.extend(this,{connectRuntime:function(a){function o(t){var s,l;return t.length?(s=t.shift(),(l=i.getConstructor(s))?(n=new l(a),n.bind("Init",function(){n.initialized=!0,setTimeout(function(){n.clients++,r.trigger("RuntimeInit",n)},1)}),n.bind("Error",function(){n.destroy(),o(t)}),n.mode?void n.init():void n.trigger("Error")):void o(t)):(r.trigger("RuntimeError",new e.RuntimeError(e.RuntimeError.NOT_INIT_ERR)),void(n=null))}var s,r=this;if("string"===t.typeOf(a)?s=a:"string"===t.typeOf(a.ruid)&&(s=a.ruid),s){if(n=i.getRuntime(s))return n.clients++,n;throw new e.RuntimeError(e.RuntimeError.NOT_INIT_ERR)}o((a.runtime_order||i.order).split(/\s*,\s*/))},getRuntime:function(){return n&&n.uid?n:(n=null,null)},disconnectRuntime:function(){n&&--n.clients<=0&&(n.destroy(),n=null)}})}}),n(y,[r,f,m],function(e,t,i){function n(o,s){function r(t,i,o){var s,r=a[this.uid];return"string"===e.typeOf(r)&&r.length?(s=new n(null,{type:o,size:i-t}),s.detach(r.substr(t,s.size)),s):null}i.call(this),o&&this.connectRuntime(o),s?"string"===e.typeOf(s)&&(s={data:s}):s={},e.extend(this,{uid:s.uid||e.guid("uid_"),ruid:o,size:s.size||0,type:s.type||"",slice:function(e,t,i){return this.isDetached()?r.apply(this,arguments):this.getRuntime().exec.call(this,"Blob","slice",this.getSource(),e,t,i)},getSource:function(){return a[this.uid]?a[this.uid]:null},detach:function(e){this.ruid&&(this.getRuntime().exec.call(this,"Blob","destroy"),this.disconnectRuntime(),this.ruid=null),e=e||"";var i=e.match(/^data:([^;]*);base64,/);i&&(this.type=i[1],e=t.atob(e.substring(e.indexOf("base64,")+7))),this.size=e.length,a[this.uid]=e},isDetached:function(){return!this.ruid&&"string"===e.typeOf(a[this.uid])},destroy:function(){this.detach(),delete a[this.uid]}}),s.data?this.detach(s.data):a[this.uid]=s}var a={};return n}),n(v,[r,c,y],function(e,t,i){function n(n,a){var o,s;if(a||(a={}),s=a.type&&""!==a.type?a.type:t.getFileMime(a.name),a.name)o=a.name.replace(/\\/g,"/"),o=o.substr(o.lastIndexOf("/")+1);else{var r=s.split("/")[0];o=e.guid((""!==r?r:"file")+"_"),t.extensions[s]&&(o+="."+t.extensions[s][0])}i.apply(this,arguments),e.extend(this,{type:s||"",name:o||e.guid("file_"),lastModifiedDate:a.lastModifiedDate||(new Date).toLocaleString()})}return n.prototype=i.prototype,n}),n(w,[r,c,d,h,u,l,v,g,m],function(e,t,i,n,a,o,s,r,l){function c(a){var c,d,h,u=this;if(-1!==e.inArray(e.typeOf(a),["string","node"])&&(a={browse_button:a}),d=i.get(a.browse_button),!d)throw new n.DOMException(n.DOMException.NOT_FOUND_ERR);h={accept:[{title:o.translate("All Files"),extensions:"*"}],name:"file",multiple:!1,required_caps:!1,container:d.parentNode||document.body},a=e.extend({},h,a),"string"==typeof a.required_caps&&(a.required_caps=r.parseCaps(a.required_caps)),"string"==typeof a.accept&&(a.accept=t.mimes2extList(a.accept)),c=i.get(a.container),c||(c=document.body),"static"===i.getStyle(c,"position")&&(c.style.position="relative"),c=d=null,l.call(u),e.extend(u,{uid:e.guid("uid_"),ruid:null,shimid:null,files:null,init:function(){u.convertEventPropsToHandlers(p),u.bind("RuntimeInit",function(t,n){u.ruid=n.uid,u.shimid=n.shimid,u.bind("Ready",function(){u.trigger("Refresh")},999),u.bind("Change",function(){var t=n.exec.call(u,"FileInput","getFiles");u.files=[],e.each(t,function(e){return 0===e.size||void u.files.push(new s(u.ruid,e))})},999),u.bind("Refresh",function(){var t,o,s,r;s=i.get(a.browse_button),r=i.get(n.shimid),s&&(t=i.getPos(s,i.get(a.container)),o=i.getSize(s),r&&e.extend(r.style,{top:t.y+"px",left:t.x+"px",width:o.w+"px",height:o.h+"px"})),r=s=null}),n.exec.call(u,"FileInput","init",a)}),u.connectRuntime(e.extend({},a,{required_caps:{select_file:!0}}))},disable:function(t){var i=this.getRuntime();i&&i.exec.call(this,"FileInput","disable","undefined"===e.typeOf(t)||t)},refresh:function(){u.trigger("Refresh")},destroy:function(){var t=this.getRuntime();t&&(t.exec.call(this,"FileInput","destroy"),this.disconnectRuntime()),"array"===e.typeOf(this.files)&&e.each(this.files,function(e){e.destroy()}),this.files=null}})}var p=["ready","change","cancel","mouseenter","mouseleave","mousedown","mouseup"];return c.prototype=a.instance,c}),n(x,[l,d,h,r,v,m,u,c],function(e,t,i,n,a,o,s,r){function l(i){var s,l=this;"string"==typeof i&&(i={drop_zone:i}),s={accept:[{title:e.translate("All Files"),extensions:"*"}],required_caps:{drag_and_drop:!0}},i="object"==typeof i?n.extend({},s,i):s,i.container=t.get(i.drop_zone)||document.body,"static"===t.getStyle(i.container,"position")&&(i.container.style.position="relative"),"string"==typeof i.accept&&(i.accept=r.mimes2extList(i.accept)),o.call(l),n.extend(l,{uid:n.guid("uid_"),ruid:null,files:null,init:function(){l.convertEventPropsToHandlers(c),l.bind("RuntimeInit",function(e,t){l.ruid=t.uid,l.bind("Drop",function(){var e=t.exec.call(l,"FileDrop","getFiles");l.files=[],n.each(e,function(e){l.files.push(new a(l.ruid,e))})},999),t.exec.call(l,"FileDrop","init",i),l.dispatchEvent("ready")}),l.connectRuntime(i)},destroy:function(){var e=this.getRuntime();e&&(e.exec.call(this,"FileDrop","destroy"),this.disconnectRuntime()),this.files=null}})}var c=["ready","dragenter","dragleave","drop","error"];return l.prototype=s.instance,l}),n(b,[r,m,u],function(e,t,i){function n(){this.uid=e.guid("uid_"),t.call(this),this.destroy=function(){this.disconnectRuntime(),this.unbindAll()}}return n.prototype=i.instance,n}),n(_,[r,f,h,u,y,v,b],function(e,t,i,n,a,o,s){function r(){function n(e,n){function p(e){c.readyState=r.DONE,c.error=e,c.trigger("error"),d()}function d(){o.destroy(),o=null,c.trigger("loadend")}function h(t){o.bind("Error",function(e,t){p(t)}),o.bind("Progress",function(e){c.result=t.exec.call(o,"FileReader","getResult"),c.trigger(e)}),o.bind("Load",function(e){c.readyState=r.DONE,c.result=t.exec.call(o,"FileReader","getResult"),c.trigger(e),d()}),t.exec.call(o,"FileReader","read",e,n)}if(o=new s,this.convertEventPropsToHandlers(l),this.readyState===r.LOADING)return p(new i.DOMException(i.DOMException.INVALID_STATE_ERR));if(this.readyState=r.LOADING,this.trigger("loadstart"),n instanceof a)if(n.isDetached()){var u=n.getSource();switch(e){case"readAsText":case"readAsBinaryString":this.result=u;break;case"readAsDataURL":this.result="data:"+n.type+";base64,"+t.btoa(u)}this.readyState=r.DONE,this.trigger("load"),d()}else h(o.connectRuntime(n.ruid));else p(new i.DOMException(i.DOMException.NOT_FOUND_ERR))}var o,c=this;e.extend(this,{uid:e.guid("uid_"),readyState:r.EMPTY,result:null,error:null,readAsBinaryString:function(e){n.call(this,"readAsBinaryString",e)},readAsDataURL:function(e){n.call(this,"readAsDataURL",e)},readAsText:function(e){n.call(this,"readAsText",e)},abort:function(){this.result=null,-1===e.inArray(this.readyState,[r.EMPTY,r.DONE])&&(this.readyState===r.LOADING&&(this.readyState=r.DONE),o&&o.getRuntime().exec.call(this,"FileReader","abort"),this.trigger("abort"),this.trigger("loadend"))},destroy:function(){this.abort(),o&&(o.getRuntime().exec.call(this,"FileReader","destroy"),o.disconnectRuntime()),c=o=null}})}var l=["loadstart","progress","load","abort","error","loadend"];return r.EMPTY=0,r.LOADING=1,r.DONE=2,r.prototype=n.instance,r}),n(D,[],function(){var e=function(t,i){for(var n=["source","scheme","authority","userInfo","user","pass","host","port","relative","path","directory","file","query","fragment"],a=n.length,o={http:80,https:443},s={},r=/^(?:([^:\/?#]+):)?(?:\/\/()(?:(?:()(?:([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?()(?:(()(?:(?:[^?#\/]*\/)*)()(?:[^?#]*))(?:\\?([^#]*))?(?:#(.*))?)/,l=r.exec(t||"");a--;)l[a]&&(s[n[a]]=l[a]);if(!s.scheme){i&&"string"!=typeof i||(i=e(i||document.location.href)),s.scheme=i.scheme,s.host=i.host,s.port=i.port;var c="";/^[^\/]/.test(s.path)&&(c=i.path,/(\/|\/[^\.]+)$/.test(c)?c+="/":c=c.replace(/\/[^\/]+$/,"/")),s.path=c+(s.path||"")}return s.port||(s.port=o[s.scheme]||80),s.port=parseInt(s.port,10),s.path||(s.path="/"),delete s.source,s},t=function(t){var i={http:80,https:443},n=e(t);return n.scheme+"://"+n.host+(n.port!==i[n.scheme]?":"+n.port:"")+n.path+(n.query?n.query:"")},i=function(t){function i(e){return[e.scheme,e.host,e.port].join("/")}return"string"==typeof t&&(t=e(t)),i(e())===i(t)};return{parseUrl:e,resolveUrl:t,hasSameOrigin:i}}),n(I,[r,m,f],function(e,t,i){return function(){function n(e,t){if(!t.isDetached()){var n=this.connectRuntime(t.ruid).exec.call(this,"FileReaderSync","read",e,t);return this.disconnectRuntime(),n}var a=t.getSource();switch(e){case"readAsBinaryString":return a;case"readAsDataURL":return"data:"+t.type+";base64,"+i.btoa(a);case"readAsText":for(var o="",s=0,r=a.length;r>s;s++)o+=String.fromCharCode(a[s]);return o}}t.call(this),e.extend(this,{uid:e.guid("uid_"),readAsBinaryString:function(e){return n.call(this,"readAsBinaryString",e)},readAsDataURL:function(e){return n.call(this,"readAsDataURL",e)},readAsText:function(e){return n.call(this,"readAsText",e)}})}}),n(S,[h,r,y],function(e,t,i){function n(){var e,n=[];t.extend(this,{append:function(a,o){var s=this,r=t.typeOf(o);o instanceof i?e={name:a,value:o}:"array"===r?(a+="[]",t.each(o,function(e){s.append(a,e)})):"object"===r?t.each(o,function(e,t){s.append(a+"["+t+"]",e)}):"null"===r||"undefined"===r||"number"===r&&isNaN(o)?s.append(a,"false"):n.push({name:a,value:o.toString()})},hasBlob:function(){return!!this.getBlob()},getBlob:function(){return e&&e.value||null},getBlobName:function(){return e&&e.name||null},each:function(i){t.each(n,function(e){i(e.value,e.name)}),e&&i(e.value,e.name)},destroy:function(){e=null,n=[]}})}return n}),n(C,[r,h,u,f,D,g,b,y,I,S,p,c],function(e,t,i,n,a,o,s,r,l,c,p,d){function h(){this.uid=e.guid("uid_")}function u(){function i(e,t){return C.hasOwnProperty(e)?1===arguments.length?p.can("define_property")?C[e]:S[e]:void(p.can("define_property")?C[e]=t:S[e]=t):void 0}function l(t){function n(){D&&(D.destroy(),D=null),r.dispatchEvent("loadend"),r=null}function a(a){D.bind("LoadStart",function(e){i("readyState",u.LOADING),r.dispatchEvent("readystatechange"),r.dispatchEvent(e),E&&r.upload.dispatchEvent(e)}),D.bind("Progress",function(e){i("readyState")!==u.LOADING&&(i("readyState",u.LOADING),r.dispatchEvent("readystatechange")),r.dispatchEvent(e)}),D.bind("UploadProgress",function(e){E&&r.upload.dispatchEvent({type:"progress",lengthComputable:!1,total:e.total,loaded:e.loaded})}),D.bind("Load",function(t){i("readyState",u.DONE),i("status",Number(a.exec.call(D,"XMLHttpRequest","getStatus")||0)),i("statusText",f[i("status")]||""),i("response",a.exec.call(D,"XMLHttpRequest","getResponse",i("responseType"))),~e.inArray(i("responseType"),["text",""])?i("responseText",i("response")):"document"===i("responseType")&&i("responseXML",i("response")),B=a.exec.call(D,"XMLHttpRequest","getAllResponseHeaders"),r.dispatchEvent("readystatechange"),i("status")>0?(E&&r.upload.dispatchEvent(t),r.dispatchEvent(t)):(M=!0,r.dispatchEvent("error")),n()}),D.bind("Abort",function(e){r.dispatchEvent(e),n()}),D.bind("Error",function(e){M=!0,i("readyState",u.DONE),r.dispatchEvent("readystatechange"),P=!0,r.dispatchEvent(e),n()}),a.exec.call(D,"XMLHttpRequest","send",{url:y,method:v,async:T,user:w,password:x,headers:k,mimeType:$,encoding:R,responseType:r.responseType,withCredentials:r.withCredentials,options:O},t)}var r=this;b=(new Date).getTime(),D=new s,"string"==typeof O.required_caps&&(O.required_caps=o.parseCaps(O.required_caps)),O.required_caps=e.extend({},O.required_caps,{return_response_type:r.responseType}),t instanceof c&&(O.required_caps.send_multipart=!0),N||(O.required_caps.do_cors=!0),O.ruid?a(D.connectRuntime(O)):(D.bind("RuntimeInit",function(e,t){a(t)}),D.bind("RuntimeError",function(e,t){r.dispatchEvent("RuntimeError",t)}),D.connectRuntime(O))}function m(){i("responseText",""),i("responseXML",null),i("response",null),i("status",0),i("statusText",""),b=_=null}var y,v,w,x,b,_,D,I,S=this,C={timeout:0,readyState:u.UNSENT,withCredentials:!1,status:0,statusText:"",responseType:"",responseXML:null,responseText:null,response:null},T=!0,k={},R=null,$=null,L=!1,A=!1,E=!1,P=!1,M=!1,N=!1,F=null,W=null,O={},B="";e.extend(this,C,{uid:e.guid("uid_"),upload:new h,open:function(o,s,r,l,c){var p;if(!o||!s)throw new t.DOMException(t.DOMException.SYNTAX_ERR);if(/[\u0100-\uffff]/.test(o)||n.utf8_encode(o)!==o)throw new t.DOMException(t.DOMException.SYNTAX_ERR);if(~e.inArray(o.toUpperCase(),["CONNECT","DELETE","GET","HEAD","OPTIONS","POST","PUT","TRACE","TRACK"])&&(v=o.toUpperCase()),~e.inArray(v,["CONNECT","TRACE","TRACK"]))throw new t.DOMException(t.DOMException.SECURITY_ERR);if(s=n.utf8_encode(s),p=a.parseUrl(s),N=a.hasSameOrigin(p),y=a.resolveUrl(s),(l||c)&&!N)throw new t.DOMException(t.DOMException.INVALID_ACCESS_ERR);if(w=l||p.user,x=c||p.pass,T=r||!0,T===!1&&(i("timeout")||i("withCredentials")||""!==i("responseType")))throw new t.DOMException(t.DOMException.INVALID_ACCESS_ERR);L=!T,A=!1,k={},m.call(this),i("readyState",u.OPENED),this.convertEventPropsToHandlers(["readystatechange"]),this.dispatchEvent("readystatechange")},setRequestHeader:function(a,o){var s=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","content-transfer-encoding","date","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","user-agent","via"];if(i("readyState")!==u.OPENED||A)throw new t.DOMException(t.DOMException.INVALID_STATE_ERR);if(/[\u0100-\uffff]/.test(a)||n.utf8_encode(a)!==a)throw new t.DOMException(t.DOMException.SYNTAX_ERR);return a=e.trim(a).toLowerCase(),!~e.inArray(a,s)&&!/^(proxy\-|sec\-)/.test(a)&&(k[a]?k[a]+=", "+o:k[a]=o,!0)},getAllResponseHeaders:function(){return B||""},getResponseHeader:function(t){return t=t.toLowerCase(),M||~e.inArray(t,["set-cookie","set-cookie2"])?null:B&&""!==B&&(I||(I={},e.each(B.split(/\r\n/),function(t){var i=t.split(/:\s+/);2===i.length&&(i[0]=e.trim(i[0]),I[i[0].toLowerCase()]={header:i[0],value:e.trim(i[1])})})),I.hasOwnProperty(t))?I[t].header+": "+I[t].value:null},overrideMimeType:function(n){var a,o;if(~e.inArray(i("readyState"),[u.LOADING,u.DONE]))throw new t.DOMException(t.DOMException.INVALID_STATE_ERR);if(n=e.trim(n.toLowerCase()),/;/.test(n)&&(a=n.match(/^([^;]+)(?:;\scharset\=)?(.*)$/))&&(n=a[1],a[2]&&(o=a[2])),!d.mimes[n])throw new t.DOMException(t.DOMException.SYNTAX_ERR);F=n,W=o},send:function(i,a){if(O="string"===e.typeOf(a)?{ruid:a}:a?a:{},this.convertEventPropsToHandlers(g),
this.upload.convertEventPropsToHandlers(g),this.readyState!==u.OPENED||A)throw new t.DOMException(t.DOMException.INVALID_STATE_ERR);if(i instanceof r)O.ruid=i.ruid,$=i.type||"application/octet-stream";else if(i instanceof c){if(i.hasBlob()){var o=i.getBlob();O.ruid=o.ruid,$=o.type||"application/octet-stream"}}else"string"==typeof i&&(R="UTF-8",$="text/plain;charset=UTF-8",i=n.utf8_encode(i));this.withCredentials||(this.withCredentials=O.required_caps&&O.required_caps.send_browser_cookies&&!N),E=!L&&this.upload.hasEventListener(),M=!1,P=!i,L||(A=!0),l.call(this,i)},abort:function(){if(M=!0,L=!1,~e.inArray(i("readyState"),[u.UNSENT,u.OPENED,u.DONE]))i("readyState",u.UNSENT);else{if(i("readyState",u.DONE),A=!1,!D)throw new t.DOMException(t.DOMException.INVALID_STATE_ERR);D.getRuntime().exec.call(D,"XMLHttpRequest","abort",P),P=!0}},destroy:function(){D&&("function"===e.typeOf(D.destroy)&&D.destroy(),D=null),this.unbindAll(),this.upload&&(this.upload.unbindAll(),this.upload=null)}})}var f={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",306:"Reserved",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",426:"Upgrade Required",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",510:"Not Extended"};h.prototype=i.instance;var g=["loadstart","progress","abort","error","load","timeout","loadend"];return u.UNSENT=0,u.OPENED=1,u.HEADERS_RECEIVED=2,u.LOADING=3,u.DONE=4,u.prototype=i.instance,u}),n(T,[r,f,m,u],function(e,t,i,n){function a(){function n(){p=d=0,c=this.result=null}function o(t,i){var n=this;l=i,n.bind("TransportingProgress",function(t){d=t.loaded,p>d&&-1===e.inArray(n.state,[a.IDLE,a.DONE])&&s.call(n)},999),n.bind("TransportingComplete",function(){d=p,n.state=a.DONE,c=null,n.result=l.exec.call(n,"Transporter","getAsBlob",t||"")},999),n.state=a.BUSY,n.trigger("TransportingStarted"),s.call(n)}function s(){var e,i=this,n=p-d;h>n&&(h=n),e=t.btoa(c.substr(d,h)),l.exec.call(i,"Transporter","receive",e,p)}var r,l,c,p,d,h;i.call(this),e.extend(this,{uid:e.guid("uid_"),state:a.IDLE,result:null,transport:function(t,i,a){var s=this;if(a=e.extend({chunk_size:204798},a),(r=a.chunk_size%3)&&(a.chunk_size+=3-r),h=a.chunk_size,n.call(this),c=t,p=t.length,"string"===e.typeOf(a)||a.ruid)o.call(s,i,this.connectRuntime(a));else{var l=function(e,t){s.unbind("RuntimeInit",l),o.call(s,i,t)};this.bind("RuntimeInit",l),this.connectRuntime(a)}},abort:function(){var e=this;e.state=a.IDLE,l&&(l.exec.call(e,"Transporter","clear"),e.trigger("TransportingAborted")),n.call(e)},destroy:function(){this.unbindAll(),l=null,this.disconnectRuntime(),n.call(this)}})}return a.IDLE=0,a.BUSY=1,a.DONE=2,a.prototype=n.instance,a}),n(k,[r,d,h,I,C,g,m,T,p,u,y,v,f],function(e,t,i,n,a,o,s,r,l,c,p,d,h){function u(){function n(e){e||(e=this.getRuntime().exec.call(this,"Image","getInfo")),this.size=e.size,this.width=e.width,this.height=e.height,this.type=e.type,this.meta=e.meta,""===this.name&&(this.name=e.name)}function c(t){var n=e.typeOf(t);try{if(t instanceof u){if(!t.size)throw new i.DOMException(i.DOMException.INVALID_STATE_ERR);g.apply(this,arguments)}else if(t instanceof p){if(!~e.inArray(t.type,["image/jpeg","image/png"]))throw new i.ImageError(i.ImageError.WRONG_FORMAT);m.apply(this,arguments)}else if(-1!==e.inArray(n,["blob","file"]))c.call(this,new d(null,t),arguments[1]);else if("string"===n)/^data:[^;]*;base64,/.test(t)?c.call(this,new p(null,{data:t}),arguments[1]):y.apply(this,arguments);else{if("node"!==n||"img"!==t.nodeName.toLowerCase())throw new i.DOMException(i.DOMException.TYPE_MISMATCH_ERR);c.call(this,t.src,arguments[1])}}catch(e){this.trigger("error",e.code)}}function g(t,i){var n=this.connectRuntime(t.ruid);this.ruid=n.uid,n.exec.call(this,"Image","loadFromImage",t,"undefined"===e.typeOf(i)||i)}function m(t,i){function n(e){a.ruid=e.uid,e.exec.call(a,"Image","loadFromBlob",t)}var a=this;a.name=t.name||"",t.isDetached()?(this.bind("RuntimeInit",function(e,t){n(t)}),i&&"string"==typeof i.required_caps&&(i.required_caps=o.parseCaps(i.required_caps)),this.connectRuntime(e.extend({required_caps:{access_image_binary:!0,resize_image:!0}},i))):n(this.connectRuntime(t.ruid))}function y(e,t){var i,n=this;i=new a,i.open("get",e),i.responseType="blob",i.onprogress=function(e){n.trigger(e)},i.onload=function(){m.call(n,i.response,!0)},i.onerror=function(e){n.trigger(e)},i.onloadend=function(){i.destroy()},i.bind("RuntimeError",function(e,t){n.trigger("RuntimeError",t)}),i.send(null,t)}s.call(this),e.extend(this,{uid:e.guid("uid_"),ruid:null,name:"",size:0,width:0,height:0,type:"",meta:{},clone:function(){this.load.apply(this,arguments)},load:function(){this.bind("Load Resize",function(){n.call(this)},999),this.convertEventPropsToHandlers(f),c.apply(this,arguments)},downsize:function(t){var n={width:this.width,height:this.height,crop:!1,preserveHeaders:!0};t="object"==typeof t?e.extend(n,t):e.extend(n,{width:arguments[0],height:arguments[1],crop:arguments[2],preserveHeaders:arguments[3]});try{if(!this.size)throw new i.DOMException(i.DOMException.INVALID_STATE_ERR);if(this.width>u.MAX_RESIZE_WIDTH||this.height>u.MAX_RESIZE_HEIGHT)throw new i.ImageError(i.ImageError.MAX_RESOLUTION_ERR);this.getRuntime().exec.call(this,"Image","downsize",t.width,t.height,t.crop,t.preserveHeaders)}catch(e){this.trigger("error",e.code)}},crop:function(e,t,i){this.downsize(e,t,!0,i)},getAsCanvas:function(){if(!l.can("create_canvas"))throw new i.RuntimeError(i.RuntimeError.NOT_SUPPORTED_ERR);var e=this.connectRuntime(this.ruid);return e.exec.call(this,"Image","getAsCanvas")},getAsBlob:function(e,t){if(!this.size)throw new i.DOMException(i.DOMException.INVALID_STATE_ERR);return e||(e="image/jpeg"),"image/jpeg"!==e||t||(t=90),this.getRuntime().exec.call(this,"Image","getAsBlob",e,t)},getAsDataURL:function(e,t){if(!this.size)throw new i.DOMException(i.DOMException.INVALID_STATE_ERR);return this.getRuntime().exec.call(this,"Image","getAsDataURL",e,t)},getAsBinaryString:function(e,t){var i=this.getAsDataURL(e,t);return h.atob(i.substring(i.indexOf("base64,")+7))},embed:function(n){function a(){if(l.can("create_canvas")){var t=o.getAsCanvas();if(t)return n.appendChild(t),t=null,o.destroy(),void f.trigger("embedded")}var a=o.getAsDataURL(s,c);if(!a)throw new i.ImageError(i.ImageError.WRONG_FORMAT);if(l.can("use_data_uri_of",a.length))n.innerHTML='<img src="'+a+'" width="'+o.width+'" height="'+o.height+'" />',o.destroy(),f.trigger("embedded");else{var p=new r;p.bind("TransportingComplete",function(){d=f.connectRuntime(this.result.ruid),f.bind("Embedded",function(){e.extend(d.getShimContainer().style,{top:"0px",left:"0px",width:o.width+"px",height:o.height+"px"}),d=null},999),d.exec.call(f,"ImageView","display",this.result.uid,m,y),o.destroy()}),p.transport(h.atob(a.substring(a.indexOf("base64,")+7)),s,e.extend({},g,{required_caps:{display_media:!0},runtime_order:"flash,silverlight",container:n}))}}var o,s,c,p,d,f=this,g=arguments[1]||{},m=this.width,y=this.height;try{if(!(n=t.get(n)))throw new i.DOMException(i.DOMException.INVALID_NODE_TYPE_ERR);if(!this.size)throw new i.DOMException(i.DOMException.INVALID_STATE_ERR);if(this.width>u.MAX_RESIZE_WIDTH||this.height>u.MAX_RESIZE_HEIGHT)throw new i.ImageError(i.ImageError.MAX_RESOLUTION_ERR);if(s=g.type||this.type||"image/jpeg",c=g.quality||90,p="undefined"!==e.typeOf(g.crop)&&g.crop,g.width)m=g.width,y=g.height||m;else{var v=t.getSize(n);v.w&&v.h&&(m=v.w,y=v.h)}return o=new u,o.bind("Resize",function(){a.call(f)}),o.bind("Load",function(){o.downsize(m,y,p,!1)}),o.clone(this,!1),o}catch(e){this.trigger("error",e.code)}},destroy:function(){this.ruid&&(this.getRuntime().exec.call(this,"Image","destroy"),this.disconnectRuntime()),this.unbindAll()}})}var f=["progress","load","error","resize","embedded"];return u.MAX_RESIZE_WIDTH=6500,u.MAX_RESIZE_HEIGHT=6500,u.prototype=c.instance,u}),n(R,[r,h,g,p],function(e,t,i,n){function a(t){var a=this,r=i.capTest,l=i.capTrue,c=e.extend({access_binary:r(window.FileReader||window.File&&window.File.getAsDataURL),access_image_binary:function(){return a.can("access_binary")&&!!s.Image},display_media:r(n.can("create_canvas")||n.can("use_data_uri_over32kb")),do_cors:r(window.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest),drag_and_drop:r(function(){var e=document.createElement("div");return("draggable"in e||"ondragstart"in e&&"ondrop"in e)&&("IE"!==n.browser||n.version>9)}()),filter_by_extension:r(function(){return"Chrome"===n.browser&&n.version>=28||"IE"===n.browser&&n.version>=10}()),return_response_headers:l,return_response_type:function(e){return!("json"!==e||!window.JSON)||n.can("return_response_type",e)},return_status_code:l,report_upload_progress:r(window.XMLHttpRequest&&(new XMLHttpRequest).upload),resize_image:function(){return a.can("access_binary")&&n.can("create_canvas")},select_file:function(){return n.can("use_fileinput")&&window.File},select_folder:function(){return a.can("select_file")&&"Chrome"===n.browser&&n.version>=21},select_multiple:function(){return!(!a.can("select_file")||"Safari"===n.browser&&"Windows"===n.os||"iOS"===n.os&&n.verComp(n.osVersion,"7.0.4","<"))},send_binary_string:r(window.XMLHttpRequest&&((new XMLHttpRequest).sendAsBinary||window.Uint8Array&&window.ArrayBuffer)),send_custom_headers:r(window.XMLHttpRequest),send_multipart:function(){return!!(window.XMLHttpRequest&&(new XMLHttpRequest).upload&&window.FormData)||a.can("send_binary_string")},slice_blob:r(window.File&&(File.prototype.mozSlice||File.prototype.webkitSlice||File.prototype.slice)),stream_upload:function(){return a.can("slice_blob")&&a.can("send_multipart")},summon_file_dialog:r(function(){return"Firefox"===n.browser&&n.version>=4||"Opera"===n.browser&&n.version>=12||"IE"===n.browser&&n.version>=10||!!~e.inArray(n.browser,["Chrome","Safari"])}()),upload_filesize:l},arguments[2]);i.call(this,t,arguments[1]||o,c),e.extend(this,{init:function(){this.trigger("Init")},destroy:function(e){return function(){e.call(a),e=a=null}}(this.destroy)}),e.extend(this.getShim(),s)}var o="html5",s={};return i.addConstructor(o,a),s}),n($,[R,y],function(e,t){function i(){function e(e,t,i){var n;if(!window.File.prototype.slice)return(n=window.File.prototype.webkitSlice||window.File.prototype.mozSlice)?n.call(e,t,i):null;try{return e.slice(),e.slice(t,i)}catch(n){return e.slice(t,i-t)}}this.slice=function(){return new t(this.getRuntime().uid,e.apply(this,arguments))}}return e.Blob=i}),n(L,[r],function(e){function t(){this.returnValue=!1}function i(){this.cancelBubble=!0}var n={},a="moxie_"+e.guid(),o=function(o,s,r,l){var c,p;s=s.toLowerCase(),o.addEventListener?(c=r,o.addEventListener(s,c,!1)):o.attachEvent&&(c=function(){var e=window.event;e.target||(e.target=e.srcElement),e.preventDefault=t,e.stopPropagation=i,r(e)},o.attachEvent("on"+s,c)),o[a]||(o[a]=e.guid()),n.hasOwnProperty(o[a])||(n[o[a]]={}),p=n[o[a]],p.hasOwnProperty(s)||(p[s]=[]),p[s].push({func:c,orig:r,key:l})},s=function(t,i,o){var s,r;if(i=i.toLowerCase(),t[a]&&n[t[a]]&&n[t[a]][i]){s=n[t[a]][i];for(var l=s.length-1;l>=0&&(s[l].orig!==o&&s[l].key!==o||(t.removeEventListener?t.removeEventListener(i,s[l].func,!1):t.detachEvent&&t.detachEvent("on"+i,s[l].func),s[l].orig=null,s[l].func=null,s.splice(l,1),o===r));l--);if(s.length||delete n[t[a]][i],e.isEmptyObj(n[t[a]])){delete n[t[a]];try{delete t[a]}catch(e){t[a]=r}}}},r=function(t,i){t&&t[a]&&e.each(n[t[a]],function(e,n){s(t,n,i)})};return{addEvent:o,removeEvent:s,removeAllEvents:r}}),n(A,[R,r,d,L,c,p],function(e,t,i,n,a,o){function s(){var e,s=[];t.extend(this,{init:function(r){var l,c,p,d,h,u,f=this,g=f.getRuntime();e=r,s=[],p=e.accept.mimes||a.extList2mimes(e.accept,g.can("filter_by_extension")),c=g.getShimContainer(),c.innerHTML='<input id="'+g.uid+'" type="file" style="font-size:999px;opacity:0;"'+(e.multiple&&g.can("select_multiple")?"multiple":"")+(e.directory&&g.can("select_folder")?"webkitdirectory directory":"")+(p?' accept="'+p.join(",")+'"':"")+" />",l=i.get(g.uid),t.extend(l.style,{position:"absolute",top:0,left:0,width:"100%",height:"100%"}),d=i.get(e.browse_button),g.can("summon_file_dialog")&&("static"===i.getStyle(d,"position")&&(d.style.position="relative"),h=parseInt(i.getStyle(d,"z-index"),10)||1,d.style.zIndex=h,c.style.zIndex=h-1,n.addEvent(d,"click",function(e){var t=i.get(g.uid);t&&!t.disabled,e.preventDefault()},f.uid)),u=g.can("summon_file_dialog")?d:c,n.addEvent(u,"mouseover",function(){f.trigger("mouseenter")},f.uid),n.addEvent(u,"mouseout",function(){f.trigger("mouseleave")},f.uid),n.addEvent(u,"mousedown",function(){f.trigger("mousedown")},f.uid),n.addEvent(i.get(e.container),"mouseup",function(){f.trigger("mouseup")},f.uid),l.onchange=function i(){if(s=[],e.directory?t.each(this.files,function(e){"."!==e.name&&s.push(e)}):s=[].slice.call(this.files),"IE"!==o.browser&&"IEMobile"!==o.browser)this.value="";else{var n=this.cloneNode(!0);this.parentNode.replaceChild(n,this),n.onchange=i}f.trigger("change")},f.trigger({type:"ready",async:!0}),c=null},getFiles:function(){return s},disable:function(e){var t,n=this.getRuntime();(t=i.get(n.uid))&&(t.disabled=!!e)},destroy:function(){var t=this.getRuntime(),a=t.getShim(),o=t.getShimContainer();n.removeAllEvents(o,this.uid),n.removeAllEvents(e&&i.get(e.container),this.uid),n.removeAllEvents(e&&i.get(e.browse_button),this.uid),o&&(o.innerHTML=""),a.removeInstance(this.uid),s=e=o=a=null}})}return e.FileInput=s}),n(E,[R,r,d,L,c],function(e,t,i,n,a){function o(){function e(e){if(!e.dataTransfer||!e.dataTransfer.types)return!1;var i=t.toArray(e.dataTransfer.types||[]);return-1!==t.inArray("Files",i)||-1!==t.inArray("public.file-url",i)||-1!==t.inArray("application/x-moz-file",i)}function o(e){for(var i=[],n=0;n<e.length;n++)[].push.apply(i,e[n].extensions.split(/\s*,\s*/));return-1===t.inArray("*",i)?i:[]}function s(e){if(!u.length)return!0;var i=a.getFileExtension(e.name);return!i||-1!==t.inArray(i,u)}function r(e,i){var n=[];t.each(e,function(e){var t=e.webkitGetAsEntry();if(t)if(t.isFile){var i=e.getAsFile();s(i)&&h.push(i)}else n.push(t)}),n.length?l(n,i):i()}function l(e,i){var n=[];t.each(e,function(e){n.push(function(t){c(e,t)})}),t.inSeries(n,function(){i()})}function c(e,t){e.isFile?e.file(function(e){s(e)&&h.push(e),t()},function(){t()}):e.isDirectory?p(e,t):t()}function p(e,t){function i(e){a.readEntries(function(t){t.length?([].push.apply(n,t),i(e)):e()},e)}var n=[],a=e.createReader();i(function(){l(n,t)})}var d,h=[],u=[];t.extend(this,{init:function(i){var a,l=this;d=i,u=o(d.accept),a=d.container,n.addEvent(a,"dragover",function(t){e(t)&&(t.preventDefault(),t.dataTransfer.dropEffect="copy")},l.uid),n.addEvent(a,"drop",function(i){e(i)&&(i.preventDefault(),h=[],i.dataTransfer.items&&i.dataTransfer.items[0].webkitGetAsEntry?r(i.dataTransfer.items,function(){l.trigger("drop")}):(t.each(i.dataTransfer.files,function(e){s(e)&&h.push(e)}),l.trigger("drop")))},l.uid),n.addEvent(a,"dragenter",function(e){l.trigger("dragenter")},l.uid),n.addEvent(a,"dragleave",function(e){l.trigger("dragleave")},l.uid)},getFiles:function(){return h},destroy:function(){n.removeAllEvents(d&&i.get(d.container),this.uid),h=u=d=null}})}return e.FileDrop=o}),n(P,[R,f,r],function(e,t,i){function n(){function e(e){return t.atob(e.substring(e.indexOf("base64,")+7))}var n,a=!1;i.extend(this,{read:function(e,t){var o=this;n=new window.FileReader,n.addEventListener("progress",function(e){o.trigger(e)}),n.addEventListener("load",function(e){o.trigger(e)}),n.addEventListener("error",function(e){o.trigger(e,n.error)}),n.addEventListener("loadend",function(){n=null}),"function"===i.typeOf(n[e])?(a=!1,n[e](t.getSource())):"readAsBinaryString"===e&&(a=!0,n.readAsDataURL(t.getSource()))},getResult:function(){return n&&n.result?a?e(n.result):n.result:null},abort:function(){n&&n.abort()},destroy:function(){n=null}})}return e.FileReader=n}),n(M,[R,r,c,D,v,y,S,h,p],function(e,t,i,n,a,o,s,r,l){function c(){function e(e,t){var i,n,a=this;i=t.getBlob().getSource(),n=new window.FileReader,n.onload=function(){t.append(t.getBlobName(),new o(null,{type:i.type,data:n.result})),f.send.call(a,e,t)},n.readAsBinaryString(i)}function c(){return!window.XMLHttpRequest||"IE"===l.browser&&l.version<8?function(){for(var e=["Msxml2.XMLHTTP.6.0","Microsoft.XMLHTTP"],t=0;t<e.length;t++)try{return new ActiveXObject(e[t])}catch(e){}}():new window.XMLHttpRequest}function p(e){var t=e.responseXML,i=e.responseText;return"IE"===l.browser&&i&&t&&!t.documentElement&&/[^\/]+\/[^\+]+\+xml/.test(e.getResponseHeader("Content-Type"))&&(t=new window.ActiveXObject("Microsoft.XMLDOM"),t.async=!1,t.validateOnParse=!1,t.loadXML(i)),t&&("IE"===l.browser&&0!==t.parseError||!t.documentElement||"parsererror"===t.documentElement.tagName)?null:t}function d(e){var t="----moxieboundary"+(new Date).getTime(),i="--",n="\r\n",a="",s=this.getRuntime();if(!s.can("send_binary_string"))throw new r.RuntimeError(r.RuntimeError.NOT_SUPPORTED_ERR);return h.setRequestHeader("Content-Type","multipart/form-data; boundary="+t),e.each(function(e,s){a+=e instanceof o?i+t+n+'Content-Disposition: form-data; name="'+s+'"; filename="'+unescape(encodeURIComponent(e.name||"blob"))+'"'+n+"Content-Type: "+(e.type||"application/octet-stream")+n+n+e.getSource()+n:i+t+n+'Content-Disposition: form-data; name="'+s+'"'+n+n+unescape(encodeURIComponent(e))+n}),a+=i+t+i+n}var h,u,f=this;t.extend(this,{send:function(i,a){var r=this,p="Mozilla"===l.browser&&l.version>=4&&l.version<7,f="Android Browser"===l.browser,g=!1;if(u=i.url.replace(/^.+?\/([\w\-\.]+)$/,"$1").toLowerCase(),h=c(),h.open(i.method,i.url,i.async,i.user,i.password),a instanceof o)a.isDetached()&&(g=!0),a=a.getSource();else if(a instanceof s){if(a.hasBlob())if(a.getBlob().isDetached())a=d.call(r,a),g=!0;else if((p||f)&&"blob"===t.typeOf(a.getBlob().getSource())&&window.FileReader)return void e.call(r,i,a);if(a instanceof s){var m=new window.FormData;a.each(function(e,t){e instanceof o?m.append(t,e.getSource()):m.append(t,e)}),a=m}}h.upload?(i.withCredentials&&(h.withCredentials=!0),h.addEventListener("load",function(e){r.trigger(e)}),h.addEventListener("error",function(e){r.trigger(e)}),h.addEventListener("progress",function(e){r.trigger(e)}),h.upload.addEventListener("progress",function(e){r.trigger({type:"UploadProgress",loaded:e.loaded,total:e.total})})):h.onreadystatechange=function(){switch(h.readyState){case 1:break;case 2:break;case 3:var e,t;try{n.hasSameOrigin(i.url)&&(e=h.getResponseHeader("Content-Length")||0),h.responseText&&(t=h.responseText.length)}catch(i){e=t=0}r.trigger({type:"progress",lengthComputable:!!e,total:parseInt(e,10),loaded:t});break;case 4:h.onreadystatechange=function(){},r.trigger(0===h.status?"error":"load")}},t.isEmptyObj(i.headers)||t.each(i.headers,function(e,t){h.setRequestHeader(t,e)}),""!==i.responseType&&"responseType"in h&&(h.responseType="json"!==i.responseType||l.can("return_response_type","json")?i.responseType:"text"),g?h.sendAsBinary?h.sendAsBinary(a):!function(){for(var e=new Uint8Array(a.length),t=0;t<a.length;t++)e[t]=255&a.charCodeAt(t);h.send(e.buffer)}():h.send(a),r.trigger("loadstart")},getStatus:function(){try{if(h)return h.status}catch(e){}return 0},getResponse:function(e){var t=this.getRuntime();try{switch(e){case"blob":var n=new a(t.uid,h.response),o=h.getResponseHeader("Content-Disposition");if(o){var s=o.match(/filename=([\'\"'])([^\1]+)\1/);s&&(u=s[2])}return n.name=u,n.type||(n.type=i.getFileMime(u)),n;case"json":return l.can("return_response_type","json")?h.response:200===h.status&&window.JSON?JSON.parse(h.responseText):null;case"document":return p(h);default:return""!==h.responseText?h.responseText:null}}catch(e){return null}},getAllResponseHeaders:function(){try{return h.getAllResponseHeaders()}catch(e){}return""},abort:function(){h&&h.abort()},destroy:function(){f=u=null}})}return e.XMLHttpRequest=c}),n(N,[],function(){return function(){function e(e,t){var i,n=o?0:-8*(t-1),s=0;for(i=0;t>i;i++)s|=a.charCodeAt(e+i)<<Math.abs(n+8*i);return s}function i(e,t,i){i=3===arguments.length?i:a.length-t-1,a=a.substr(0,t)+e+a.substr(i+t)}function n(e,t,n){var a,s="",r=o?0:-8*(n-1);for(a=0;n>a;a++)s+=String.fromCharCode(t>>Math.abs(r+8*a)&255);i(s,e,n)}var a,o=!1;return{II:function(e){return e===t?o:void(o=e)},init:function(e){o=!1,a=e},SEGMENT:function(e,t,n){switch(arguments.length){case 1:return a.substr(e,a.length-e-1);case 2:return a.substr(e,t);case 3:i(n,e,t);break;default:return a}},BYTE:function(t){return e(t,1)},SHORT:function(t){return e(t,2)},LONG:function(i,a){return a===t?e(i,4):void n(i,a,4)},SLONG:function(t){var i=e(t,4);return i>2147483647?i-4294967296:i},STRING:function(t,i){var n="";for(i+=t;i>t;t++)n+=String.fromCharCode(e(t,1));return n}}}}),n(F,[N],function(e){return function t(i){var n,a,o,s=[],r=0;if(n=new e,n.init(i),65496===n.SHORT(0)){for(a=2;a<=i.length;)if(o=n.SHORT(a),o>=65488&&65495>=o)a+=2;else{if(65498===o||65497===o)break;r=n.SHORT(a+2)+2,o>=65505&&65519>=o&&s.push({hex:o,name:"APP"+(15&o),start:a,length:r,segment:n.SEGMENT(a,r)}),a+=r}return n.init(null),{headers:s,restore:function(e){var t,i;for(n.init(e),a=65504==n.SHORT(2)?4+n.SHORT(4):2,i=0,t=s.length;t>i;i++)n.SEGMENT(a,0,s[i].segment),a+=s[i].length;return e=n.SEGMENT(),n.init(null),e},strip:function(e){var i,a,o;for(a=new t(e),i=a.headers,a.purge(),n.init(e),o=i.length;o--;)n.SEGMENT(i[o].start,i[o].length,"");return e=n.SEGMENT(),n.init(null),e},get:function(e){for(var t=[],i=0,n=s.length;n>i;i++)s[i].name===e.toUpperCase()&&t.push(s[i].segment);return t},set:function(e,t){var i,n,a,o=[];for("string"==typeof t?o.push(t):o=t,i=n=0,a=s.length;a>i&&(s[i].name===e.toUpperCase()&&(s[i].segment=o[n],s[i].length=o[n].length,n++),!(n>=o.length));i++);},purge:function(){s=[],n.init(null),n=null}}}}}),n(W,[r,N],function(e,i){return function n(){function n(e,i){var n,a,o,r,l,d,h,u,f=s.SHORT(e),g=[],m={};for(n=0;f>n;n++)if(h=d=e+12*n+2,o=i[s.SHORT(h)],o!==t){switch(r=s.SHORT(h+=2),l=s.LONG(h+=2),h+=4,g=[],r){case 1:case 7:for(l>4&&(h=s.LONG(h)+p.tiffHeader),a=0;l>a;a++)g[a]=s.BYTE(h+a);break;case 2:l>4&&(h=s.LONG(h)+p.tiffHeader),m[o]=s.STRING(h,l-1);continue;case 3:for(l>2&&(h=s.LONG(h)+p.tiffHeader),a=0;l>a;a++)g[a]=s.SHORT(h+2*a);break;case 4:for(l>1&&(h=s.LONG(h)+p.tiffHeader),a=0;l>a;a++)g[a]=s.LONG(h+4*a);break;case 5:for(h=s.LONG(h)+p.tiffHeader,a=0;l>a;a++)g[a]=s.LONG(h+4*a)/s.LONG(h+4*a+4);break;case 9:for(h=s.LONG(h)+p.tiffHeader,a=0;l>a;a++)g[a]=s.SLONG(h+4*a);break;case 10:for(h=s.LONG(h)+p.tiffHeader,a=0;l>a;a++)g[a]=s.SLONG(h+4*a)/s.SLONG(h+4*a+4);break;default:continue}u=1==l?g[0]:g,m[o]=c.hasOwnProperty(o)&&"object"!=typeof u?c[o][u]:u}return m}function a(){var e=p.tiffHeader;return s.II(18761==s.SHORT(e)),42===s.SHORT(e+=2)&&(p.IFD0=p.tiffHeader+s.LONG(e+=2),l=n(p.IFD0,r.tiff),"ExifIFDPointer"in l&&(p.exifIFD=p.tiffHeader+l.ExifIFDPointer,delete l.ExifIFDPointer),"GPSInfoIFDPointer"in l&&(p.gpsIFD=p.tiffHeader+l.GPSInfoIFDPointer,delete l.GPSInfoIFDPointer),!0)}function o(e,t,i){var n,a,o,l=0;if("string"==typeof t){var c=r[e.toLowerCase()];for(var d in c)if(c[d]===t){t=d;break}}n=p[e.toLowerCase()+"IFD"],a=s.SHORT(n);for(var h=0;a>h;h++)if(o=n+12*h+2,s.SHORT(o)==t){l=o+8;break}return!!l&&(s.LONG(l,i),!0)}var s,r,l,c,p={};return s=new i,r={tiff:{274:"Orientation",270:"ImageDescription",271:"Make",272:"Model",305:"Software",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer"},exif:{36864:"ExifVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",36867:"DateTimeOriginal",33434:"ExposureTime",33437:"FNumber",34855:"ISOSpeedRatings",37377:"ShutterSpeedValue",37378:"ApertureValue",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37386:"FocalLength",41986:"ExposureMode",41987:"WhiteBalance",41990:"SceneCaptureType",41988:"DigitalZoomRatio",41992:"Contrast",41993:"Saturation",41994:"Sharpness"},gps:{0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude"}},c={ColorSpace:{1:"sRGB",0:"Uncalibrated"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{1:"Daylight",2:"Fliorescent",3:"Tungsten",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 -5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire.",1:"Flash fired.",5:"Strobe return light not detected.",7:"Strobe return light detected.",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},ExposureMode:{0:"Auto exposure",1:"Manual exposure",2:"Auto bracket"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},GPSLatitudeRef:{N:"North latitude",S:"South latitude"},GPSLongitudeRef:{E:"East longitude",W:"West longitude"}},{init:function(e){return p={tiffHeader:10},!(e===t||!e.length)&&(s.init(e),65505===s.SHORT(0)&&"EXIF\0"===s.STRING(4,5).toUpperCase()&&a())},TIFF:function(){return l},EXIF:function(){var t;if(t=n(p.exifIFD,r.exif),t.ExifVersion&&"array"===e.typeOf(t.ExifVersion)){for(var i=0,a="";i<t.ExifVersion.length;i++)a+=String.fromCharCode(t.ExifVersion[i]);t.ExifVersion=a}return t},GPS:function(){var t;return t=n(p.gpsIFD,r.gps),t.GPSVersionID&&"array"===e.typeOf(t.GPSVersionID)&&(t.GPSVersionID=t.GPSVersionID.join(".")),t},setExif:function(e,t){return("PixelXDimension"===e||"PixelYDimension"===e)&&o("exif",e,t)},getBinary:function(){return s.SEGMENT()},purge:function(){s.init(null),s=l=null,p={}}}}}),n(O,[r,h,F,N,W],function(e,t,i,n,a){function o(o){function s(){for(var e,t,i=0;i<=l.length;){if(e=c.SHORT(i+=2),e>=65472&&65475>=e)return i+=5,{height:c.SHORT(i),width:c.SHORT(i+=2)};t=c.SHORT(i+=2),i+=t-2}return null}function r(){d&&p&&c&&(d.purge(),p.purge(),c.init(null),l=h=p=d=c=null)}var l,c,p,d,h,u;if(l=o,c=new n,c.init(l),65496!==c.SHORT(0))throw new t.ImageError(t.ImageError.WRONG_FORMAT);p=new i(o),d=new a,u=!!d.init(p.get("app1")[0]),h=s.call(this),e.extend(this,{type:"image/jpeg",size:l.length,width:h&&h.width||0,height:h&&h.height||0,setExif:function(t,i){return!!u&&("object"===e.typeOf(t)?e.each(t,function(e,t){d.setExif(t,e)}):d.setExif(t,i),void p.set("app1",d.getBinary()))},writeHeaders:function(){return arguments.length?p.restore(arguments[0]):l=p.restore(l)},stripHeaders:function(e){return p.strip(e)},purge:function(){r.call(this)}}),u&&(this.meta={tiff:d.TIFF(),exif:d.EXIF(),gps:d.GPS()})}return o}),n(B,[h,r,N],function(e,t,i){function n(n){function a(){var e,t;return e=s.call(this,8),"IHDR"==e.type?(t=e.start,{width:l.LONG(t),height:l.LONG(t+=4)}):null}function o(){l&&(l.init(null),r=d=c=p=l=null)}function s(e){var t,i,n,a;return t=l.LONG(e),i=l.STRING(e+=4,4),n=e+=4,a=l.LONG(e+t),{length:t,type:i,start:n,CRC:a}}var r,l,c,p,d;r=n,l=new i,l.init(r),function(){var t=0,i=0,n=[35152,20039,3338,6666];for(i=0;i<n.length;i++,t+=2)if(n[i]!=l.SHORT(t))throw new e.ImageError(e.ImageError.WRONG_FORMAT)}(),d=a.call(this),t.extend(this,{type:"image/png",size:r.length,width:d.width,height:d.height,purge:function(){o.call(this)}}),o.call(this)}return n}),n(z,[r,h,O,B],function(e,t,i,n){return function(a){var o,s=[i,n];o=function(){for(var e=0;e<s.length;e++)try{return new s[e](a)}catch(e){}throw new t.ImageError(t.ImageError.WRONG_FORMAT)}(),e.extend(this,{type:"",size:0,width:0,height:0,setExif:function(){},writeHeaders:function(e){return e},stripHeaders:function(e){return e},purge:function(){}}),e.extend(this,o),this.purge=function(){o.purge(),o=null}}}),n(H,[],function(){function e(e,n,a){var o=e.naturalWidth,s=e.naturalHeight,r=a.width,l=a.height,c=a.x||0,p=a.y||0,d=n.getContext("2d");t(e)&&(o/=2,s/=2);var h=1024,u=document.createElement("canvas");u.width=u.height=h;for(var f=u.getContext("2d"),g=i(e,o,s),m=0;s>m;){for(var y=m+h>s?s-m:h,v=0;o>v;){var w=v+h>o?o-v:h;f.clearRect(0,0,h,h),f.drawImage(e,-v,-m);var x=v*r/o+c<<0,b=Math.ceil(w*r/o),_=m*l/s/g+p<<0,D=Math.ceil(y*l/s/g);d.drawImage(u,0,0,w,y,x,_,b,D),v+=h}m+=h}u=f=null}function t(e){var t=e.naturalWidth,i=e.naturalHeight;if(t*i>1048576){var n=document.createElement("canvas");n.width=n.height=1;var a=n.getContext("2d");return a.drawImage(e,-t+1,0),0===a.getImageData(0,0,1,1).data[3]}return!1}function i(e,t,i){var n=document.createElement("canvas");n.width=1,n.height=i;var a=n.getContext("2d");a.drawImage(e,0,0);for(var o=a.getImageData(0,0,1,i).data,s=0,r=i,l=i;l>s;){var c=o[4*(l-1)+3];0===c?r=l:s=l,l=r+s>>1}n=null;var p=l/i;return 0===p?1:p}return{isSubsampled:t,renderTo:e}}),n(K,[R,r,h,f,v,z,H,c,p],function(e,t,i,n,a,o,s,r,l){function c(){function e(){if(!w&&!y)throw new i.ImageError(i.DOMException.INVALID_STATE_ERR);return w||y}function c(e){return n.atob(e.substring(e.indexOf("base64,")+7))}function p(e,t){return"data:"+(t||"")+";base64,"+n.btoa(e)}function d(e){var t=this;y=new Image,y.onerror=function(){m.call(this),t.trigger("error",i.ImageError.WRONG_FORMAT)},y.onload=function(){t.trigger("load")},y.src=/^data:[^;]*;base64,/.test(e)?e:p(e,b.type)}function h(e,t){var n,a=this;return window.FileReader?(n=new FileReader,n.onload=function(){t(this.result)},n.onerror=function(){a.trigger("error",i.ImageError.WRONG_FORMAT)},void n.readAsDataURL(e)):t(e.getAsDataURL())}function u(i,n,a,o){var s,r,l,c,p,d=this,h=0,u=0;if(I=o,p=this.meta&&this.meta.tiff&&this.meta.tiff.Orientation||1,-1!==t.inArray(p,[5,6,7,8])){var m=i;i=n,n=m}return r=e(),a?(i=Math.min(i,r.width),n=Math.min(n,r.height),s=Math.max(i/r.width,n/r.height)):s=Math.min(i/r.width,n/r.height),s>1&&!a&&o?void this.trigger("Resize"):(w||(w=document.createElement("canvas")),l=Math.round(r.width*s),c=Math.round(r.height*s),a?(w.width=i,w.height=n,l>i&&(h=Math.round((l-i)/2)),c>n&&(u=Math.round((c-n)/2))):(w.width=l,w.height=c),I||g(w.width,w.height,p),f.call(this,r,w,-h,-u,l,c),this.width=w.width,this.height=w.height,D=!0,void d.trigger("Resize"))}function f(e,t,i,n,a,o){
if("iOS"===l.OS)s.renderTo(e,t,{width:a,height:o,x:i,y:n});else{var r=t.getContext("2d");r.drawImage(e,i,n,a,o)}}function g(e,t,i){switch(i){case 5:case 6:case 7:case 8:w.width=t,w.height=e;break;default:w.width=e,w.height=t}var n=w.getContext("2d");switch(i){case 2:n.translate(e,0),n.scale(-1,1);break;case 3:n.translate(e,t),n.rotate(Math.PI);break;case 4:n.translate(0,t),n.scale(1,-1);break;case 5:n.rotate(.5*Math.PI),n.scale(1,-1);break;case 6:n.rotate(.5*Math.PI),n.translate(0,-t);break;case 7:n.rotate(.5*Math.PI),n.translate(e,-t),n.scale(-1,1);break;case 8:n.rotate(-.5*Math.PI),n.translate(-e,0)}}function m(){v&&(v.purge(),v=null),x=y=w=b=null,D=!1}var y,v,w,x,b,_=this,D=!1,I=!0;t.extend(this,{loadFromBlob:function(e){var t=this,n=t.getRuntime(),a=!(arguments.length>1)||arguments[1];if(!n.can("access_binary"))throw new i.RuntimeError(i.RuntimeError.NOT_SUPPORTED_ERR);return b=e,e.isDetached()?(x=e.getSource(),void d.call(this,x)):void h.call(this,e.getSource(),function(e){a&&(x=c(e)),d.call(t,e)})},loadFromImage:function(e,t){this.meta=e.meta,b=new a(null,{name:e.name,size:e.size,type:e.type}),d.call(this,t?x=e.getAsBinaryString():e.getAsDataURL())},getInfo:function(){var t,i=this.getRuntime();return!v&&x&&i.can("access_image_binary")&&(v=new o(x)),t={width:e().width||0,height:e().height||0,type:b.type||r.getFileMime(b.name),size:x&&x.length||b.size||0,name:b.name||"",meta:v&&v.meta||this.meta||{}}},downsize:function(){u.apply(this,arguments)},getAsCanvas:function(){return w&&(w.id=this.uid+"_canvas"),w},getAsBlob:function(e,t){return e!==this.type&&u.call(this,this.width,this.height,!1),new a(null,{name:b.name||"",type:e,data:_.getAsBinaryString.call(this,e,t)})},getAsDataURL:function(e){var t=arguments[1]||90;if(!D)return y.src;if("image/jpeg"!==e)return w.toDataURL("image/png");try{return w.toDataURL("image/jpeg",t/100)}catch(e){return w.toDataURL("image/jpeg")}},getAsBinaryString:function(e,t){if(!D)return x||(x=c(_.getAsDataURL(e,t))),x;if("image/jpeg"!==e)x=c(_.getAsDataURL(e,t));else{var i;t||(t=90);try{i=w.toDataURL("image/jpeg",t/100)}catch(e){i=w.toDataURL("image/jpeg")}x=c(i),v&&(x=v.stripHeaders(x),I&&(v.meta&&v.meta.exif&&v.setExif({PixelXDimension:this.width,PixelYDimension:this.height}),x=v.writeHeaders(x)),v.purge(),v=null)}return D=!1,x},destroy:function(){_=null,m.call(this),this.getRuntime().getShim().removeInstance(this.uid)}})}return e.Image=c}),n(V,[r,p,d,h,g],function(e,t,i,n,a){function o(){var e;try{e=navigator.plugins["Shockwave Flash"],e=e.description}catch(t){try{e=new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version")}catch(t){e="0.0"}}return e=e.match(/\d+/g),parseFloat(e[0]+"."+e[1])}function s(s){var c,p=this;s=e.extend({swf_url:t.swf_url},s),a.call(this,s,r,{access_binary:function(e){return e&&"browser"===p.mode},access_image_binary:function(e){return e&&"browser"===p.mode},display_media:a.capTrue,do_cors:a.capTrue,drag_and_drop:!1,report_upload_progress:function(){return"client"===p.mode},resize_image:a.capTrue,return_response_headers:!1,return_response_type:function(t){return!("json"!==t||!window.JSON)||(!e.arrayDiff(t,["","text","document"])||"browser"===p.mode)},return_status_code:function(t){return"browser"===p.mode||!e.arrayDiff(t,[200,404])},select_file:a.capTrue,select_multiple:a.capTrue,send_binary_string:function(e){return e&&"browser"===p.mode},send_browser_cookies:function(e){return e&&"browser"===p.mode},send_custom_headers:function(e){return e&&"browser"===p.mode},send_multipart:a.capTrue,slice_blob:function(e){return e&&"browser"===p.mode},stream_upload:function(e){return e&&"browser"===p.mode},summon_file_dialog:!1,upload_filesize:function(t){return e.parseSizeStr(t)<=2097152||"client"===p.mode},use_http_method:function(t){return!e.arrayDiff(t,["GET","POST"])}},{access_binary:function(e){return e?"browser":"client"},access_image_binary:function(e){return e?"browser":"client"},report_upload_progress:function(e){return e?"browser":"client"},return_response_type:function(t){return e.arrayDiff(t,["","text","json","document"])?"browser":["client","browser"]},return_status_code:function(t){return e.arrayDiff(t,[200,404])?"browser":["client","browser"]},send_binary_string:function(e){return e?"browser":"client"},send_browser_cookies:function(e){return e?"browser":"client"},send_custom_headers:function(e){return e?"browser":"client"},stream_upload:function(e){return e?"client":"browser"},upload_filesize:function(t){return e.parseSizeStr(t)>=2097152?"client":"browser"}},"client"),o()<10&&(this.mode=!1),e.extend(this,{getShim:function(){return i.get(this.uid)},shimExec:function(e,t){var i=[].slice.call(arguments,2);return p.getShim().exec(this.uid,e,t,i)},init:function(){var i,a,o;o=this.getShimContainer(),e.extend(o.style,{position:"absolute",top:"-8px",left:"-8px",width:"9px",height:"9px",overflow:"hidden"}),i='<object id="'+this.uid+'" type="application/x-shockwave-flash" data="'+s.swf_url+'" ',"IE"===t.browser&&(i+='classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" '),i+='width="100%" height="100%" style="outline:0"><param name="movie" value="'+s.swf_url+'" /><param name="flashvars" value="uid='+escape(this.uid)+"&target="+t.global_event_dispatcher+'" /><param name="wmode" value="transparent" /><param name="allowscriptaccess" value="always" /></object>',"IE"===t.browser?(a=document.createElement("div"),o.appendChild(a),a.outerHTML=i,a=o=null):o.innerHTML=i,c=setTimeout(function(){p&&!p.initialized&&p.trigger("Error",new n.RuntimeError(n.RuntimeError.NOT_INIT_ERR))},5e3)},destroy:function(e){return function(){e.call(p),clearTimeout(c),s=c=e=p=null}}(this.destroy)},l)}var r="flash",l={};return a.addConstructor(r,s),l}),n(j,[V,y],function(e,t){var i={slice:function(e,i,n,a){var o=this.getRuntime();return 0>i?i=Math.max(e.size+i,0):i>0&&(i=Math.min(i,e.size)),0>n?n=Math.max(e.size+n,0):n>0&&(n=Math.min(n,e.size)),e=o.shimExec.call(this,"Blob","slice",i,n,a||""),e&&(e=new t(o.uid,e)),e}};return e.Blob=i}),n(U,[V],function(e){var t={init:function(e){this.getRuntime().shimExec.call(this,"FileInput","init",{name:e.name,accept:e.accept,multiple:e.multiple}),this.trigger("ready")}};return e.FileInput=t}),n(G,[V,f],function(e,t){function i(e,i){switch(i){case"readAsText":return t.atob(e,"utf8");case"readAsBinaryString":return t.atob(e);case"readAsDataURL":return e}return null}var n="",a={read:function(e,t){var a=this,o=a.getRuntime();return"readAsDataURL"===e&&(n="data:"+(t.type||"")+";base64,"),a.bind("Progress",function(t,a){a&&(n+=i(a,e))}),o.shimExec.call(this,"FileReader","readAsBase64",t.uid)},getResult:function(){return n},destroy:function(){n=null}};return e.FileReader=a}),n(Y,[V,f],function(e,t){function i(e,i){switch(i){case"readAsText":return t.atob(e,"utf8");case"readAsBinaryString":return t.atob(e);case"readAsDataURL":return e}return null}var n={read:function(e,t){var n,a=this.getRuntime();return(n=a.shimExec.call(this,"FileReaderSync","readAsBase64",t.uid))?("readAsDataURL"===e&&(n="data:"+(t.type||"")+";base64,"+n),i(n,e,t.type)):null}};return e.FileReaderSync=n}),n(q,[V,r,y,v,I,S,T],function(e,t,i,n,a,o,s){var r={send:function(e,n){function a(){e.transport=p.mode,p.shimExec.call(c,"XMLHttpRequest","send",e,n)}function r(e,t){p.shimExec.call(c,"XMLHttpRequest","appendBlob",e,t.uid),n=null,a()}function l(e,t){var i=new s;i.bind("TransportingComplete",function(){t(this.result)}),i.transport(e.getSource(),e.type,{ruid:p.uid})}var c=this,p=c.getRuntime();if(t.isEmptyObj(e.headers)||t.each(e.headers,function(e,t){p.shimExec.call(c,"XMLHttpRequest","setRequestHeader",t,e.toString())}),n instanceof o){var d;if(n.each(function(e,t){e instanceof i?d=t:p.shimExec.call(c,"XMLHttpRequest","append",t,e)}),n.hasBlob()){var h=n.getBlob();h.isDetached()?l(h,function(e){h.destroy(),r(d,e)}):r(d,h)}else n=null,a()}else n instanceof i?n.isDetached()?l(n,function(e){n.destroy(),n=e.uid,a()}):(n=n.uid,a()):a()},getResponse:function(e){var i,o,s=this.getRuntime();if(o=s.shimExec.call(this,"XMLHttpRequest","getResponseAsBlob")){if(o=new n(s.uid,o),"blob"===e)return o;try{if(i=new a,~t.inArray(e,["","text"]))return i.readAsText(o);if("json"===e&&window.JSON)return JSON.parse(i.readAsText(o))}finally{o.destroy()}}return null},abort:function(e){var t=this.getRuntime();t.shimExec.call(this,"XMLHttpRequest","abort"),this.dispatchEvent("readystatechange"),this.dispatchEvent("abort")}};return e.XMLHttpRequest=r}),n(X,[V,y],function(e,t){var i={getAsBlob:function(e){var i=this.getRuntime(),n=i.shimExec.call(this,"Transporter","getAsBlob",e);return n?new t(i.uid,n):null}};return e.Transporter=i}),n(J,[V,r,T,y,I],function(e,t,i,n,a){var o={loadFromBlob:function(e){function t(e){a.shimExec.call(n,"Image","loadFromBlob",e.uid),n=a=null}var n=this,a=n.getRuntime();if(e.isDetached()){var o=new i;o.bind("TransportingComplete",function(){t(o.result.getSource())}),o.transport(e.getSource(),e.type,{ruid:a.uid})}else t(e.getSource())},loadFromImage:function(e){var t=this.getRuntime();return t.shimExec.call(this,"Image","loadFromImage",e.uid)},getAsBlob:function(e,t){var i=this.getRuntime(),a=i.shimExec.call(this,"Image","getAsBlob",e,t);return a?new n(i.uid,a):null},getAsDataURL:function(){var e,t=this.getRuntime(),i=t.Image.getAsBlob.apply(this,arguments);return i?(e=new a,e.readAsDataURL(i)):null}};return e.Image=o}),n(Z,[r,p,d,h,g],function(e,t,i,n,a){function o(e){var t,i,n,a,o,s=!1,r=null,l=0;try{try{r=new ActiveXObject("AgControl.AgControl"),r.IsVersionSupported(e)&&(s=!0),r=null}catch(r){var c=navigator.plugins["Silverlight Plug-In"];if(c){for(t=c.description,"1.0.30226.2"===t&&(t="2.0.30226.2"),i=t.split(".");i.length>3;)i.pop();for(;i.length<4;)i.push(0);for(n=e.split(".");n.length>4;)n.pop();do a=parseInt(n[l],10),o=parseInt(i[l],10),l++;while(l<n.length&&a===o);o>=a&&!isNaN(a)&&(s=!0)}}}catch(e){s=!1}return s}function s(s){var c,p=this;s=e.extend({xap_url:t.xap_url},s),a.call(this,s,r,{access_binary:a.capTrue,access_image_binary:a.capTrue,display_media:a.capTrue,do_cors:a.capTrue,drag_and_drop:!1,report_upload_progress:a.capTrue,resize_image:a.capTrue,return_response_headers:function(e){return e&&"client"===p.mode},return_response_type:function(e){return"json"!==e||!!window.JSON},return_status_code:function(t){return"client"===p.mode||!e.arrayDiff(t,[200,404])},select_file:a.capTrue,select_multiple:a.capTrue,send_binary_string:a.capTrue,send_browser_cookies:function(e){return e&&"browser"===p.mode},send_custom_headers:function(e){return e&&"client"===p.mode},send_multipart:a.capTrue,slice_blob:a.capTrue,stream_upload:!0,summon_file_dialog:!1,upload_filesize:a.capTrue,use_http_method:function(t){return"client"===p.mode||!e.arrayDiff(t,["GET","POST"])}},{return_response_headers:function(e){return e?"client":"browser"},return_status_code:function(t){return e.arrayDiff(t,[200,404])?"client":["client","browser"]},send_browser_cookies:function(e){return e?"browser":"client"},send_custom_headers:function(e){return e?"client":"browser"},use_http_method:function(t){return e.arrayDiff(t,["GET","POST"])?"client":["client","browser"]}}),o("2.0.31005.0")&&"Opera"!==t.browser||(this.mode=!1),e.extend(this,{getShim:function(){return i.get(this.uid).content.Moxie},shimExec:function(e,t){var i=[].slice.call(arguments,2);return p.getShim().exec(this.uid,e,t,i)},init:function(){var e;e=this.getShimContainer(),e.innerHTML='<object id="'+this.uid+'" data="data:application/x-silverlight," type="application/x-silverlight-2" width="100%" height="100%" style="outline:none;"><param name="source" value="'+s.xap_url+'"/><param name="background" value="Transparent"/><param name="windowless" value="true"/><param name="enablehtmlaccess" value="true"/><param name="initParams" value="uid='+this.uid+",target="+t.global_event_dispatcher+'"/></object>',c=setTimeout(function(){p&&!p.initialized&&p.trigger("Error",new n.RuntimeError(n.RuntimeError.NOT_INIT_ERR))},"Windows"!==t.OS?1e4:5e3)},destroy:function(e){return function(){e.call(p),clearTimeout(c),s=c=e=p=null}}(this.destroy)},l)}var r="silverlight",l={};return a.addConstructor(r,s),l}),n(Q,[Z,r,j],function(e,t,i){return e.Blob=t.extend({},i)}),n(ee,[Z],function(e){var t={init:function(e){function t(e){for(var t="",i=0;i<e.length;i++)t+=(""!==t?"|":"")+e[i].title+" | *."+e[i].extensions.replace(/,/g,";*.");return t}this.getRuntime().shimExec.call(this,"FileInput","init",t(e.accept),e.name,e.multiple),this.trigger("ready")}};return e.FileInput=t}),n(te,[Z,d,L],function(e,t,i){var n={init:function(){var e,n=this,a=n.getRuntime();return e=a.getShimContainer(),i.addEvent(e,"dragover",function(e){e.preventDefault(),e.stopPropagation(),e.dataTransfer.dropEffect="copy"},n.uid),i.addEvent(e,"dragenter",function(e){e.preventDefault();var i=t.get(a.uid).dragEnter(e);i&&e.stopPropagation()},n.uid),i.addEvent(e,"drop",function(e){e.preventDefault();var i=t.get(a.uid).dragDrop(e);i&&e.stopPropagation()},n.uid),a.shimExec.call(this,"FileDrop","init")}};return e.FileDrop=n}),n(ie,[Z,r,G],function(e,t,i){return e.FileReader=t.extend({},i)}),n(ne,[Z,r,Y],function(e,t,i){return e.FileReaderSync=t.extend({},i)}),n(ae,[Z,r,q],function(e,t,i){return e.XMLHttpRequest=t.extend({},i)}),n(oe,[Z,r,X],function(e,t,i){return e.Transporter=t.extend({},i)}),n(se,[Z,r,J],function(e,t,i){return e.Image=t.extend({},i,{getInfo:function(){var e=this.getRuntime(),i=["tiff","exif","gps"],n={meta:{}},a=e.shimExec.call(this,"Image","getInfo");return a.meta&&t.each(i,function(e){var t,i,o,s,r=a.meta[e];if(r&&r.keys)for(n.meta[e]={},i=0,o=r.keys.length;o>i;i++)t=r.keys[i],s=r[t],s&&(/^(\d|[1-9]\d+)$/.test(s)?s=parseInt(s,10):/^\d*\.\d+$/.test(s)&&(s=parseFloat(s)),n.meta[e][t]=s)}),n.width=parseInt(a.width,10),n.height=parseInt(a.height,10),n.size=parseInt(a.size,10),n.type=a.type,n.name=a.name,n}})}),n(re,[r,h,g,p],function(e,t,i,n){function a(t){var a=this,r=i.capTest,l=i.capTrue;i.call(this,t,o,{access_binary:r(window.FileReader||window.File&&File.getAsDataURL),access_image_binary:!1,display_media:r(s.Image&&(n.can("create_canvas")||n.can("use_data_uri_over32kb"))),do_cors:!1,drag_and_drop:!1,filter_by_extension:r(function(){return"Chrome"===n.browser&&n.version>=28||"IE"===n.browser&&n.version>=10}()),resize_image:function(){return s.Image&&a.can("access_binary")&&n.can("create_canvas")},report_upload_progress:!1,return_response_headers:!1,return_response_type:function(t){return!("json"!==t||!window.JSON)||!!~e.inArray(t,["text","document",""])},return_status_code:function(t){return!e.arrayDiff(t,[200,404])},select_file:function(){return n.can("use_fileinput")},select_multiple:!1,send_binary_string:!1,send_custom_headers:!1,send_multipart:!0,slice_blob:!1,stream_upload:function(){return a.can("select_file")},summon_file_dialog:r(function(){return"Firefox"===n.browser&&n.version>=4||"Opera"===n.browser&&n.version>=12||!!~e.inArray(n.browser,["Chrome","Safari"])}()),upload_filesize:l,use_http_method:function(t){return!e.arrayDiff(t,["GET","POST"])}}),e.extend(this,{init:function(){this.trigger("Init")},destroy:function(e){return function(){e.call(a),e=a=null}}(this.destroy)}),e.extend(this.getShim(),s)}var o="html4",s={};return i.addConstructor(o,a),s}),n(le,[re,r,d,L,c,p],function(e,t,i,n,a,o){function s(){function e(){var a,p,d,h,u,f,g=this,m=g.getRuntime();f=t.guid("uid_"),a=m.getShimContainer(),s&&(d=i.get(s+"_form"),d&&t.extend(d.style,{top:"100%"})),h=document.createElement("form"),h.setAttribute("id",f+"_form"),h.setAttribute("method","post"),h.setAttribute("enctype","multipart/form-data"),h.setAttribute("encoding","multipart/form-data"),t.extend(h.style,{overflow:"hidden",position:"absolute",top:0,left:0,width:"100%",height:"100%"}),u=document.createElement("input"),u.setAttribute("id",f),u.setAttribute("type","file"),u.setAttribute("name",r.name||"Filedata"),u.setAttribute("accept",c.join(",")),t.extend(u.style,{fontSize:"999px",opacity:0}),h.appendChild(u),a.appendChild(h),t.extend(u.style,{position:"absolute",top:0,left:0,width:"100%",height:"100%"}),"IE"===o.browser&&o.version<10&&t.extend(u.style,{filter:"progid:DXImageTransform.Microsoft.Alpha(opacity=0)"}),u.onchange=function(){var t;this.value&&(t=this.files?this.files[0]:{name:this.value},l=[t],this.onchange=function(){},e.call(g),g.bind("change",function e(){var t,n=i.get(f),a=i.get(f+"_form");g.unbind("change",e),g.files.length&&n&&a&&(t=g.files[0],n.setAttribute("id",t.uid),a.setAttribute("id",t.uid+"_form"),a.setAttribute("target",t.uid+"_iframe")),n=a=null},998),u=h=null,g.trigger("change"))},m.can("summon_file_dialog")&&(p=i.get(r.browse_button),n.removeEvent(p,"click",g.uid),n.addEvent(p,"click",function(e){u&&!u.disabled&&u.click(),e.preventDefault()},g.uid)),s=f,a=d=p=null}var s,r,l=[],c=[];t.extend(this,{init:function(t){var o,s=this,l=s.getRuntime();r=t,c=t.accept.mimes||a.extList2mimes(t.accept,l.can("filter_by_extension")),o=l.getShimContainer(),function(){var e,a,r;e=i.get(t.browse_button),l.can("summon_file_dialog")&&("static"===i.getStyle(e,"position")&&(e.style.position="relative"),a=parseInt(i.getStyle(e,"z-index"),10)||1,e.style.zIndex=a,o.style.zIndex=a-1),r=l.can("summon_file_dialog")?e:o,n.addEvent(r,"mouseover",function(){s.trigger("mouseenter")},s.uid),n.addEvent(r,"mouseout",function(){s.trigger("mouseleave")},s.uid),n.addEvent(r,"mousedown",function(){s.trigger("mousedown")},s.uid),n.addEvent(i.get(t.container),"mouseup",function(){s.trigger("mouseup")},s.uid),e=null}(),e.call(this),o=null,s.trigger({type:"ready",async:!0})},getFiles:function(){return l},disable:function(e){var t;(t=i.get(s))&&(t.disabled=!!e)},destroy:function(){var e=this.getRuntime(),t=e.getShim(),a=e.getShimContainer();n.removeAllEvents(a,this.uid),n.removeAllEvents(r&&i.get(r.container),this.uid),n.removeAllEvents(r&&i.get(r.browse_button),this.uid),a&&(a.innerHTML=""),t.removeInstance(this.uid),s=l=c=r=a=t=null}})}return e.FileInput=s}),n(ce,[re,P],function(e,t){return e.FileReader=t}),n(pe,[re,r,d,D,h,L,y,S],function(e,t,i,n,a,o,s,r){function l(){function e(e){var t,n,a,s,r=this,l=!1;if(p){if(t=p.id.replace(/_iframe$/,""),n=i.get(t+"_form")){for(a=n.getElementsByTagName("input"),s=a.length;s--;)switch(a[s].getAttribute("type")){case"hidden":a[s].parentNode.removeChild(a[s]);break;case"file":l=!0}a=[],l||n.parentNode.removeChild(n),n=null}setTimeout(function(){o.removeEvent(p,"load",r.uid),p.parentNode&&p.parentNode.removeChild(p);var t=r.getRuntime().getShimContainer();t.children.length||t.parentNode.removeChild(t),t=p=null,e()},1)}}var l,c,p;t.extend(this,{send:function(d,h){function u(){var i=w.getShimContainer()||document.body,a=document.createElement("div");a.innerHTML='<iframe id="'+f+'_iframe" name="'+f+'_iframe" src="javascript:&quot;&quot;" style="display:none"></iframe>',p=a.firstChild,i.appendChild(p),o.addEvent(p,"load",function(){var i;try{i=p.contentWindow.document||p.contentDocument||window.frames[p.id].document,/^4(0[0-9]|1[0-7]|2[2346])\s/.test(i.title)?l=i.title.replace(/^(\d+).*$/,"$1"):(l=200,c=t.trim(i.body.innerHTML),v.trigger({type:"progress",loaded:c.length,total:c.length}),y&&v.trigger({type:"uploadprogress",loaded:y.size||1025,total:y.size||1025}))}catch(t){if(!n.hasSameOrigin(d.url))return void e.call(v,function(){v.trigger("error")});l=404}e.call(v,function(){v.trigger("load")})},v.uid)}var f,g,m,y,v=this,w=v.getRuntime();if(l=c=null,h instanceof r&&h.hasBlob()){if(y=h.getBlob(),f=y.uid,m=i.get(f),g=i.get(f+"_form"),!g)throw new a.DOMException(a.DOMException.NOT_FOUND_ERR)}else f=t.guid("uid_"),g=document.createElement("form"),g.setAttribute("id",f+"_form"),g.setAttribute("method",d.method),g.setAttribute("enctype","multipart/form-data"),g.setAttribute("encoding","multipart/form-data"),g.setAttribute("target",f+"_iframe"),w.getShimContainer().appendChild(g);h instanceof r&&h.each(function(e,i){if(e instanceof s)m&&m.setAttribute("name",i);else{var n=document.createElement("input");t.extend(n,{type:"hidden",name:i,value:e}),m?g.insertBefore(n,m):g.appendChild(n)}}),g.setAttribute("action",d.url),u(),g.submit(),v.trigger("loadstart")},getStatus:function(){return l},getResponse:function(e){if("json"===e&&"string"===t.typeOf(c)&&window.JSON)try{return JSON.parse(c.replace(/^\s*<pre[^>]*>/,"").replace(/<\/pre>\s*$/,""))}catch(e){return null}return c},abort:function(){var t=this;p&&p.contentWindow&&(p.contentWindow.stop?p.contentWindow.stop():p.contentWindow.document.execCommand?p.contentWindow.document.execCommand("Stop"):p.src="about:blank"),e.call(this,function(){t.dispatchEvent("abort")})}})}return e.XMLHttpRequest=l}),n(de,[re,K],function(e,t){return e.Image=t}),o([r,l,c,p,d,h,u,f,g,m,y,v,w,x,b,_,D,I,S,C,T,k,L])}(this),function(e){"use strict";var t={},i=e.moxie.core.utils.Basic.inArray;return function e(n){var a,o;for(a in n)o=typeof n[a],"object"!==o||~i(a,["Exceptions","Env","Mime"])?"function"===o&&(t[a]=n[a]):e(n[a])}(e.moxie),t.Env=e.moxie.core.utils.Env,t.Mime=e.moxie.core.utils.Mime,t.Exceptions=e.moxie.core.Exceptions,e.mOxie=t,e.o||(e.o=t),t}(this),function(e,t,i){function n(e){function t(e,t,i){var a={chunks:"slice_blob",jpgresize:"send_binary_string",pngresize:"send_binary_string",progress:"report_upload_progress",multi_selection:"select_multiple",dragdrop:"drag_and_drop",drop_element:"drag_and_drop",headers:"send_custom_headers",urlstream_upload:"send_binary_string",canSendBinary:"send_binary",triggerDialog:"summon_file_dialog"};a[e]?n[a[e]]=t:i||(n[e]=t)}var i=e.required_features,n={};return"string"==typeof i?s.each(i.split(/\s*,\s*/),function(e){t(e,!0)}):"object"==typeof i?s.each(i,function(e,i){t(i,e)}):i===!0&&(e.chunk_size>0&&(n.slice_blob=!0),!e.resize.enabled&&e.multipart||(n.send_binary_string=!0),s.each(e,function(e,i){t(i,!!e,!0)})),n}var a=e.setTimeout,o={},s={VERSION:"2.1.2",STOPPED:1,STARTED:2,QUEUED:1,UPLOADING:2,FAILED:4,DONE:5,GENERIC_ERROR:-100,HTTP_ERROR:-200,IO_ERROR:-300,SECURITY_ERROR:-400,INIT_ERROR:-500,FILE_SIZE_ERROR:-600,FILE_EXTENSION_ERROR:-601,FILE_DUPLICATE_ERROR:-602,IMAGE_FORMAT_ERROR:-700,MEMORY_ERROR:-701,IMAGE_DIMENSIONS_ERROR:-702,mimeTypes:t.mimes,ua:t.ua,typeOf:t.typeOf,extend:t.extend,guid:t.guid,get:function(e){var i,n=[];"array"!==t.typeOf(e)&&(e=[e]);for(var a=e.length;a--;)i=t.get(e[a]),i&&n.push(i);return n.length?n:null},each:t.each,getPos:t.getPos,getSize:t.getSize,xmlEncode:function(e){var t={"<":"lt",">":"gt","&":"amp",'"':"quot","'":"#39"},i=/[<>&\"\']/g;return e?(""+e).replace(i,function(e){return t[e]?"&"+t[e]+";":e}):e},toArray:t.toArray,inArray:t.inArray,addI18n:t.addI18n,translate:t.translate,isEmptyObj:t.isEmptyObj,hasClass:t.hasClass,addClass:t.addClass,removeClass:t.removeClass,getStyle:t.getStyle,addEvent:t.addEvent,removeEvent:t.removeEvent,removeAllEvents:t.removeAllEvents,cleanName:function(e){var t,i;for(i=[/[\300-\306]/g,"A",/[\340-\346]/g,"a",/\307/g,"C",/\347/g,"c",/[\310-\313]/g,"E",/[\350-\353]/g,"e",/[\314-\317]/g,"I",/[\354-\357]/g,"i",/\321/g,"N",/\361/g,"n",/[\322-\330]/g,"O",/[\362-\370]/g,"o",/[\331-\334]/g,"U",/[\371-\374]/g,"u"],t=0;t<i.length;t+=2)e=e.replace(i[t],i[t+1]);return e=e.replace(/\s+/g,"_"),e=e.replace(/[^a-z0-9_\-\.]+/gi,"")},buildUrl:function(e,t){var i="";return s.each(t,function(e,t){i+=(i?"&":"")+encodeURIComponent(t)+"="+encodeURIComponent(e)}),i&&(e+=(e.indexOf("?")>0?"&":"?")+i),e},formatSize:function(e){function t(e,t){return Math.round(e*Math.pow(10,t))/Math.pow(10,t)}if(e===i||/\D/.test(e))return s.translate("N/A");var n=Math.pow(1024,4);return e>n?t(e/n,1)+" "+s.translate("tb"):e>(n/=1024)?t(e/n,1)+" "+s.translate("gb"):e>(n/=1024)?t(e/n,1)+" "+s.translate("mb"):e>1024?Math.round(e/1024)+" "+s.translate("kb"):e+" "+s.translate("b")},parseSize:t.parseSizeStr,predictRuntime:function(e,i){var n,a;return n=new s.Uploader(e),a=t.Runtime.thatCan(n.getOption().required_features,i||e.runtimes),n.destroy(),a},addFileFilter:function(e,t){o[e]=t}};s.addFileFilter("mime_types",function(e,t,i){e.length&&!e.regexp.test(t.name)?(this.trigger("Error",{code:s.FILE_EXTENSION_ERROR,message:s.translate("File extension error."),file:t}),i(!1)):i(!0)}),s.addFileFilter("max_file_size",function(e,t,i){var n;e=s.parseSize(e),t.size!==n&&e&&t.size>e?(this.trigger("Error",{code:s.FILE_SIZE_ERROR,message:s.translate("File size error."),file:t}),i(!1)):i(!0)}),s.addFileFilter("prevent_duplicates",function(e,t,i){if(e)for(var n=this.files.length;n--;)if(t.name===this.files[n].name&&t.size===this.files[n].size)return this.trigger("Error",{code:s.FILE_DUPLICATE_ERROR,message:s.translate("Duplicate file error."),file:t}),void i(!1);i(!0)}),s.Uploader=function(e){function r(){var e,t,i=0;if(this.state==s.STARTED){for(t=0;t<R.length;t++)e||R[t].status!=s.QUEUED?i++:(e=R[t],this.trigger("BeforeUpload",e)&&(e.status=s.UPLOADING,this.trigger("UploadFile",e)));i==R.length&&(this.state!==s.STOPPED&&(this.state=s.STOPPED,this.trigger("StateChanged")),this.trigger("UploadComplete",R))}}function l(e){e.percent=e.size>0?Math.ceil(e.loaded/e.size*100):100,c()}function c(){var e,t;for(C.reset(),e=0;e<R.length;e++)t=R[e],t.size!==i?(C.size+=t.origSize,C.loaded+=t.loaded*t.origSize/t.size):C.size=i,t.status==s.DONE?C.uploaded++:t.status==s.FAILED?C.failed++:C.queued++;C.size===i?C.percent=R.length>0?Math.ceil(C.uploaded/R.length*100):0:(C.bytesPerSec=Math.ceil(C.loaded/((+new Date-S||1)/1e3)),C.percent=C.size>0?Math.ceil(C.loaded/C.size*100):0)}function p(){var e=L[0]||A[0];return!!e&&e.getRuntime().uid}function d(e,i){if(e.ruid){var n=t.Runtime.getInfo(e.ruid);if(n)return n.can(i)}return!1}function h(){this.bind("FilesAdded FilesRemoved",function(e){e.trigger("QueueChanged"),e.refresh()}),this.bind("CancelUpload",x),this.bind("BeforeUpload",m),this.bind("UploadFile",y),this.bind("UploadProgress",v),this.bind("StateChanged",w),this.bind("QueueChanged",c),this.bind("Error",_),this.bind("FileUploaded",b),this.bind("Destroy",D)}function u(e,i){var n=this,a=0,o=[],r={runtime_order:e.runtimes,required_caps:e.required_features,preferred_caps:$,swf_url:e.flash_swf_url,xap_url:e.silverlight_xap_url};s.each(e.runtimes.split(/\s*,\s*/),function(t){e[t]&&(r[t]=e[t])}),e.browse_button&&s.each(e.browse_button,function(i){o.push(function(o){var l=new t.FileInput(s.extend({},r,{accept:e.filters.mime_types,name:e.file_data_name,multiple:e.multi_selection,container:e.container,browse_button:i}));l.onready=function(){var e=t.Runtime.getInfo(this.ruid);t.extend(n.features,{chunks:e.can("slice_blob"),multipart:e.can("send_multipart"),multi_selection:e.can("select_multiple")}),a++,L.push(this),o()},l.onchange=function(){n.addFile(this.files)},l.bind("mouseenter mouseleave mousedown mouseup",function(n){E||(e.browse_button_hover&&("mouseenter"===n.type?t.addClass(i,e.browse_button_hover):"mouseleave"===n.type&&t.removeClass(i,e.browse_button_hover)),e.browse_button_active&&("mousedown"===n.type?t.addClass(i,e.browse_button_active):"mouseup"===n.type&&t.removeClass(i,e.browse_button_active)))}),l.bind("mousedown",function(){n.trigger("Browse")}),l.bind("error runtimeerror",function(){l=null,o()}),l.init()})}),e.drop_element&&s.each(e.drop_element,function(e){o.push(function(i){var o=new t.FileDrop(s.extend({},r,{drop_zone:e}));o.onready=function(){var e=t.Runtime.getInfo(this.ruid);n.features.dragdrop=e.can("drag_and_drop"),a++,A.push(this),i()},o.ondrop=function(){n.addFile(this.files)},o.bind("error runtimeerror",function(){o=null,i()}),o.init()})}),t.inSeries(o,function(){"function"==typeof i&&i(a)})}function f(e,n,a){var o=new t.Image;try{o.onload=function(){return n.width>this.width&&n.height>this.height&&n.quality===i&&n.preserve_headers&&!n.crop?(this.destroy(),a(e)):void o.downsize(n.width,n.height,n.crop,n.preserve_headers)},o.onresize=function(){a(this.getAsBlob(e.type,n.quality)),this.destroy()},o.onerror=function(){a(e)},o.load(e)}catch(t){a(e)}}function g(e,i,a){function o(e,t,i){var n=I[e];switch(e){case"max_file_size":"max_file_size"===e&&(I.max_file_size=I.filters.max_file_size=t);break;case"chunk_size":(t=s.parseSize(t))&&(I[e]=t,I.send_file_name=!0);break;case"multipart":I[e]=t,t||(I.send_file_name=!0);break;case"unique_names":I[e]=t,t&&(I.send_file_name=!0);break;case"filters":"array"===s.typeOf(t)&&(t={mime_types:t}),i?s.extend(I.filters,t):I.filters=t,t.mime_types&&(I.filters.mime_types.regexp=function(e){var t=[];return s.each(e,function(e){s.each(e.extensions.split(/,/),function(e){/^\s*\*\s*$/.test(e)?t.push("\\.*"):t.push("\\."+e.replace(new RegExp("["+"/^$.*+?|()[]{}\\".replace(/./g,"\\$&")+"]","g"),"\\$&"))})}),new RegExp("("+t.join("|")+")$","i")}(I.filters.mime_types));break;case"resize":i?s.extend(I.resize,t,{enabled:!0}):I.resize=t;break;case"prevent_duplicates":I.prevent_duplicates=I.filters.prevent_duplicates=!!t;break;case"browse_button":case"drop_element":t=s.get(t);case"container":case"runtimes":case"multi_selection":case"flash_swf_url":case"silverlight_xap_url":I[e]=t,i||(l=!0);break;default:I[e]=t}i||r.trigger("OptionChanged",e,t,n)}var r=this,l=!1;"object"==typeof e?s.each(e,function(e,t){o(t,e,a)}):o(e,i,a),a?(I.required_features=n(s.extend({},I)),$=n(s.extend({},I,{required_features:!0}))):l&&(r.trigger("Destroy"),u.call(r,I,function(e){e?(r.runtime=t.Runtime.getInfo(p()).type,r.trigger("Init",{runtime:r.runtime}),r.trigger("PostInit")):r.trigger("Error",{code:s.INIT_ERROR,message:s.translate("Init error.")})}))}function m(e,t){if(e.settings.unique_names){var i=t.name.match(/\.([^.]+)$/),n="part";i&&(n=i[1]),t.target_name=t.id+"."+n}}function y(e,i){function n(){p-- >0?a(o,1e3):(i.loaded=u,e.trigger("Error",{code:s.HTTP_ERROR,message:s.translate("HTTP Error."),file:i,response:T.responseText,status:T.status,responseHeaders:T.getAllResponseHeaders()}))}function o(){var d,f,g,m={};i.status===s.UPLOADING&&e.state!==s.STOPPED&&(e.settings.send_file_name&&(m.name=i.target_name||i.name),c&&h.chunks&&r.size>c?(g=Math.min(c,r.size-u),d=r.slice(u,u+g)):(g=r.size,d=r),c&&h.chunks&&(e.settings.send_chunk_number?(m.chunk=Math.ceil(u/c),m.chunks=Math.ceil(r.size/c)):(m.offset=u,m.total=r.size)),T=new t.XMLHttpRequest,T.upload&&(T.upload.onprogress=function(t){i.loaded=Math.min(i.size,u+t.loaded),e.trigger("UploadProgress",i)}),T.onload=function(){return T.status>=400?void n():(p=e.settings.max_retries,g<r.size?(d.destroy(),u+=g,i.loaded=Math.min(u,r.size),e.trigger("ChunkUploaded",i,{offset:i.loaded,total:r.size,response:T.responseText,status:T.status,responseHeaders:T.getAllResponseHeaders()}),"Android Browser"===t.Env.browser&&e.trigger("UploadProgress",i)):i.loaded=i.size,d=f=null,!u||u>=r.size?(i.size!=i.origSize&&(r.destroy(),r=null),e.trigger("UploadProgress",i),i.status=s.DONE,e.trigger("FileUploaded",i,{response:T.responseText,status:T.status,responseHeaders:T.getAllResponseHeaders()})):a(o,1),void 0)},T.onerror=function(){n()},T.onloadend=function(){this.destroy(),T=null},e.settings.multipart&&h.multipart?(T.open("post",l,!0),s.each(e.settings.headers,function(e,t){T.setRequestHeader(t,e)}),f=new t.FormData,s.each(s.extend(m,e.settings.multipart_params),function(e,t){f.append(t,e)}),f.append(e.settings.file_data_name,d),T.send(f,{runtime_order:e.settings.runtimes,required_caps:e.settings.required_features,preferred_caps:$,swf_url:e.settings.flash_swf_url,xap_url:e.settings.silverlight_xap_url})):(l=s.buildUrl(e.settings.url,s.extend(m,e.settings.multipart_params)),T.open("post",l,!0),T.setRequestHeader("Content-Type","application/octet-stream"),s.each(e.settings.headers,function(e,t){T.setRequestHeader(t,e)}),T.send(d,{runtime_order:e.settings.runtimes,required_caps:e.settings.required_features,preferred_caps:$,swf_url:e.settings.flash_swf_url,xap_url:e.settings.silverlight_xap_url})))}var r,l=e.settings.url,c=e.settings.chunk_size,p=e.settings.max_retries,h=e.features,u=0;i.loaded&&(u=i.loaded=c?c*Math.floor(i.loaded/c):0),r=i.getSource(),e.settings.resize.enabled&&d(r,"send_binary_string")&&~t.inArray(r.type,["image/jpeg","image/png"])?f.call(this,r,e.settings.resize,function(e){r=e,i.size=e.size,o()}):o()}function v(e,t){l(t)}function w(e){if(e.state==s.STARTED)S=+new Date;else if(e.state==s.STOPPED)for(var t=e.files.length-1;t>=0;t--)e.files[t].status==s.UPLOADING&&(e.files[t].status=s.QUEUED,
c())}function x(){T&&T.abort()}function b(e){c(),a(function(){r.call(e)},1)}function _(e,t){t.code===s.INIT_ERROR?e.destroy():t.file&&(t.file.status=s.FAILED,l(t.file),e.state==s.STARTED&&(e.trigger("CancelUpload"),a(function(){r.call(e)},1)))}function D(e){e.stop(),s.each(R,function(e){e.destroy()}),R=[],L.length&&(s.each(L,function(e){e.destroy()}),L=[]),A.length&&(s.each(A,function(e){e.destroy()}),A=[]),$={},E=!1,S=T=null,C.reset()}var I,S,C,T,k=s.guid(),R=[],$={},L=[],A=[],E=!1;I={runtimes:t.Runtime.order,max_retries:0,chunk_size:0,multipart:!0,multi_selection:!0,file_data_name:"file",flash_swf_url:"js/Moxie.swf",silverlight_xap_url:"js/Moxie.xap",filters:{mime_types:[],prevent_duplicates:!1,max_file_size:0},resize:{enabled:!1,preserve_headers:!0,crop:!1},send_file_name:!0,send_chunk_number:!0},g.call(this,e,null,!0),C=new s.QueueProgress,s.extend(this,{id:k,uid:k,state:s.STOPPED,features:{},runtime:null,files:R,settings:I,total:C,init:function(){var e=this;return"function"==typeof I.preinit?I.preinit(e):s.each(I.preinit,function(t,i){e.bind(i,t)}),h.call(this),I.browse_button&&I.url?void u.call(this,I,function(i){"function"==typeof I.init?I.init(e):s.each(I.init,function(t,i){e.bind(i,t)}),i?(e.runtime=t.Runtime.getInfo(p()).type,e.trigger("Init",{runtime:e.runtime}),e.trigger("PostInit")):e.trigger("Error",{code:s.INIT_ERROR,message:s.translate("Init error.")})}):void this.trigger("Error",{code:s.INIT_ERROR,message:s.translate("Init error.")})},setOption:function(e,t){g.call(this,e,t,!this.runtime)},getOption:function(e){return e?I[e]:I},refresh:function(){L.length&&s.each(L,function(e){e.trigger("Refresh")}),this.trigger("Refresh")},start:function(){this.state!=s.STARTED&&(this.state=s.STARTED,this.trigger("StateChanged"),r.call(this))},stop:function(){this.state!=s.STOPPED&&(this.state=s.STOPPED,this.trigger("StateChanged"),this.trigger("CancelUpload"))},disableBrowse:function(){E=arguments[0]===i||arguments[0],L.length&&s.each(L,function(e){e.disable(E)}),this.trigger("DisableBrowse",E)},getFile:function(e){var t;for(t=R.length-1;t>=0;t--)if(R[t].id===e)return R[t]},addFile:function(e,i){function n(e,i){var n=[];t.each(c.settings.filters,function(t,i){o[i]&&n.push(function(n){o[i].call(c,t,e,function(e){n(!e)})})}),t.inSeries(n,i)}function r(e){var o=t.typeOf(e);if(e instanceof t.File){if(!e.ruid&&!e.isDetached()){if(!l)return!1;e.ruid=l,e.connectRuntime(l)}r(new s.File(e))}else e instanceof t.Blob?(r(e.getSource()),e.destroy()):e instanceof s.File?(i&&(e.name=i),d.push(function(t){n(e,function(i){i||(R.push(e),h.push(e),c.trigger("FileFiltered",e)),a(t,1)})})):t.inArray(o,["file","blob"])!==-1?r(new t.File(null,e)):"node"===o&&"filelist"===t.typeOf(e.files)?t.each(e.files,r):"array"===o&&(i=null,t.each(e,r))}var l,c=this,d=[],h=[];l=p(),r(e),d.length&&t.inSeries(d,function(){h.length&&c.trigger("FilesAdded",h)})},removeFile:function(e){for(var t="string"==typeof e?e:e.id,i=R.length-1;i>=0;i--)if(R[i].id===t)return this.splice(i,1)[0]},splice:function(e,t){var n=R.splice(e===i?0:e,t===i?R.length:t),a=!1;return this.state==s.STARTED&&(s.each(n,function(e){if(e.status===s.UPLOADING)return a=!0,!1}),a&&this.stop()),this.trigger("FilesRemoved",n),s.each(n,function(e){e.destroy()}),a&&this.start(),n},bind:function(e,t,i){var n=this;s.Uploader.prototype.bind.call(this,e,function(){var e=[].slice.call(arguments);return e.splice(0,1,n),t.apply(this,e)},0,i)},destroy:function(){this.trigger("Destroy"),I=C=null,this.unbindAll()}})},s.Uploader.prototype=t.EventTarget.instance,s.File=function(){function e(e){s.extend(this,{id:s.guid(),name:e.name||e.fileName,type:e.type||"",size:e.size||e.fileSize,origSize:e.size||e.fileSize,loaded:0,percent:0,status:s.QUEUED,lastModifiedDate:e.lastModifiedDate||(new Date).toLocaleString(),getNative:function(){var e=this.getSource().getSource();return t.inArray(t.typeOf(e),["blob","file"])!==-1?e:null},getSource:function(){return i[this.id]?i[this.id]:null},destroy:function(){var e=this.getSource();e&&(e.destroy(),delete i[this.id])}}),i[this.id]=e}var i={};return e}(),s.QueueProgress=function(){var e=this;e.size=0,e.loaded=0,e.uploaded=0,e.failed=0,e.queued=0,e.percent=0,e.bytesPerSec=0,e.reset=function(){e.size=e.loaded=e.uploaded=e.failed=e.queued=e.percent=e.bytesPerSec=0}},e.plupload=s}(window,mOxie),define("libs/plupload/plupload.full.min",function(){}),define("libs/plupload/form-file-uploader",["../../parts/common","utils","./plupload.full.min"],function(e,t,i){function n(e,t){this.uniqueNumber=function(){var e=0;return function(){return++e}}(),this.uploadedImages={},this.uploaderRefs={},this.uploaderFileRefs={},this.formFileDelToken=null,this.plupload=window.plupload,this.parent=t,this.parentPageview=e}return n.prototype={initUploader:function(e,t,i,n,a){var o=this;console.debug("init Uploader start.taskId="+i);var s=2e7,r={};this.isShare=a,this.parentPageview.ajax({url:"/oss/policy",type:"GET",success:function(e){r.accessid=e.data.accessid,r.policy=e.data.policy,r.signature=e.data.signature,r.key=e.data.dir,r.success_action_status=201,r.host=e.data.host}});var l=$(e),c=$(t),p="",d=l.length,h=c.length;1!==d&&console.error("init Uploader found picker size!=1 but:"+d),1!==h&&console.error("init Uploader found container size!=1 but:"+h);var u=l.attr("uploader-init");if(u)return p=l.attr("data-uploader-id"),console.info("uploader inited before.uploaderId="+p),p;p="id_"+this.uniqueNumber(),l.attr("uploader-init","true").attr("data-uploader-id",p),c.attr("data-uploader-id",p),this.uploadedImages[p]=[],e.nodeType||(e=e[0]);p=l.attr("data-uploader-id");var f=new this.plupload.Uploader({runtimes:"html5,flash,silverlight,html4",browse_button:e.children[0],multi_selection:!0,flash_swf_url:"./Moxie.swf",silverlight_xap_url:"./Moxie.xap",url:"http://oss.aliyuncs.com",filters:{},init:{PostInit:function(){},FilesAdded:function(e,t){var i=o.parent.fileMaxNum-o.parent.fileNum;e.files.length>i&&(console.debug("length1:"+e.files.length),e.splice(i,999),e.refresh()),e.settings.browse_button[0].disabled=!0,e.start()},BeforeUpload:function(e,t){var i=(new Date).getTime();if(t.name=i+"_"+t.name,console.debug("当前时间:"+i),t.size&&t.size>s)return e.state=o.plupload.FAILED,e.removeFile(t.id),o.parentPageview.showTip({text:"文件大小超出限制！",duration:1e3}),!1;var a={key:r.key+"_"+t.name,policy:r.policy,OSSAccessKeyId:r.accessid,success_action_status:"200",signature:r.signature};e.setOption({url:r.host,multipart_params:a,fileNumLimit:n})},UploadProgress:function(e,t){o.parentPageview.showLoading({text:"上传中 "+t.percent+"%"}),console.log(t.id+":"+t.name+" 上传%:"+t.percent)},FileUploaded:function(e,t,n){if(e.settings.browse_button[0].disabled=!1,200===n.status){var a={};a.share=o.isShare||"",a.id=t.id,a.name=t.name,a.type=t.type,a.dir=r.key,a.taskId=i<=-1?"":i,a.processInstanceId="",o.parentPageview.ajax({url:o.getAppServerUrl()+"/file/saveFileModel",data:JSON.stringify(a),type:"POST",dataType:"json",contentType:"application/json",success:function(i){if(o.parentPageview.hideLoading(!0),console.log(t.id+":"+t.name+" 上传完毕"),i.success){o.parentPageview.showTip({text:"上传成功",duration:1e3});var n=i.data;o.uploaderFileRefs[n.id]=t,o.parent.loadFilesData(i.data),o.recordFileUploaded(p,n)}else o.parentPageview.showTip({text:"上传失败："+i.msg,duration:2e3}),f.removeFile(t),console.log(t.name+"上传失败:"+i.msg);e.removeFile(t.id),e.refresh()}})}else e.fail(n.response),console.error(n.response)},Error:function(e,t){t.code===-601&&(e.settings.browse_button[0].disabled=!1)}}});return f.setOption("fileNumLimit",12),this.uploaderRefs[p]=f,f.me=this,f.init(),p},recordFileUploaded:function(e,t){console.debug("recordFileUploaded:"+e+"-->"+t.id+",type="+t.type);var i=$("div.uploadimg-container[data-uploader-id='"+e+"']");this.showFileInContainer(i,t,e,!0,!0)},showFileInContainer:function(e,t,i,n,a){var o=this,s=e.children(".upload-file-preview").length;s>=12&&(console.error("文件数量已经超过12个,则不再显示"),$("div.choose-file-btn[data-uploader-id='"+i+"']").css("display","none"));var r=t.id;this.uploadedImages[i].push(r);var l=this.createFileShowDiv(t);e.find(".choose-file-btn").before(l),s++,this.updateFileContainerSize(e),this.updateUploaderLimit(i,e.children(".upload-file-preview").length),console.debug("imgLen:"+s),s>=12&&(console.debug("隐藏文件上传按钮"),$("div.choose-file-btn[data-uploader-id='"+i+"']").css("display","none")),n&&o.createFileDelIcon(l,function(){a?o.deleteServerUploadImage(r,function(){o.removeUploadFileInPage(l,i,r,e)}):o.removeUploadFileInPage(l,i,r,e)})},updateUploaderLimit:function(e,t){var i=this.uploaderRefs[e],n=i.getOption("fileNumLimit"),a=12-t;console.info("更新uploader的文件数限制:"+n+"-->"+a+"-->"+i.getOption("fileNumLimit")),a>0&&a<=12?($("div.choose-file-btn[data-uploader-id='"+e+"']").css("display",""),$("div.uploadimg-container[data-uploader-id='"+e+"']").children(":eq(1)").css("display",""),$(".moxie-shim").each(function(){$(this).height(48),$(this).width(48)})):$("div.choose-file-btn[data-uploader-id='"+e+"']").css("display","none")},removeUploadFileInPage:function(e,t,i,n){console.debug("移除页面上的文件:delFileId="+i+",uploaderId="+t),e.remove();var a=this.uploaderRefs[t];n.children(".upload-file-preview").length<a.getOption("fileNumLimit")&&($("div.choose-file-btn[data-uploader-id='"+t+"']").css("display",""),$("div.uploadimg-container[data-uploader-id='"+t+"']").children(":eq(1)").css("display",""));var o=this.uploadedImages[t];console.debug("thisUploaderFiles="+o.length),$.each(o,function(e,n){if(console.debug("loop:"+e+",fileId="+n),i===n){console.debug("删除的文件的idx="+e),console.debug("删除前文件数组="+o),o.splice(e,1),console.debug("删除后文件数组="+o);var a=(this.uploaderRefs[t],this.uploaderFileRefs[i]);return a&&console.debug("清除uploader里记录的文件.uploaderId="+t+",file="+a),!1}}),this.updateFileContainerSize(n),this.updateUploaderLimit(t,n.children(".upload-file-preview").length)},uploadedFileCacheToForm:function(){console.debug("uploadedFileCacheToForm..."),$.each(this.uploadedImages,function(e,t){console.debug("附件toForm :"+e+","+t);var i=t.join(",");$("div.choose-file-btn[data-uploader-id='"+e+"']").find("input.upload-file-store").val(i)})},deleteAllServerUploadImage:function(e,t,i){var n=this,a=[];if($.each(this.uploadedImages,function(e,t){console.debug("删除附件 :"+e+","+t),a=a.concat(t)}),e.length>0){console.info("所有附件id:"+a.join(",")),console.info("过滤掉不能删除的附件id:"+e.join(","));var o=a.filter(function(t){var i=e.indexOf(t);return i===-1});console.info("剩下需要删除的附件id:"+o.join(",")),a=o}if(a.length>0){var s=a.join(",");n.deleteServerAttas(s,t,i)}else console.debug("没有附件需要删除"),t&&t()},deleteSubFormServerUploadImages:function(e,t,i,n){var a=this;console.debug("删除子表"+e+"的第"+t+"条记录里的文件.字段名:"+i),a.uploadedFileCacheToForm(),$.each(i,function(i,o){var s=$("input.upload-file-store[name='"+e+"."+o+"']").eq(t),r=s.val();if(console.debug("删除表单域 "+o+"对应的文件="+r),null!==r&&r.length>0){if(n){console.debug("删除服务器里的文件");var l=r.split(",");$.each(l,function(e,t){a.deleteServerUploadImage(t)})}else console.debug("不删除服务器里的文件");var c=s.parents("div.choose-file-btn"),p=c.attr("data-uploader-id");console.debug("删除表单域 "+o+"对应的缓存id="+p+",清空..."),this.uploadedImages[p]=[]}})},deleteServerUploadImage:function(e,t,i){console.debug("delete attach.imgId="+e),this.deleteServerAttas(e,t,i)},deleteServerAttas:function(e,t,i){this.parentPageview.ajax({url:"file/deleteAttachment",data:{fileIds:e,token:this.formFileDelToken},success:function(){console.debug("删除已上传到服务器的临时附件成功"),t&&t()},error:function(){i&&i()}})},updateUploaderSize:function(){console.debug("更新uploader上传插件的大小"),$("div.webuploader-container").css("position","absolute"),$("div.webuploader-pick").removeClass("webuploader-pick").removeClass("webuploader-pick-hover"),$("div[id^='rt_rt_']").css({left:"0px",top:"0px",width:"100%",height:"100%","z-index":10})},getAppServerUrl:function(){var e="";return 0===e.toLowerCase().indexOf("file://")?"//ys.yyuap.com/weixin-mp-prod":e},createFileShowDiv:function(e){var t=this,i=this.getAppServerUrl(),n=e.type?e.type.toLowerCase():"",a=null;if(n.length>6&&"image/"==n.substring(0,6)){console.debug("image file."+e.id+".type="+n);var o=e.aliOSSLimitUrl,s=i+"/static/image/loading.gif",r=document.documentElement.clientWidth,l=(parseInt(r/4),o);console.info(l),this.createPrefetch(o),a=$("<img src='"+s+"' class='tab3-img'></img>");var c=new Image;c.src=l,c.onload=function(){console.debug("litterImg load over. "+this.src),a.attr("src",this.src)},c.onerror=function(){a.attr("src",i+"/static/image/fail.jpg")},this.bindClickEvent(a,function(){$.post(i+"/oss/file?filename="+e.externalUrl,function(e){var e=$.parseJSON(e);t.showImg(e.url)})})}else{var p=e.name;a=$('<a href="'+i+"/file/downloadattachment/"+e.id+'" target="_blank" class="tab3-img font-size-3 tab3-notimg-file"><i class="icon iconfont icon-enclosure"></i><br>'+p+"</a>")}var d=$('<div class="tab3-img-div upload-file-preview"></div>');return d.append(a),d},createPrefetch:function(e){var t='<link rel="prefetch prerender" href="'+e+'">';$("body").append(t)},bindClickEvent:function(e,t){$(e).on("click",function(){t&&t(),t&&t()})},updateFileContainerSize:function(e){console.debug("设置文件显示区域大小");var t=e.children(".upload-file-preview").length;t>0?e.css("height","auto"):e.css("min-height","0");var i=10;i=1===t?10:t>=3?14:7*t,e.css("width",i+"rem"),console.debug("更新文件container的width="+i+"实际结果="+e.css("width"))},createFileDelIcon:function(e,t){var i=$('<i class="upload-icon iconfont icon-delete"></i>');e.append(i),this.bindClickEvent(i,function(){t&&t()})},getAppUrl:function(){var e=location.href,t=e.indexOf("/static/");t===-1&&(t=e.indexOf("/form/"));var i=e.substring(0,t);return i},showImg:function(e){var t=this,i=(document.documentElement.clientWidth,this.getAppServerUrl()+"/static/image/loading.gif"),n=location.href.indexOf("/form/"),a=null;n===-1?(console.debug("---------其他界面显示大图"),a='<div class="img-view-bg z-index-newPage-bg bg-opactity"></div>',a+='<div class="img-view-bg z-index-newPage">',a+='\t<div class="img-whole">',a+='\t\t<img src="'+i+'" class="img-view img-filter" title="图片" id="bigImg">',a+=" \t</div>",a+="</div>"):(console.debug("--------->>表单附件上传界面显示缩略图图"),a='<div class="img-view-bg-sl z-index-newPage-bg-sl bg-opactity"></div>',a+='<div class="img-view-bg-sl z-index-newPage">',a+='\t<div class="img-whole-sl">',a+='\t\t<img src="'+i+'" class="img-view-sl img-filter" title="图片" id="bigImg">',a+=" \t</div>",a+="</div>"),$("body").append(a),$("#bigImg").animate({opacity:"1"},500,function(){$(this).on("error",function(){var e=t.getAppServerUrl();$("#bigImg").attr("src",e+"/static/image/fail.jpg")}),$(this).attr("src",e)}),this.bindClickEvent(".img-view-bg",function(){$(".img-view-bg").remove()}),this.bindClickEvent(".img-view-bg-sl",function(){$(".img-view-bg-sl").remove()})}},n}),define("components/ApplyFile",["./ApplyBase","utils","../parts/common","../libs/plupload/form-file-uploader"],function(e,t,i,n){function a(e){var n=this;a.baseConstructor.call(this,e),this.fileMaxNum=this.itemData.isSingle?1:9,this.fileNum=0,this.format={"application/msword":{ext:"word.png"},"application/pdf":{ext:"pdf.png"},"application/pgp-signature":{ext:"other.png"},"application/postscript":{ext:"other.png"},"application/rtf":{ext:"other.png"},"application/vnd.ms-excel":{ext:"exc.png"},"application/vnd.ms-powerpoint":{ext:"ppt.png"},"application/zip":{ext:"zipfile.png"},"application/x-shockwave-flash":{ext:"other.png"},"application/vnd.openxmlformats-officedocument.wordprocessingml.document":{ext:"word.png"},"application/vnd.openxmlformats-officedocument.wordprocessingml.template":{ext:"word.png"},"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":{ext:"exc.png"},"application/vnd.openxmlformats-officedocument.presentationml.presentation":{ext:"ppt.png"},"application/vnd.openxmlformats-officedocument.presentationml.template":{ext:"other.png"},"application/vnd.openxmlformats-officedocument.presentationml.slideshow":{ext:"other.png"},"application/x-javascript":{ext:"other.png"},"application/json":{ext:"other.png"},"audio/mpeg":{ext:"other.png"},"audio/x-wav":{ext:"music.png"},"audio/x-m4a":{ext:"music.png"},"audio/ogg":{ext:"music.png"},"audio/aiff":{ext:"other.png"},"audio/flac":{ext:"other.png"},"audio/aac":{ext:"other.png"},"audio/ac3":{ext:"other.png"},"audio/x-ms-wma":{ext:"other.png"},"image/bmp":{ext:"pic.png"},"image/gif":{ext:"pic.png"},"image/jpeg":{ext:"pic.png"},"image/photoshop":{ext:"other.png"},"image/png":{ext:"pic.png"},"image/svg+xml":{ext:"other.png"},"image/tiff":{ext:"other.png"},"text/plain":{ext:"text.png"},"text/html":{ext:"other.png"},"text/css":{ext:"other.png"},"text/csv":{ext:"other.png"},"text/rtf":{ext:"other.png"},"video/mpeg":{ext:"video.png"},"video/quicktime":{ext:"video.png"},"video/mp4":{ext:"video.png"},"video/x-m4v":{ext:"video.png"},"video/x-flv":{ext:"video.png"},"video/x-ms-wmv":{ext:"video.png"},"video/avi":{ext:"video.png"},"video/webm":{ext:"video.png"},"video/3gpp":{ext:"video.png"},"video/3gpp2":{ext:"video.png"},"video/vnd.rn-realvideo":{ext:"video.png"},"video/ogg":{ext:"video.png"},"video/x-matroska":{ext:"video.png"},"application/vnd.oasis.opendocument.formula-template":{ext:"other.png"},"application/octet-stream":{ext:"other.png"},unknow:{ext:"other.png"}},this.titleKey=this.id+"_title",this.root.push(this.titleKey),this.root.push(this.id),this.imageKey=this.id+"_image",this.imageDelKey=this.id+"_imagedelbtn",this.subComponentKey=this.id+"_addbtn",this.itemData.tips="请上传附件",this.components[this.titleKey]=i.getCtlTitle(this.itemData.title),this.components[this.id]={type:"repeat",subComponentAlwaysShow:!0,ref:!0,items:[],root:[this.imageKey,this.imageDelKey],style:t.processStyle({flexDirection:"row",flexWrap:"wrap",marginBottom:10,paddingLeft:5}),itemStyle:t.processStyle({w:90,justifyContent:"center",alignItems:"center"}),subComponent:this.subComponentKey},this.components[this.subComponentKey]={type:"icon",text:"＋",style:t.processStyle({w:80,backgroundColor:"#fff",marginTop:5,marginLeft:5,border:"1px dashed rgb(207,207,207)"}),textStyle:t.processStyle({color:"rgb(207,207,207)",fontSize:49})},this.components[this.imageDelKey]={type:"icon",font:"icomoon_e909",style:t.processStyle({position:"absolute",right:8,border:"2px solid #fff",borderRadius:"100%",backgroundColor:"#fff",top:8}),iconStyle:t.processStyle({color:"#FC505F",fontSize:17})},this.components[this.imageKey]={type:"image",src_bind:"src",src:"",style:t.processStyle({width:80,borderRadius:5,border:"1px solid #ededed",backgroundColor:"rgba(244,244,244,.1)"})},this.plugin[this.subComponentKey+"_didmount"]=function(e,t){setTimeout(function(){n.initUploader(e)},1e3)},this.plugin[this.subComponentKey+"_click"]=function(e,t){var i=e.parent.rowInstance;return i?n.RepeatInstance=i.refs[n.id]:n.RepeatInstance=this.pageview.refs[n.id],n.fileNum=n.RepeatInstance.datasource.length,n.RepeatInstance.datasource.length>=n.fileMaxNum?void n.plugin.pageview.showTip({text:"最多上传"+n.fileMaxNum+"张图片",duration:1e3}):void e.parent.$el.find(".moxie-shim.moxie-shim-html5 input").click()},this.plugin[this.id+"_itemclick"]=function(e,t){var i=e.datasource.aliOSSUrl,a=e.datasource.type,o=e.datasource.name.split("_")[1];if(a.indexOf("image/")>-1)try{window.yyesn.client.viewImage({files:i})}catch(e){}else{var s="."+o.split(".")[1];o.length>=20&&(o=o.substring(0,20)+".."),n.plugin.pageview.showTip({text:o+s,duration:2e3})}},this.plugin[this.imageDelKey+"_click"]=function(e,t){e.rowInstance.remove(),n.fileUploader.deleteServerUploadImage(e.datasource.id,function(e){})},setTimeout(function(){},1e3)}return t.extends(a,e),a.prototype.initUploader=function(e){var t=this,i="";this.loadToken(function(e){t.token=e});var a=e.parent.$el,o=e.parent.$el,s=this.fileMaxNum-(this.RepeatInstance&&this.RepeatInstance.datasource.length||0);this.fileUploader=new n(this.plugin.pageview,this),i=this.plugin.pageview.params.share||"",this.uploaderId=this.fileUploader.initUploader(a,o,"",s,i),setTimeout(function(){t.fileUploader.updateUploaderSize()},100)},a.prototype.loadToken=function(e){this.plugin.pageview.ajax({url:"user/getToken",success:function(t){e(t)},error:function(e){console.error(e)}})},a.prototype.loadFilesData=function(e){var t="";t=e.type.indexOf("image/")>-1?e.aliOSSLimitUrl:"./imgs/"+(this.format[e.type]?this.format[e.type].ext:this.format.unknow.ext),this.RepeatInstance.datasource.length>this.fileMaxNum-1||this.RepeatInstance.addItem($.extend(e,{src:t}))},a.prototype.getValue=function(){return this.plugin.pageview.refs[this.id].datasource},a.prototype.bindInitValueInRepeat=function(e){var t=e.datasource[this.id]||[];if(t instanceof Array){for(var i=[],n=0,a=t.length;n<a;n++)i.push({src:t[n]});e.config.items=i}},a.prototype.bindInitValue=function(e){var t=this.itemData.value||[];if(t instanceof Array){for(var i=[],n=0,a=t.length;n<a;n++)i.push({src:t[n]});e.config.items=i}},a.prototype.getValueWhenItemInRepeat=function(e){return e.refs[this.id].datasource},a.prototype.getConfig=function(e){var i,n=t.copy(this.itemData);if(i=e?this.getValueWhenItemInRepeat(e)||[]:this.getValue()||[],this.isRequired&&0===i.length)return this.showRequiedTip(),!1;for(var a=[],o=0,s=i.length;o<s;o++)a.push({src:i[o].src,id:i[o].id,name:i[o].name,type:i[o].type,aliOSSUrl:i[o].aliOSSUrl});return n.value=a,n},a}),define("components/ApplyIdentifyCode",["./ApplyBase","utils","../parts/commonLayout"],function(e,t,i){function n(e){var a=this;this.countDownLock=!1;var o={};n.baseConstructor.call(this,e),i.switchIdentifyCodeLayout(this,o),this.itemData.required=!0,this.plugin[this.id+"_button_click"]=function(e,i){function n(){o>=0?(e.$el.html(o+" s"),setTimeout(function(){o--,n()},1e3)):(e.$el.css({borderColor:"#29b6f6",color:"#29b6f6"}),e.$el.html("重新获取"),a.countDownLock=!1)}if(a.phone=a.plugin.pageview.refs[a.itemData.mobileId].getValue(),!a.phone)return a.plugin.pageview.showTip({text:"请输入手机号码！",duration:1e3}),!1;if(a.phone&&!t.isPhone(a.phone))return a.plugin.pageview.showTip({text:"手机号格式不对！",duration:1e3}),!1;var o=60;a.plugin.pageview.ajax({url:"sms/sendVerCode",type:"GET",data:{mobile:a.phone},success:function(t){a.countDownLock||(a.countDownLock=!0,e.$el.css({borderColor:"#bbb",color:"#aaa"}),n())},error:function(){a.countDownLock||(a.countDownLock=!0,e.$el.css({borderColor:"#bbb",color:"#aaa"}),n())}})}}return t.extends(n,e),n.prototype.getValue=function(){var e=this.plugin.pageview.refs[this.itemData.fieldId].$el.find("input").val();return{mobile:this.phone||this.plugin.pageview.refs[this.itemData.mobileId].getValue(),smsVerCode:e}},n.prototype.getConfig=function(e){var i,n=t.copy(this.itemData);return i=this.getValue(),i.smsVerCode?(n.value=i||"",n):(this.plugin.pageview.showTip({text:"请输入验证码! ",duration:1e3}),!1)},n}),define("components/ApplyImage",["./ApplyBase","utils","../parts/common"],function(e,t,i){function n(e){var a=this;n.baseConstructor.call(this,e),this.titleKey=this.id+"_title",this.root.push(this.titleKey),this.root.push(this.id),this.imageKey=this.id+"_image",this.imageDelKey=this.id+"_imagedelbtn",this.subComponentKey=this.id+"_addbtn",this.components[this.titleKey]=i.getCtlTitle(this.itemData.title),this.components[this.id]={type:"repeat",subComponentAlwaysShow:!0,ref:!0,items:[],root:[this.imageKey,this.imageDelKey],style:t.processStyle({flexDirection:"row",flexWrap:"wrap",marginBottom:10,paddingLeft:5}),itemStyle:t.processStyle({w:90,justifyContent:"center",alignItems:"center"}),subComponent:this.subComponentKey},this.components[this.subComponentKey]={type:"icon",text:"＋",style:t.processStyle({w:80,backgroundColor:"#fff",marginTop:5,marginLeft:5,border:"1px dashed rgb(207,207,207)"}),textStyle:t.processStyle({color:"rgb(207,207,207)",fontSize:49})},this.components[this.imageDelKey]={type:"icon",font:"icomoon_e909",style:t.processStyle({position:"absolute",right:8,border:"2px solid #fff",borderRadius:"100%",backgroundColor:"#fff",top:8}),iconStyle:t.processStyle({color:"#FC505F",fontSize:17})},this.components[this.imageKey]={type:"image",src_bind:"src",src:"",style:t.processStyle({w:80,backgroundColor:"rgba(0,0,0,.1)"})};var o=10;this.plugin[this.subComponentKey+"_click"]=function(e,t){if(window.isPreview!==!0){var i,n=e.parent.rowInstance;if(i=n?n.refs[a.id]:this.pageview.refs[a.id],i.datasource.length>=o)return void a.pageview.showTip({text:"最多上传"+o+"张图片",duration:1e3,style:{width:"220px"}});try{var s=o-i.datasource.length;window.yyesn.client.selectAttachment(function(e){var t=e.data;t.length>s&&this.pageview.showTip({text:"最多上传5张图片",duration:1e3,style:{width:"220px"}});for(var n=0,a=s;n<a;n++)i.addItem({src:t[n].path})},{type:1,maxselectnum:s})}catch(e){}}},this.plugin[this.id+"_itemclick"]=function(e,t){for(var i=[],n=0,a=e.parent.datasource.length;n<a;n++)i.push(e.parent.datasource[n].src);try{window.yyesn.client.viewImage({files:i.join(","),index:parseInt(t.index)})}catch(e){}},this.plugin[this.imageDelKey+"_click"]=function(e,t){e.rowInstance.remove()}}return t.extends(n,e),n.prototype.getValue=function(){return this.plugin.pageview.refs[this.id].datasource},n.prototype.bindInitValueInRepeat=function(e){var t=e.datasource[this.id]||[];if(t instanceof Array){for(var i=[],n=0,a=t.length;n<a;n++)i.push({src:t[n]});e.config.items=i}},n.prototype.bindInitValue=function(e){var t=this.itemData.value||[];if(t instanceof Array){for(var i=[],n=0,a=t.length;n<a;n++)i.push({src:t[n]});e.config.items=i}},n.prototype.getValueWhenItemInRepeat=function(e){return e.refs[this.id].datasource},n.prototype.getConfig=function(e){var i,n=t.copy(this.itemData);if(i=e?this.getValueWhenItemInRepeat(e)||[]:this.getValue()||[],this.isRequired&&0===i.length)return this.showRequiedTip(),!1;for(var a=[],o=0,s=i.length;o<s;o++)a.push(i[o].src);return n.value=a,n},n}),define("components/ApplyInputCheckbox",["./ApplyBase","utils","../parts/commonLayout"],function(e,t,i){function n(e){var t=this,a=[];n.baseConstructor.call(this,e),a.title="选项",i.createItemLayout(this,a),this.checkListID=this.id+"_radiolist",this.plugin[this.checkListID+"_selected"]=function(e,i){for(var n=[],a=0,o=i.selectedValue.length;a<o;a++)n.push(i.selectedValue[a].name);t.curFormRowInstance?(t.curFormRowInstance.datasource[t.id]=i.selectedValue,t.curFormRowInstance.refs[t.id].setText(n.join(","))):this.pageview.refs[t.id].setText(n.join(","))},e.plugin[this.checkListID+"_init"]=function(e,i){t.isInDetail||t.bindSelectListInitValue(e)},this.createCheckOrRadioList("checklist")}return t.extends(n,e),n.prototype.bindInitValue=function(e){var t=[],i=this.itemData.values,n=this.itemData.options||[];if(i&&i.length>0)i.split(",").forEach(function(e,i){for(var a=0,o=n.length;a<o;a++)n[a].selectionId===e&&t.push(n[a].name)}),e.config.text=t.join(",");else{for(var a=0,o=n.length;a<o;a++)n[a].defOption&&t.push(n[a].name);t.length>0&&(e.config.text=t.join(","))}},n.prototype.bindInitAuth=function(e){this.authInfo&&this.authInfo.readonly&&setTimeout(function(){e.setDisabled(!0),e.$el.css({opacity:1})},10)},n.prototype.bindInitValueInRepeat=function(e){var t=e.datasource[this.id],i=this.itemData.options||[],n=[],a=[];if(t)t.split(",").forEach(function(e,t){for(var o=0,s=i.length;o<s;o++)i[o].selectionId===e&&(n.push(i[o].name),a.push(e))}),e.config.text=n.join(",");else{for(var o=0,s=i.length;o<s;o++)i[o].defOption&&(n.push(i[o].name),a.push(i[o]));n.length>0&&(e.config.text=n.join(","))}e.config.selectedValue=a},n.prototype.bindSelectListInitValue=function(e){var t=[],i=this.itemData.values,n=this.itemData.options||[];if(i&&i.length>0)i.split(",").forEach(function(e,i){for(var a=0,o=n.length;a<o;a++)n[a].selectionId===e&&t.push(n[a])});else for(var a=0,o=n.length;a<o;a++)n[a].defOption&&t.push(n[a]);e.config.selectedValue=t},n.prototype.getValue=function(){return this.plugin.pageview.refs[this.checkListID].selectedValue},n.prototype.getValueWhenItemInRepeat=function(e){return e.datasource[this.id]?e.datasource[this.id]:this.getDefaultOptions()},n.prototype.getDefaultOptions=function(){for(var e=[],t=this.itemData.options||[],i=0,n=t.length;i<n;i++)t[i].defOption&&e.push(t[i]);return e},n.prototype.getConfig=function(e){var i,n={},a="",o=this,s=t.copy(this.itemData);if(i=e?this.getValueWhenItemInRepeat(e)||[]:this.getValue()||[],this.isRequired&&0===i.length)return this.showRequiedTip(),!1;var r=[];if(i instanceof Array){for(var l=0,c=i.length;l<c;l++)r.push(i[l].selectionId);s.value=r.join(",")}else s.value=i||"";if(this.itemData.options.forEach(function(e,t){o.plugin.optionsFlow[e.selectionId]=e.name}),!e&&this.itemData.crux){for(var p=this.plugin.pageview.refs[this.checkListID].selectedValue||[],d=[],l=0,c=p.length;l<c;l++)d.push(p[l].name);d.length>0&&(a=d.join(",")),n.key=this.itemData.title||"选项",n.value=a,n.code=this.itemData.columncode}return s.keyFeature=n,s},n}),define("components/ApplyInputDate",["./ApplyBase","utils","../parts/commonLayout"],function(e,t,i){function n(e){var a=this,o={};n.baseConstructor.call(this,e),o.title="日期",i.createItemLayout(this,o);var s=this.itemData.format.toLowerCase();switch(s){case"yyyy-mm-dd":this.dateType="1";break;case"yyyy-mm-dd hh:mm":this.dateType="2";break;case"hh:mm:ss":this.dateType="3";break;case"yyyy-mm":this.dateType="4";break;default:console.error("时间控件未指定准确类型")}this.authInfo.readonly||this.itemData.isReadonly||(this.plugin[this.id+"_warp_click"]=function(e,t){a.scrollIntoView(),"2"===a.dateType.toString()?(this.yyyyMMddhhssTimePicker.sender=e,this.yyyyMMddhhssTimePicker.curDateBetweenInstance=null,this.yyyyMMddhhssTimePicker.curDateInstance=a,this.yyyyMMddhhssTimePicker.show(a.getText(e))):"4"===a.dateType.toString()?(this.yyyyMMTimePicker.sender=e,this.yyyyMMTimePicker.curDateBetweenInstance=null,this.yyyyMMTimePicker.curDateInstance=a,this.yyyyMMTimePicker.show(a.getText(e))):(this.yyyyMMddTimePicker.sender=e,this.yyyyMMddTimePicker.curDateBetweenInstance=null,this.yyyyMMddTimePicker.curDateInstance=a,this.yyyyMMddTimePicker.show(a.getText(e)))}),this.itemData.isSystemDate&&(this.plugin[this.id+"_init"]=function(e,i){var n="";"yyyy-mm-dd hh:mm"===a.itemData.format.toLowerCase()?n="yyyy-MM-dd hh:mm":"yyyy-mm-dd"===a.itemData.format.toLowerCase()?n="yyyy-MM-dd":"yyyy-mm"===a.itemData.format.toLowerCase()&&(n="yyyy-MM"),e.config.text=t.ConvertDateToStr(new Date,n)})}return t.extends(n,e),n.prototype.setValue=function(e,t){var i=t.rowInstance;i?i.refs[this.id].setText(e):this.plugin.pageview.refs[this.id].setText(e),this.plugin[this.id+"_change"]&&this.plugin[this.id+"_change"].call(this.plugin,e,t)},n.prototype.bindInitValueInRepeat=function(e){var t=e.datasource[this.id]||"";t.length>0&&(e.config.text=t)},n.prototype.bindInitValue=function(e){"MODIFY"===this.plugin.mode&&(e.config.text=this.itemData.values)},n.prototype.getValue=function(){var e=this.plugin.pageview.refs[this.id].getText();return e.indexOf("请选择")>=0&&(e=null),e},n.prototype.getValueWhenItemInRepeat=function(e){var t=e.refs[this.id].getText();return t.indexOf("请选择")>=0&&(t=null),t},n.prototype.getText=function(e){var t=null,i=e.rowInstance;return t=i?i.refs[this.id].getText():this.plugin.pageview.refs[this.id].getText(),(!t||t.indexOf("请选择")>=0)&&(t=null),t},n}),define("components/ApplyInputDateBetween",["./ApplyBase","utils"],function(e,t){function i(e){var n=this;i.baseConstructor.call(this,e);var a=this.itemData.format.toLowerCase();if(a="yyyy-mm"===a?"0":"yyyy-mm-dd hh:mm"===a?"2":"1",this.dateType=a,this.isAutoCaculate="1"===this.itemData.autocalculate,this.createItem(),this.createItem("1"),this.isAutoCaculate){this.autoCalculateKey=this.id+"_autocaculate";var o=this.id+"_autocaculateLabel";this.autoCaculateLabelValue=this.id+"_autocaculatevalue",this.components[this.autoCalculateKey]={type:"view",className:"form-row",style:t.processStyle({height:40,flexDirection:"row",marginBottom:10,backgroundColor:"#fff",justifyContent:"center"}),root:[o,this.autoCaculateLabelValue]},this.components[o]={type:"text",numberofline:2,style:t.processStyle({width:240,fontSize:14,paddingLeft:13,color:"#262626"}),text:this.itemData.autocalculatetitle+("2"===this.dateType?"(时)":"1"===this.dateType?"(天)":"(月)")
},this.components[this.autoCaculateLabelValue]={type:"text",ref:!0,style:t.processStyle({flex:1,justifyContent:"flex-end",paddingRight:16,fontSize:15,color:"#b7b7b7"}),text:0},this.root.push(this.autoCalculateKey),this.plugin[this.autoCaculateLabelValue+"_init"]=function(e,t){var i=[];i=n.isInDetail?e.datasource[n.id]||[]:n.itemData.value||[],e.config.text=n.caculateDiff(i[0],i[1])}}this.plugin[this.id+"1_init"]=function(e,t){n.isInDetail?n.bindInitValueInRepeat1(e):(n.bindInitValue1(e),n.bindInitAuth(e))}}return t.extends(i,e),i.prototype.caculateDiff=function(e,i){if(!e||!i)return"0";"0"===this.dateType&&(e+="-01",i+="-01");var n=t.convertToDate(e),a=t.convertToDate(i),o=a-n,s=0;return o<=0?"2"===this.dateType||(s=1):s="2"===this.dateType?(o/36e5).toFixed(1):o/864e5+1,s=this.parseInt(s)},i.prototype.bindInitValue1=function(e){this.itemData.value=this.itemData.value||[],this.itemData.value instanceof Array||(this.itemData.value=[]);var t=this.itemData.value[1]||"";t=t.toString(),t.length>0&&(e.config.text=t)},i.prototype.bindInitValue=function(e){this.itemData.value=this.itemData.value||[],this.itemData.value instanceof Array||(this.itemData.value=[]);var t=this.itemData.value[0]||"";t=t.toString(),t.length>0&&(e.config.text=t)},i.prototype.bindInitValueInRepeat1=function(e){var t=e.datasource[this.id];t instanceof Array||(t=[]);var i=t[1]||"";i=i.toString(),i.length>0&&(e.config.text=i)},i.prototype.bindInitValueInRepeat=function(e){var t=e.datasource[this.id];t instanceof Array||(t=[]);var i=t[0]||"";i=i.toString(),i.length>0&&(e.config.text=i)},i.prototype.createItem=function(e){var i=this;e=e||"";var n=this.id+"_warp"+e,a=this.id+"_title"+e,o=this.id.toString()+""+e;this.components[n]={type:"view",className:"form-row "+("1"!==e||this.isAutoCaculate?"from-between-first":""),style:t.processStyle({backgroundColor:"#fff",height:50,marginBottom:"1"!==e||this.isAutoCaculate?0:1,fontSize:15,paddingLeft:13,flexDirection:"row"}),root:[a,o]};var s=this.itemData.tips?this.itemData.tips:"请选择";this.components[o]={type:"icon",ref:!0,textPos:"left",text:this.isRequired?s+" (必填)":s,font:"icomoon_e913",textStyle:t.processStyle({color:"#b7b7b7",fontSize:15,marginRight:6}),iconStyle:t.processStyle({color:"#CCC",fontSize:14}),style:t.processStyle({flex:1,justifyContent:"flex-end",paddingRight:16})};var r=this.itemData.title+(e?"(结束)":"(开始)");this.components[a]={type:"text",text:r,numberofline:2,style:{width:100,color:"#262626"}},this.root.push(n),this.authInfo.readonly||(this.plugin[n+"_click"]=function(t,n){i.scrollIntoView();var a="1"===e.toString()?"1":"0";"2"===i.dateType.toString()?(this.yyyyMMddhhssTimePicker.curDateBetweenInstance=i,this.yyyyMMddhhssTimePicker.curDateBetweenInstanceIndex=a,this.yyyyMMddhhssTimePicker.curDateInstance=null,this.yyyyMMddhhssTimePicker.sender=t,this.yyyyMMddhhssTimePicker.show(i.getSingleValue(a,t))):"0"===i.dateType.toString()?(this.yyyyMMTimePicker.curDateBetweenInstance=i,this.yyyyMMTimePicker.curDateBetweenInstanceIndex=a,this.yyyyMMTimePicker.curDateInstance=null,this.yyyyMMTimePicker.sender=t,this.yyyyMMTimePicker.show(i.getSingleValue(a,t))):(this.yyyyMMddTimePicker.curDateBetweenInstance=i,this.yyyyMMddTimePicker.curDateBetweenInstanceIndex=a,this.yyyyMMddTimePicker.curDateInstance=null,this.yyyyMMddTimePicker.sender=t,this.yyyyMMddTimePicker.show(i.getSingleValue(a,t)))})},i.prototype.getValue=function(){return[this.convertText(this.plugin.pageview.refs[this.id].getText())||"",this.convertText(this.plugin.pageview.refs[this.id+"1"].getText())||""]},i.prototype.getValueWhenItemInRepeat=function(e){return[this.convertText(e.refs[this.id].getText())||"",this.convertText(e.refs[this.id+"1"].getText())||""]},i.prototype.getConfigWhenItemInRepeatForSummary=function(e){var i=t.copy(this.itemData),n=this.getValueWhenItemInRepeat(e)||"";return i.value=n,i},i.prototype.getConfig=function(e){var i,n={},a=t.copy(this.itemData);if(e?i=this.getValueWhenItemInRepeat(e)||"":(i=this.getValue()||"",!e&&this.itemData.crux&&(n.key=this.itemData.title||"未命名",n.value=i,n.code=this.itemData.columncode)),this.isRequired)for(var o=0;o<=1;o++)if(0===i[o].length){var s=0===o?this.itemData.title:this.itemData.title1;this.showRequiedTip(s),i=!1;break}return i===!1?i:(a.value=i,a.keyFeature=n,a)},i.prototype.setSingleValue=function(e,t,i,n){var a=this.id.toString()+""+("0"===t?"":t),o=i.rowInstance;o?o.refs[a].setText(e):this.plugin.pageview.refs[a].setText(e),n||this.change(e,i,t)},i.prototype.setDiffStr=function(e,t){t?t.refs[this.autoCaculateLabelValue].setText(e):this.plugin.pageview.refs[this.autoCaculateLabelValue].setText(e)},i.prototype.change=function(e,i,n){var a=this.getSingleValue("0",i);a||(this.setSingleValue(e,"0",i,!0),a=e);var o=this.getSingleValue("1",i);o||(this.setSingleValue(e,"1",i,!0),o=e),"0"===this.dateType&&(a+="-01",o+="-01");var s=t.convertToDate(a),r=t.convertToDate(o),l=r-s,c=0;l<=0?("0"===n?this.setSingleValue(e,"1",i,!0):this.setSingleValue(e,"0",i,!0),"2"===this.dateType||(c=1)):c="2"===this.dateType?(l/36e5).toFixed(1):l/864e5+1,c=this.parseInt(c),this.isAutoCaculate&&(this.setDiffStr(c,i.rowInstance),this.isSummaryField&&this.DetailInstance&&this.DetailInstance.updateSummary(),this.isEnabledConditionField()&&(this.isInDetail||(this.itemData.diff=c),this.plugin.updateApproveLines()))},i.prototype.getSingleValue=function(e,t){var i,n=this.id.toString()+""+("0"===e?"":e),a=t.rowInstance;return i=a?a.refs[n].getText():this.plugin.pageview.refs[n].getText(),this.convertText(i)},i}),define("components/ApplyInputDateCalculate",["./ApplyBase","utils","../parts/commonLayout"],function(e,t,i){function n(e){var t=this,a=[];n.baseConstructor.call(this,e),a.title="日期",i.switchLayout(this,a),this.caculateData=[],console.log(this.itemData),this.itemData.dateFieldArr.forEach(function(e,i){"field"===e.type&&t.caculateData.push(e.value)}),this.caculateData.forEach(function(e,i){t.plugin[e+"_change"]=function(e,i){var n=t.getDateValue(i);n&&i.parent.$el.find("."+t.id).find("input").val(n)}})}return t.extends(n,e),n.prototype.getDateValue=function(e){var i=this,n=[],a=0;return this.caculateData.forEach(function(a,o){var s="";s=i.itemData.inDataTable?e.rowInstance.refs[a].getText():i.plugin.pageview.refs[a].getText();var r=/^(\d{4})-(\d{2})-(\d{2})$/,l=s,c=r.exec(l);$.isArray(c)&&c.length>0?n.push(+t.convertStrToDate(s)):n.push("")}),n[0]&&n[1]?(a=(n[0]-n[1])/1e3/60/60/24,(a>0||0===a)&&(a+=1),this.days=a,a+"（天）"):""},n.prototype.getValue=function(e,t){return this.days?this.days+"（天）":""},n}),define("components/ApplyInputEmail",["./ApplyBase","utils","../parts/commonLayout"],function(e,t,i){function n(e){var a=this,o=[];n.baseConstructor.call(this,e),o.title="邮箱",i.switchLayout(this,o),this.plugin[this.id+"_blur"]=function(e,i){a.getValue()&&!t.isEmail(a.getValue())?(a.setAttribute("verify",!0),a.setAttribute("verifyMsg",a.itemData.title+"格式错误！"),a.showTip("邮箱格式错误！")):a.setAttribute("verify",!1)}}return t.extends(n,e),n}),define("components/ApplyInputLink",["./ApplyBase","utils","../parts/commonLayout"],function(e,t,i){function n(e){var a=this,o={};n.baseConstructor.call(this,e),o.title="超链接",i.switchLayout(this,o),this.plugin[this.id+"_focus"]=function(e,t){},this.plugin[this.id+"_blur"]=function(e,i){var n=e.getValue();n&&!t.isRealURL(n)?(a.verify=!0,a.verifyMsg=(a.itemData.title||"")+"请输入正确的网址格式",a.scrollIntoView(),a.plugin.pageview.showTip({text:"请输入正确的网址格式",duration:1100})):a.verify=!1}}return t.extends(n,e),n}),define("components/ApplyInputMobile",["./ApplyBase","utils","../parts/commonLayout"],function(e,t,i){function n(e){var a=this,o={};n.baseConstructor.call(this,e),o.title="手机号码",i.switchLayout(this,o),this.plugin[this.id+"_blur"]=function(e,i){if("Mobile"===a.itemData.componentKey){if(a.getValue()&&!t.isPhone(a.getValue()))return a.verify=!0,a.verifyMsg="手机号格式不对！",a.showTip(a.verifyMsg),void a.scrollIntoView();a.verify=!1}else if("Phone"===a.itemData.componentKey){if(a.getValue()&&!t.isMobile(a.getValue()))return a.verify=!0,a.verifyMsg="座机号格式不对！",a.showTip(a.verifyMsg),void a.scrollIntoView();a.verify=!1}else a.showTip("未找到对应表单类型！")}}return t.extends(n,e),n}),define("components/ApplyInputPassword",["./ApplyBase","utils","../parts/commonLayout"],function(e,t,i){function n(e){var t={};n.baseConstructor.call(this,e),t.mode="password",t.title="密码",i.switchLayout(this,t),this.plugin[this.id+"_focus"]=function(e,t){}}return t.extends(n,e),n}),define("components/ApplyInputRadio",["./ApplyBase","utils","../parts/common"],function(e,t,i){function n(e){var t=this,a=[];n.baseConstructor.call(this,e),a.title="选项",i.createItemLayout(this,a),this.checkListID=this.id+"_radiolist",this.plugin[this.checkListID+"_selected"]=function(e,i){t.curFormRowInstance?(t.curFormRowInstance.datasource[t.id]=i.selectedValue,t.curFormRowInstance.refs[t.id].setText(i.selectedValue[0].name)):(this.pageview.refs[t.id].setText(i.selectedValue[0].name),t.isEnabledConditionField()&&this.updateApproveLines())},e.plugin[this.checkListID+"_init"]=function(e,i){t.isInDetail||t.bindSelectListInitValue(e)},this.createCheckOrRadioList("radiolist")}return t.extends(n,e),n.prototype.bindInitValue=function(e){if(""!==this.itemData.options&&void 0!==this.itemData.options&&null!==this.itemData.options){var t=[],i=this.itemData.values,n=this.itemData.options||[];if(i){for(var a="",o=0,s=n.length;o<s;o++)n[o].selectionId===i&&(a=n[o].name);e.config.text=a}else{for(var o=0,s=n.length;o<s;o++)n[o].defOption&&t.push(n[o].name);t.length>0&&(e.config.text=t.join(","))}}},n.prototype.bindSelectListInitValue=function(e){var t=[],i=this.itemData.values,n=this.itemData.options||[];if(i&&i.length>0)i.split(",").forEach(function(e,i){for(var a=0,o=n.length;a<o;a++)n[a].selectionId===e&&t.push(n[a])});else for(var a=0,o=n.length;a<o;a++)n[a].defOption&&t.push(n[a]);e.config.selectedValue=t},n.prototype.getValue=function(){return this.plugin.pageview.refs[this.checkListID].selectedValue[0].name},n.prototype.getRadioValue=function(){return this.plugin.pageview.refs[this.checkListID].selectedValue},n.prototype.bindInitValueInRepeat=function(e){var i=t.copy(e.datasource[this.id]),n=this.itemData.options||[],a=[];if(i){for(var o="",s=0,r=n.length;s<r;s++)n[s].selectionId===i&&(o=n[s].name);e.config.text=o}else{for(var s=0,r=n.length;s<r;s++)n[s].defOption&&a.push(n[s].name);a.length>0&&(e.config.text=a.join(","))}},n.prototype.getValueWhenItemInRepeat=function(e){return e.datasource[this.id]?e.datasource[this.id]:this.getDefaultOptions()},n.prototype.getDefaultOptions=function(){for(var e=[],t=this.itemData.options||[],i=0,n=t.length;i<n;i++)if(t[i].defOption){e.push(t[i]);break}return e},n.prototype.getConfig=function(e){var i="",n={},a="",o=this,s=t.copy(this.itemData);if(i=e?this.getValueWhenItemInRepeat(e):this.getRadioValue()||[],i instanceof Array&&i.length>0)s.value=i[0].selectionId+"";else if(i)s.value=i||"";else if(this.isRequired)return this.showRequiedTip(),!1;if(this.itemData.options.forEach(function(e,t){o.plugin.optionsFlow[e.selectionId]=e.name}),!e&&this.itemData.crux){var r=this.plugin.pageview.refs[this.checkListID].selectedValue||[];r.forEach(function(e,t){a+=e.name}),n.key=this.itemData.title||"选项",n.value=a,n.code=this.itemData.columncode}return s.keyFeature=n,s},n}),define("components/ApplyInputString",["./ApplyBase","utils"],function(e,t){function i(e){var n=this;i.baseConstructor.call(this,e),this.strKey=this.id+"_string",this.root.push(this.strKey),this.components[this.strKey]={type:"text",style:t.processStyle({whiteSpace:"pre",paddingTop:7,paddingBottom:6,borderBottom:"1px solid #ededed",fontSize:14,color:"#262626",paddingLeft:13,paddingRight:10}),textStyle:t.processStyle({whiteSpace:"pre-line"}),text:this.itemData.content},this.plugin[this.strKey+"_init"]=function(e,t){var i;switch(n.itemData.style){case"alert-none":i="#f5f5f5";break;case"alert-success":i="#dff0d8";break;case"alert-info":i="#d9edf7";break;case"alert-warning":i="#fcf8e3";break;case"alert-danger":i="#f2dede";break;default:i="#f5f5f5"}e.config.style.backgroundColor=i}}return t.extends(i,e),i.prototype.getValue=function(){return this.itemData.content},i}),define("components/ApplyInputText",["./ApplyBase","utils","../parts/commonLayout"],function(e,t,i){function n(e){var t=this,a={};n.baseConstructor.call(this,e),a.title="文本",i.switchLayout(this,a),t.isEditor=!0,this.plugin[this.id+"_focus"]=function(e,i){t.scrollIntoView()},this.plugin[this.id+"_blur"]=function(e,i){var n=e.getValue();e.setValue(t.limitTextLength(n))},this.plugin[this.id+"_input"]=function(e,i){if(t.isEditor){var n=e.getValue();e.setValue(t.limitTextLength(n))}},this.plugin[this.id+"_compositionstart"]=function(e,i){t.isEditor=!1},this.plugin[this.id+"_compositionend"]=function(e,i){t.isEditor=!0}}return t.extends(n,e),n.prototype.bindInitValueInRepeat=function(e){e.datasource[this.id]?e.config.value=e.datasource[this.id]:e.config.value=this.itemData.defaultValue},n}),define("components/ApplyInputTextMoney",["./ApplyBase","utils","../parts/common","../parts/commonLayout"],function(e,t,i,n){function a(e){var o=this,s="",r=[];a.baseConstructor.call(this,e),r.title="金额";var l="人民币"!==this.itemData.moneyType?"（"+this.itemData.moneyType+"）":"";this.itemData.tips=this.itemData.tips+l,n.createMoneyItemLayout(this,r),this.itemData.readonly&&(this.components[this.id].disabled=!0),this.itemData.numberToChinese&&this.isInDetail===!1&&(this.components[this.id].style.marginBottom=0,this.upperCaseKey=this.id+"_upperCase",s=this.id+"_upperCaseLabel",this.upperCaseLabelValue=this.id+"_upperCasevalue",this.components[this.upperCaseKey]={type:"view",className:"form-row form-upper-warp bottom-half-line",style:t.processStyle({height:40,flexDirection:"row",backgroundColor:"#fff",justifyContent:"center"}),root:[s,this.upperCaseLabelValue]},this.components[s]={type:"text",style:t.processStyle({width:60,fontSize:14,paddingLeft:15,color:"#262626"}),text:"大写"},this.components[this.upperCaseLabelValue]={type:"text",ref:!0,numberofline:2,style:t.processStyle({flex:1,justifyContent:"flex-start",paddingRight:15,fontSize:13,color:"#999"}),text:""},this.root.push(this.upperCaseKey),this.plugin[this.upperCaseLabelValue+"_init"]=function(e,t){e.config.text=i.MoneyDX(o.itemData.value||0)}),this.itemData.numberToChinese&&this.isInDetail===!0&&(this.components[this.id].style.marginBottom=0,this.upperCaseKey=this.id+"_upperCase",s=this.id+"_upperCaseLabel",this.upperCaseLabelValue=this.id+"_upperCasevalue",this.components[this.upperCaseKey]={type:"view",className:"form-row form-upper-warp bottom-half-line",style:t.processStyle({height:40,flexDirection:"row",backgroundColor:"#fff",justifyContent:"center",paddingLeft:13}),root:[s,this.upperCaseLabelValue]},this.components[s]={type:"text",ref:!0,style:t.processStyle({width:94,fontSize:14,color:"#262626"}),text:"大写"},this.components[this.upperCaseLabelValue]={type:"text",ref:!0,numberofline:2,style:t.processStyle({flex:1,justifyContent:"flex-start",paddingRight:15,fontSize:13,color:"#999"}),text:""},this.root.push(this.upperCaseKey),this.plugin[this.upperCaseLabelValue+"_init"]=function(e,t){e.config.text=i.MoneyDX(o.itemData.value||0)}),this.plugin[this.id+"_keyup"]=function(e,t){var i=e.rowInstance;if(i){var n=o.itemData;if(n.isTotal||n.average||n.maxInGird||n.minInGird){var a=!0;o.DetailInstance.updateSummary(a)}}o.isEnabledConditionField()&&this.updateApproveLines(),o.setDX();var s=parseInt(e.getValue(),10),r=e.getValue(),l=parseInt(o.itemData.min,10),c=parseInt(o.itemData.max,10),p=o.itemData.decimalPlace;if(r&&r.length>16&&(o.verify=!0,o.showTip("目前只支持16位字符"),e.setValue(r.substring(0,16))),!isNaN(l)&&!isNaN(s)&&l>s)return o.verify=!0,o.verifyMsg=(o.itemData.title||"")+"请输入大于"+l+"的数字",o.showTip(o.verifyMsg),void o.scrollIntoView();if(!isNaN(c)&&!isNaN(s)&&c<s)return o.verify=!0,o.verifyMsg=(o.itemData.title||"")+"请输入小于"+c+"的数字",o.showTip(o.verifyMsg),void o.scrollIntoView();if(0!==p&&s&&r.indexOf(".")>-1){var d=r.split(".")[1],h=r.split(".")[0];d.length>p&&e.setValue(h+"."+d.substring(0,p))}o.verify=!1},this.plugin[this.id+"_blur"]=function(e,t){var i=e.getValue(),n=o.itemData.decimalPlace;if(i&&i.indexOf(".")>-1){var a=i.split(".")[1],s=i.split(".")[0];0!==n?a.length>n&&e.setValue(s+"."+a.substring(0,n)):e.setValue(s)}},this.plugin[this.id+"_didmount"]=function(e,t){o.moneySender=e,o.itemData.mainTableField&&(o.plugin.calculateComponent+=o.itemData.mainTableField+";"),o.isInDetail||(o.updateFormulaFieldState(),setTimeout(function(){o.updateFormulaFieldValue()},100))},this.plugin[this.id+"_money_setvalue"]=function(){o.setDX()}}return t.extends(a,e),a.prototype.setValue=function(e){this.moneySender.setValue(e),this.setDX()},a.prototype.setDX=function(){var e=this;e.itemData.numberToChinese&&(e.isInDetail===!1?e.plugin.pageview.delegate(e.upperCaseLabelValue,function(t){t.setText(i.MoneyDX(e.getValue()))}):e.rowInstance.delegate(e.upperCaseLabelValue,function(t){t.setText(i.MoneyDX(e.getValueWhenItemInRepeat(e.rowInstance)))}))},a.prototype.getConfig=function(e){var i,n,a={},o=t.copy(this.itemData);return e?(n=this.itemData.numberToChinese?e.refs[this.upperCaseLabelValue].getText()||"":this.getValueWhenItemInRepeat(e)||"",i=this.getValueWhenItemInRepeat(e)||""):(n=this.itemData.numberToChinese?this.plugin.pageview.refs[this.upperCaseLabelValue].getText()||"":this.getValue()||"",i=this.getValue()||""),this.isRequired&&0===i.length?(this.showRequiedTip(),!1):this.verify?(this.showVerifyTip(this.verifyMsg),!1):(!e&&this.itemData.crux&&(a.key=this.itemData.title||"未命名",a.value=n,a.code=this.itemData.columncode,a.index=this.plugin.keyFeatureIndex,this.plugin.keyFeatureIndex++),o.value=i,o.keyFeature=a,o)},a}),define("components/ApplyInputTextNum",["./ApplyBase","utils","../parts/commonLayout"],function(e,t,i){function n(e){var t=this,a={};n.baseConstructor.call(this,e),a.title="数字",i.createMoneyItemLayout(this,a),this.plugin[this.id+"_keyup"]=function(e,i){var n=e.rowInstance;if(n){var a=t.itemData;if(a.isTotal||a.average||a.maxInGird||a.minInGird){var o=!0;t.DetailInstance.updateSummary(o)}}t.isEnabledConditionField()&&this.updateApproveLines();var s=parseInt(e.getValue(),10),r=e.getValue(),l=parseInt(t.itemData.min,10),c=parseInt(t.itemData.max,10),p=t.itemData.decimalPlace;if(r&&r.length>16&&(t.verify=!0,t.showTip("目前只支持16位字符"),e.setValue(r.substring(0,16))),!isNaN(l)&&!isNaN(s)&&l>s)return t.verify=!0,t.verifyMsg=(t.itemData.title||"")+"请输入大于"+l+"的数字",t.showTip(t.verifyMsg),void t.scrollIntoView();if(!isNaN(c)&&!isNaN(s)&&c<s)return t.verify=!0,t.verifyMsg=(t.itemData.title||"")+"请输入小于"+c+"的数字",t.showTip(t.verifyMsg),void t.scrollIntoView();if(0!==p&&s&&r.indexOf(".")>-1){var d=r.split(".")[1],h=r.split(".")[0];d.length>p&&e.setValue(h+"."+d.substring(0,p))}t.verify=!1},this.plugin[this.id+"_focus"]=function(e,t){},this.plugin[this.id+"_blur"]=function(e,i){var n=e.getValue(),a=t.itemData.decimalPlace;if(n&&n.indexOf(".")>-1){var o=n.split(".")[1],s=n.split(".")[0];0!==a?o.length>a&&e.setValue(s+"."+o.substring(0,a)):e.setValue(s)}},this.plugin[this.id+"_didmount"]=function(e,i){t.itemData.mainTableField&&(t.plugin.calculateComponent+=t.itemData.mainTableField+";"),t.isInDetail||(t.updateFormulaFieldState(),setTimeout(function(){t.updateFormulaFieldValue()},100))}}return t.extends(n,e),n.prototype.bindInitValueInRepeat=function(e){e.datasource[this.id]?e.config.value=e.datasource[this.id]:e.config.value=this.itemData.defaultValue},n}),define("components/ApplyInputTextPercent",["./ApplyBase","utils","../parts/commonLayout"],function(e,t,i){function n(e){var t=[];n.baseConstructor.call(this,e),t.title="百分比",i.createMoneyItemLayout(this,t),this.plugin[this.id+"_focus"]=function(e,t){var i=e.getValue(),n="";n=i.indexOf(".")>-1?parseFloat(i.split("%")[0]).toFixed(2):parseFloat(i.split("%")[0]),i&&e.setValue(n)},this.plugin[this.id+"_blur"]=function(e,t){var i=e.getValue(),n=i+"";n.indexOf(".")>-1&&(n=parseFloat(n).toFixed(2)),n+="%",i&&e.setValue(n)}}return t.extends(n,e),n}),define("components/ApplyInputTextarea",["./ApplyBase","utils","../parts/commonLayout"],function(e,t,i){function n(e){var t=this,a={};n.baseConstructor.call(this,e),a.height=80,a.type="textarea",a.title="多行文本",a.singleLineStyle={paddingTop:10,paddingBottom:10,paddingRight:13,height:80},a.multiLineFirStyle={height:80},a.multiLineSecSecStyle={paddingTop:10,paddingBottom:10,paddingLeft:0,paddingRight:13},a.multiLineSecFirStyle={paddingTop:10,alignItems:"flex-tart"},i.switchLayout(this,a),this.plugin[this.id+"_focus"]=function(e,i){t.scrollIntoView()},this.plugin[this.id+"_blur"]=function(e,i){var n=e.getValue();e.setValue(t.limitTextLength(n))},this.plugin[this.id+"_input"]=function(e,i){var n=e.getValue();e.setValue(t.limitTextLength(n))}}return t.extends(n,e),n.prototype.bindInitValueInRepeat=function(e){e.datasource[this.id]?e.config.value=e.datasource[this.id]:e.config.value=this.itemData.defaultValue},n}),define("components/ApplyLayout",["./ApplyBase","utils"],function(e,t){function i(e){i.baseConstructor.call(this,e)}return t.extends(i,e),i}),define("components/ApplyReference",["./ApplyBase","utils","../parts/commonLayout"],function(e,t,i){function n(e){var t=this,a=[];this.config=e,this.selectedData="",this.isDisabled=!1,n.baseConstructor.call(this,e),i.createItemLayout(this,a),!this.itemData.linkageComponent||this.authInfo&&this.authInfo.readonly||(window.linkageComponents||(window.linkageComponents={}),window.linkageComponents[this.itemData.linkageComponent+"_id"]=this.itemData.linkageField,this.isDisabled=!0,setTimeout(function(){$("."+t.id+"_warp").css({opacity:.4})},100)),"MODIFY"===this.plugin.mode&&setTimeout(function(){t.setValue()},100),this.plugin[this.itemData.linkageComponent+"_change"]=function(e,i){e&&(t.isDisabled=!1,$("."+t.id+"_warp").css({opacity:1}))},this.plugin[this.itemData.id+"_wrap_init"]=function(e,t){},this.plugin[this.id+"_warp_click"]=function(i,n){if(this.sender=i,t.isDisabled)return!1;if(t.authInfo&&t.authInfo.readonly)return!1;if("bpmuserref"===e.itemData.contMeta)if(e.itemData.isMutiSelect)try{window.yyesn.enterprise.selectContacts(function(e){if("0"===e.error_code){var i=e.data;t.multiValue="";for(var n=0,a=i.length;n<a;n++){var o=i[n];t.multiValue+=o.name+","}t.multiValue=t.multiValue.substring(0,t.multiValue.length-1);var s="."+t.id;$(s).find("span").html(t.multiValue)}},{mode:1,multi:1,select_list:t.add_sign_select_list||[]},function(e){})}catch(e){alert(JSON.stringify(e))}else try{window.yyesn.enterprise.selectContacts(function(e){if("0"===e.error_code){var i=JSON.stringify(e),n=JSON.parse(i).data[0];t.multiValue=n.name;var a="."+t.id;$(a).find("span").html(t.multiValue)}},{mode:1,multi:0},function(e){})}catch(e){alert(JSON.stringify(e))}else"bpmorgref"===e.itemData.contMeta?console.log("调选部门"):this.pageview.showPage({pageKey:"referenceList",nocache:!0,mode:"fromRight2",params:{config:e,parent:t}})},this.afterClosePage=function(i){var n="."+t.id;if(t.selectedData=i,t.multiValue="",t.multiKey="",e.itemData.isMutiSelect?(t.selectedData.forEach(function(e,i){t.multiValue+=e.refname+",",t.multiKey+=e.refcode+","}),t.multiValue=t.multiValue.substring(0,t.multiValue.length-1),t.multiKey=t.multiKey.substring(0,t.multiKey.length-1),$(n).find("span").html(t.multiValue),t.plugin[t.id+"_change"]&&t.plugin[t.id+"_change"].call(t.plugin,t.multiValue,t.selectedData)):($(n).find("span").html(i.refname),t.plugin[t.id+"_change"]&&t.plugin[t.id+"_change"].call(t.plugin,i.refname,t.selectedData)),window.linkageComponents&&window.linkageComponents[t.id+"_id"]){var a=window.linkageComponents[t.id+"_id"];i.linkageField=a,window.linkageComponents[t.id]=i}}}return t.extends(n,e),n.prototype.setValue=function(){var e="."+this.id,t=JSON.parse(this.itemData.values);if(this.itemData.isMutiSelect){var i="",n="";t.forEach(function(e,t){i+=t.name+",",n+=t.code+","}),i=i.substring(0,i.length-1),n=n.substring(0,n.length-1),this.multiKey=n,this.multiValue=i,$(e).find("span").html(this.multiValue)}else this.selectedData={refname:t[0].name,linkageField:this.itemData.linkageField,refcode:t[0].code},$(e).find("span").html(this.selectedData.refname)},n.prototype.getValue=function(e){return this.config.itemData.isMutiSelect?this.multiKey:this.selectedData.refcode},n.prototype.getReferenceValue=function(){return this.config.itemData.isMutiSelect?this.multiValue:this.selectedData.refname},n.prototype.getConfig=function(e){var i,n={},a=t.copy(this.itemData);return i=this.getValue(),this.isRequired&&0===i.length?(this.showRequiedTip(),!1):(a.value=i||"",e||this.itemData.crux&&(n.key=this.itemData.title||"关联",n.value=this.getReferenceValue(),n.code=i),a.keyFeature=n,a)},n}),define("components/ApplyScore",["./ApplyBase","utils","../parts/commonLayout"],function(e,t,i){function n(e){var t=this;n.baseConstructor.call(this,e),this.starNum=e.num||5,this.halfSelect=!!this.itemData.half,this.starColor=e.starColor||"#F39801",this.defaultstar=this.itemData.defaultstar,this.repeatArray=[],this.score=0,i.layoutForScore(this),this.plugin[this.id+"_didmount"]=function(e,i){t.defaultstar&&setTimeout(function(){var i=Math.round(t.defaultstar);t.halfSelect&&(t.defaultstar+"").indexOf(".")===-1?(e.components[i-1].$el.click(),e.components[i-1].$el.click()):e.components[i-1].$el.click()},500)},this.authInfo.readonly||(this.plugin[this.id+"_itemclick"]=function(e,i){var n=e.components[t.scoreKey];t.score=0;for(var a=0;a<e.datasource;a++)e.parent.components[a].components[t.scoreKey].setIcon("cap_e907",{color:t.starColor}),e.parent.components[a].$el.find(".star_icon i").css({color:t.starColor}),a<e.datasource-1&&e.parent.components[a].components[t.scoreKey].$el.addClass("all"),t.score+=1;for(var o=4;o>e.datasource-1;o--)e.parent.components[o].components[t.scoreKey].$el.addClass("all"),e.parent.components[o].components[t.scoreKey].setIcon("cap_e908",{color:t.starColor});t.halfSelect&&(n.$el.hasClass("all")?(n.$el.removeClass("all").addClass("half"),n.setIcon("cap_e909",{color:t.starColor}),t.score-=.5):(n.$el.removeClass("half").addClass("all"),n.setIcon("cap_e907",{color:t.starColor})))})}return t.extends(n,e),n.prototype.bindInitValue=function(e){for(var t=1;t<this.starNum+1;t++)this.repeatArray.push(t);e.config.items=this.repeatArray},n.prototype.getValue=function(){return console.log(this.score),this.score},n}),define("components/ApplySwitch",["./ApplyBase","utils","../parts/commonLayout"],function(e,t,i){function n(e){n.baseConstructor.call(this,e),this.itemData.inLeft=!0,i.layoutForSwitch(this),this.plugin[this.id+"_change"]=function(e,t){e.setValue(t.value)}}return t.extends(n,e),n.prototype.bindInitValueInRepeat=function(e){var t=e.datasource[this.id],i=this.itemData.defOption;t?e.config.value="true"===t||"1"===t:e.config.value="true"===i||"1"===i},n.prototype.bindInitValue=function(e){var t=this.itemData.values,i=this.itemData.defOption;t&&t.length>0?e.config.value="true"===t[0]||"1"===t[0]:e.config.value="true"===i||"1"===i},n.prototype.getConfig=function(e){var i,n="",a=t.copy(this.itemData);return e?i=this.getValueWhenItemInRepeat(e)+"":(i=this.getValue()+"",this.itemData.crux&&(n=(this.itemData.title||"未命名")+":"+i)),this.isRequired&&0===i.length?(this.showRequiedTip(),!1):this.verify?(this.showVerifyTip(this.verifyMsg),!1):(a.value=i,a.keyFeature=n,a)},n}),define("components/ApplyTaskComment",["./ApplyBase","utils","../parts/commonLayout"],function(e,t,i){function n(e){var t=this,a={};n.baseConstructor.call(this,e),a.type="text",this.itemData.tips="系统自动填入审批意见",a.multiLineSecSecStyle={justifyContent:"flex-start",color:"#262626"},i.switchLayout(this,a),this.plugin[this.id+"_didmount"]=function(e,i){e.setText(t.itemData.tips)}}return t.extends(n,e),n.prototype.getValue=function(){return"MODIFY"===this.plugin.mode?this.itemData.values:""},n.prototype.bindInitValue=function(e){var t=this.itemData.values;t&&t.length>0?e.config.value=t[0]:e.config.value=this.itemData.defaultValue||""},n.prototype.bindInitValueInRepeat=function(e){e.datasource[this.id]?e.config.value=e.datasource[this.id]:e.config.value=this.itemData.defaultValue},n}),define("components/ApplyTileCheckbox",["./ApplyBase","utils","../parts/common"],function(e,t,i){function n(e){var a=this;n.baseConstructor.call(this,e),this.textKey=this.id+"_text",this.titleKey=this.id+"_title",this.otherKey=this.id+"_other",this.root.push(this.titleKey),this.root.push(this.id),this.components[this.titleKey]=this.getTileCtlTitle(this.itemData.title||"选项"),this.itemData.hasOther&&this.root.push(this.otherKey),this.components[this.otherKey]={type:"input",ref:!0,placeholder:"请输入其他内容",style:t.processStyle({display:"none",backgroundColor:"#fff",height:50,fontSize:15,borderBottom:"1px solid #ededed",paddingLeft:13})},this.components[this.id]={type:"repeat",selectedMode:"m",ref:!0,items:[],root:["checkbox_select_icon",this.textKey],style:t.processStyle({flexDirection:"row",flexWrap:"wrap",backgroundColor:"white",borderBottom:"1px solid #ededed",paddingLeft:5}),itemStyle:t.processStyle({justifyContent:"center",alignItems:"center",flexDirection:"row",paddingTop:8,paddingBottom:8,paddingLeft:10,paddingRight:10})},this.components.checkbox_select_icon={type:"checkbox",selectedClassName:"checkbox-group-selected",radioStyle:{fontSize:14},selectedStyle:{width:16,height:16,fontSize:14,backgroundColor:i.mainColor,borderColor:i.mainColor},style:{width:16,height:16,fontSize:14}},this.components[this.textKey]={type:"text",text_bind:"name",style:t.processStyle({fontSize:14,paddingLeft:5,paddingRight:5,color:"#262626"})},this.plugin[this.id+"_itemclick"]=function(e,t){e.select(),a.curFormRowInstance?(a.curFormRowInstance.datasource[a.id]=t.selectedValue[0],a.curFormRowInstance.refs[a.id].setText(t.selectedValue[0].name)):a.isEnabledConditionField()&&this.updateApproveLines(),"其他"===e.datasource.name&&"other"===e.datasource.type&&(e.isSelected?this.pageview.refs[a.otherKey].$el.show():this.itemData.hasOther&&this.pageview.refs[a.otherKey].$el.hide())},this.plugin[this.id+"_iteminit"]=function(e,t){a.bindInitItemValue(e)}}return t.extends(n,e),n.prototype.bindInitValue=function(e){for(var t=this.itemData.options,i=0,n=t.length;i<n;i++)t[i].id=i,t[i].value=t[i].name;this.itemData.hasOther&&t.push({name:"其他",defOption:!1,type:"other"}),e.config.items=t},n.prototype.bindInitItemValue=function(e){var t=e.datasource,i="";this.itemData.values?(i=this.itemData.values.split(","),$.inArray(t.selectionId,i)!==-1&&setTimeout(function(){e.select()},1e3)):t.defOption&&setTimeout(function(){e.select()},1e3)},n.prototype.getValue=function(){return this.plugin.pageview.refs[this.id].selectedItems[0].name},n.prototype.getCheckboxValue=function(){var e=this;return this.plugin.pageview.refs[this.id].selectedItems.forEach(function(t,i){if("其他"===t.datasource.name&&"other"===t.datasource.type){var n=e.plugin.pageview.refs[e.otherKey].getValue()||"其他";t.datasource.selectionId="$$hasOther$$"+n}}),this.plugin.pageview.refs[this.id].selectedItems},n.prototype.getValueWhenItemInRepeat=function(e){return e.datasource[this.id]},n.prototype.getConfig=function(e){var i,n={},a="",o=t.copy(this.itemData);if(i=e?[this.getValueWhenItemInRepeat(e)]||[]:this.getCheckboxValue()||[],this.isRequired&&0===i.length)return this.showRequiedTip(),!1;for(var s=[],r=0,l=i.length;r<l;r++)i[r].selectionId?s.push(i[r].selectionId):s.push(i[r].datasource.selectionId);if(o.value=s.join(","),this.itemData.crux){for(var c=this.plugin.pageview.refs[this.id].selectedItems||[],p=[],r=0,l=c.length;r<l;r++)p.push(c[r].name||c[r].datasource.name);p.length>0&&(a=p.join(",")),n.key=this.itemData.title||"选项",n.value=a,n.code=this.itemData.columncode}return o.keyFeature=n,o},n.prototype.getTileCtlTitle=function(e){return{type:"text",text:e,style:t.processStyle({height:30,width:"100%",paddingLeft:13,fontSize:14,color:"#262626",background:"white"})}},n}),define("components/ApplyTileRadio",["./ApplyBase","utils","../parts/commonLayout"],function(e,t,i){function n(e){var i=this;n.baseConstructor.call(this,e),this.textKey=this.id+"_text",this.titleKey=this.id+"_title",
this.otherKey=this.id+"_other",this.root.push(this.titleKey),this.root.push(this.id),this.components[this.titleKey]=this.getTileCtlTitle(this.itemData.title),console.log(this.itemData),this.itemData.hasOther&&this.root.push(this.otherKey),this.components[this.otherKey]={type:"input",ref:!0,placeholder:"请输入其他内容",style:t.processStyle({display:"none",backgroundColor:"#fff",height:50,fontSize:15,borderBottom:"1px solid #ededed",paddingLeft:13})},this.components[this.id]={type:"repeat",selectedMode:"s",ref:!0,items:[],root:["item_select_icon",this.textKey],style:t.processStyle({flexDirection:"row",flexWrap:"wrap",backgroundColor:"white",borderBottom:"1px solid #ededed",paddingLeft:5}),itemStyle:t.processStyle({justifyContent:"center",alignItems:"center",flexDirection:"row",paddingTop:8,paddingBottom:8,paddingLeft:10,paddingRight:10})},this.components.item_select_icon={type:"radiobox",selectedClassName:"radio-group-selected",ref:!0,radioStyle:{fontSize:14,width:18,height:18},selectedRadioStyle:{width:18,height:18,fontSize:18},style:{fontSize:14,paddingRight:5}},this.components[this.textKey]={type:"text",text_bind:"name",style:t.processStyle({fontSize:14,color:"#262626"})},this.plugin[this.id+"_itemclick"]=function(e,t){e.select(),i.curFormRowInstance?(i.curFormRowInstance.datasource[i.id]=t.selectedValue[0],i.curFormRowInstance.refs[i.id].setText(t.selectedValue[0].name)):i.isEnabledConditionField()&&this.updateApproveLines(),"其他"===e.datasource.name&&"other"===e.datasource.type?this.pageview.refs[i.otherKey].$el.show():i.itemData.hasOther&&this.pageview.refs[i.otherKey].$el.hide()},this.plugin[this.id+"_iteminit"]=function(e,t){i.bindInitItemValue(e)}}return t.extends(n,e),n.prototype.bindInitValue=function(e){for(var t=this.itemData.options,i=0,n=t;i<n;i++)t[i].id=i,t[i].value=t[i].name;this.itemData.hasOther&&t.push({name:"其他",defOption:!1,type:"other"}),e.config.items=t},n.prototype.bindInitItemValue=function(e){var t=e.datasource,i="";this.itemData.values?(i=this.itemData.values.split(","),$.inArray(t.selectionId,i)!==-1&&setTimeout(function(){e.select()},1e3)):t.defOption&&setTimeout(function(){e.select()},1e3)},n.prototype.getValue=function(){return this.plugin.pageview.refs[this.id].selectedItems[0].name},n.prototype.getRadioValue=function(){var e=this;return this.plugin.pageview.refs[this.id].selectedItems.forEach(function(t,i){if("其他"===t.datasource.name&&"other"===t.datasource.type){var n=e.plugin.pageview.refs[e.otherKey].getValue()||"其他";t.datasource.selectionId="$$hasOther$$"+n}}),this.plugin.pageview.refs[this.id].selectedItems},n.prototype.getValueWhenItemInRepeat=function(e){return e.datasource[this.id]},n.prototype.getConfig=function(e){var i,n={},a="",o=t.copy(this.itemData);if(i=e?[this.getValueWhenItemInRepeat(e)]:this.getRadioValue()||[],0===i.length){if(this.isRequired)return this.showRequiedTip(),!1;o.value=""}else o.value=i[0].datasource.selectionId+"";if(this.itemData.crux){var s=this.plugin.pageview.refs[this.id].selectedItems||[];s.forEach(function(e,t){a+=e.name||e.datasource.name}),n.key=this.itemData.title||"选项",n.value=a,n.code=this.itemData.columncode}return o.keyFeature=n,o},n.prototype.getTileCtlTitle=function(e){return{type:"text",text:e,style:t.processStyle({height:30,width:"100%",paddingLeft:13,fontSize:14,color:"#262626",background:"white"})}},n}),define("components/ApplyViewImage",["./ApplyBase","utils","../parts/commonLayout"],function(e,t,i){function n(e){n.baseConstructor.call(this,e),this.root.push(this.id),this.components[this.id]={type:"image",src:e.itemData.url,style:t.processStyle({fontSize:15,marginBottom:10,marginTop:10,marginLeft:13,marginRight:13,backgroundColor:"#F2F4F4"})}}return t.extends(n,e),n.prototype.getValue=function(){return""},n}),define("components/ApproveSearchView",["utils","base"],function(e,t){var i=function(t){var n=this;i.baseConstructor.call(this,t);var a="displayflex yy-seachview yy-fd-column",o=this.config.iconStyle,s=this.config.iconItemStyle,r=this.config.searchInputStyle;this.$el.addClass(a);var l,c,p=this.config.font||"",d=p.split("_");l=d[0],c=d[1],e.css(this.$el,{fontFamily:l}),this.iconDom=$('<i class="yy-icon-code" data-code="'+c+'" data-icon="&#x'+c+';"></i>'),o&&e.css(this.iconDom,o),this.searchBtn=$('<div class="displayflex yy-icon yy-ai-center yy-jc-center"></div>'),s&&e.css(this.searchBtn,s),this.searchBtn.bind("click",function(e){e.stopPropagation(),n._click()}),this.searchBar=$('<div style="background-color: #00b412; height: 33px;position: absolute;top: 0;left: 0;bottom: 0px;right: 0;z-index: 11; display: none;"></div>'),r&&e.css(this.searchBar,r),this.searchBar.bind("click",function(e){e.stopPropagation()}),this.cancelBtnWidth=e.getRealWidth(60);var h=e.getRealHeight(30),u=$("<div style='width:"+this.cancelBtnWidth+"px;height:"+h+"px;font-size:"+e.fontSize(16)+"px' class='yy-sv-cancel displayflex yy-jc-center yy-ai-center'>取消</div>");this.config.cancelBtnStyle&&e.css(u,this.config.cancelBtnStyle),this.searchBtn.append(this.iconDom),this.$el.append(this.searchBar),this.$el.append(this.searchBtn)};return e.extends(i,t),i.prototype.inputChange=function(e){var t=this.input.val();""==t?this.clearBtn.addClass("displaynone"):this.clearBtn.removeClass("displaynone")},i.prototype._cancelSearch=function(){this.form.css({width:this.inputWidth+"px"}),this.clearBtn.addClass("displaynone"),this.searchBar[0].className=this.searchBarClassName+" yy-sv-defalut",this.defaultComyWrapper&&(this.defaultComyWrapper.removeClass("displaynone"),this.resultComWrapper&&this.resultComWrapper.addClass("displaynone"))},i.prototype._focus=function(){this.form.css({width:this.inputFocusWidth+"px"}),this.input.val().length>0&&this.clearBtn.removeClass("displaynone"),this.searchBar[0].className=this.searchBarClassName+" yy-sv-active",this.resultComWrapper&&(this.resultComWrapper.removeClass("displaynone"),this.defaultComyWrapper&&this.defaultComyWrapper.addClass("displaynone"))},i.prototype._click=function(){return this.searchBar.show(),this.iconDom},i}),define("logic/additionApproval",[],function(){function e(e){this.pageview=e.pageview}return e.prototype={},e}),define("pages/additionApproval",["../logic/additionApproval","../parts/common","utils"],function(e,t,i){var n={pluginClass:e,style:{backgroundColor:t.backColor,overflow:"auto"},root:["body"],components:{body:{type:"view",style:{padding:15,color:"#999"},root:["title","titleLable","contentText","contentImage","contentText1","contentImage1","contentText2","contentImage2","contentImage3","contentText3","contentImage4","contentText4","contentImage5"]},title:{type:"text",text:"如何添加审批模版",style:{fontSize:17,color:"#000",margin:"auto",fontWeight:"bold"}},titleLable:{type:"text",text:"如果我们提供的审批模版中没有你想要的审批模版，我们还能提供强大的自定义功能，可以定制出任何您想要的审批模版",style:{fontSize:14,marginTop:15}},contentText:{type:"text",text:"1、电脑上登录企业空间进入审批应用，点击“审批”进入审批应用",style:{fontSize:14,margin:"15px 0"}},contentText1:{type:"text",text:"2、点击右上角按钮“创建新审批”，可以选择“从设计器创建”或者“经典模版”创建。",style:{fontSize:14,margin:"15px 0"}},contentText2:{type:"text",text:"3、各种控件名称，提示文案，控件性质设置等完全自定义，可以拖动左边的控件进入中间编辑区域，通过右边的控件设置可设置属性",style:{fontSize:14,margin:"15px 0"}},contentText3:{type:"text",text:"4、设计完成，可以选择保存或者保存并启用",style:{fontSize:14,margin:"15px 0"}},contentText4:{type:"text",text:"5、如果新建的模版被启用，则审批中会新增一个自定义的模版，满足企业各种审批的需求",style:{fontSize:14,margin:"15px 0"}},contentImage:{type:"image",src:"./imgs/help/1.1.png",style:{margin:"auto"}},contentImage1:{type:"image",src:"./imgs/help/1.2.png",style:{margin:"auto"}},contentImage2:{type:"image",src:"./imgs/help/1.3.png",style:{margin:"auto"}},contentImage3:{type:"image",src:"./imgs/help/1.4.png",style:{margin:"auto"}},contentImage4:{type:"image",src:"./imgs/help/1.5.png",style:{margin:"auto"}},contentImage5:{type:"image",src:"./imgs/help/1.6.png",style:{margin:"auto"}}}};return n}),define("logic/commonlist",["../parts/common","utils"],function(e,t){function i(e){this.pageview=e.pageview;var t=this.pageview.params.type;this.fullPageKey=this.pageview.config.fullPageKey,this.listDataSource=[],this.searchValue=!1,this.searchValue1=!1,this.searchKey=!0,"commonlist_waitmyapprove"===this.fullPageKey?this.searchKey=!1:"commonlist_waitmyapprovedone"===this.fullPageKey&&(this.searchKey=!0),"myapprove"===t?window.needRefresMyApproveListData=!1:"copyapprove"===t&&(window.needRefresCopyApproveListData=!1,this.fullPageKey="commonlist_copyapprove"),this.setHeader()}return i.prototype={body_init:function(e){this.body=e},setHeader:function(){var e="审批";"commonlist_myapproverunning"===this.fullPageKey?e="我发起的":"commonlist_waitmyapprovedone"===this.fullPageKey?e="我已审批":"commonlist_waitmyapprove"===this.fullPageKey?e="待我审批":"commonlist_copyapprove"===this.fullPageKey&&(e="抄送我的"),window.pageViewTitle=e;try{window.yyesn.client.setHeader(function(){},{type:2,title:e,rightTitle:"",rightValues:[]},function(e){})}catch(e){}},searchBtn_click:function(e,t){this.pageview.refs.leftview.$el.hide(),this.pageview.refs.searchInput.$el.show(),this.pageview.refs.searchInput._focus(),this.pageview.refs.approveSelector.hideDropDown()},searchview_init:function(e,t){e.config.style.display="none"},searchInput1_init:function(e,t){this.searchKey?e.config.style.display="show":e.config.style.display="none"},searchInput1_cancel:function(e,t){var i=t.value;(i||this.searchValue1)&&(this.searchValue1=!1,e.input.val(""),this.listviewSender.config.ajaxConfig.data.keyword="",this.pageview.refs.listview.loadFirstPageData({parentAnimate:!0}))},searchInput_cancel:function(e,t){var i=t.value;(i||this.searchValue)&&(this.searchValue=!1,e.input.val(""),this.listviewSender.config.ajaxConfig.data.keyword="",this.pageview.refs.listview.loadFirstPageData({parentAnimate:!0})),this.pageview.refs.leftview.$el.show(),this.pageview.refs.searchInput.$el.hide()},approveSelector_menu1_loaddata:function(e,t){var i=t.success,n=(t.error,[{name:"全部时间",id:"taskTime_all",group:"taskTime"},{name:"今天",id:"taskTime_today",group:"taskTime"},{name:"昨天",id:"taskTime_yesterday",group:"taskTime"},{name:"两天前",id:"taskTime_2more",group:"taskTime"}]);i(n)},approveSelector_menu0_loaddata:function(e,t){var i=t.success,n=(t.error,[{name:"全部状态",id:"dueDate_all",group:"dueDate"},{name:"正常",id:"dueDate_normal",group:"dueDate"},{name:"逾期",id:"dueDate_overdue",group:"dueDate"}]);i(n)},approveSelector_menu2_loaddata:function(e,t){var i=t.success,n=(t.error,this);window.setTimeout(function(){var e={url:"/process/category",type:"POST",data:{},success:function(e){for(var t=[{name:"全部类型",id:"",group:"type"}],n=0;n<e.data.length;n++){var a={name:e.data[n].name,id:e.data[n].id,group:"type"};t.push(a)}i(t)},error:function(e){}};n.pageview.ajax(e)})},approveSelector_menu0_itemClick:function(e,t){e.rootInstance.hideDropDown(),this.listviewSender.config.ajaxConfig.data.taskDue=e.curSelectedItem.data.id,this.pageview.refs.listview.loadFirstPageData({parentAnimate:!0})},approveSelector_menu1_itemClick:function(e,t){e.rootInstance.hideDropDown(),this.listviewSender.config.ajaxConfig.data.taskDate=e.curSelectedItem.data.id,this.pageview.refs.listview.loadFirstPageData({parentAnimate:!0})},approveSelector_menu2_itemClick:function(e,t){e.rootInstance.hideDropDown(),this.listviewSender.config.ajaxConfig.data.categoryIds=e.curSelectedItem.data.id,this.pageview.refs.listview.loadFirstPageData({parentAnimate:!0})},searchInput_search:function(e,t){t.value&&(this.searchValue=!0),this.pageview.refs.listview.ajaxConfig.data.start=0,this.pageview.refs.listview.ajaxConfig.data.pageNum=1,this.listviewSender.config.ajaxConfig.data.categoryIds=null,this.listviewSender.config.ajaxConfig.data.keyword=t.value,this.pageview.refs.listview.loadFirstPageData({parentAnimate:!0})},searchInput1_search:function(e,t){t.value&&(this.searchValue1=!0),this.pageview.refs.listview.ajaxConfig.data.start=0,this.pageview.refs.listview.ajaxConfig.data.pageNum=1,this.listviewSender.config.ajaxConfig.data.categoryIds=null,this.listviewSender.config.ajaxConfig.data.keyword=t.value,this.pageview.refs.listview.loadFirstPageData({parentAnimate:!0})},onPageResume:function(){this.pageview.refs.listview.ajaxConfig.data.start=0,this.pageview.refs.listview.ajaxConfig.data.pageNum=1,"commonlist_myapproverunning"===this.fullPageKey&&window.needRefresMyApproveListData===!0&&(window.needRefresMyApproveListData=!1,this.pageview.refs.listview.loadFirstPageData({parentAnimate:!0})),"commonlist_copyapprove"===this.fullPageKey&&window.needRefresCopyApproveListData===!0&&(window.needRefresCopyApproveListData=!1,this.pageview.refs.listview.loadFirstPageData({parentAnimate:!0})),this.setHeader()},body_pulltorefresh:function(e,t){this.pageview.refs.listview.ajaxConfig.data.start=0,this.pageview.refs.listview.ajaxConfig.data.pageNum=1,this.pageview.refs.listview.setAjaxConfigParams(),this.pageview.refs.listview.loadFirstPageData()},body_reload:function(e){this.pageview.refs.listview.reload()},body_loadmore:function(e,t){var i=this.pageview.refs.listview.ajaxConfig.data.size,n=this.pageview.refs.listview.ajaxConfig.data.start,a=i+n;this.pageview.refs.listview.ajaxConfig.data.start=a,this.pageview.refs.listview.ajaxConfig.data.pageNum++,this.pageview.refs.listview.setAjaxConfigParams(),this.pageview.refs.listview.loadNextPageData()},listview_rowclick:function(e,t){window.nowFormData=e.datasource;var i,n,a,o="";"commonlist_myapproverunning"===this.fullPageKey||"commonlist_myapprovedone"===this.fullPageKey?(i=e.datasource.inst.id,n=e.datasource.inst.name,a=e.datasource.inst.id):"commonlist_copyapprove"===this.fullPageKey?(i=e.datasource.procssInstId,n=e.datasource.title,a=e.datasource.taskId,o=e.datasource.id):void 0===e.datasource.processInstance?(i=e.datasource.historicProcessInstance.id,n=e.datasource.historicProcessInstance.name,a=e.datasource.id):(i=e.datasource.processInstance.id,n=e.datasource.processInstance.name,a=e.datasource.id),n.indexOf("的")>-1&&n.indexOf("的")<n.length&&(n=n.substring(n.indexOf("的")+1,n.length)),this.pageview.go("detail",{taskId:a,instId:i,copyToId:o,formDataName:encodeURI(n)})},listview_parsedata:function(e,t){var i=t.data;return 0===i.code&&(i.data||(i.data={list:[]}),i.data.list)},listview_init:function(e){var t="";switch(e.config.style.marginTop=0,this.fullPageKey){case"commonlist_waitmyapprove":t+="/process/listTodo",e.config.style.marginTop=5;break;case"commonlist_waitmyapprovedone":t+="/process/listDone";break;case"commonlist_myapproverunning":t="/process/listHistory";break;case"commonlist_myapprovedone":t="/process/listHistory?withState=true&finished=true";break;case"commonlist_copyapprove":t="/process/listCopy";break;default:t="/process/listTodo",console.error("status未定义"),e.config.style.marginTop=5}this.listviewSender=e,e.config.ajaxConfig={url:t,type:"POST",pageSize:10,pageNumKey:"pageNum",data:{pageNum:1,start:0,size:10}},e.config.autoLoadData=!0},row_feature_repeat_init:function(e,t){var i;e.parent.datasource.keyFeature?i=e.parent.datasource.keyFeature:e.parent.datasource.processInstance?i=e.parent.datasource.processInstance.keyFeature:e.parent.datasource.inst?i=e.parent.datasource.inst.keyFeature:e.parent.datasource.historicProcessInstance?i=e.parent.datasource.historicProcessInstance.keyFeature:e.parent.datasource.historicProcessInstanceResponse&&(i=e.parent.datasource.historicProcessInstanceResponse.keyFeature);var n=[];try{var a=JSON.parse(i);if(a)a.forEach(function(e,t){var i={};i.text=e.key+":"+e.value,n.push(i)});else if(null!==i&&"null"!==i)for(var o=i.split(";"),s=0;s<o.length;s++){var r={};r.text=o[s],n.push(r)}}catch(e){if(null!==i&&"null"!==i)for(var l=i.split(";"),c=0;c<l.length;c++){var p={};p.text=l[c],n.push(p)}}0===n.length&&(e.config.style.display="none"),e.bindData(n)},row_time_init:function(e,i){if(null===e.config.text)if(null!==e.datasource.startTime&&void 0!==e.datasource.startTime)if("commonlist_waitmyapprovedone"===this.fullPageKey){var n=0;null!==e.datasource.endTime&&(n=e.datasource.endTime),e.config.text=t.timestampToTimeStr(n,!0)}else e.config.text=t.timestampToTimeStr(e.datasource.startTime,!0);else e.datasource.inst&&(e.config.text=t.timestampToTimeStr(e.datasource.inst.startTime,!0));else e.config.text=t.timestampToTimeStr(e.config.text,!0)},row_state_init:function(e,t){if("commonlist_copyapprove"!==this.fullPageKey){var i=e.parent.datasource.dueDate;i&&i<new Date&&"commonlist_waitmyapprove"===this.fullPageKey&&(e.config.style.display="block")}},row_status_init:function(e,t){var i=this.fullPageKey;if("commonlist_myapproverunning"===i||"commonlist_myapprovedone"===i){var n=e.datasource.inst.state;e.datasource.inst.processDefinitionId.indexOf("processKey")>-1?(e.config.text="已提交",e.config.style.color="#ADADAD"):"run"===n?(e.config.text="审批中",e.config.style.color="#F39801"):"end"===n?(e.config.text="已完成",e.config.style.color="#ADADAD"):"delete"===n&&(e.config.text="已中止",e.config.style.color="#F17868")}else if("commonlist_waitmyapprovedone"===i||"commonlist_waitmyapprove"===i)if("commonlist_waitmyapprove"===i){var a=e.datasource.processInstance&&e.datasource.processInstance.completed,o=e.datasource.processInstance.ended;a?(e.config.text="已完成",e.config.style.color="#ADADAD"):o?(e.config.text="已中止",e.config.style.color="#F17868"):(e.config.text="审批中",e.config.style.color="#F39801")}else{var s=e.datasource.historicProcessInstance,r=!!s&&null!==s.endTime,l=s?s.deleteReason:null;r?"stop"===l?(e.config.text="已中止",e.config.style.color="#F17868"):l?(e.config.text="已中止",e.config.style.color="#F17868"):(e.config.text="已完成",e.config.style.color="#ADADAD"):(e.config.text="审批中",e.config.style.color="#F39801")}},row_image_init:function(e,t){"commonlist_myapproverunning"===this.fullPageKey||"commonlist_myapprovedone"===this.fullPageKey?(e.config.style.backgroundColor="#fff",e.config.style.borderRadius="",e.config.style.height=30,e.config.style.width=30,e.datasource.inst.icon?e.config.src="./imgs/"+e.datasource.inst.icon+".png":e.config.src="./imgs/icon-1.png"):"commonlist_copyapprove"!==this.fullPageKey&&"commonlist_waitmyapprove"!==this.fullPageKey?(null===e.config.title&&(e.datasource.historicProcessInstance.startParticipant?e.config.title=e.datasource.historicProcessInstance.startParticipant.name:(e.config.title="丢失",e.config.src="丢失")),e.datasource.historicProcessInstance&&e.datasource.historicProcessInstance.startParticipant&&(e.config.src=e.datasource.historicProcessInstance.startParticipant.pic?e.datasource.historicProcessInstance.startParticipant.pic:"none.jpg"),e.datasource.historicProcessInstance&&e.datasource.historicProcessInstance.startParticipant&&(e.config.title=e.datasource.historicProcessInstance.startParticipant.name)):"commonlist_waitmyapprove"!==this.fullPageKey&&"commonlist_copyapprove"!==this.fullPageKey?e.config.title=e.datasource.title:"commonlist_copyapprove"===this.fullPageKey?e.datasource.historicProcessInstanceResponse.startParticipant?(e.config.title=e.datasource.historicProcessInstanceResponse.startParticipant.name,e.config.src=e.datasource.historicProcessInstanceResponse.startParticipant.pic?e.datasource.historicProcessInstanceResponse.startParticipant.pic:"null.thumb.jpg"):(e.config.title="丢失",e.config.src="丢失"):e.datasource.processInstance.startParticipant?(e.config.title=e.datasource.processInstance.startParticipant.name,e.config.src=e.datasource.processInstance.startParticipant.pic?e.datasource.processInstance.startParticipant.pic:"null.thumb.jpg"):(e.config.title="丢失",e.config.src="丢失")},row_left_init:function(e,t){"commonlist_copyapprove"===this.fullPageKey&&"0"===e.datasource.taskStatus.toString()&&e.setBadge(1,{backgroundColor:"#F66C6C",right:"50px",fontSize:"0",top:"3px",height:"6px",width:"6px",padding:"0",borderRadius:"30px",boxShadow:"0px 0px 0px 1px #fff"})},row_title_init:function(e,t){null===e.config.text&&(void 0!==e.datasource.historicProcessInstance?e.config.text=e.datasource.historicProcessInstance.name:void 0!==e.datasource.inst?e.config.text=e.datasource.inst.name:"commonlist_copyapprove"===this.fullPageKey&&(e.config.text=e.datasource.title))}},i}),define("pages/commonlist",["../logic/commonlist","../parts/common","utils"],function(e,t,i){var n={pluginClass:e,style:{backgroundColor:t.backColor},root:["body"],components:{body:{type:"view",style:{flex:1,overflowY:"auto",overflowX:"hidden"},root:["searchInput1","listview"]},icons:{type:"icon",font:"ap_e903"},searchview:{type:"view",root:["leftview","searchInput"],style:{width:"100%"}},leftview:{type:"view",ref:!0,root:["selectItem","searchBtn"]},selectItem:{type:"view",ref:!0,root:["approveSelector"],style:{background:"#fff",width:331}},approveSelector:{type:"conditionselector",mode:1,ref:!0,menu1ClassName:"approveSelector",style:{backgroundColor:"#fff",borderBottom:"1px solid #e2e8ed"},items:["全部状态","全部时间","全部类型"],menu0LabelKey:"name",menu1LabelKey:"name",menu2LabelKey:"name",menu0selectedKey:0,menu1selectedKey:0,menu2selectedKey:0,menu2LeftStyle:{width:90},menu1Style:{minHeight:40},menu2Style:{minHeight:40},menu0Style:{minHeight:40},menu0Col:2},searchBtn:{type:"icon",ref:!0,font:"cap_e90c",style:{borderBottom:"solid 1px #e2e8ed",backgroundColor:"#fff",color:"#ccc",width:45,position:"absolute",right:0,top:0,bottom:0}},searchInput:{cancelBtnStyle:{color:"#37B7FD",fontSize:15},style:{backgroundColor:"#fff",display:"none"},iconStyle:{},placeholder:"搜索标题",font:"ap_e903",ref:!0,type:"simplesearchview"},searchInput1:{cancelBtnStyle:{color:"#37B7FD",fontSize:15},style:{backgroundColor:"#fff",display:"none"},iconStyle:{},placeholder:"搜索标题",font:"ap_e903",ref:!0,type:"simplesearchview"},nodata:{ref:"true",type:"icon",text:"暂无内容",textPos:"bottom",src:"./imgs/yunshen_nodata.png?v=1",textStyle:{fontSize:"15px",color:"#ADADAD",paddingLeft:11,paddingTop:10},style:{width:"100%",alineItems:"center",justifyContent:"center",backgroundColor:"#F7F7F7",paddingTop:180},iconStyle:{w:80,h:80}},listview:{ref:!0,type:"listview",nodata:"nodata",itemClassName:"bottom-half-line",rowStyle:{flexDirection:"row",paddingTop:12,paddingBottom:12},style:{flexDirection:"column"},root:["row_left","row_mide","row_right"]},row_left:{type:"view",style:{width:70,alignItems:"center",justifyContent:"center"},root:["row_image"]},row_mide:{type:"view",ref:!0,style:{flex:1,flexDirection:"column",justifyContent:"center"},root:["row_title","row_feature_repeat"]},row_right:{type:"view",style:{width:100,alignItems:"flex-end",paddingRight:15},root:["row_time","row_view"]},row_view:{type:"view",root:["row_state","row_status"],style:{width:"100%",marginTop:8,minHeight:14,flexDirection:"row"}},row_state:{type:"text",text:"逾期",ref:!0,style:{display:"none",fontSize:10,borderRadius:4,backgroundColor:"#FDE6E7",color:"#FA4F52",justifyContent:"center",verticalAlign:"middle",textAlign:"center",width:36,marginTop:-2}},row_status:{type:"text",style:{fontSize:14,lineHeight:"14px",color:"#8C8D8E",position:"absolute",right:0,verticalAlign:"middle"}},row_image:{type:"image",style:{w:40,borderRadius:"100%",backgroundColor:"#eee"}},row_title:{type:"text",numberofline:1,style:{color:"#292F33",fontSize:16,lineHeight:"18px"},text_bind:"processInstance.name"},row_feature_repeat:{type:"repeat",root:["rep_view"],ref:!0,style:{display:"inline",paddingTop:6},itemStyle:{}},rep_view:{type:"view",style:{width:"100%"},root:["row_feature_text"]},row_feature_text:{type:"text",numberofline:1,style:{color:"#ADADAD",fontSize:12,lineHeight:16},text_bind:"text"},row_time:{type:"text",style:{top:2,color:"#999999",fontSize:12},text_bind:"createTime"}}};return n}),define("logic/deal",["../parts/common","utils"],function(e,t){function i(e){this.pageview=e.pageview,this.params=this.pageview.params||{},this.comment="",this.setHeader(),this.selectAssignList=[],this.add_sign_select_list=[],this.hasSelectIndex=0,this.reminderLock=!1}return i.prototype={onPageResume:function(){this.processSelectAssignList(),this.reRenderAssignList()},processSelectAssignList:function(){var e=this,t=!1;this.selectAssignList.forEach(function(i,n){n===e.hasSelectIndex&&(t=!0,i=e.hasSelectData)}),!t&&e.hasSelectData&&this.selectAssignList.push(e.hasSelectData)},reRenderAssignList:function(){var e="",t=this.agreeAssignList[this.hasSelectIndex].components.agree_assign_list_repeat_item.components.agree_assign_list_repeat_content;this.hasSelectData&&0!==this.hasSelectData.length?this.hasSelectData.forEach(function(t,i){e+=t.name+";"}):e="请选择审批人",t.setText(e)},setHeader:function(){var e=this,t=this.formName||"";try{t="1"===this.params.type&&e.params.userName?"转交给"+decodeURI(e.params.userName):"5"===this.params.type?"催办":"审批意见",window.yyesn.client.setHeader(function(){},{type:2,title:t,rightTitle:"",rightValues:[]},function(e){})}catch(e){}},main_view_init:function(e,t){"2"===this.params.type?this.beforeReject():"3"===this.params.type?this.beforeAssign():"4"===this.params.type&&this.beforeAddSign()},beforeReject:function(e,t){var i=this;this.pageview.showLoading({text:"努力加载中...",timeout:8e3}),this.pageview.ajax({url:"/process/rejectCheck",type:"POST",data:{taskId:this.params.taskId},success:function(e){i.pageview.hideLoading(!0),i.pageview.delegate("reject_process_repeat",function(t){i.rejectList=e.data,e.msg&&e.msg.indexOf("BPM数据不存在")>-1?(i.pageview.showTip({text:"此单据已被修改，请刷新或重新进入！",duration:1e3}),window.changeFormStatus=!0,setTimeout(function(){i.pageview.goBack()},1e3)):(i.rejectList.forEach(function(e,t){e.activityName||(e.activityName="环节名称未定义（审批人：",e.participants&&e.participants.length>0&&(e.activityName+=(e.participants[0].name||"未指定")+"）"))}),i.rejectList.push({activityName:"终止流程",placeholder:"终止当前审批流并通知发起人",activityId:"-2"}),t.bindData(i.rejectList))})}})},beforeAssign:function(e,t){var i=this;if(i.currentTaskAsign=JSON.parse(window.localStorage.getItem("ASSIGN_CHECK_DATA")).data,i.pageview.delegate("agree_assign",function(e){e.$el.show()}),i.currentTaskAsign.assignAble)i.initAssignList(i.currentTaskAsign.assignInfo);else{var n=i.currentTaskAsign.description;i.pageview.showTip({text:"任务不支持指派."+(n?n:"")})}},beforeAddSign:function(e,t){this.pageview.delegate("add_sign",function(e){e.$el.show()})},beforeReminder:function(){},initAssignList:function(e){if(null!==e){var t=e.assignInfoItems||[],i=t.length;console.info("可选指派环节数量:"+i),0!==i&&this.pageview.delegate("agree_assign_list_repeat",function(e){e.bindData(t)})}},reject_process_init:function(e,t){"2"===this.params.type&&(e.config.style.display="flex")},reject_process_repeat_item_init:function(e,t){1===this.rejectList.length&&(e.parent.select(),this.activityId=-2)},reject_process_repeat_itemclick:function(e,t){e.select(),"-2"===e.datasource.activityId?this.activityId=-2:this.activityId=e.datasource.activityId},input_textarea_init:function(e,t){"1"===this.params.type?e.config.placeholder="请输入同意理由（非必填, 200字以内）":"2"===this.params.type?e.config.placeholder="请输入拒绝理由（非必填, 200字以内）":"3"===this.params.type?e.config.placeholder="请输入同意理由（非必填, 200字以内）":"5"===this.params.type&&(e.config.placeholder="请输入催办内容 （200字以内）")},input_textarea_didmount:function(e,t){if("5"===this.params.type){var i=decodeURI(this.params.currentUserName)+"催您审批 “"+decodeURI(this.params.instName)+"”，赶快去处理吧。";e.setValue(i)}},agree_assign_list_repeat_itemclick:function(e,t){var i=this;this.pageview.delegate("agree_assign_list_repeat",function(e){i.agreeAssignList=e.components||[]}),this.pageview.showPage({pageKey:"selectApprovers",mode:"fromRight2",nocache:!0,params:{taskId:i.params.taskId,dealLogic:i,approverList:e.datasource,index:t.index}})},add_sign_person_right_repeat_init:function(e,t){e.bindData(this.add_sign_select_list)},add_sign_person_repeat_itemclick:function(e,t){var i=e.datasource.memberId.toString();if(this.add_sign_select_list)for(var n=this.add_sign_select_list.length-1;n>=0;n--)this.add_sign_select_list[n].member_id.toString()===i&&this.add_sign_select_list.splice(n,1);e.remove()},add_sign_person_btn_click:function(e,t){var i=this;try{window.yyesn.enterprise.selectContacts(function(e){if("0"===e.error_code){var t=e.data;i.pageview.refs.add_sign_person_repeat.empty(),i.add_sign_select_list=[];for(var n=0,a=t.length;n<a;n++){var o=t[n];i.add_sign_select_list.push(o),i.pageview.refs.add_sign_person_repeat.addItem({userName:o.name,headImgUrl:o.avatar,memberId:o.member_id})}}},{mode:1,multi:1,select_list:i.add_sign_select_list||[]},function(e){})}catch(e){alert(JSON.stringify(e))}},add_sign_bottom_poplayer_init:function(e,t){this.poplayer=e},add_sign_way_click:function(e,t){this.poplayer.show()},add_sign_bottom_poplayer_repeat_itemclick:function(e,t){var i=this;this.pageview.delegate("add_sign_way_middle",function(t){t.setText(e.datasource.title),i.selectAssignWay=e.datasource.title,i.selectAssignWayKey="会签"===e.datasource.title?"1":"0"}),e.select(),this.poplayer.hide()},agree_assign_list_repeat_title_init:function(e,t){e.config.text=e.config.text||"环节名称未定义"},submit_click:function(e,t){var i={};i.instanceId=this.params.instanceId,i.taskId=this.params.taskId,i.comment=e.parent.components.main_view.components.input_textarea.$el.find("textarea").val()||"",i.processId=this.params.processId,i.comment=this.beforeSubmit(i.comment),"1"===this.params.type?this.doAgree(i):"2"===this.params.type?this.doReject(i):"3"===this.params.type?this.doAssign(i):"4"===this.params.type?this.doAddSign(i):"5"===this.params.type&&this.doReminder(i)},doAgree:function(e){var t=this,i=e,n="";if(this.pageview.showLoading({text:"努力加载中...",timeout:8e3}),this.params.isAdd){var a=window.localStorage.getItem("ADDITIONAL_FORM_DATA");n="/process/saveActivityFormAndAudit",i=$.extend(i,{formData:a,businessKey:this.params.businessKey})}else n="/process/audit",i.formData=this.addTaskCommentPara();this.pageview.ajax({url:n,data:i,type:"POST",success:function(e){t.pageview.hideLoading(!0),console.log(e),0===e.code?(t.pageview.showTip({text:"审批成功！",duration:800}),window.changeFormStatus=!0,setTimeout(function(){t.params.isAdd?t.pageview.goBack(-2):t.pageview.goBack(-1)},800)):t.pageview.showTip({text:e.msg,duration:1e3})},error:function(e){console.log(e)}})},doReject:function(e){var t=this;e.activityId=this.activityId,e.starter=this.params.starter,this.pageview.showLoading({text:"努力加载中...",timeout:8e3}),this.pageview.ajax({url:"/process/rejectTask",data:e,type:"POST",success:function(e){t.pageview.hideLoading(!0),0===e.code?(t.pageview.showTip({text:"驳回成功！",duration:800}),window.changeFormStatus=!0,setTimeout(function(){t.pageview.goBack()},800)):t.pageview.showTip({text:e.msg,duration:1e3})},error:function(e){console.log(e)}})},doAssign:function(e){var i=!1,n=this,a=t.copy(n.currentTaskAsign.assignInfo.assignInfoItems);if(a.forEach(function(e,t){e.participants=[],n.selectAssignList.forEach(function(n,a){t===a&&(e.participants=n,i=!0)})}),this.params.isAdd){var o=window.localStorage.getItem("ADDITIONAL_FORM_DATA");n.currentTaskAsign.assignInfo.formData=o}if(!i)return this.pageview.showTip({text:"请选择1个或多个指派环节中的1个或多个用户！",duration:4e3}),!1;this.currentTaskAsign.assignInfo.assignInfoItems=JSON.stringify(a),this.pageview.showLoading({text:"努力加载中...",timeout:8e3});var s=this.addTaskCommentPara();this.pageview.ajax({url:"process/actionTask",type:"POST",data:$.extend({instanceId:e.instanceId,processId:e.processId,formData:s,comment:e.comment},n.currentTaskAsign.assignInfo),success:function(t){n.pageview.hideLoading(!0),t.success?(n.doComment(e),n.pageview.showTip({text:"指派成功",duration:1e3}),setTimeout(function(){n.params.isAdd?n.pageview.goBack(-2):n.pageview.goBack(-1)},1100)):n.pageview.showTip({text:t.msg,duration:1e3})},error:function(){n.pageview.showTip({text:"指派失败",duration:1e3})}})},doComment:function(e){var t=this;e.comment&&this.pageview.ajax({url:"process/addComment",type:"POST",data:{instanceId:e.instanceId,comment:e.comment,taskId:e.taskId},success:function(){},error:function(){t.pageview.showTip({text:"评论失败",duration:1e3})}})},doAddSign:function(e){var t=this,i=this.add_sign_select_list,n="";return 0===i.length?void this.pageview.showTip({text:"请选择加签人",duration:1e3}):this.selectAssignWayKey?(i.forEach(function(e,t){n+=t!==i.length-1?e.member_id+",":e.member_id}),this.pageview.showLoading({text:"努力加载中...",timeout:8e3}),void this.pageview.ajax({url:"process/counterSignAddTask",
type:"POST",data:{instanceId:e.instanceId,processId:e.processId,taskId:e.taskId,assignees:n,counterSignType:this.selectAssignWayKey},success:function(i){t.pageview.hideLoading(!0),i.success?(t.doComment(e),t.pageview.showTip({text:"加签成功",duration:1e3}),setTimeout(function(){t.pageview.goBack()},1100)):t.pageview.showTip({text:i.msg,duration:1e3})},error:function(){t.pageview.showTip({text:"加签失败",duration:1e3})}})):void this.pageview.showTip({text:"请选择加签方式",duration:1e3})},add_sign_bottom_poplayer_repeat_iteminit:function(e,t){var i=this;"抢占"===e.datasource.title&&(e.select(),this.pageview.delegate("add_sign_way_middle",function(e){e.setText("抢占"),i.selectAssignWay="抢占",i.selectAssignWayKey="0"}))},doReminder:function(e){var t=this;return e.comment?void(this.reminderLock||(this.pageview.showLoading({text:"处理中..."}),this.reminderLock=!0,this.pageview.ajax({url:"esn/sendTaskMessage",timeout:15e3,type:"POST",data:{processInstanceId:this.params.instId,fromUserId:this.params.currentUserId,toUserId:this.params.assignee,message:e.comment,taskId:this.params.taskId,formInstanceId:this.params.formInstanceId,processDefinitionId:this.params.processDefinitionId},success:function(e){t.pageview.hideLoading(!0),e.success?(t.pageview.showTip({text:"催办成功",duration:1e3}),setTimeout(function(){t.reminderLock=!1,t.pageview.goBack()},1e3)):(t.pageview.showTip({text:e.msg,duration:1e3}),t.reminderLock=!1)},error:function(e){t.pageview.hideLoading(!0),t.pageview.showTip({text:e.msg,duration:1e3}),t.reminderLock=!1}}))):(this.pageview.showTip({text:"请输入催办内容",duration:1e3}),!1)},addTaskCommentPara:function(){var e=window._formData,t=window._applyHistory,i={};return $.isArray(e)&&e.length>0&&e[0]?(i={formData:e,pkValue:t.formDataList[0].pk_boins,version:t.formDataList[0].version,pk_temp:t.formDataList[0].pk_temp,tableName:t.iForms.bo_tablename},i=JSON.stringify(i)):i="",i},beforeSubmit:function(e){return this.filterEmoji(e)},filterEmoji:function(e){if(!e)return"";var t=e.replace(/\uD83C[\uDF00-\uDFFF]|\uD83D[\uDC00-\uDE4F]|[\uD800-\uDBFF]|[\uDC00-\uDFFF]/g,"");return t}},i}),define("pages/deal",["../logic/deal","../parts/common","utils"],function(e,t,i){var n={pluginClass:e,style:{backgroundColor:"#F2F3F4"},root:["main_view","submit","add_sign_bottom_poplayer"],components:{main_view:{type:"view",root:["agree_assign","reject_process","add_sign","input_textarea"],style:{flexDirection:"column",paddingBottom:15}},agree_assign:{type:"view",ref:!0,style:{display:"none",minHeight:50,marginBottom:10,fontSize:15,flexDirection:"column"},root:["agree_assign_title","agree_assign_list_repeat"]},agree_assign_title:{type:"text",text:"请选择指派环节的审批人",numberofline:2,style:{paddingLeft:13,fontSize:13,height:30}},agree_assign_list_repeat:{type:"repeat",ref:!0,itemClassName:"form-row",root:["agree_assign_list_repeat_item"],style:{flexDirection:"column",backgroundColor:"#fff"},itemStyle:{backgroundColor:"#fff",borderBottom:"1px solid #ddd",flexDirection:"row"}},agree_assign_list_repeat_item:{type:"view",className:"form-row",root:["agree_assign_list_repeat_title","agree_assign_list_repeat_content","agree_assign_list_repeat_icon"],style:{flexDirection:"row",width:"100%"}},agree_assign_list_repeat_title:{type:"text",text_bind:"activityName",style:{height:50,fontSize:15,paddingLeft:13,flexDirection:"row"}},agree_assign_list_repeat_content:{type:"text",textPos:"left",ref:!0,text:"请选择审批人",font:"icomoon_e913",numberofline:1,style:{flex:1,justifyContent:"flex-end",paddingLeft:20},textStyle:{height:50,lineHeight:50}},agree_assign_list_repeat_icon:{type:"icon",font:"icomoon_e913",numberofline:5,iconStyle:{color:"#BBBBBB",fontSize:14},style:{width:10,justifyContent:"flex-end",paddingRight:16,paddingLeft:20}},reject_process:{type:"view",root:["reject_process_title","reject_process_repeat"],style:{display:"none",flexDirection:"column",marginBottom:10}},reject_process_title:{type:"text",text:"请选择驳回环节",style:{height:30,width:"100%",paddingLeft:13,fontSize:13,color:"#666"}},reject_process_repeat:{type:"repeat",text:"123",ref:!0,root:["reject_process_repeat_item"],style:{flexDirection:"column"},itemSelectedClassName:"reject_process_selected",itemStyle:{borderBottom:"1px solid #ddd"}},reject_process_repeat_item:{type:"view",root:["reject_process_repeat_item_left","reject_process_repeat_item_right"],style:{}},reject_process_repeat_item_left:{type:"text",text_bind:"activityName",style:{backgroundColor:"#fff",height:50,fontSize:15,paddingLeft:13,flexDirection:"row"}},reject_process_repeat_item_right:{type:"icon",font:"cap_e903",style:{display:"none",fontSize:"16",color:"#29B6F6",position:"absolute",right:15,top:0,height:50,lineHeight:50}},add_sign:{type:"view",ref:!0,root:["add_sign_person","add_sign_way"],style:{display:"none",flexDirection:"column"}},add_sign_person:{type:"view",style:{backgroundColor:"#fff",marginBottom:10,marginTop:10},root:["add_sign_person_title","add_sign_person_repeat"]},add_sign_person_title:{type:"text",text:"加签人",nextText:"(点击头像删除人员)",style:{marginTop:10,paddingBottom:10,color:"#333333",fontSize:16,marginLeft:14},nextTextStyle:{color:"#999",marginLeft:10,fontSize:12}},add_sign_person_repeat:{type:"repeat",className:"line-repeat",ref:!0,style:{minHeight:80,flexWrap:"wrap",paddingLeft:6,paddingBottom:10,flexDirection:"row"},subComponent:"add_sign_person_btn",itemStyle:{width:50},root:["add_sign_person_icon"]},add_sign_person_icon:{type:"icon",style:{paddingTop:10,zIndex:10},iconStyle:{w:32,backgroundColor:"#eee",borderRadius:"100%",overflow:"hidden"},textStyle:{marginTop:3,color:"#999999",fontSize:12},title_bind:"userName",src_bind:"headImgUrl",text_bind:"userName",textPos:"bottom"},add_sign_person_btn:{type:"image",src:"./imgs/addapprove.png",style:{w:32,marginTop:9,marginLeft:9,backgroundColor:"#fff"}},add_sign_way:{type:"view",className:"form-row",root:["add_sign_way_left","add_sign_way_middle","add_sign_way_right"],style:{flexDirection:"row",backgroundColor:"#fff",marginBottom:10,fontSize:16}},add_sign_way_left:{type:"text",text:"加签方式",style:{color:"#333",height:50,fontSize:16,paddingLeft:13,flexDirection:"row"}},add_sign_way_middle:{type:"text",textPos:"left",ref:!0,text:"请选择加签方式",font:"icomoon_e913",numberofline:1,style:{flex:1,color:"#ADADAD",justifyContent:"flex-end",paddingLeft:20},textStyle:{height:50,lineHeight:50}},add_sign_way_right:{type:"icon",font:"icomoon_e913",numberofline:5,iconStyle:{color:"#BBBBBB",fontSize:14},style:{width:10,justifyContent:"flex-end",paddingRight:16,paddingLeft:20}},input_textarea:{type:"textarea",ref:!0,max:200,limitStyle:{right:10,color:"#aaa",display:"none"},numStyle:{},maxStyle:{},placeholder:"请输入同意理由（非必填, 200字以内）",style:{height:150,paddingLeft:15,paddingRight:15,fontSize:15,paddingTop:15,width:"100%"}},images_repeat:{type:"repeat",ref:!0,subComponentAlwaysShow:!0,root:["image","image_del_icon"],style:{flexDirection:"row",flexWrap:"wrap",marginTop:10,paddingLeft:10},itemStyle:{w:90,justifyContent:"center",alignItems:"center"},subComponent:"add_image_icon"},add_image_icon:{type:"icon",text:"＋",style:{w:80,backgroundColor:"#fff",marginTop:5,marginLeft:5,border:"1px dashed rgb(207,207,207)"},textStyle:{color:"rgb(207,207,207)",fontSize:28}},image:{type:"image",src_bind:"src",src:"",style:{w:80,backgroundColor:"rgba(0,0,0,.1)"}},image_del_icon:{type:"icon",font:"icomoon_e909",style:{position:"absolute",right:8,border:"2px solid #fff",borderRadius:"100%",backgroundColor:"#fff",top:8},iconStyle:{color:"#FC505F",fontSize:17}},submit:{type:"button",title:"提交",style:{fontSize:16,height:45,backgroundColor:"#37B7FD",border:"none",color:"#fff",margin:15,width:"auto"}},add_sign_bottom_poplayer:{type:"poplayer",mode:"bottom",style:{backgroundColor:"#f2f3f4",flexDirection:"column",width:"100%"},root:["add_sign_bottom_poplayer_title","add_sign_bottom_poplayer_repeat"]},add_sign_bottom_poplayer_title:{type:"text",text:"请选择",style:{color:"#9E9E9E",backgroundColor:"F7F7F7",height:28,fontSize:12,paddingLeft:12}},add_sign_bottom_poplayer_repeat:{type:"repeat",itemSelectedClassName:"add_sign_bottom_poplayer_select",items:[{id:"1",title:"会签",placeholder:"所有加签人并行处理才完成"},{id:"2",title:"抢占",placeholder:"只有一个加签人处理完即完成"}],root:["add_sign_bottom_poplayer_repeat_item"],style:{flexDirection:"column",backgroundColor:"#fff"}},add_sign_bottom_poplayer_repeat_item:{type:"view",root:["add_sign_bottom_poplayer_repeat_item_left","add_sign_bottom_poplayer_repeat_item_right"],style:{flex:1,height:50,borderBottom:"1px solid #eee",color:"#333",fontSize:14,paddingLeft:12}},add_sign_bottom_poplayer_repeat_item_left:{type:"text",text_bind:"title",nextText_bind:"placeholder",style:{flex:1,height:50,color:"#333",fontSize:14},nextTextStyle:{marginLeft:10,color:"#9E9E9E"}},add_sign_bottom_poplayer_repeat_item_right:{type:"icon",font:"cap_e903",style:{display:"none",fontSize:"16",color:"#29B6F6",position:"absolute",right:15,top:0,height:50,lineHeight:50}}}};return n}),define("logic/../../../components/dialog",["utils","base"],function(e,t){var i=function(t){var i=this,n=t.wrapper||$(document.body),a=t.mode||1,o=t.className;this.dialogBackCover=$("<div style='visibility: hidden;' class='yy-dialog-bk'></div>"),this.dialogWrapper=$("<div class='yy-dialog-wrapper yy-dialog-effect-"+a+" yy-dialog-hide + "+o+"'></div>");var s=$("<div class='yy-dialog-inner'></div>"),r=$("<div class='yy-dialog-body'></div>"),l="row"===t.btnDirection?"yy-fd-row":"yy-fd-column",c=$("<div class='yy-dialog-btn-wrapper displayflex "+l+"'></div>");this.dialogBackCover.bind("click",function(){i.hide()});var p=t.title||"";this.titleDom=$("<div class='yy-dialog-title'>"+p+"</div>"),this.bodyContentDom=$("<div class='yy-dialog-content'></div>");var d=t.createContent;if(d)d(this.bodyContentDom);else{var h=t.contentText;this.contentTextDom=$("<div class='yy-dialog-content-text'>"+h+"</div>"),this.bodyContentDom.append(this.contentTextDom)}if(r.append(this.titleDom).append(this.bodyContentDom),t.buttons)for(var u=0,f=t.buttons.length;u<f;u++){var g=t.buttons[u],p=g.title||"按钮",m=g.style,y=g.onClick;!function(t,i,n,a,o){var s=$("<div class='yy-dialog-btn yy-flex-1 displayflex yy-jc-center yy-ai-center'>"+t+"</div>");i&&e.css(s,i),a&&s.bind("click",function(e){a()}),n.append(s)}(p,m,c,y,this)}s.append(r).append(c),this.dialogWrapper.append(s),n.append(this.dialogWrapper).append(this.dialogBackCover)};return i.prototype.show=function(){var e=this;this.dialogWrapper.css({visibility:"visible"}),this.dialogBackCover.css({visibility:"visible"}),this.dialogBackCover.addClass("yy-dialog-bk-show"),window.setTimeout(function(){e.dialogWrapper.removeClass("yy-dialog-hide").addClass("yy-dialog-show")},1)},i.prototype.hide=function(){var e=this;this.dialogWrapper.removeClass("yy-dialog-show").addClass("yy-dialog-hide"),this.dialogBackCover.removeClass("yy-dialog-bk-show"),window.setTimeout(function(){e.dialogWrapper.css({visibility:"hidden"}),e.dialogBackCover.css({visibility:"hidden"})},200)},i}),define("parts/analysis",["./common"],function(e){var t=[],i={getAnalysis_ifroms:function(e,i,n){window._formData=[];var a=JSON.parse(e[0].jsontemp);t=[];var o=a.form.processAuthinfo[n];o||(o=a.form.processAuthinfo.fillIn);for(var s in a)if("enable"!==s&&"pk_bo"!==s&&"form"!==s)switch(s){case"formLayout":var r;r="object"==typeof a[s].layoutDetail?a[s].layoutDetail:JSON.parse(a[s].layoutDetail);for(var l=0;l<r.layoutDetail.length;l++)this.getComponentData(r.layoutDetail[l],i[0],o,n)}return t},getComponentData:function(i,n,a,o){var s=this;n||(n=[]);var r={};switch(i.componentKey){case"ColumnPanel":case"TableLayout":i.layoutDetail.forEach(function(i,l){i.layoutDetail.forEach(function(i,l){if(s.isHide(i.fieldId,a)&&"Score"!==i.componentKey){if(r={},r.title=i.title+"：",r.type=i.componentKey,r.content=n[i.columncode],"Paragraph"===i.componentKey)r.style=i.style;else if("Select"===i.componentKey){r.content="";var c=n[i.columncode];if(c){i.options.forEach(function(e,t){c.indexOf(e.selectionId)>-1&&(r.content+=e.name+",")});var p=c.split(","),d=p[p.length-1];0===d.indexOf("$$hasOther$$")&&(r.content+=d.substring(12,d.length)+","),r.content=","===r.content.substring(r.content.length-1)?r.content.substring(0,r.content.length-1):r.content}}else if("Picture"===i.componentKey)r.url=i.url;else if("Money"===i.componentKey)""!==r.content&&r.content||(r.content="0"),i.numberToChinese&&(r.content=e.MoneyDX(r.content)),r.moneyType=i.moneyType;else if("Password"===i.componentKey){r.content="";for(var h=n[i.columncode],u=0;u<h.length;u++)r.content+="＊"}else if("TaskComment"===i.componentKey&&i.processActivity&&i.processActivity===o){var f={name:i.columncode,type:"TaskComment",value:i.showStyle.toString()};window._formData.push(f)}t.push(r)}})});break;case"Select":if(s.isHide(i.fieldId,a)){r.title=i.title+"：",r.type=i.componentKey;var l=n[i.columncode];if(console.log(i.hasOther),console.log(i),console.log(l),l){r.content="",i.options.forEach(function(e,t){l.indexOf(e.selectionId)>-1&&(r.content+=e.name+",")});var c=l.split(","),p=c[c.length-1];p.indexOf("$$hasOther$$");0===p.indexOf("$$hasOther$$")&&(r.content+=p.substring(12,p.length)+","),r.content=","===r.content.substring(r.content.length-1)?r.content.substring(0,r.content.length-1):r.content}t.push(r)}break;case"Picture":s.isHide(i.fieldId,a)&&(r.title=i.title+"：",r.type=i.componentKey,r.url=i.url,t.push(r));break;case"Money":s.isHide(i.fieldId,a)&&(r.title=i.title+"：",r.type=i.componentKey,r.content=n[i.columncode],r.moneyType=i.moneyType,i.numberToChinese&&(r.content=e.MoneyDX(r.content)),t.push(r));break;case"DataTable":if(s.isHide(i.fieldId,a)){var d=n[i.tableName];if(r={},r.title="明细子表",r.type=i.componentKey,r.items=[],d)d.forEach(function(t,a){var o={};o.title="明细子表",o.num=a+1,o.type=i.componentKey,o.items=[],i.layoutDetail.forEach(function(i,a){if("Score"!==i.componentKey){var s={};if(s.title=i.title+"：",s.type=i.componentKey,s.content=t[i.columncode],"Paragraph"===i.componentKey)s.style=i.style;else if("Select"===i.componentKey){var l=t[i.columncode];if(s.content="",l){i.options.forEach(function(e,t){l.indexOf(e.selectionId)>-1&&(s.content+=e.name+",")});var c=l.split(","),p=c[c.length-1];0===p.indexOf("$$hasOther$$")&&(s.content+=p.substring(12,p.length)+","),s.content=","===s.content.substring(s.content.length-1)?s.content.substring(0,s.content.length-1):s.content}}else if("Picture"===i.componentKey)r.url=i.url;else if("Money"===i.componentKey)""!==s.content&&s.content||(s.content="0"),i.numberToChinese&&(s.content=e.MoneyDX(s.content)),s.moneyType=i.moneyType;else if("Password"===i.componentKey){s.content="";for(var d=n[i.columncode]||"",h=0;h<d.length;h++)s.content+="＊"}o.items.push(s)}}),r.items.push(o)});else{var h={};h.title="明细子表",h.num="1",h.type=i.componentKey,h.items=[],i.layoutDetail.forEach(function(t,i){if("Score"!==t.componentKey){var a={};if(a.title=t.title+"：",a.type=t.componentKey,a.content=n[t.columncode],"Paragraph"===t.componentKey)a.style=t.style;else if("Select"===t.componentKey){var o=n[t.columncode];if(a.content="",o){t.options.forEach(function(e,t){o.indexOf(e.selectionId)>-1&&(a.content+=e.name+",")});var s=o.split(","),l=s[s.length-1];0===l.indexOf("$$hasOther$$")&&(a.content+=l.substring(12,l.length)+","),a.content=","===a.content.substring(a.content.length-1)?a.content.substring(0,a.content.length-1):a.content}}else if("Picture"===t.componentKey)r.url=t.url;else if("Money"===t.componentKey)""!==a.content&&a.content||(a.content="0"),t.numberToChinese&&(a.content=e.MoneyDX(a.content)),a.moneyType=t.moneyType;else if("Password"===t.componentKey){a.content="";for(var c=n[t.columncode]||"",p=0;p<c.length;p++)a.content+="＊"}h.items.push(a)}}),r.items.push(h)}t.push(r)}break;case"Password":if(s.isHide(i.fieldId,a)){r.title=i.title+"：",r.type=i.componentKey;var u=n[i.columncode]||"";r.content="";for(var f=0;f<u.length;f++)r.content+="＊";t.push(r)}break;case"Score":break;case"TaskComment":if(s.isHide(i.fieldId,a)){if(i.processActivity&&i.processActivity===o){var g={name:i.columncode,type:"TaskComment",value:i.showStyle.toString()};window._formData.push(g)}r.title=i.title+"：",r.type=i.componentKey,r.content=n[i.columncode],t.push(r)}break;case"IdentifyCode":break;default:s.isHide(i.fieldId,a)&&(r.title=i.title+"：",r.type=i.componentKey,r.content=n[i.columncode],"Paragraph"===i.componentKey&&(r.style=i.style,r.content||(r.content="")),t.push(r))}},isHide:function(e,t){if(t)for(var i=0;i<t.length;i++)if(t[i].fieldid===e&&"0"===t[i].auth)return!1;return!0}};return i}),define("logic/detail",["../parts/common","utils","../../../components/dialog","../libs/plupload/form-file-uploader","../parts/analysis"],function(e,t,i,n,a){function o(e){var i=this;this.applyHistory={},this.item=[],this.pageview=e.pageview,this.formName=this.pageview.params.formDataName||"",this.formName=decodeURI(this.formName)||"",this.currentTodoTaskInitAttCnt=0,this.fileMaxNum=9,this.fileNum=0,this.setHeader(),t.deviceInfo().isAndroid?window.setTimeout(function(){i.loadData()},300):i.loadData()}return o.prototype={onPageResume:function(){this.applyHistory={},this.item=[],this.setHeader(),this.loadData()},setHeader:function(){try{var e=this.formName||"";window.yyesn.client.setHeader(function(){},{type:2,title:e,rightTitle:"",rightValues:[]},function(e){})}catch(e){}},loadData:function(){var e=this;this.pageview.showLoading({text:"努力加载中...",timeout:8e3,reLoadCallBack:function(){e._loadData()}}),e._loadData()},_loadData:function(){var e=this,t={url:"/process/getApply",type:"POST",data:{instId:this.pageview.params.instId||"",taskId:this.pageview.params.taskId||"",copyToId:this.pageview.params.copyToId||""},success:function(t){if(e.applyHistory={},e.detailData=t.data,e.pageview.hideLoading(!0),0===t.code){e.detailData.dataCollection?e.pageview.refs.segment.$el.hide():e.pageview.refs.segment.$el.show(),window.needRefresCopyApproveListData=!0;var i=e.pageview.refs.top_view.components.viewpager;e.pageview.delegate("userinfo_name",function(i){e.instName=t.data.inst.name,i.setText(t.data.inst.name)});for(var n=[],o=[],s={},r=t.data.inst.bpmForms?t.data.inst.bpmForms[0].fields:[],l=0;l<r.length;l++){var c={};s={};var p=JSON.parse(r[l].fieldContent),d=JSON.parse(r[l].variableContent),h=d.name?d.name:"未命名";if(s.title=h+": ",s.type=d.type.name,d.type.kind&&(s.kind=d.type.kind),t.data.inst.formDataList&&t.data.inst.formDataList.length>0&&(s.content=t.data.inst.formDataList[0][r[l].tableFieldName]),p.keyFeatures){var u=s.content;"boolean"===s.type&&(u="1"===s.content?"是":"否"),c.text=s.title+u}$.isEmptyObject(c)||o.push(c),n.push(s)}0===r.length&&t.data.inst.iforms&&(n=a.getAnalysis_ifroms(t.data.inst.iforms,t.data.inst.formDataList,t.data.inst.currentActivityId));for(var f=[],g=t.data.inst.bpmForms?t.data.inst.bpmForms[0].subForms:[],m=0;m<g.length;m++){var y={},v=g[m]?g[m].fields:[];y.title=g[m].title,y.item=[];for(var w=0;w<v.length;w++){var x=JSON.parse(v[w].variableContent),b=x.name?x.name:"未命名",_=x.type.name,D=t.data.inst.formDataList&&t.data.inst.formDataList[0][g[m].tableName],I=D>0&&D[0][v[w].tableFieldName]?D[0][v[w].tableFieldName]:"";y.item.push({name:b+"：",type:_,content:I})}f.push(y)}if(t.data.inst.keyFeature){var S=[],C=t.data.inst.keyFeature;try{var T=JSON.parse(C);if(T)T.forEach(function(e,t){var i={};i.text=e.key+":"+e.value,S.push(i)});else if(null!==C&&"null"!==C)for(var k=C.split(";"),R=0;R<k.length;R++){var L={};L.text=k[R],S.push(L)}}catch(e){if(null!==C&&"null"!==C)for(var A=C.split(";"),E=0;E<A.length;E++){var P={};P.text=A[E],S.push(P)}}e.pageview.delegate("userinfo_repeat",function(e){S&&S.length>0?e.bindData(S):e.$el.css({display:"none"})})}e.applyHistory.taskId=e.pageview.params.taskId,e.applyHistory.nodeFormID=t.data.nodeFormID,e.applyHistory.currentUserId=t.data.currentUserId,e.applyHistory.currentMemberId=t.data.currentMemberId,e.applyHistory.currentUserName=t.data.currentUserName,e.applyHistory.copyToEndTime=t.data.copyToEndTime,e.applyHistory.instData=t.data.inst,e.applyHistory.formDataList=t.data.inst.formDataList||[],e.applyHistory.variableData=t.data.inst.variables,e.applyHistory.taskList=t.data.inst.historicTasks||[],e.applyHistory.instanceTodoTasks=[],e.applyHistory.instanceDoneTasks=[],e.applyHistory.subFormDatas=[],e.applyHistory.bpmActivityForms=t.data.inst.bpmActivityForms||[],e.applyHistory.formDataMap=t.data.inst.formDataMap||[],e.applyHistory.formKey=e.applyHistory.taskList.formKey,e.applyHistory.editFlag=t.data.editFlag;for(var M=t.data.inst.historicActivityInstances,N=0;N<M.length;N++)if("startEvent"===M[N].activityType){e.applyHistory.photo=M[N].pic,e.applyHistory.name=M[N].userName;break}if(e.pageview.delegate("user_icon",function(t){e.applyHistory.photo&&e.applyHistory.photo.length>4?t.setSrc(e.applyHistory.photo):t.setTitle(e.applyHistory.name)}),t.data.inst.bpmForms&&t.data.inst.bpmForms.length>0?(e.applyHistory.mainForm=t.data.inst.bpmForms[0],e.applyHistory.formId=t.data.inst.bpmForms[0].id):t.data.inst.iforms&&(e.applyHistory.iForms=t.data.inst.iforms[0],e.applyHistory.formId=t.data.inst.iforms[0].pk_bo),e.initFormData(),e.applyHistory.mainForm){var F=e.applyHistory.mainForm.buttons;F&&(e.applyHistory.taskBtnVars=JSON.parse(F))}e.applyHistory.currentUserId&&$.each(e.applyHistory.taskList,function(t,i){"deleted"!==i.deleteReason&&(null===i.endTime||i.endTime.indexOf("9999")>-1?(e.applyHistory.instanceTodoTasks.push(i),i.id===e.applyHistory.taskId&&i.assignee===e.applyHistory.currentUserId?(e.applyHistory.currentTodoTask=i,e.applyHistory.currentUserName=i.userName):i.processInstanceId===e.applyHistory.taskId&&i.assignee===e.applyHistory.currentUserId&&(e.applyHistory.currentTodoTask=i,e.applyHistory.currentUserName=i.userName)):(e.applyHistory.instanceDoneTasks.push(i),i.id===e.applyHistory.taskId&&i.assignee===e.applyHistory.currentUserId&&(e.applyHistory.currentDoneTask=i,e.applyHistory.currentUserName=i.userName)))}),window.setTimeout(function(){i.curPageViewItem.contentInstance.refs.moreBill&&(0===e.applyHistory.bpmActivityForms.length?i.curPageViewItem.contentInstance.refs.moreBill.$el.hide():i.curPageViewItem.contentInstance.refs.moreBill.$el.show())},100),e.getSort(),window._applyHistory=e.applyHistory,window.setTimeout(function(){i.curPageViewItem.contentInstance.refs.subform_repeat&&i.curPageViewItem.contentInstance.refs.subform_repeat.bindData(f),i.curPageViewItem.contentInstance.refs.detail_repeat?i.curPageViewItem.contentInstance.refs.detail_repeat.bindData(n):i.curPageViewItem.contentInstance.refs.middle_flow_repeat&&i.curPageViewItem.contentInstance.refs.middle_flow_repeat.bindData(e.applyHistory.processInstances),i.curPageViewItem.contentInstance.refs.copyuser_repeat&&e.applyHistory.instData.copyUserParticipants&&(i.curPageViewItem.contentInstance.refs.copyuser_item.$el.show(),i.curPageViewItem.contentInstance.refs.copyuser_repeat.bindData(e.applyHistory.instData.copyUserParticipants))},100),e.pageview.delegate("result_logo",function(t){e.detailData.dataCollection||(e.pageview.refs.result_text.$el.hide(),e.applyHistory.instData.endTime&&e.applyHistory.instData.endTime.indexOf("9999")===-1?e.applyHistory.instData.deleteReason?(t.$el.find("img").attr("src","./imgs/refuse.png"),setTimeout(function(){t.$el.show()},300),setTimeout(function(){t.$el.css({"-webkit-transform":"scale(.5)",opacity:"1"})},450)):(setTimeout(function(){t.$el.show()},300),setTimeout(function(){t.$el.css({"-webkit-transform":"scale(.5)",opacity:"1"})},450)):(e.pageview.refs.result_text.innerText.css("color","#E7A757"),e.pageview.refs.result_text.innerText.html("审批中"),e.pageview.refs.result_text.$el.show(),e.applyHistory.currentTodoTask?console.log("待办"):"auditor"===e.applyHistory.currentUserType?console.log("已流转"):console.debug("进行中")))});var W=e.applyHistory.currentTodoTask&&e.applyHistory.currentTodoTask.taskAuditDesc;if(W&&W.indexOf("加签给")!==-1)console.warn("当前任务是加签任务则不能再做审批"),e.item.push({label:"任务加签中，请等待加签审批结果"});else{if(e.applyHistory.currentTodoTask){var O=e.applyHistory.currentTodoTask.activity,B=!1,z=!1,H=!1;null!==O&&null!==O.properties&&(B=O.properties.rejectAble,z=O.properties.delegateAble,H=O.properties.addsignAble),e.item.push({label:"同意"}),B&&e.item.push({label:"驳回"}),e.item.push({label:"抄送"}),z&&e.item.push({label:"改派"}),H&&e.item.push({label:"加签"})}else if(null!==e.applyHistory.currentDoneTask&&e.applyHistory.instanceTodoTasks.length>0){var K=e.applyHistory.instanceDoneTasks[e.applyHistory.instanceDoneTasks.length-1];if(K&&e.applyHistory.currentDoneTask&&e.applyHistory.currentDoneTask.id===K.id&&"completed"===K.deleteReason){var V=e.applyHistory.currentDoneTask.taskAuditDesc?"撤回审批":"同意";e.item.push({label:V})}}e.applyHistory.taskBtnVars&&e.applyHistory.taskBtnVars.length>0&&$.each(e.applyHistory.taskBtnVars,function(t,i){e.item.push({label:i})}),e.applyHistory.copyToEndTime||(e.applyHistory.nodeFormID?(e.applyHistory.copyToEndTime||e.item.push({label:"编辑",id:e.applyHistory.nodeFormID}),e.applyHistory.formKey||window.setTimeout(function(){i.curPageViewItem.contentInstance.refs.btnAddDoc&&i.curPageViewItem.contentInstance.refs.btnAddDoc.$el.show()},100)):window.setTimeout(function(){i.curPageViewItem.contentInstance.refs.btnAddDoc&&i.curPageViewItem.contentInstance.refs.btnAddDoc.$el.hide()},100),e.applyHistory.editFlag&&(e.applyHistory.instData.endTime||e.item.push({label:"编辑",id:e.applyHistory.instData.id}))),e.applyHistory.currentUserId===e.applyHistory.instData.startUserId&&e.applyHistory.instData.deleteReason&&e.item.push({label:"重新提交"})}e.initBtn()}else e.pageview.showTip({text:t.msg,duration:2e3})},error:function(e){}};this.pageview.ajax(t)},initBtn:function(){for(var e=0;e<this.item.length;e++)if(this.item[e].label.indexOf("撤回申请")>-1){this.item.splice(e,1);break}if(this.item.length>4){for(var t=[],i=[],n=0;n<this.item.length;n++)n>=3?i.push(this.item[n]):t.push(this.item[n]);0===t.length?(this.pageview.refs.buttonGroup.$el.hide(),this.pageview.refs.buttonGroup.$el.css({"background-color":"rgb(247, 247, 247)"}),this.pageview.refs.buttonGroup.$el.css({"border-top":"1px solid #eee"})):(this.pageview.refs.buttonGroup.$el.show(),this.pageview.refs.buttonGroup.$el.css({"border-top":"1px solid #eee"}),this.pageview.refs.bottomToolBar.$el.css({"background-color":"rgb(255, 255, 255)"}),this.pageview.refs.buttonGroup.$el.css({"background-color":"rgb(255, 255, 255)"})),this.pageview.refs.moreRepeat.bindData(i),this.pageview.refs.buttonGroup.bindData(t),this.pageview.refs.bottomToolBar.$el.show(),this.pageview.refs.splitline.$el.show(),this.pageview.refs.moreBtn.$el.show()}else 0===this.item.length?(this.pageview.refs.bottomToolBar.$el.hide(),this.pageview.refs.buttonGroup.$el.css({"background-color":"rgb(247, 247, 247)"}),this.pageview.refs.buttonGroup.$el.css({"border-top":"rgb(247, 247, 247)"})):(this.pageview.refs.bottomToolBar.$el.show(),this.pageview.refs.buttonGroup.$el.css({"background-color":"rgb(255, 255, 255)"}),this.pageview.refs.bottomToolBar.$el.css({"background-color":"rgb(255, 255, 255)"})),this.pageview.refs.buttonGroup.bindData(this.item),this.pageview.refs.splitline.$el.hide(),this.pageview.refs.moreBtn.$el.hide()},initFormData:function(){var e=this,t=e.applyHistory.formDataList;if(0===t.length)return void console.debug("表单数据不存在");e.applyHistory.mainFormData=t[0];var i=0;$.each(t[0],function(t,n){$.isArray(n)?(i++,e.applyHistory.subFormDatas[t]=n):e.applyHistory.mainFormData[t]=n})},viewpager_init:function(e,t){this.viewpager=e},getSort:function(){var e=this,t={};this.applyHistory.processInstances=[],this.applyHistory.instData.historicActivityInstances.forEach(function(i,n){"startEvent"===i.activityType&&(t.userName=i.userName,t.activityType=i.activityType,t.startTime=i.startTime,t.endTime=i.endTime,t.pic=i.pic,t.assignee=e.applyHistory.instData.startUserId,t.memberId=i.memberId)});var i=this.applyHistory.instData.historicTasks;if(i)for(var n=i.length-1;n>=0;n--){var a=(e.applyHistory.instData.historicActivityInstances,{});a.userName=i[n].userName,a.activityType="userTask",a.startTime=i[n].startTime,a.endTime=i[n].endTime,a.pic=i[n].pic,a.assignee=i[n].assignee,a.taskId=i[n].id,a.taskComments=i[n].taskComments,a.dueDate=i[n].dueDate,a.deleteReason=i[n].deleteReason,a.taskAuditDesc=i[n].taskAuditDesc,a.processDefinitionId=i[n].processDefinitionId,a.memberId=i[n].memberId,e.applyHistory.processInstances.push(a)}this.applyHistory.processInstances.push(t)},segment_change:function(e,t){var i=this;if(!t.nochange){var n=t.item,a=n.datasource,o=a.title;i.getSort(),"详情"===o?(this.initBtn(),this.viewpager.showItem("detailContent_detail",{type:"content"})):"流程"===o?(this.initBtn(),this.viewpager.showItem("detailProcess_detail",{type:"process",parentThis:this}),window.setTimeout(function(){i.viewpager.curPageViewItem.contentInstance.refs.middle_flow_repeat.bindData(i.applyHistory.processInstances)},200)):"附件"===o&&(this.applyHistory.instData.endTime||(this.applyHistory.instData.deleteReason?i.pageview.refs.bottomToolBar.$el.hide():i.applyHistory.currentUserId===i.applyHistory.processInstances[0].assignee&&i.applyHistory.taskId===i.applyHistory.processInstances[0].taskId?i.pageview.refs.buttonGroup.bindData([{label:"上传附件"}]):i.pageview.refs.bottomToolBar.$el.hide()),this.pageview.refs.splitline.$el.hide(),this.pageview.refs.moreBtn.$el.hide(),this.viewpager.showItem("detailAttachment_detail",{type:"attachment",parent:this}),setTimeout(function(){i.initUploader(i.pageview.refs.buttonGroup)},500))}},morePopover_init:function(e,t){this.morePopver=e},moreBtn_click:function(e,t){this.morePopver.show(e)},moreRepeat_itemclick:function(e,t){this.buttonGroupClick(e),this.morePopver.hide()},buttonGroup_itemclick:function(e,t){this.buttonGroupClick(e)},buttonGroupClick:function(e){var t=e.datasource.label.replace(/ /g,""),i=this.applyHistory.taskId,n=this.applyHistory.iForms,a=n?n.source:"",o=this.applyHistory.instData.currentActivityId,s={instanceId:this.detailData.inst.id,processId:this.detailData.inst.processDefinitionId,taskId:i,starter:this.detailData.inst.startUserId},r={id:this.pageview.params.instId,title:encodeURI(this.instName),procInstName:encodeURI(window._applyHistory.instData.name),formType:null,source:a,taskDefinitionKey:o};switch(t){case"编辑":r.formType="MODIFY",this.pageview.replaceGo("form",r);break;case"同意":this.goAgreeAndAssign(s);break;case"驳回":this.goReject(s);break;case"抄送":this.goCopyTo(s);break;case"加签":this.goAddSign(s);break;case"改派":this.goDelegate(s);break;case"撤回审批":this.goResetApprove(s);break;case"撤回申请":this.goResetApply(s);break;case"上传附件":this.fileNum<this.fileMaxNum?$(".moxie-shim.moxie-shim-html5 input").click():this.pageview.showTip({text:"最多上传"+this.fileMaxNum+"张图片",duration:1e3});break;case"重新提交":r.formType="reAdd",this.pageview.replaceGo("form",r);break;default:console.error("未指定的按钮类型")}},goAgreeAndAssign:function(e){var t=this;this.pageview.showLoading({text:"努力加载中...",timeout:8e3}),this.pageview.ajax({url:"process/assignCheck",type:"GET",data:{taskId:e.taskId},success:function(i){t.pageview.hideLoading(!0),i.success?i.data.assignAble?(window.localStorage.setItem("ASSIGN_CHECK_DATA",JSON.stringify(i)),t.pageview.go("deal",{type:3,instanceId:e.instanceId,processId:e.processId,taskId:e.taskId,formName:this.formName})):t.pageview.go("deal",{type:1,instanceId:e.instanceId,processId:e.processId,taskId:e.taskId,formName:this.formName}):(i.msg.indexOf("当前环节任务已完成")>-1&&(t.pageview.showTip({text:"此任务已被修改或完成，请刷新或重新进入",duration:800}),t.applyHistory={},t.item=[],t.loadData()),t.pageview.showTip({text:i.msg,duration:1e3}))},error:function(e){console.error("指派检查失败")}})},goReject:function(e){this.pageview.go("deal",{type:2,instanceId:e.instanceId,processId:e.processId,taskId:e.taskId,starter:e.starter})},goAddSign:function(e){this.pageview.go("deal",{type:4,instanceId:e.instanceId,processId:e.processId,taskId:e.taskId,starter:e.starter})},goDelegate:function(t){var n=this;try{window.yyesn.enterprise.selectContacts(function(a){if("0"===a.error_code){var o=a.data[0];n.delegatePerson={userName:o.name,headImgUrl:o.avatar,memberId:o.member_id},n.delegateDialog=new i({mode:3,wrapper:n.pageview.$el,contentText:"确定要将审批单改派给"+o.name+"进行审批吗?",
btnDirection:"row",buttons:[{title:"取消",style:{height:45,fontSize:16,color:e.titleColor,borderRight:"1px solid #eee"},onClick:function(){n.delegateDialog.hide()}},{title:"确定",style:{height:45,fontSize:16,color:"#37b7fd"},onClick:function(){n.delegateDialog.hide(),n.doDelegate(t)}}]}),n.delegateDialog.show()}},{mode:1,multi:0},function(e){})}catch(e){alert(JSON.stringify(e))}},doDelegate:function(e){var t=this;this.pageview.showLoading({text:"努力加载中...",timeout:8e3}),this.pageview.ajax({url:"process/delegateTask",type:"POST",data:{instanceId:e.instanceId,processId:e.processId,taskId:e.taskId,toAssignee:this.delegatePerson.memberId},success:function(e){t.pageview.hideLoading(!0),e.success?(t.pageview.showTip({text:"改派成功",duration:1e3}),t.applyHistory={},t.item=[],t.loadData()):t.pageview.showTip({text:e.msg,duration:1e3})},error:function(e){t.pageview.showTip({text:e.msg,duration:1e3})}})},goCopyTo:function(t){var n=this;try{window.yyesn.enterprise.selectContacts(function(a){if("0"===a.error_code){var o=a.data,s="",r=0,l="";n.copy_to_list=[];for(var c=0,p=o.length;c<p;c++){var d=o[c];n.copy_to_list.push(d),c<3&&(s+=d.name+"、")}s=s.substring(0,s.length-1),r=n.copy_to_list.length,l=r>3?"确定要将"+s+"等"+r+"人加到抄送人中吗？":"确定要将"+s+"加到抄送人中吗？",n.copyToDialog=new i({mode:3,wrapper:n.pageview.$el,contentText:l,btnDirection:"row",buttons:[{title:"取消",style:{height:45,fontSize:16,color:e.titleColor,borderRight:"1px solid #eee"},onClick:function(){n.copyToDialog.hide()}},{title:"确定",style:{height:45,fontSize:16,color:"#37b7fd"},onClick:function(){n.copyToDialog.hide(),n.doCopyTo(t)}}]}),n.copyToDialog.show()}},{mode:1,multi:1},function(e){})}catch(e){alert(JSON.stringify(e))}},doCopyTo:function(e){var t=this,i="";this.copy_to_list.forEach(function(e,t){i+=e.member_id+","}),i=i.substring(0,i.length-1),this.pageview.showLoading({text:"努力加载中...",timeout:8e3}),this.pageview.ajax({url:"process/copyToTask",type:"POST",data:{instanceId:e.instanceId,processId:e.processId,taskId:e.taskId,assignees:i},success:function(e){t.pageview.hideLoading(!0),e.success?(t.pageview.showTip({text:"抄送成功",duration:1e3}),t.applyHistory={},t.item=[],t.loadData()):t.pageview.showTip({text:e.msg,duration:1e3})},error:function(e){t.pageview.showTip({text:e.msg,duration:1e3})}})},goResetApply:function(t){var n=this;n.delegateDialog||(n.delegateDialog=new i({mode:3,wrapper:n.pageview.$el,contentText:"确定要撤销该申请吗?",btnDirection:"row",buttons:[{title:"取消",style:{height:45,fontSize:16,color:e.titleColor,borderRight:"1px solid #eee"},onClick:function(){n.delegateDialog.hide()}},{title:"确定",style:{height:45,fontSize:16,color:"#37b7fd"},onClick:function(){n.delegateDialog.hide(),n.pageview.showLoading({text:"努力加载中...",timeout:8e3}),n.pageview.ajax({url:"process/withdrawTask",type:"POST",data:{taskId:t.taskId},success:function(e){n.pageview.hideLoading(!0),e.success?n.pageview.showTip({text:"撤回成功",duration:1e3}):n.pageview.showTip({text:e.msg,duration:1e3})},error:function(e){n.pageview.showTip({text:e.msg,duration:1e3})}})}}]})),n.delegateDialog.show()},goResetApprove:function(t){var n=this;n.delegateDialog=new i({mode:3,wrapper:n.pageview.$el,contentText:"确定要撤销该审批吗?",btnDirection:"row",buttons:[{title:"取消",style:{height:45,fontSize:16,color:e.titleColor,borderRight:"1px solid #eee"},onClick:function(){n.delegateDialog.hide()}},{title:"确定",style:{height:45,fontSize:16,color:"#37b7fd"},onClick:function(){n.delegateDialog.hide(),n.pageview.showLoading({text:"努力加载中...",timeout:8e3}),n.pageview.ajax({url:"process/withdrawTask",type:"POST",data:{taskId:t.taskId},success:function(t){n.pageview.hideLoading(!0),t.success?(e.replaceUrl(n.pageview.params.taskId,t.data,n.pageview),n.pageview.params.taskId=t.data,n.pageview.showTip({text:"撤回成功",duration:1e3}),n.applyHistory={},n.item=[],n.loadData()):n.pageview.showTip({text:t.msg,duration:1e3})},error:function(e){n.pageview.showTip({text:e.msg,duration:1e3})}})}}]}),n.delegateDialog.show()},initUploader:function(e){var t=this;this.loadToken(function(e){t.token=e});var i=e.$el,a=$(".flow_repeat"),o=this.fileMaxNum;this.fileUploader||(this.fileUploader=new n(this.pageview,this),this.uploaderId=this.fileUploader.initUploader(i,a,this.pageview.params.taskId,o),setTimeout(function(){t.fileUploader.updateUploaderSize()},100))},loadFilesData:function(){this.viewpager.curPageViewItem.contentInstance.pageview.plugin._loadData()},loadToken:function(e){this.pageview.ajax({url:"user/getToken",success:function(t){e(t)},error:function(e){console.error(e)}})}},o}),define("pages/detail",["../logic/detail","../parts/common","utils"],function(e,t,i){var n={pluginClass:e,style:{backgroundColor:"#F7F7F7"},root:["top_view","bottomToolBar","morePopover"],components:{top_view:{type:"view",ref:!0,style:{flex:1,background:"#f2f3f4"},root:["userinfo_warp","segment","viewpager"]},userinfo_warp:{type:"view",ref:!0,className:"bottom-half-line",style:{flexDirection:"row",alignItems:"flex-start",background:"#fff",padding:"20px 0 24px 0",zIndex:11},root:["user_icon","userinfo_rightwarp","result_logo","result_text"]},user_icon:{type:"image",ref:!0,src:"./imgs/1.png1",title:"...",style:{w:55,fontSize:18,backgroundColor:"rgba(255, 255, 255,0)",marginLeft:13,marginRight:13,borderRadius:"100%"}},userinfo_rightwarp:{type:"view",style:{flex:1,justifyContent:"center",minHeight:55},root:["userinfo_name","userinfo_repeat"]},result_text:{type:"text",text:"进行中",ref:!0,style:{display:"none",position:"absolute",fontSize:14,right:16,top:17,pointerEvents:"none"}},result_logo:{type:"image",src:"./imgs/agree.png",ref:!0,style:{display:"none",position:"absolute",top:-25,width:160,right:-30,opacity:"1",background:"rgba(255,255,255,0)",transition:"all 150ms ease","-webkit-backface-visibility":"hidden","-webkit-transform-style":"preserve-3d","-webkit-transform":"translate3d(0,0,0)",pointerEvents:"none"}},userinfo_name:{type:"text",ref:!0,text:"加载中...",style:{color:"#262626",fontSize:16,lineHeight:16,paddingRight:60}},userinfo_repeat:{type:"repeat",ref:!0,style:{display:"inline",paddingTop:8},root:["userinfo_view"]},userinfo_view:{type:"view",root:["userinfo_status"],style:{flex:1,paddingRight:12}},userinfo_status:{type:"text",text:"加载中...",text_bind:"text",ref:!0,numberofline:1,style:{fontSize:13,lineHeight:18,height:18,color:"#ADADAD"}},segment:{type:"segment_android",ref:!0,items:[{title:"详情"},{title:"流程"},{title:"附件"}],root:["segment_item"],className:"bottom-half-line",style:{display:"none",height:38,color:"#262626",backgroundColor:"#fff"},itemStyle:{paddingBottom:2}},segment_item:{type:"text",text:"加载中...",text_bind:"title",selectedClassName:"yy-sgm-item-selected-android",style:{color:"#262626",fontSize:15}},viewpager:{type:"viewpager",className:"detail_viewpager",defaultKey:"detailContent_detail",style:{flex:1}},bottomToolBar:{type:"view",ref:!0,style:{height:46,flexDirection:"row",backgroundColor:"#fff",alignItems:"center"},root:["buttonGroup","splitline","moreBtn"]},splitline:{type:"view",ref:!0,style:{borderLeft:"1px solid rgb(220, 220, 220)",height:14}},buttonGroup:{type:"repeat",ref:!0,root:["toolbarIcon"],className:"top-half-line",style:{flex:1,alignItems:"center",backgroundColor:"rgb(247, 247, 247)",height:46},itemStyle:{flex:1,zIndex:11,justifyContent:"center",alignItems:"center",height:"100%",width:"100%"},splitStyle:{borderLeft:"1px solid #ededed",height:16}},toolbarIcon:{type:"icon",text_bind:"label",style:{flex:1,width:"100%"},iconStyle:{color:"#262626",fontSize:14},textStyle:{color:"#262626",marginLeft:5,fontSize:14}},moreBtn:{type:"icon",font:"cap_e90d",ref:!0,iconStyle:{color:"#262626",fontSize:16},style:{display:"none",height:46,width:30,padding:"0 42px",borderTop:"1px solid #eee"}},morePopover:{type:"popover",root:["moreRepeat"],animate:{mode:"2"},bkCoverStyle:{backgroundColor:"rgba(230, 230, 230, 0.2)"},arrowStyle:{backgroundColor:"#fff",zIndex:2,"-webkit-box-shadow":"9px 8px 13px #9C9C9C","box-shadow":"9px 8px 13px #9C9C9C"},style:{"-webkit-box-shadow":"0px 8px 13px #9C9C9C","box-shadow":"0px 8px 13px #9C9C9C",width:72,backgroundColor:"#fff",minHeight:50,height:"auto",borderRadius:"7px"}},moreRepeat:{type:"repeat",ref:!0,root:["moreRepeat_icon"],style:{flexDirection:"column",flex:1},itemStyle:{justifyContent:"center",alignItems:"stretch",height:40,padding:"0 5px"}},moreRepeat_icon:{type:"icon",text:"按钮",text_bind:"label",style:{},textStyle:{fontSize:14,color:"#292f33"}}}};return n}),define("logic/detail1",["../parts/common","utils","../../../components/dialog"],function(e,t,i){function n(e){var i=this;this.pageview=e.pageview,this.nowApprove=!0,window.changeFormStatus=!1,this.formName=this.pageview.params.formDataName||"",this.formName=decodeURI(this.formName)||"",this.setHeader(),t.deviceInfo().isAndroid?window.setTimeout(function(){i.loadData()},300):i.loadData(),this.renderCacheData()}return n.prototype={onPageResume:function(){this.loadData(),this.resetData(),this.setHeader()},setHeader:function(){try{var e=(window.nowFormData&&window.nowFormData.name?window.nowFormData.name+"的":"")+this.formName||"";window.yyesn.client.setHeader(function(){},{type:2,title:e,rightTitle:"",rightValues:[]},function(e){})}catch(e){}},loadData:function(){var e=this;this.pageview.showLoading({text:"努力加载中...",timeout:9e3,reLoadCallBack:function(){e._loadData()}}),e._loadData()},_loadData:function(){var e=this,t={url:"/formdata/mylist/"+this.pageview.params.formId,type:"GET",data:{toMemberId:this.pageview.params.toMemberId||"",qzId:this.pageview.params.qzId||"",ccId:this.pageview.params.ccId||""},success:function(t){0===t.code?(e.myListData=t.data,e.templateid=t.data.formData.ftId,e.loadDetailSuccess(t.data),window.needRefresCopyApproveListData=!0):e.pageview.showTip({text:t.msg,duration:1e3})},error:function(t){e.pageview.showTip({text:t.msg,duration:1e3})}},i={url:"/processdata/gethistory/"+this.pageview.params.formId,type:"GET",data:{toMemberId:this.pageview.params.toMemberId||"",qzId:this.pageview.params.qzId||""},success:function(t){0===t.code?(e.detailData=t.data,e.currentMemberId=t.data.currentMemberId,e.loadListSuccess(t.data)):e.pageview.showTip({text:t.msg,duration:1e3})},error:function(t){e.pageview.showTip({text:t.msg,duration:1e3})}};this.pageview.ajax(t),this.pageview.ajax(i)},loadDetailSuccess:function(e){this.pageview.hideLoading(!0),this.pageview.delegate("middle_cc_list_repeat",function(t){t.bindData(e.cclist)}),this.pageview.delegate("middle_cc_list_top",function(t){0===e.cclist.length&&t.$el.hide()}),this.renderData(e)},loadListSuccess:function(e){var t=this;this.pageview.delegate("middle_flow_repeat",function(i){t.historyLength=e.historyList.length,e.historyList[0].isFirst=!0,e.historyList[e.historyList.length-1].isLast=!0,i.bindData(e.historyList)})},renderCacheData:function(){var e=t.copy(window.nowFormData);this.nowFormData=e,e&&!$.isEmptyObject(e)&&(this.pageview.delegate("userinfo_name",function(t){t.setText(e.name)}),this.pageview.delegate("user_icon",function(t){t.title=e.name,t.setSrc(e.avatar+".thumb.jpg")}),this.pageview.delegate("userinfo_status",function(t){switch(parseInt(e.formDataResult)){case 0:t.setText("等待 "+(e.approverName||" ")+"审批"),t.$el.css({color:"#F5C464"});break;case 1:t.setText("审批通过");break;case 2:t.setText("审批拒绝"),t.$el.css({color:"#FD8282"});break;case 3:t.setText("已撤销"),t.$el.css({color:"#F5C464"});break;default:console.error("未知的状态详情")}})),window.nowFormData={}},renderData:function(e){var t=this;this.pageview.delegate("userinfo_name",function(t){t.setText(e.creatorName)}),this.pageview.delegate("user_icon",function(t){t.title=e.creatorName,t.setSrc(e.creatorAvatar+".thumb.jpg")}),this.pageview.delegate("userinfo_status",function(t){switch(e.status){case 0:t.setText("等待 "+(e.approver||"未知")+"审批"),t.$el.css({color:"#F5C464"});break;case 1:t.setText("审批通过");break;case 2:t.setText("审批拒绝"),t.$el.css({color:"#FD8282"});break;case 3:t.setText("已撤销"),t.$el.css({color:"#F5C464"});break;default:console.error("未知的状态详情")}}),this.pageview.delegate("result_logo",function(t){1===e.status?(setTimeout(function(){t.$el.show()},300),setTimeout(function(){t.$el.css({"-webkit-transform":"scale(.5)",opacity:"1"})},450)):2===e.status&&(t.$el.find("img").attr("src","./imgs/refuse.png"),setTimeout(function(){t.$el.show()},300),setTimeout(function(){t.$el.css({"-webkit-transform":"scale(.5)",opacity:"1"})},450))});var i=JSON.parse(e.formData.formData).body;i.unshift({type:"ApplyInputText",title:"审批编号",value:e.formData.number},{type:"ApplyInputText",title:"所在部门",value:e.deptName});var n=t.processFormData(i);this.pageview.delegate("middle_detail_repeat",function(e){var t=n.simple;e.bindData(t)}),this.pageview.delegate("middle_layout_detail_repeat",function(e){var t=n.layout,i=t[t.length-1];i&&(i.isLastLayout=!0,i.value&&i.value.length>0&&i.value[i.value.length-1].type.indexOf("Total")>-1&&(i.value[i.value.length-1].isLastLayout=!0)),e.bindData(t)});var a=[];this.pageview.delegate("bottom_repeat",function(t){var i=e.approverMemberId&&e.approverMemberId.toString(),n=e.creatorMemberId&&e.creatorMemberId.toString(),o=e.currentMemberId&&e.currentMemberId.toString(),s=e.status;i===o&&i!==n&&0===s?(t.$el.show(),a=[{title:"同意",key:"1"},{title:"拒绝",key:"2"},{title:"转交",key:"5"}]):i===o&&i===n&&0===s?(t.$el.show(),a=[{title:"同意",key:"1"},{title:"拒绝",key:"2"},{title:"转交",key:"5"},{title:"更多",key:"6"}]):o===n&&0===s?(t.$el.show(),a=[{title:"撤销",key:"4"},{title:"重新提交",key:"3"}]):o===n&&0!==s?(t.$el.show(),a=[{title:"重新提交",key:"3"}]):t.$el.hide(),t.bindData(a),setTimeout(function(){t.$el.css({bottom:0})},350)})},middle_detail_repeat_item_left_init:function(e,t){if(e.config.text){e.config.text=e.config.text+":";var i=e.datasource.value.length,n=e.datasource.title.length,a=i+n;a>20&&(e.config.style.maxWidth="70px",e.config.style.lineHeight="21px")}else e.config.text="未填写标题:"},middle_detail_repeat_item_repeat_iteminit:function(e,t){e.datasource.type.indexOf("Total")>-1&&("start"===e.datasource.flag?e.config.style={margin:"7px 10px 8px 15px",paddingTop:"12px",borderTop:"1px solid #eee"}:"end"===e.datasource.flag?e.config.style={margin:"0 10px 0 15px"}:"only_start"===e.datasource.flag?e.config.style={margin:"10px 10px 0 15px",padding:"6px 0",borderTop:"1px solid #eee"}:e.config.style={margin:"0 10px 8px 15px"})},middle_detail_repeat_item_repeat_item_left_init:function(e,t){e.config.text?e.config.text=e.config.text+":":e.config.text="未填写标题:",e.datasource.type.indexOf("Total")>-1&&(e.datasource.isLastLayout&&(e.config.style.borderBottom="none"),e.config.style.marginLeft="0")},flow_right_content_left_init:function(e,t){e.config.src=e.config.src+".thumb.jpg"},flow_right_content_right_init:function(e,i){e.config.text?e.config.text=t.timestampToTimeStr(e.config.text):e.config.text=""},flow_right_content_right_didmount:function(e,t){var i=this;i.detailData.approverMemberId||(i.detailData.approverMemberId=""),i.detailData.approverMemberId||(i.detailData.creatorMemberId=""),i.detailData.approverMemberId||(i.detailData.currentMemberId=""),i.detailData.currentMemberId.toString()!==i.detailData.approverMemberId.toString()&&i.detailData.currentMemberId.toString()!==i.detailData.creatorMemberId.toString()||(i.detailData.approverMemberId.toString()===e.datasource.memberId.toString()&&i.detailData.currentMemberId.toString()!==i.detailData.approverMemberId.toString()||i.detailData.creatorMemberId.toString()===e.datasource.memberId.toString()&&i.detailData.creatorMemberId.toString()!==i.detailData.currentMemberId.toString())&&e.setNextText('<img src="./imgs/message.png" />')},flow_right_content_right_click:function(e,t){e.$el.find(".yy-nexttext").html()&&(this.pageview.showDialog("messageDialog"),this.nowChatMessage=e.datasource,console.log(e.datasource))},flow_right_content_middle_bottom_title_init:function(e,i){var n=parseInt(e.datasource.status),a=e.datasource.step;n===-1?(e.config.text="发起申请",e.rowInstance.components.flow_left.components.left_line.$el.css({bottom:"0"})):0===n?(this.nowApprove?(e.config.text="审批中...",e.config.style.color="#F5C464",e.rowInstance.components.flow_left.components.left_round.$el.css({boxShadow:"0px 0px 0px 3px #B6E5FF"})):(e.$el.hide(),t.css(e.parent.parent.parent.$el,{alignItems:"center"}),e.rowInstance.components.flow_left.components.left_round.$el.css({backgroundColor:"#ddd"}),e.datasource.isLast?setTimeout(function(){var i=e.rowInstance.components.flow_left.$el[0].clientHeight;t.deviceInfo().isIOS?e.rowInstance.components.flow_left.components.left_line.$el.css({bottom:i-74+23+"px",height:"74px",backgroundColor:"#ddd"}):e.rowInstance.components.flow_left.components.left_line.$el.css({bottom:i-74+24+"px",height:"74px",backgroundColor:"#ddd"})},0):t.deviceInfo().isIOS?e.rowInstance.components.flow_left.components.left_line.$el.css({backgroundColor:"#ddd",bottom:"23px"}):e.rowInstance.components.flow_left.components.left_line.$el.css({backgroundColor:"#ddd",bottom:"24px"})),this.nowApprove=!1):1===n?(a<this.historyLength?(e.config.text="已同意",e.config.style.color="#999"):(e.config.text="已同意",e.config.style.color="#6ACA8A"),e.datasource.isLast&&(e.rowInstance.components.flow_left.components.left_round.$el.css({boxShadow:"0px 0px 0px 3px #B6E5FF"}),setTimeout(function(){var t=e.rowInstance.components.flow_left.$el[0].clientHeight;e.rowInstance.components.flow_left.components.left_line.$el.css({bottom:t-74+20+"px",height:"94px"})},0))):1===n&&1!==a?(e.config.text="已同意",e.config.style.color="#6ACA8A"):2===n?(e.config.text="已拒绝",e.config.style.color="#FD8282",e.rowInstance.components.flow_left.components.left_round.$el.css({boxShadow:"0px 0px 0px 3px #B6E5FF"}),setTimeout(function(){var t=e.rowInstance.components.flow_left.$el[0].clientHeight;e.rowInstance.components.flow_left.components.left_line.$el.css({bottom:t-74+20+"px",height:"94px"})},0)):3===n?(e.config.text="已撤回",e.rowInstance.components.flow_left.components.left_round.$el.css({boxShadow:"0px 0px 0px 3px #B6E5FF"})):4===n?e.config.text="已转交":e.$el.hide()},flow_right_content_middle_bottom_title_didmount:function(e,t){if(e.datasource.comment){var i=e.getText();e.setText(i+' <span style="color: #999"> （'+e.datasource.comment+"）</span>")}},flow_right_content_middle_bottom_image_repeat_init:function(e,t){if(e.datasource.photos){var i=e.datasource.photos,n=[],a=[];n=i.split(";"),n.forEach(function(e,t){e&&a.push({src:e,thumb_src:e+".thumb.jpg"})}),e.bindData(a)}},bottom_repeat_itemclick:function(t,n){var a=t.datasource.key,o=this.pageview.params.formId,s=this;switch(a){case"1":this.pageview.go("deal",{type:1,id:o,toMemberId:this.pageview.params.toMemberId||"",qzId:this.pageview.params.qzId||""});break;case"2":this.pageview.go("deal",{type:2,id:o,toMemberId:this.pageview.params.toMemberId||"",qzId:this.pageview.params.qzId||""});break;case"3":this.pageview.ajax({url:"/formdata/checkResubmit",type:"POST",data:{fdId:this.templateid},success:function(e){0===e.code?s.pageview.showPage({pageKey:"form",nocache:!0,mode:"fromBottom",params:{formName:s.formName,id:o}}):(s.reSubmitDialog||(s.reSubmitDialog=new i({mode:3,wrapper:s.pageview.$el,contentText:e.msg,btnDirection:"row",buttons:[{title:"我知道了",style:{height:45,fontSize:16,color:"#37b7fd"},onClick:function(){s.reSubmitDialog.hide()}}]})),s.reSubmitDialog.show())}});break;case"4":this.chexiaoDialog||(this.chexiaoDialog=new i({mode:3,wrapper:this.pageview.$el,contentText:"你确定要撤销申请吗？",btnDirection:"row",buttons:[{title:"取消",style:{height:45,fontSize:16,color:e.titleColor,borderRight:"1px solid #eee"},onClick:function(){s.chexiaoDialog.hide()}},{title:"确定",style:{height:45,fontSize:16,color:"#37b7fd"},onClick:function(){s.chexiaoDialog.hide(),s.refuse_click()}}]})),this.chexiaoDialog.show();break;case"5":try{window.yyesn.enterprise.selectContacts(function(e){if("0"===e.error_code){var t=JSON.stringify(e),i=JSON.parse(t).data[0];s.pageview.go("deal",{type:3,id:o,from:"resend",memberId:i.member_id,userName:encodeURI(i.name),headImgUrl:i.avatar,toMemberId:s.pageview.params.toMemberId||"",qzId:s.pageview.params.qzId||""})}},{mode:1,multi:0},function(e){console.error("选择联系人失败")})}catch(e){alert(JSON.stringify(e))}break;case"6":s.morePopover.show(t);break;default:console.error("未知状态")}},refuse_click:function(){var e=this;this.pageview.ajax({url:"/formdata/undo",type:"POST",data:{fdId:e.pageview.params.formId},success:function(t){0===t.code?(window.needRefresMyApproveListData=!0,e.pageview.showTip({text:"撤销成功！",duration:800}),setTimeout(function(){e.loadData()},800)):e.pageview.showTip({text:t.msg,duration:1e3})},error:function(t){e.pageview.showTip({text:t.msg,duration:1e3})}})},processFormData:function(t){if(t&&0===t.length)return t;var i=[],n=[],a=this;return t.forEach(function(t,o){if("ApplyInputDateBetween"===t.type)a.dateType=t.dateType.toString(),i.push({type:"ApplyInputDateBetween",title:t.title,value:t.value[0]}),i.push({type:"ApplyInputDateBetween",title:t.title1,value:t.value[1]}),"1"===t.autocalculate&&i.push({type:"ApplyInputDateBetween",title:t.autocalculatetitle+(1===t.dateType?"（天）":"（时）"),value:a.caculateDiff(t.value[0],t.value[1])||"0"});else if("ApplyLayout"===t.type&&"1"===t.isChildForm){var s=[];if(t.inputs.length>0){t.inputs[0].value.forEach(function(e,i){s.push([]),t.inputs.forEach(function(e,t){var n=$.extend(!0,{},e);n.value=e.value[i],s[i].push(n)})});var r=1;s.forEach(function(t,i){var l=[],c=[];t.forEach(function(t,n){if("ApplyInputDateBetween"===t.type)a.dateType=t.dateType.toString(),l.push({type:"ApplyInputDateBetween",title:t.title,value:t.value[0]}),l.push({type:"ApplyInputDateBetween",title:t.title1,value:t.value[1]}),"1"===t.autocalculate&&l.push({type:"ApplyInputDateBetween",title:t.autocalculatetitle+(1===t.dateType?"（天）":"（时）"),value:a.caculateDiff(t.value[0],t.value[1])||"0"}),i===s.length-1&&"1"===t.isSummaryField&&c.push({type:"TotalApplyInputDateBetween",title:"总"+t.autocalculatetitle+(1===t.dateType?"（天）":"（时）"),value:t.summaryvalue});else if("ApplyInputRadio"===t.type)l.push({type:t.type,title:t.title,value:t.value&&t.value.value||""});else if("ApplyInputCheckbox"===t.type){var o="";t.value.forEach(function(e,i){o+=i<t.value.length-1?e.value+",":e.value+";"}),l.push({type:t.type,title:t.title,value:o})}else"ApplyInputTextNum"===t.type?(i===s.length-1&&"1"===t.isSummaryField&&c.push({type:"TotalApplyInputDateBetween",title:"总"+t.title,value:t.summaryvalue}),l.push({type:t.type,title:t.title,value:t.value})):"ApplyInputTextMoney"===t.type?(i===s.length-1&&"1"===t.isSummaryField&&c.push({type:"TotalApplyInputTextMoney",title:"总"+t.title,value:t.summaryvalue}),i===s.length-1&&"1"===t.uppercase&&c.push({type:"TotalApplyInputTextMoneyDX",title:"大写",value:e.MoneyDX(t.summaryvalue)}),l.push({type:t.type,title:t.title,value:t.value})):l.push({type:t.type,title:t.title,value:t.value})}),c.length>0&&c.forEach(function(e,t){0===t?e.flag="start":t===c.length-1?e.flag="end":e.flag=t,1===c.length&&(e.flag="only_start"),l.push(e)}),n.push({type:"ApplyLayout",level:o,index:r,value:l}),r++})}}else if("ApplyInputRadio"===t.type)i.push({type:t.type,title:t.title,value:t.value&&t.value.value||""});else if("ApplyInputCheckbox"===t.type){var l="";t.value.forEach(function(e,i){l+=i<t.value.length-1?e.value+",":e.value+";"}),i.push({type:t.type,title:t.title,value:l})}else i.push({type:t.type,title:t.title,value:t.value})}),{simple:i,layout:n}},middle_detail_repeat_item_right_didmount:function(e,i){return e.datasource.value&&0!==e.datasource.value.length?void("ApplyImage"!==e.datasource.type&&"ApplyImage"!==e.datasource.type.split("_")[1]||(t.css(e.parent.$el,{flexDirection:"column"}),t.css(e.$el,{flex:"none"}),e.change("middle_detail_repeat_item_right_img_repeat"))):void e.parent.parent.$el.hide()},middle_detail_repeat_item_repeat_item_right_didmount:function(e,i){return e.datasource.value&&0!==e.datasource.value.length?void("ApplyImage"!==e.datasource.type&&"ApplyImage"!==e.datasource.type.split("_")[1]||(t.css(e.parent.$el,{flexDirection:"column"}),t.css(e.$el,{flex:"none"}),e.change("middle_detail_repeat_item_right_img_repeat"))):void e.parent.parent.$el.hide()},middle_detail_repeat_item_right_text_init:function(e,t){e.datasource.type.indexOf("Total")>-1&&(e.datasource.type.indexOf("DX")>-1?e.config.style.color="#666":e.config.style.color="#F5C464")},middle_detail_repeat_item_right_text_didmount:function(e,t){"ApplyInputTextarea"===e.datasource.type&&(e.config.text=e.config.text.replace(/\n/g,"</br>"),e.setText(e.config.text))},middle_detail_repeat_item_right_img_repeat_init:function(e,t){var i=[];e.datasource.value.forEach(function(e,t){i.push({src:e})}),e.bindData(i)},middle_detail_repeat_item_right_img_repeat_itemclick:function(e,t){for(var i=[],n=e.parent.parent.datasource.value,a=0;a<n.length;a++)i.push(n[a]);try{window.yyesn.client.viewImage({files:i.join(","),index:parseInt(t.index)})}catch(e){}},flow_right_content_middle_bottom_image_repeat_itemclick:function(e,t){var i=e.parent.parent.datasource.photos,n=i.split(";");n.splice(n.length-1,1);for(var a=[],o=0;o<n.length;o++)a.push(n[o]);try{window.yyesn.client.viewImage({files:a.join(","),index:parseInt(t.index)})}catch(e){}},middle_detail_repeat_item_repeat_init:function(e,t){e.bindData(e.datasource.value)},middle_detail_repeat_item_repeat_title_didmount:function(e,t){this.layoutLevel?this.layoutLevel!==e.datasource.level?e.$el.css({margin:"12px 10px 10px 15px",paddingTop:"14px",borderTop:"1px solid #eee"}):e.$el.css({margin:"10px 10px 10px 15px"}):(this.layoutLevel=e.datasource.level,e.$el.css({margin:"12px 10px 10px 15px",paddingTop:"14px",borderTop:"1px solid #eee"})),e.setPreText(e.datasource.index)},caculateDiff:function(e,i){if(!e||!i)return"0";var n=t.convertToDate(e),a=t.convertToDate(i),o=a-n,s=0;return o<=0?"2"===this.dateType||(s=1):s="2"===this.dateType?(o/36e5).toFixed(1):o/864e5+1,s=parseInt(s)},resetData:function(){this.nowApprove=!0},morePopover_init:function(e,t){this.morePopover=e},moreRepeat_didmount:function(e,t){var i=[{title:"重新提交",id:1},{title:"撤回",id:2}];e.bindData(i)},moreRepeat_itemclick:function(t,n){var a=this;1===t.datasource.id?this.pageview.ajax({url:"/formdata/checkResubmit",type:"POST",data:{fdId:this.templateid},success:function(e){0===e.code?a.pageview.showPage({pageKey:"form",nocache:!0,mode:"fromBottom",params:{formName:a.formName,id:a.myListData.formData.id}}):(a.reSubmitDialog||(a.reSubmitDialog=new i({mode:3,wrapper:a.pageview.$el,contentText:e.msg,btnDirection:"row",buttons:[{title:"我知道了",style:{height:45,fontSize:16,color:"#37b7fd"},onClick:function(){a.reSubmitDialog.hide()}}]})),a.reSubmitDialog.show())}}):2===t.datasource.id&&(this.chexiaoDialog||(this.chexiaoDialog=new i({mode:3,wrapper:this.pageview.$el,contentText:"你确定要撤销申请吗？",btnDirection:"row",buttons:[{title:"取消",style:{height:45,fontSize:16,color:e.titleColor,borderRight:"1px solid #eee"},onClick:function(){a.chexiaoDialog.hide()}},{title:"确定",style:{height:45,fontSize:16,color:"#37b7fd"},onClick:function(){a.chexiaoDialog.hide(),a.refuse_click()}}]})),this.chexiaoDialog.show()),this.morePopover.hide()},message_bottom_cancel_click:function(e,t){this.pageview.hideDialog("messageDialog")},message_bottom_submit_click:function(e,t){var i=this;this.pageview.hideDialog("messageDialog");try{window.yyesn.enterprise.openChatWindow(function(e){"0"===e.error_code},{chat_mode:"0",send_id:i.nowChatMessage.memberId,send_name:i.nowChatMessage.name},function(e){})}catch(e){alert(JSON.stringify(e))}},message_middle_right_didmount:function(e,t){var i=e.config.text;e.setText('<span style="color: #37b7fd">'+this.myListData.creatorName+"</span>"+i)},message_middle_left_init:function(e,t){e.src=this.myListData.templateUrl},middle_cc_list_top_click:function(e,t){e.$el.addClass("displaynone"),e.parent.components.middle_cc_list_bottom.$el.removeClass("displaynone"),e.parent.components.middle_cc_list_middle.$el.removeClass("displaynone")},middle_cc_list_bottom_click:function(e,t){e.$el.addClass("displaynone"),e.parent.components.middle_cc_list_top.$el.removeClass("displaynone"),e.parent.components.middle_cc_list_middle.$el.addClass("displaynone")}},n}),define("pages/detail1",["../logic/detail1","../parts/common","utils"],function(e,t,i){var n={pluginClass:e,style:{backgroundColor:"#f2f3f4"},root:["top_view","bottom_repeat","morePopover"],components:{top_view:{type:"view",ref:!0,style:{flex:1,overflowY:"scroll",background:"#f2f3f4","-webkit-backface-visibility":"hidden","-webkit-transform-style":"preserve-3d","-webkit-transform":"translate3d(0,0,0)"},root:["userinfo_warp","middle_detail_repeat","middle_layout_detail_repeat","middle_cc_list","middle_flow_repeat"]},userinfo_warp:{type:"view",style:{flexDirection:"row",alignItems:"flex-start",background:"#fff",padding:"14px 0 9px 0"},root:["user_icon","userinfo_rightwarp","result_logo"]},user_icon:{type:"image",ref:!0,style:{w:40,backgroundColor:"#eee",marginLeft:10,marginRight:10,borderRadius:"100%"}},userinfo_rightwarp:{type:"view",style:{flex:1,justifyContent:"center"},root:["userinfo_name","userinfo_status"]},result_logo:{type:"image",src:"./imgs/agree.png",ref:!0,style:{display:"none",position:"absolute",top:-10,width:160,right:-10,opacity:"0",background:"#fff",transition:"all 150ms ease","-webkit-backface-visibility":"hidden","-webkit-transform-style":"preserve-3d","-webkit-transform":"translate3d(0,0,0)"}},userinfo_name:{type:"text",ref:!0,text:"加载中...",style:{color:"#292F33",fontSize:16,lineHeight:16,marginBottom:8}},userinfo_status:{type:"text",text:"加载中...",ref:!0,style:{fontSize:14,lineHeight:14,color:"#8C8D8E"}},middle_detail_repeat:{type:"repeat",root:["middle_detail_repeat_item"],itemClassName:"middle_detail_repeat_item",ref:!0,style:{fontSize:14,lineHeight:14,background:"#fff",alignItems:"flex-start",flexDirection:"column"},itemStyle:{}},middle_detail_repeat_item:{type:"view",ref:!0,root:["middle_detail_repeat_item_left","middle_detail_repeat_item_right"],style:{width:"100%",flexDirection:"row"}},middle_detail_repeat_item_left:{type:"text",text_bind:"title",style:{alignItems:"flex-start",color:"#999",marginRight:"15px",marginLeft:"15px",marginTop:3}},middle_detail_repeat_item_right:{type:"statusview",defaultKey:"middle_detail_repeat_item_right_text",style:{color:"#333",flex:1,lineHeight:21}},middle_detail_repeat_item_right_text:{type:"text",text_bind:"value",style:{color:"#333",flexWrap:"wrap",flex:1,paddingRight:"15px",wordBreak:"break-all"}},middle_detail_repeat_item_right_img_repeat:{type:"repeat",ref:!0,root:["middle_detail_repeat_item_right_img_repeat_item"],style:{flexWrap:"wrap",flex:1,marginLeft:15,marginBottom:10},itemStyle:{marginTop:10,lineHeight:21,marginRight:10}},middle_detail_repeat_item_right_img_repeat_item:{type:"image",src_bind:"src",style:{w:79}},middle_layout_detail_repeat:{type:"repeat",root:["middle_detail_repeat_item_repeat_title","middle_detail_repeat_item_repeat"],itemClassName:"middle_detail_repeat_item",ref:!0,style:{fontSize:16,lineHeight:16,background:"#fff",alignItems:"flex-start",paddingBottom:15,flexDirection:"column"},itemStyle:{flexDirection:"column",width:"100%"}},middle_detail_repeat_item_repeat_title:{type:"text",text:"明细",style:{color:"#999",fontSize:14,lineHeight:14}},middle_detail_repeat_item_repeat:{type:"repeat",text_bind:"value",ref:!0,root:["middle_detail_repeat_item_repeat_item"],style:{width:"100%",flexDirection:"column",fontSize:14,lineHeight:14},itemStyle:{lineHeight:21}},middle_detail_repeat_item_repeat_item:{type:"view",root:["middle_detail_repeat_item_repeat_item_left","middle_detail_repeat_item_repeat_item_right"],style:{width:"100%",flexDirection:"row"}},middle_detail_repeat_item_repeat_item_left:{type:"text",text_bind:"title",style:{alignItems:"flex-start",color:"#999",marginRight:10,marginLeft:15}},middle_detail_repeat_item_repeat_item_right:{type:"statusview",defaultKey:"middle_detail_repeat_item_right_text",style:{flex:1}},middle_detail_repeat_item_repeat_item_right_text:{type:"text",text_bind:"value",style:{color:"#333",flexWrap:"wrap",flex:1,paddingRight:"15px",wordBreak:"break-all"}},middle_cc_list:{type:"view",root:["middle_cc_list_top","middle_cc_list_middle","middle_cc_list_bottom"],
style:{flexDirection:"column"}},middle_cc_list_top:{type:"icon",text:"展开更多",font:"ap_e901",ref:!0,iconStyle:{fontSize:8,marginRight:5},style:{backgroundColor:"#fff",color:"#999",fontSize:11,height:28,borderTop:"1px solid #EBEFF4",borderBottom:"1px solid #EBEFF4"}},middle_cc_list_middle:{type:"view",className:"displaynone",root:["middle_cc_list_title","middle_cc_list_repeat"],style:{flexDirection:"column",background:"#fff"}},middle_cc_list_title:{type:"view",root:["middle_cc_list_title_left","middle_cc_list_title_right"]},middle_cc_list_title_left:{type:"text",text:"抄送人",style:{paddingLeft:15,fontSize:14,color:"#333"}},middle_cc_list_title_right:{type:"text",text:"（审批人全部同意后，将抄送给以下人员）",style:{fontSize:14,color:"#ccc"}},middle_cc_list_repeat:{type:"repeat",className:"line-repeat",ref:!0,style:{minHeight:80,flexWrap:"wrap",paddingLeft:6,paddingBottom:10,flexDirection:"row",background:"#fff"},itemStyle:{width:50},root:["middle_cc_list_repeat_item"]},middle_cc_list_repeat_item:{type:"icon",style:{paddingTop:10,zIndex:10},iconStyle:{w:32,backgroundColor:"#eee",borderRadius:"100%",overflow:"hidden"},textStyle:{marginTop:3,color:"#999999",fontSize:12},title_bind:"userName",src_bind:"headImgUrl",text_bind:"userName",textPos:"bottom"},middle_cc_list_bottom:{type:"icon",text:"收起更多",font:"ap_e900",className:"displaynone",iconStyle:{fontSize:8,marginRight:5},style:{backgroundColor:"#fff",color:"#999",fontSize:11,height:28,borderTop:"1px solid #EBEFF4",borderBottom:"1px solid #EBEFF4"}},middle_flow_repeat:{type:"repeat",ref:!0,style:{background:"#F2F3F4",flexDirection:"column",paddingBottom:20},itemStyle:{flexDirection:"row",background:"#F2F3F4"},root:["flow_left","flow_right"]},flow_left:{type:"view",ref:!0,root:["left_line","left_round"],style:{width:24}},left_line:{type:"text",text:" ",ref:!0,style:{width:2,background:"#5FC5FD",height:"100%",position:"absolute",left:22,bottom:26}},left_round:{type:"text",text:" ",ref:!0,style:{position:"absolute",right:"-4px",top:49,w:"10px",borderRadius:"50%",background:"#5FC5FD"}},flow_right:{type:"view",ref:!0,root:["flow_right_arrow","flow_right_content"],style:{flex:1,left:25,top:20,marginBottom:20,marginRight:48,borderRadius:10,paddingLeft:10,backgroundColor:"#fff"}},flow_right_arrow:{type:"text",text:" ",ref:!0,style:{position:"absolute",top:24,left:-9,width:0,height:0,borderTop:"10px solid transparent",borderRight:"10px solid #fff",borderBottom:"10px solid transparent"}},flow_right_content:{type:"view",ref:!0,root:["flow_right_content_left","flow_right_content_middle","flow_right_content_right"],style:{flexDirection:"row",alignItems:"flex-start",padding:"12px 0"}},flow_right_content_left:{type:"image",src_bind:"avatar",title_bind:"name",style:{w:40,backgroundColor:"#eee",borderRadius:"50%",marginRight:14,top:1}},flow_right_content_middle:{type:"view",root:["flow_right_content_middle_top","flow_right_content_middle_bottom"],style:{flexDirection:"column",flex:1,marginRight:14,top:3}},flow_right_content_middle_top:{type:"text",text_bind:"name",style:{fontSize:16,lineHeight:16,marginBottom:4,color:"#292F33"}},flow_right_content_middle_bottom:{type:"view",root:["flow_right_content_middle_bottom_title","flow_right_content_middle_bottom_image_repeat"],style:{flexDirection:"column"}},flow_right_content_middle_bottom_title:{type:"text",text_bind:"status",style:{fontSize:14,lineHeight:21,color:"#999"}},flow_right_content_middle_bottom_image_repeat:{type:"repeat",ref:!0,root:["flow_right_content_middle_bottom_image_repeat_item"],style:{flexWrap:"wrap"},itemStyle:{margin:"5px 10px 5px 0"}},flow_right_content_middle_bottom_image_repeat_item:{type:"image",src_bind:"thumb_src",style:{w:40}},flow_right_content_right:{type:"text",text_bind:"time",style:{fontSize:12,lineHeight:12,height:"100%",marginRight:14,position:"absolute",flexDirection:"column",justifyContent:"flex-start",alignItems:"flex-end",right:0,top:0,color:"#999",zIndex:10}},bottom_repeat:{type:"repeat",ref:!0,style:{borderTop:"1px solid #DDDDDD",height:48,flexDirection:"row",display:"none",bottom:-50,background:"#fff",transition:"all 800ms cubic-bezier(0.23, 1, 0.32, 1) 0ms"},itemStyle:{flex:1,justifyContent:"center",alignItems:"center"},splitStyle:{height:15,marginTop:18,width:1,backgroundColor:"rgb(227, 227, 227)"},root:["bottom_repeat_text"]},bottom_repeat_text:{type:"text",text_bind:"title",style:{flex:1,fontSize:16,lineHeight:16,color:"#37B7FD"}},morePopover:{type:"popover",root:["moreRepeat"],animate:{mode:"2"},bkCoverStyle:{backgroundColor:"rgba(230, 230, 230, 0.2)"},arrowStyle:{backgroundColor:"#fff",zIndex:2,"-webkit-box-shadow":"9px 8px 13px rgb(203, 203, 203)","box-shadow":"9px 8px 13px rgb(203, 203, 203)"},style:{"-webkit-box-shadow":"0px 8px 13px rgb(203, 203, 203)","box-shadow":"0px 8px 13px rgb(203, 203, 203)",width:100,backgroundColor:"#fff",height:"auto",borderRadius:"7px"}},moreRepeat:{type:"repeat",ref:!0,items:[],root:["moreRepeat_item"],style:{flexDirection:"column",flex:1,paddingTop:4,paddingBottom:4},itemStyle:{height:40,justifyContent:"center",alignItems:"stretch"}},moreRepeat_item:{type:"text",text:"测试",text_bind:"title",style:{flex:1,justifyContent:"center"},textStyle:{fontSize:15,color:"#292f33"}},messageDialog:{type:"view",root:["message_top","message_middle","message_bottom"],style:{flexDirection:"column",width:280}},message_top:{type:"view",root:["message_top_left","message_top_right"],style:{display:"flex",justifyContent:"center",height:"45px",alignItems:"center",flexDirection:"row"}},message_top_left:{type:"text",text:"发消息给：",style:{fontSize:15,color:"#999"}},message_top_right:{type:"text",text:"3fuyu",text_bind:"userName",style:{fontSize:16,color:"#333"}},message_middle:{type:"view",root:["message_middle_left","message_middle_right"],style:{width:"90%",margin:"0 auto",alignItems:"center",borderRadius:4,marginBottom:15,padding:10,background:"#f5f5f5",flexDirection:"row"}},message_middle_left:{type:"image",defaultSrc:"./imgs/2.png",style:{borderRadius:"50%",width:40,height:40,marginRight:9}},message_middle_right:{type:"text",text:"有张审批单据需要您审批，快去看看吧！",style:{fontSize:14,flexWrap:"wrap",flex:1}},message_bottom:{type:"view",root:["message_bottom_cancel","message_bottom_submit"],style:{borderTop:"1px solid #eee",flexDirection:"row",justifyContent:"center",height:44}},message_bottom_cancel:{type:"text",text:"取消",style:{fontSize:16,color:"#333",borderRight:"1px solid #eee",width:"50%",justifyContent:"center"}},message_bottom_submit:{type:"text",text:"确定",style:{fontSize:16,color:"#37B7FD",width:"50%",justifyContent:"center"}}}};return n}),define("logic/detailAttachment",["../parts/common","utils","../../../components/dialog"],function(e,t,i){function n(e){this.pageview=e.pageview,this._taskId=this.pageview.params.taskId,this.parentThis=this.pageview.viewpagerParams.parent,this.format={"application/msword":{ext:"word.png"},"application/pdf":{ext:"pdf.png"},"application/pgp-signature":{ext:"other.png"},"application/postscript":{ext:"other.png"},"application/rtf":{ext:"other.png"},"application/vnd.ms-excel":{ext:"exc.png"},"application/vnd.ms-powerpoint":{ext:"ppt.png"},"application/zip":{ext:"zipfile.png"},"application/x-shockwave-flash":{ext:"other.png"},"application/vnd.openxmlformats-officedocument.wordprocessingml.document":{ext:"word.png"},"application/vnd.openxmlformats-officedocument.wordprocessingml.template":{ext:"word.png"},"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":{ext:"exc.png"},"application/vnd.openxmlformats-officedocument.presentationml.presentation":{ext:"ppt.png"},"application/vnd.openxmlformats-officedocument.presentationml.template":{ext:"other.png"},"application/vnd.openxmlformats-officedocument.presentationml.slideshow":{ext:"other.png"},"application/x-javascript":{ext:"other.png"},"application/json":{ext:"other.png"},"audio/mpeg":{ext:"other.png"},"audio/x-wav":{ext:"music.png"},"audio/x-m4a":{ext:"music.png"},"audio/ogg":{ext:"music.png"},"audio/aiff":{ext:"other.png"},"audio/flac":{ext:"other.png"},"audio/aac":{ext:"other.png"},"audio/ac3":{ext:"other.png"},"audio/x-ms-wma":{ext:"other.png"},"image/bmp":{ext:"pic.png"},"image/gif":{ext:"pic.png"},"image/jpeg":{ext:"pic.png"},"image/photoshop":{ext:"other.png"},"image/png":{ext:"pic.png"},"image/svg+xml":{ext:"other.png"},"image/tiff":{ext:"other.png"},"text/plain":{ext:"text.png"},"text/html":{ext:"other.png"},"text/css":{ext:"other.png"},"text/csv":{ext:"other.png"},"text/rtf":{ext:"other.png"},"video/mpeg":{ext:"video.png"},"video/quicktime":{ext:"video.png"},"video/mp4":{ext:"video.png"},"video/x-m4v":{ext:"video.png"},"video/x-flv":{ext:"video.png"},"video/x-ms-wmv":{ext:"video.png"},"video/avi":{ext:"video.png"},"video/webm":{ext:"video.png"},"video/3gpp":{ext:"video.png"},"video/3gpp2":{ext:"video.png"},"video/vnd.rn-realvideo":{ext:"video.png"},"video/ogg":{ext:"video.png"},"video/x-matroska":{ext:"video.png"},"application/vnd.oasis.opendocument.formula-template":{ext:"other.png"},"application/octet-stream":{ext:"other.png"},unknow:{ext:"other.png"}},this.loadData()}return n.prototype={onPageResume:function(){this._loadData()},loadData:function(){var e=this;this.applyHistory=window._applyHistory,this.pageview.showLoading({text:"努力加载中...",timeout:8e3,reLoadCallBack:function(){e._loadData()}}),e._loadData()},_loadData:function(){var e=this,t={url:"/process/getInstAttachments",type:"POST",data:{instId:this.parentThis.detailData.inst.id||""},success:function(t){e.pageview.hideLoading(!0),e.parentThis.fileNum=t.data.length,e.pageview.delegate("flow_repeat",function(e){e.bindData(t.data)})},error:function(e){}};this.pageview.ajax(t)},format_image_init:function(e,t){var i=e.datasource.type||"unknow";i.indexOf("image")>-1?e.config.src=e.datasource.aliOSSLimitUrl:e.config.src="./imgs/"+(this.format[e.datasource.type]?this.format[e.datasource.type].ext:this.format.unknow.ext)},atta_contributor_init:function(e,t){this.applyHistory=window._applyHistory,console.log(e.datasource);var i=this;this.applyHistory.taskList[this.applyHistory.taskList.length-1].deleteReason||this.applyHistory.currentUserId!==e.datasource.userId||this.applyHistory.instData.historicActivityInstances.forEach(function(t,n){t.assignee===e.datasource.userId&&i.applyHistory.currentUserId===e.datasource.userId&&(e.config.style.display="block")})},file_size_init:function(e,t){var i=e.config.text;e.config.text=i+e.datasource.author},atta_contributor_click:function(t,n){var a=this;a.deleteDialog=new i({mode:3,wrapper:a.parentThis.pageview.$el,contentText:"确定要删除该附件吗?",btnDirection:"row",buttons:[{title:"取消",style:{height:45,fontSize:16,color:e.titleColor,borderRight:"1px solid #eee"},onClick:function(){a.deleteDialog.hide()}},{title:"确定",style:{height:45,fontSize:16,color:"#37b7fd"},onClick:function(){a.deleteDialog.hide(),a.pageview.showLoading({text:"删除中...",timeout:8e3}),a.parentThis.fileUploader.deleteServerUploadImage(t.datasource.id,function(e){a.pageview.hideLoading(!0),t.rowInstance.remove(),a.parentThis.fileNum=t.rowInstance.parent.datasource.length,a.pageview.showTip({text:"删除成功",duration:1e3})},function(){a.pageview.hideLoading(!0),a.pageview.showTip({text:"删除失败，请稍后重试",duration:1e3})})}}]}),a.deleteDialog.show()},title_view_init:function(e,t){var i=e.datasource.name.split("_"),n=i[i.length-1];e.config.text=n},flow_repeat_itemclick:function(e,t){var i=e.datasource.type,n=e.datasource.name.split("_"),a=n[n.length-1];if(i.indexOf("image")>-1)try{window.yyesn.client.viewImage({files:e.datasource.aliOSSUrl})}catch(e){}else{window.location.origin;this.downloadFile(a,e.datasource.aliOSSUrl)}},downloadFile:function(e,i){if(t.deviceInfo().isAndroid)try{window.yyesn.enterprise.fileBrowser(function(){},{filename:e,fileext:e.split(".")[1],file_down_url:i})}catch(e){console.log(e)}else window.open(i)},atta_time_init:function(e,i){e.config.text=t.timestampToTimeStr(e.datasource.time)}},n}),define("pages/detailAttachment",["../logic/detailAttachment","../parts/common","utils"],function(e,t,i){var n={pluginClass:e,style:{backgroundColor:"#F7F7F7"},root:["flow_repeat"],components:{flow_repeat:{type:"repeat",ref:!0,style:{marginTop:10,background:"#F7F7F7",flexDirection:"column",paddingBottom:20},itemStyle:{flexDirection:"row",background:"#fff",height:65,borderBottom:"solid 1px #EDEDED"},nodata:"list_nodata",root:["flow_view"]},list_nodata:{type:"view",root:["list_nodata_img","list_nodata_text"],style:{justifyContent:"center",alignItems:"center",height:300}},list_nodata_img:{type:"image",src:"./imgs/yunshen_nodata.png",style:{w:80,h:80,background:"#f7f7f7",marginBottom:14}},list_nodata_text:{type:"text",text:"暂无内容",style:{fontSize:14,color:"#adadad"}},flow_view:{type:"view",root:["flow_left","flow_middle","flow_right"],style:{flexDirection:"row",flex:1,alignItems:"center",justifyContent:"center"}},flow_left:{type:"view",style:{width:40,justifyContent:"center",display:"flex",height:"100%",marginLeft:12,marginRight:14},root:["format_image"]},format_image:{type:"image",src:"./imgs/exc.png",ref:!0,style:{borderRadius:4}},flow_middle:{type:"view",style:{flex:1,justifyContent:"center"},root:["title_view","file_size"]},title_view:{type:"text",text_bind:"name",numberofline:1,style:{fontSize:16,color:"#262626",display:"block",overflow:"hidden",textOverflow:"ellipsis",paddingBottom:2}},file_size:{type:"text",text:"贡献者：",style:{fontSize:13,color:"#9E9E9E"}},flow_right:{type:"view",style:{width:120,flexDirection:"column",alignItems:"flex-end",justifyContent:"center",paddingRight:12},root:["atta_time","atta_contributor"]},atta_time:{type:"text",text:"00:00",style:{fontSize:13,paddingBottom:3}},atta_contributor:{type:"text",text:"删除",style:{display:"none",fontSize:13,color:"#0093ff"}}}};return n}),define("pages/detailComponent",["../logic/additionApproval","../parts/common","utils"],function(e,t,i){var n={pluginClass:e,style:{backgroundColor:t.backColor,overflow:"auto"},root:["body"],components:{body:{type:"view",style:{padding:15,color:"#999"},root:["title","titleLable","contentText","contentImage","contentText1","contentImage1"]},title:{type:"text",text:"什么是明细组件",style:{fontSize:17,color:"#000",margin:"auto",fontWeight:"bold"}},titleLable:{type:"text",text:"在自定义审批表单时，你会看到“明细”这个组件，它的功能可是很强大哦，下面看看它有什么功能吧",style:{fontSize:14,marginTop:15}},contentText:{type:"text",text:"1、在web端，明细相当于一个容器，可以拖动除了明细组件其他任意组件进入，如果有数字，金额，时间段组件，还可以设置“明细内部统计总和”",style:{fontSize:14,margin:"15px 0"}},contentText1:{type:"text",text:"2、在移动端，明细的样式相当于一个审批单据内部的小表单，可以增加相同的明细项，达到多个审批单据一起提交的作用",style:{fontSize:14,margin:"15px 0"}},contentImage:{type:"image",src:"./imgs/help/3.1.png",style:{margin:"auto"}},contentImage1:{type:"image",src:"./imgs/help/3.2.png",style:{margin:"auto"}}}};return n}),define("parts/currency",[],function(){var e={HKD:{name:"港币",code:"HKD"},MOP:{name:"澳门元",code:"MOP"},TWD:{name:"新台币",code:"TWD"},CNY:{name:"人民币",code:"CNY"},KPW:{name:"韩元",code:"KPW"},KPW:{name:"朝鲜圆",code:"KPW"},VND:{name:"越南盾",code:"VND"},JPY:{name:"日圆",code:"JPY"},LAK:{name:"基普",code:"LAK"},KHR:{name:"瑞尔",code:"KHR"},MYR:{name:"马元",code:"MYR"},SGD:{name:"新加坡元",code:"SGD"},THP:{name:"泰铢",code:"THP"},BUK:{name:"缅元",code:"BUK"},LKR:{name:"斯里兰卡卢比",code:"LKR"},MVR:{name:"马尔代夫卢比",code:"MVR"},IDR:{name:"盾",code:"IDR"},PRK:{name:"巴基斯坦卢比",code:"PRK"},INR:{name:"卢比",code:"INR"},NPR:{name:"尼泊尔卢比",code:"NPR"},AFA:{name:"阿富汗尼",code:"AFA"},IRR:{name:"伊朗里亚尔",code:"IRR"},IQD:{name:"伊拉克第纳尔",code:"IQD"},SYP:{name:"叙利亚镑",code:"SYP"},LBP:{name:"巴黎嫩镑",code:"LBP"},JOD:{name:"约旦第纳尔",code:"JOD"},SAR:{name:"亚尔",code:"SAR"},KWD:{name:"科威特第纳尔",code:"KWD"},BHD:{name:"巴林第纳尔",code:"BHD"},QAR:{name:"卡塔尔里亚尔",code:"QAR"},OMR:{name:"阿曼里亚尔",code:"OMR"},YER:{name:"也门里亚尔",code:"YER"},YDD:{name:"也门第纳尔",code:"YDD"},CYP:{name:"塞浦路斯镑",code:"CYP"},EUR:{name:"欧元",code:"EUR"},ISK:{name:"冰岛克朗",code:"ISK"},DKK:{name:"丹麦克朗",code:"DKK"},NOK:{name:"挪威克朗",code:"NOK"},SEK:{name:"瑞典克朗",code:"SEK"},SUR:{name:"卢布",code:"SUR"},PLZ:{name:"波兰",code:"PLZ"},CSK:{name:"捷克克朗",code:"CSK"},HUF:{name:"福林",code:"HUF"},DEM:{name:"马克",code:"DEM"},ATS:{name:"奥地利先令",code:"ATS"},CHF:{name:"瑞士法郎",code:"CHF"},NLG:{name:"荷兰盾",code:"NLG"},BEF:{name:"比利时法郎",code:"BEF"},LUF:{name:"卢森堡法郎",code:"LUF"},GBP:{name:"英镑",code:"GBP"},IEP:{name:"爱尔兰镑",code:"IEP"},FRF:{name:"法郎",code:"FRF"},ESP:{name:"比塞塔",code:"ESP"},PTE:{name:"埃斯库多",code:"PTE"},ITL:{name:"里拉",code:"ITL"},MTP:{name:"马耳他镑",code:"MTP"},YUD:{name:"南斯拉夫新第纳尔",code:"YUD"},ROL:{name:"列伊",code:"ROL"},BGL:{name:"列弗",code:"BGL"},TRL:{name:"土耳其镑",code:"TRL"},ALL:{name:"列克",code:"ALL"},CAD:{name:"加元",code:"CAD"},USD:{name:"美元",code:"USD"},MXP:{name:"墨西哥比索",code:"MXP"},GTQ:{name:"格查尔",code:"GTQ"},SVC:{name:"萨尔瓦多科朗",code:"SVC"},HNL:{name:"伦皮拉",code:"HNL"},NIC:{name:"科多巴",code:"NIC"},CRC:{name:"哥斯达黎加科朗",code:"CRC"},PAB:{name:"巴拿马巴波亚",code:"PAB"},CUP:{name:"古巴比索",code:"CUP"},BSD:{name:"巴哈马元",code:"BSD"},JMD:{name:"牙买加元",code:"JMD"},HTG:{name:"古德",code:"HTG"},DOP:{name:"多米尼加比索",code:"DOP"},TTD:{name:"特立尼达多巴哥元",code:"TTD"},BBD:{name:"巴巴多斯元",code:"BBD"},COP:{name:"哥伦比亚比索",code:"COP"},VEB:{name:"博利瓦",code:"VEB"},GYD:{name:"圭亚那元",code:"GYD"},SRG:{name:"苏里南盾",code:"SRG"},PES:{name:"新索尔",code:"PES"},ECS:{name:"苏克雷",code:"ECS"},BRC:{name:"新克鲁赛罗",code:"BRC"},BOP:{name:"玻利维亚比索",code:"BOP"},CLP:{name:"智利比索",code:"CLP"},ARP:{name:"阿根廷比索",code:"ARP"},PYG:{name:"巴拉圭瓜拉尼",code:"PYG"},UYP:{name:"乌拉圭新比索",code:"UYP"},EGP:{name:"埃及镑",code:"EGP"},LYD:{name:"利比亚第纳尔",code:"LYD"},SDP:{name:"苏丹镑",code:"SDP"},TND:{name:"突尼斯第纳尔",code:"TND"},DZD:{name:"阿尔及利亚第纳尔",code:"DZD"},MAD:{name:"摩洛哥迪拉姆",code:"MAD"},MRO:{name:"乌吉亚",code:"MRO"},XOF:{name:"非共体法郎",code:"XOF"},GMD:{name:"法拉西",code:"GMD"},GWP:{name:"几内亚比索",code:"GWP"},GNS:{name:"几内亚西里",code:"GNS"},SLL:{name:"利昂",code:"SLL"},LRD:{name:"利比里亚元",code:"LRD"},GHC:{name:"塞地",code:"GHC"},NGN:{name:"奈拉",code:"NGN"},XAF:{name:"中非金融合作法郎",code:"XAF"},GQE:{name:"赤道几内亚埃奎勒",code:"GQE"},ZAR:{name:"兰特",code:"ZAR"},DJF:{name:"吉布提法郎",code:"DJF"},SOS:{name:"索马里先令",code:"SOS"},KES:{name:"肯尼亚先令",code:"KES"},UGS:{name:"乌干达先令",code:"UGS"},TZS:{name:"坦桑尼亚先令",code:"TZS"},RWF:{name:"卢旺达法郎",code:"RWF"},BIF:{name:"布隆迪法郎",code:"BIF"},ZRZ:{name:"扎伊尔",code:"ZRZ"},ZMK:{name:"赞比亚克瓦查",code:"ZMK"},MCF:{name:"马达加斯加法郎",code:"MCF"},SCR:{name:"塞舌尔卢比",code:"SCR"},MUR:{name:"毛里求斯卢比",code:"MUR"},ZWD:{name:"津巴布韦元",code:"ZWD"},KMF:{name:"科摩罗法郎",code:"KMF"},AUD:{name:"澳大利亚元",code:"AUD"},NZD:{name:"新西兰元",code:"NZD"},FJD:{name:"斐济元",code:"FJD"},SBD:{name:"所罗门元",code:"SBD"}},t={getCurrencyName:function(t){return null!==t&&void 0!==t?e[t]?e[t]:t:e.CNY}};return t}),define("parts/format",[],function(){var e={"application/msword":{ext:"word.png"},"application/pdf":{ext:"pdf.png"},"application/pgp-signature":{ext:"other.png"},"application/postscript":{ext:"other.png"},"application/rtf":{ext:"other.png"},"application/vnd.ms-excel":{ext:"exc.png"},"application/vnd.ms-powerpoint":{ext:"ppt.png"},"application/zip":{ext:"zipfile.png"},"application/x-shockwave-flash":{ext:"other.png"},"application/vnd.openxmlformats-officedocument.wordprocessingml.document":{ext:"word.png"},"application/vnd.openxmlformats-officedocument.wordprocessingml.template":{ext:"word.png"},"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":{ext:"exc.png"},"application/vnd.openxmlformats-officedocument.presentationml.presentation":{ext:"ppt.png"},"application/vnd.openxmlformats-officedocument.presentationml.template":{ext:"other.png"},"application/vnd.openxmlformats-officedocument.presentationml.slideshow":{ext:"other.png"},"application/x-javascript":{ext:"other.png"},"application/json":{ext:"other.png"},"audio/mpeg":{ext:"other.png"},"audio/x-wav":{ext:"music.png"},"audio/x-m4a":{ext:"music.png"},"audio/ogg":{ext:"music.png"},"audio/aiff":{ext:"other.png"},"audio/flac":{ext:"other.png"},"audio/aac":{ext:"other.png"},"audio/ac3":{ext:"other.png"},"audio/x-ms-wma":{ext:"other.png"},"image/bmp":{ext:"pic.png"},"image/gif":{ext:"pic.png"},"image/jpeg":{ext:"pic.png"},"image/photoshop":{ext:"other.png"},"image/png":{ext:"pic.png"},"image/svg+xml":{ext:"other.png"},"image/tiff":{ext:"other.png"},"text/plain":{ext:"text.png"},"text/html":{ext:"other.png"},"text/css":{ext:"other.png"},"text/csv":{ext:"other.png"},"text/rtf":{ext:"other.png"},"video/mpeg":{ext:"video.png"},"video/quicktime":{ext:"video.png"},"video/mp4":{ext:"video.png"},"video/x-m4v":{ext:"video.png"},"video/x-flv":{ext:"video.png"},"video/x-ms-wmv":{ext:"video.png"},"video/avi":{ext:"video.png"},"video/webm":{ext:"video.png"},"video/3gpp":{ext:"video.png"},"video/3gpp2":{ext:"video.png"},"video/vnd.rn-realvideo":{ext:"video.png"},"video/ogg":{ext:"video.png"},"video/x-matroska":{ext:"video.png"},"application/vnd.oasis.opendocument.formula-template":{ext:"other.png"},"application/octet-stream":{ext:"other.png"},unknow:{ext:"other.png"}},t={getFormat:function(t){return null!==t&&void 0!==t?e[t]||e.unknow:e.unknow}};return t}),define("parts/analysisContent",["./common","utils"],function(e,t){var i={getAnalysisContent:function(i,n){var a=i.datasource.type;switch(a){case"link":case"Hyperlink":i.config.style.color="#0093ff";break;case"date":"datetime"===i.datasource.kind?i.config.text=i.config.text?t.ConvertDateToStr(i.config.text,"yyyy-MM-dd hh:mm:ss"):"":"time"===i.datasource.kind?i.config.text=i.config.text?t.ConvertDateToStr(i.config.text,"hh:mm:ss"):"":i.config.text=i.config.text?t.ConvertDateToStr(i.config.text,"yyyy-MM-dd"):"";break;case"user":var o=i.config.text,s={url:"/user/getUserInfo",type:"POST",data:{userId:o||""},success:function(e){e.success&&i.setText(e.data.userName)},error:function(e){}};n.pageview.ajax(s);break;case"money":var r=JSON.parse(i.config.text),l=e.getCurrencyName(r.currency);i.config.text=r.amount+" "+l.name;break;case"Money":i.config.text=i.config.text+" "+i.datasource.moneyType;break;case"boolean":var c="1"===i.datasource.content?"是":"否";i.config.text=c;break;case"Paragraph":i.config.text=" "+i.datasource.content;break;case"Picture":case"file":case"File":case"DividingLine":case"DataTable":i.$el.hide();break;case"DateCalculate":i.config.text?i.config.text+=" 天":i.config.text="0 天";break;case"Text":case"TextEditor":i.config.text=i.datasource.content&&i.datasource.content.replace(/\n/gi,"<br/>");break;case"DateInterval":try{var p=JSON.parse(i.datasource.content);p[0].length>0&&p[1].length>0?i.config.text=p[0]+" 至 "+p[1]:i.config.text=""}catch(e){var d=i.datasource.content.split(",");d[0]&&d[1]&&d[0].length>0&&d[1].length>0?i.config.text=d[0]+" 至 "+d[1]:i.config.text=""}break;case"Raty":i.config.text=i.config.text+" 星";break;case"Employee":i.config.text="",n.pageview.ajax({url:"user/getUserNames",type:"POST",data:{memberIds:i.datasource.content},success:function(e){i.innerText.html(e.data.userName)},error:function(e){}});break;case"Department":i.config.text="",n.pageview.ajax({url:"user/queryOrgNames",type:"POST",data:{orgCodes:i.datasource.content},success:function(e){i.innerText.html(e.data),0===e.data.length&&i.innerText.html(i.datasource.content)},error:function(e){}})}}};return i}),define("logic/detailContent",["../parts/currency","utils","../parts/format","../parts/analysisContent"],function(e,t,i,n){function a(e){this.pageview=e.pageview,this.itemNum=1,this.classContent={"alert-none":{"padding-left":"10px",color:"rgb(85, 85, 85)","border-color":"rgb(204, 204, 204)"},"alert-success":{"padding-left":"10px",color:"rgb(60, 118, 61)","background-color":"rgb(223, 240, 216)"},"alert-info":{"padding-left":"10px",color:"rgb(49, 112, 143)","background-color":"rgb(217, 237, 247)"},"alert-warning":{"padding-left":"10px",color:"rgb(138, 109, 59)","background-color":"rgb(252, 248, 227)"},"alert-danger":{"padding-left":"10px",color:"rgb(169, 68, 66)","background-color":"rgb(242, 222, 222)"}}}return a.prototype={detail_repeat_iteminit:function(e,t){"Paragraph"===e.datasource.type?e.$el.css(this.classContent[e.datasource.style]):"DataTable"===e.datasource.type&&window.setTimeout(function(){e.refs.datatable_repeat.bindData(e.datasource.items),e.refs.datatable_repeat.$el.show()},100)},detail_item_content_init:function(e,t){n.getAnalysisContent(e,this)},detail_item_title_init:function(e,t){switch(e.datasource.type){case"file":case"File":e.config.style.minHeight=30;break;case"Paragraph":case"Picture":case"DividingLine":case"DataTable":e.$el.hide();break;default:var i=e.datasource.title.length,n=e.datasource.content?e.datasource.content.length:0,a=n+i;a<=24?(e.config.style.width="auto",e.config.style.paddingRight="10"):(e.config.style.width="auto",e.config.style.maxWidth="110px",e.config.style.paddingRight="10")}},detail_iamge_init:function(e,t){"Picture"===e.datasource.type?e.config.src=e.datasource.url:e.$el.hide()},detail_DividingLine_init:function(e,t){"DividingLine"!==e.datasource.type?e.$el.hide():e.rowInstance.$el.css({"min-height":"0px","border-bottom":"1px solid rgb(237, 237, 237)"})},detail_view_init:function(e,t){"file"!==e.datasource.type&&"File"!==e.datasource.type||e.$el.css({"flex-direction":"column",width:"100%"})},detail_item_files_init:function(e,t){var i=e;if("file"===e.rowInstance.datasource.type){var n={url:"/process/getInstanceAttachments",type:"POST",data:{fileIds:e.rowInstance.datasource.content||""},success:function(e){0===e.code&&i.bindData(e.data)},error:function(e){}};this.pageview.ajax(n)}else"File"===e.rowInstance.datasource.type?e.rowInstance.datasource.content&&i.bindData(JSON.parse(e.rowInstance.datasource.content)):e.config.style.display="none"},btnAddDoc_click:function(e,t){var i=this.pageview.params.instId,n=window._applyHistory.instData.name,a="addFormMore",o=window._applyHistory.mainForm,s=o?o.source:"";this.pageview.go("form",{id:i,title:encodeURI(n),source:s,formType:a})},detail_item_files_itemclick:function(e,t){var i=e.datasource.type,n=e.datasource.name.split("_");n[n.length-1];if(i.indexOf("image")>-1)try{window.yyesn.client.viewImage({files:e.datasource.aliOSSUrl})}catch(e){}else{var a=window.location.origin+"/approve-app/file/downloadattachment/"+e.datasource.id;window.location.href=a}},detail_files_view_left_init:function(e,t){var n=e.datasource.type||"unknow";e.config.src="./imgs/"+i.getFormat(n).ext},detail_repeat_itemclick:function(e,t){"link"!==e.datasource.type&&"Hyperlink"!==e.datasource.type||(e.datasource.content.indexOf("http://")===-1&&e.datasource.content.indexOf("https://")===-1&&(e.datasource.content="http://"+e.datasource.content),window.open(e.datasource.content,"_self"))},moreBill_click:function(e,t){var i=window._applyHistory.bpmActivityForms;localStorage.setItem("_applyHistory",JSON.stringify(window._applyHistory)),1===i.length?this.pageview.go("subformDetail",{id:i[0].id}):this.pageview.go("subformList")},subform_view_title_init:function(e,t){e.config.preText=this.itemNum,this.itemNum++},subform_view_item_init:function(e,t){e.bindData(e.rowInstance.datasource.item)},subform_view_item_title:function(e,t){switch(e.datasource.type){case"file":case"File":e.config.style.minHeight=30;break;case"Paragraph":case"Picture":case"DividingLine":case"DataTable":e.$el.hide();break;default:var i=e.datasource.title.length,n=e.datasource.content?e.datasource.content.length:0,a=n+i;a<=24?(e.config.style.width="auto",e.config.style.paddingRight="10"):(e.config.style.width="auto",e.config.style.maxWidth="110px",e.config.style.paddingRight="10")}},datatable_view_item_content_click:function(e,t){"link"!==e.datasource.type&&"Hyperlink"!==e.datasource.type||(e.datasource.content.indexOf("http://")===-1&&e.datasource.content.indexOf("https://")===-1&&(e.datasource.content="http://"+e.datasource.content),window.open(e.datasource.content,"_self"))},datatable_view_item_content_init:function(e,t){n.getAnalysisContent(e,this)},datatable_view_title_init:function(e,t){e.config.preText=e.datasource.num},datatable_view_item_title_init:function(e,t){switch(e.datasource.type){case"file":case"File":e.config.style.minHeight=30;break;case"Paragraph":case"Picture":case"DividingLine":case"DataTable":e.$el.hide();break;default:var i=e.datasource.title.length,n=e.datasource.content?e.datasource.content.length:0,a=n+i;a<=24?(e.config.style.width="auto",e.config.style.paddingRight="10"):(e.config.style.width="auto",e.config.style.maxWidth="110px",e.config.style.paddingRight="10")}},datatable_view_item_init:function(e,t){e.bindData(e.rowInstance.datasource.items)},copyuser_img_init:function(e,t){e.datasource.pic||(e.config.src="none.png")}},a}),define("pages/detailContent",["../logic/detailContent","../parts/common","utils"],function(e,t,i){var n={pluginClass:e,style:{backgroundColor:"#F7F7F7"},root:["addDoc_view","detail_repeat","subform_repeat","copyuser_item","moreBill"],components:{addDoc_view:{type:"view",root:["btnAddDoc"]},btnAddDoc:{type:"button",text:"+ 追加单据",ref:!0,style:{display:"none",borderRadius:0,borderColor:"#F7F7F7",borderLeftWidth:0,fontSize:15,borderRightWidth:0,height:43,marginTop:"10px",color:"#29B6F6",width:"100%"}},moreBill:{type:"icon",text:"更多单据",font:"cap_e901",textPos:"left",ref:!0,iconStyle:{fontSize:10,padding:"0 5px"},style:{display:"none",borderRadius:0,borderLeftWidth:0,borderColor:"rgba(0,0,0,0)",fontSize:13,borderRightWidth:0,height:40,width:"100%",marginBottom:20,verticalAlign:"middle",color:"#adadad",backgroundColor:"#fff"}},copyuser_item:{type:"view",ref:!0,root:["copyuser_title","copyuser_repeat"],style:{display:"none",backgroundColor:"#fff",flexDirection:"row"}},copyuser_title:{type:"text",text:"抄送人：",style:{width:80,fontSize:13,paddingLeft:13,color:"#9E9E9E"}},copyuser_repeat:{type:"repeat",ref:!0,root:["copyuser_view"],style:{minHeight:50,flex:1,flexDirection:"row",flexWrap:"wrap",marginBottom:-1},itemStyle:{}},copyuser_view:{type:"view",root:["copyuser_img","copyuser_name"],style:{flexDirection:"column",margin:"8px 5px"}},copyuser_img:{type:"image",src:"./imgs/1.png",src_bind:"pic",title_bind:"name",style:{w:35,fontSize:12,backgroundColor:"#e3e3e3",margin:"auto",borderRadius:"100%"}},copyuser_name:{type:"text",text_bind:"name",style:{fontSize:10,justifyContent:"center"}},datatable_repeat:{type:"repeat",ref:!0,root:["datatable_view"],style:{display:"none",width:"100%",backgroundColor:"#fff",flexDirection:"column"},itemStyle:{minHeight:40,flexDirection:"row"},itemClassName:"bottom-half-line"},datatable_view:{type:"view",root:["datatable_view_title","datatable_view_item"],style:{flexDirection:"column",width:"100%"}},datatable_view_title:{type:"text",text_bind:"title",preText:"1",preTextStyle:{backgroundColor:"#F39801",color:"rgb(255, 255, 255)",borderRadius:"50%",fontSize:12,w:15,lineHeight:14,marginRight:4,textAlign:"center"},style:{backgroundColor:"rgb(251,251,251)",color:"#9E9E9E",fontSize:13,paddingLeft:14,height:40}},datatable_view_item:{type:"repeat",root:["datatable_view_item_title","datatable_view_item_content","detail_item_files"],style:{display:"inline",width:"100%",backgroundColor:"#fff"},itemStyle:{minHeight:30,flexDirection:"row"}},datatable_view_item_title:{type:"text",text_bind:"title",style:{color:"#9E9E9E",fontSize:13,paddingLeft:14}},datatable_view_item_content:{type:"text",text_bind:"content",style:{color:"#262626",fontSize:13}},subform_repeat:{type:"repeat",ref:!0,root:["subform_view"],style:{display:"inline",width:"100%",backgroundColor:"#fff"},itemStyle:{borderBottom:"solid 1px #EDEDED",minHeight:40,flexDirection:"row"}},subform_view:{type:"view",root:["subform_view_title","subform_view_item"],style:{flexDirection:"column",width:"100%"}},subform_view_title:{type:"text",text_bind:"title",preText:"1",preTextStyle:{backgroundColor:"#F39801",color:"rgb(255, 255, 255)",borderRadius:"50%",fontSize:12,w:15,lineHeight:14,marginRight:4,textAlign:"center"},style:{backgroundColor:"rgb(251,251,251)",color:"#9E9E9E",fontSize:13,paddingLeft:14,height:40}},subform_view_item:{type:"repeat",root:["subform_view_item_title","subform_view_item_content"],style:{display:"inline",width:"100%",backgroundColor:"#fff"},itemStyle:{minHeight:30,flexDirection:"row"}},subform_view_item_title:{type:"text",text_bind:"name",style:{color:"#9E9E9E",fontSize:13,paddingLeft:14}},subform_view_item_content:{type:"text",text_bind:"content",style:{color:"#262626",
fontSize:13}},detail_repeat:{type:"repeat",ref:!0,root:["detail_view"],style:{display:"inline",width:"100%",backgroundColor:"#fff",marginTop:10},itemStyle:{minHeight:40,flexDirection:"row",widht:"100%"},itemClassName:"bottom-half-line"},detail_view:{type:"view",root:["detail_item_title","detail_item_content","detail_item_files","detail_iamge","detail_DividingLine","datatable_repeat"],style:{flexDirection:"row",width:"100%"}},detail_DividingLine:{type:"text",style:{height:1,borderBottom:"1px solid rgb(237, 237, 237)",borderTopColor:"rgb(237, 237, 237)",borderRightColor:"rgb(237, 237, 237)",borderLeftColor:"rgb(237, 237, 237)",marginBottom:10,paddingBottom:10,width:"100%"}},detail_item_title:{type:"text",text:"title:",text_bind:"title",ref:!0,style:{color:"#9E9E9E",fontSize:13,paddingLeft:13,width:80}},detail_item_content:{type:"text",text:"content",text_bind:"content",numberofline:200,style:{flex:1,color:"#262626",fontSize:13,paddingRight:8,padding:"10 0"}},detail_iamge:{type:"image",style:{width:"100%"}},detail_item_files:{type:"repeat",ref:!0,root:["detail_files_view"],style:{display:"inline",flex:1,backgroundColor:"#fff"},itemStyle:{height:40,flexDirection:"row"}},detail_files_view:{type:"view",style:{flexDirection:"row",flex:1},root:["detail_files_view_left","detail_files_view_right"]},detail_files_view_left:{type:"image",style:{w:34,margin:"4px 8px 0 10px",backgroundColor:"#fff"},src:"./imgs/link.png"},detail_files_view_right:{type:"text",text_bind:"name",numberofline:1,style:{flex:1,color:"#262626",fontSize:13,paddingRight:10}}}};return n}),define("logic/detailProcess",["../parts/common","utils","../../../components/dialog"],function(e,t,i){function n(e){this.pageview=e.pageview,this.parentThis=this.pageview.viewpagerParams.parentThis}return n.prototype={flow_right_content_right_init:function(e,i){if("startEvent"===e.datasource.activityType){var n=null===e.datasource.endTime?e.datasource.startTime:e.datasource.endTime;e.config.text=t.timestampToTimeStr(new Date(n).getTime(),!0)}else"userTask"===e.datasource.activityType?this.setAnalysis(e,"time"):e.rowInstance.$el.hide()},flow_right_content_middle_bottom_title_init:function(e,t){"startEvent"===e.datasource.activityType?e.config.text="提交了申请":this.setAnalysis(e,"status")},left_round_init:function(e,t){this.setAnalysis(e,"icon")},flow_line_init:function(e,t){if(e.datasource.assignee!==this.applyHistory.currentUserId){var i=e.datasource.taskAuditDesc||(e.datasource.endTime&&e.datasource.endTime.indexOf("9999")===-1?"同意":"待办");"待办"===i&&null===e.datasource.deleteReason?e.config.style.display="block":"completed"!==e.datasource.deleteReason&&"withdraw"!==e.datasource.deleteReason&&"deleted"!==e.datasource.deleteReason&&"delete"!==e.datasource.deleteReason&&(i.indexOf("指派")>-1||i.indexOf("改派")>-1||i.indexOf("改签")>-1||i.indexOf("被加签")>-1)&&(e.config.style.display="block")}},flow_IM_init:function(e,t){e.datasource.assignee===this.applyHistory.currentUserId&&(e.config.style.display="none")},flow_remind_init:function(e,t){this.setAnalysis(e,"remind")},flow_remind_click:function(e,t){var i=this;this.pageview.go("deal",{type:5,instId:i.applyHistory.instData.id,taskId:i.applyHistory.taskId,currentUserId:i.applyHistory.currentUserId,currentUserName:encodeURI(i.applyHistory.currentUserName),assignee:e.datasource.assignee,instName:encodeURI(i.applyHistory.instData.name),processDefinitionId:e.datasource.processDefinitionId,formInstanceId:this.applyHistory.formId})},flow_right_content_left_init:function(e,i){if(!e.datasource.pic){var n=t.getImgTitle(e.datasource.userName);e.setTitle(n),e.config.style.backgroundColor=t.getImgBg(n)}},setAnalysis:function(e,i){if(this.applyHistory=window._applyHistory,"time"===i)e.datasource.endTime&&e.datasource.endTime.indexOf("9999")===-1?e.config.text=t.timestampToTimeStr(new Date(e.datasource.endTime).getTime(),!0):e.config.text="";else if("status"===i){var n="";e.datasource.taskComments&&e.datasource.taskComments.length>0&&(n=" 意见:"+e.datasource.taskComments[0].message,"ACTIVITI_DISAGREE"===e.datasource.deleteReason&&"jumpToActivity"===e.datasource.taskComments[0].message&&(n=""));var a=e.datasource.taskAuditDesc||(e.datasource.endTime&&e.datasource.endTime.indexOf("9999")===-1?"同意":"待办");a.indexOf("驳回")!==-1||a.indexOf("中止申请")!==-1?e.config.style.color="#F17868":"待办"===a&&null===e.datasource.deleteReason?e.config.style.color="#F39801":"ACTIVITI_DELETED"===e.datasource.deleteReason?(e.config.style.color="#F17868",a=a||"中止申请"):"completed"===e.datasource.deleteReason&&a.indexOf("指派")===-1&&a.indexOf("改派")===-1&&a.indexOf("改签")===-1&&a.indexOf("被加签")===-1&&(a=a||"同意"),e.config.text=a+" "+n}else if("icon"===i){var o=e.datasource.taskAuditDesc||(e.datasource.endTime&&e.datasource.endTime.indexOf("9999")===-1?"同意":"待办");o.indexOf("驳回")!==-1||o.indexOf("中止申请")!==-1?(e.config.iconStyle.color="#F17868",e.config.font="cap_e90e"):"待办"===o&&null===e.datasource.deleteReason?(e.config.font="cap_e90b",e.config.iconStyle.color="#F39801"):"ACTIVITI_DELETED"===e.datasource.deleteReason?(e.config.iconStyle.color="#F17868",e.config.font="cap_e90e"):"completed"===e.datasource.deleteReason&&o.indexOf("指派")===-1&&o.indexOf("改派")===-1&&o.indexOf("改签")===-1&&o.indexOf("被加签")===-1?o="同意":"completed"!==e.datasource.deleteReason&&"withdraw"!==e.datasource.deleteReason&&"deleted"!==e.datasource.deleteReason&&"delete"!==e.datasource.deleteReason&&(o.indexOf("指派")>-1||o.indexOf("改派")>-1||o.indexOf("改签")>-1||o.indexOf("被加签")>-1||o.indexOf("加签给")>-1)?(e.config.font="cap_e90b",e.config.iconStyle.color="#F39801"):"completed"===e.datasource.deleteReason&&(o.indexOf("指派")>-1||o.indexOf("改派")>-1||o.indexOf("改签")>-1||o.indexOf("被加签")>-1||o.indexOf("加签给")>-1)}else if("remind"===i&&e.datasource.assignee!==this.applyHistory.currentUserId){var s=e.datasource.taskAuditDesc||(e.datasource.endTime&&e.datasource.endTime.indexOf("9999")===-1?"同意":"待办");"待办"===s&&null===e.datasource.deleteReason?e.config.style.display="block":"completed"!==e.datasource.deleteReason&&"withdraw"!==e.datasource.deleteReason&&"deleted"!==e.datasource.deleteReason&&"delete"!==e.datasource.deleteReason&&(s.indexOf("指派")>-1||s.indexOf("改派")>-1||s.indexOf("改签")>-1||s.indexOf("被加签")>-1)&&(e.config.style.display="block")}},flow_IM_click:function(t,n){var a=this,o=window._applyHistory.currentMemberId+""||"",s=t.datasource.memberId+""||"",r=t.datasource.userName||"",l=t.datasource.memberId+"",c=window.location.href,p=window._applyHistory.instData.name,d="确定要和"+r+"聊天吗？",h="",u="";try{var f=JSON.parse(window._applyHistory.instData.keyFeature);f&&f.forEach(function(e,t){u+=e.key+":"+(e.value||"暂无")+";"}),h=u}catch(e){h=p}h||(h=p),this.sendIMDialog=new i({mode:3,wrapper:this.parentThis.pageview.$el,contentText:d,btnDirection:"row",buttons:[{title:"取消",style:{height:45,fontSize:16,color:e.titleColor,borderRight:"1px solid #eee"},onClick:function(){a.sendIMDialog.hide()}},{title:"确定",style:{height:45,fontSize:16,color:"#37b7fd"},onClick:function(){a.sendIMDialog.hide(),a.pageview.showLoading({text:"请稍后..."}),a.pageview.ajax({url:"/esn/sendIM",type:"POST",data:{title:p,content:h,url:c,userid:o,receiver:s},success:function(e){if(a.pageview.hideLoading(!0),e.success)try{window.yyesn.enterprise.openChatWindow(function(e){"0"===e.error_code},{chat_mode:"0",send_id:l.toString(),send_name:r.toString()},function(e){})}catch(e){alert(JSON.stringify(e))}else a.pageview.showTip({text:e.msg,duration:1e3})},error:function(e){a.pageview.hideLoading(!0),a.pageview.showTip({text:e.msg,duration:1e3})}})}}]}),this.sendIMDialog.show()}},n}),define("pages/detailProcess",["../logic/detailProcess","../parts/common","utils"],function(e,t,i){var n={pluginClass:e,style:{backgroundColor:"#F7F7F7"},root:["middle_flow_repeat"],components:{middle_flow_repeat:{type:"repeat",ref:!0,style:{background:"rgb(247, 247, 247)",flexDirection:"column"},itemStyle:{flexDirection:"row",background:"rgb(247, 247, 247);"},root:["flow_left","flow_right"]},flow_left:{type:"view",ref:!0,root:["left_line","left_round"],style:{width:24}},left_line:{type:"text",text:" ",ref:!0,style:{borderLeft:"solid 1px #e6e6e6",background:"#e6e6e6",height:"95%",position:"absolute",left:22,bottom:29}},left_round:{type:"icon",font:"cap_e90a",ref:!0,iconStyle:{color:"#56CFAE",borderRadius:"50%",fontSize:18,backgroundColor:"#fff"},style:{position:"absolute",right:"-8px",top:42,w:18,borderRadius:"50%",zIndex:11}},flow_right:{type:"view",ref:!0,root:["flow_right_arrow","flow_right_content"],style:{flex:1,left:25,top:20,marginBottom:20,marginRight:48,borderRadius:6,paddingLeft:10,backgroundColor:"#fff",boxShadow:"0px 0px 0px 1px #ededed"}},flow_right_arrow:{type:"text",text:" ",ref:!0,style:{display:"none",position:"absolute",top:20,left:-9,width:0,height:0,borderTop:"10px solid transparent",borderRight:"10px solid #fff",borderBottom:"10px solid transparent"}},flow_right_content:{type:"view",ref:!0,root:["flow_right_content_left","flow_right_content_middle","flow_right_content_right","flow_iconview"],style:{flexDirection:"row",alignItems:"flex-start",padding:"12px 0",position:"relative"}},flow_iconview:{type:"view",root:["flow_remind","flow_line","flow_IM"],ref:!0,style:{position:"absolute",right:14,bottom:12,flexDirection:"row",borderRadius:"50%",zIndex:11}},flow_right_content_left:{type:"image",src_bind:"pic",src:"pic",title_bind:"userName",style:{w:40,backgroundColor:"#eee",borderRadius:"50%",marginRight:14,top:1}},flow_right_content_middle:{type:"view",root:["flow_right_content_middle_top","flow_right_content_middle_bottom"],style:{flexDirection:"column",flex:1,marginRight:14,top:3}},flow_right_content_middle_top:{type:"text",text_bind:"userName",style:{fontSize:16,lineHeight:16,marginBottom:4,color:"#292F33"}},flow_right_content_middle_bottom:{type:"view",root:["flow_right_content_middle_bottom_title","flow_right_content_middle_bottom_image_repeat"],style:{flexDirection:"column",paddingRight:20}},flow_right_content_middle_bottom_title:{type:"text",text:"状态加载中...",style:{fontSize:14,lineHeight:21,color:"#9E9E9E"}},flow_right_content_middle_bottom_image_repeat:{type:"repeat",ref:!0,root:["flow_right_content_middle_bottom_image_repeat_item"],style:{flexWrap:"wrap"},itemStyle:{margin:"5px 10px 5px 0"}},flow_right_content_middle_bottom_image_repeat_item:{type:"image",src_bind:"pic",style:{w:40}},flow_right_content_right:{type:"text",text_bind:"startTime",style:{fontSize:12,lineHeight:12,height:"100%",marginRight:14,position:"absolute",flexDirection:"column",justifyContent:"flex-start",alignItems:"flex-end",right:0,top:0,color:"#ADADAD",zIndex:10}},flow_remind:{type:"icon",font:"cap_e921",ref:!0,iconStyle:{color:"#9e9e9e",borderRadius:"50%",fontSize:16},style:{display:"none"}},flow_line:{type:"view",style:{display:"none",width:2,height:15,margin:"0 15",borderRight:"solid 1px #ededed"}},flow_IM:{type:"icon",font:"cap_e920",ref:!0,iconStyle:{color:"#9e9e9e",borderRadius:"50%",fontSize:16},style:{}}}};return n}),define("parts/timepicker",["utils"],function(e){function t(e){var t,i,n=window.getComputedStyle(e,null),a=!0;return a?(n=n["-webkit-transform"].split(")")[0].split(", "),t=+(n[12]||n[4]),i=+(n[13]||n[5])):(t=+n.left.replace(/[^-\d.]/g,""),i=+n.top.replace(/[^-\d.]/g,"")),{x:t,y:i}}var i=function(t){var i=this;t=t||{},i.CanTouch="ontouchend"in document;var n=document.createElement("DIV").style;"-webkit-transform"in n?(i.transitionend="webkitTransitionEnd",i.transform="-webkit-transform",i.transition="-webkit-transition"):(i.transitionend="transitionend",i.transform="transform",i.transition="transition"),i.mode="",i.Now=new Date,i.RealModeArr=[],i.rowsCount=5,i.itemHeight=e.getRealHeight(40),i.ParentContainer=document.body,i.extendArr=[],i.DTP_Obj=[],i.mapping={yyyy:{label:"年",start:1950,end:2040},MM:{label:"月",start:1,end:12},dd:{label:"日",start:1,end:31},hh:{label:"时",start:0,end:23},mm:{label:"分",start:0,end:59}},i.DTP_Conatiner=document.createElement("DIV"),i.DTP_Conatiner.className="tmpk-wrapper",i.DTP_Mid_Area=document.createElement("DIV"),i.DTP_Mid_Area.className="tmpk-mid-area",i.DTP_Mid_Area.style.height=i.itemHeight+"px",i.DTP_Mid_Area.style.top=2*i.itemHeight+"px",i.GradientLayer=document.createElement("DIV"),i.GradientLayer.className="tmpk-gradient-layer";var a=document.createElement("DIV");a.className="tmpk-top-area",a.style.height=e.getRealHeight(42)+"px";var o=document.createElement("DIV"),s=t.cancelBtnClassName||"";o.className="tmpk-top-col tmpk-cancel "+s,o.innerHTML=t.cancelText||"取消",o.addEventListener("click",function(e){i.CancelClick(e)});var r=document.createElement("DIV");r.className="tmpk-top-col tmpk-auto-col",i.TitleLabel=document.createElement("DIV"),r.appendChild(i.TitleLabel);var l=document.createElement("DIV"),c=t.okBtnClassName||"";l.className="tmpk-top-col "+c,l.innerHTML="确定",l.addEventListener("click",function(e){i.OkClick(e)});var p=document.createElement("DIV");p.className="tmpk-top-col tmpk-clear",p.innerHTML="清除",p.addEventListener("click",function(e){i.ClearClick(e)}),a.appendChild(o),a.appendChild(r),a.appendChild(p),a.appendChild(l),i.DTP_Conatiner.appendChild(a),i.DateArea_Container=document.createElement("DIV"),i.DateArea_Container.className="tmpk-date-area",i.DateArea_Container.style.height=i.rowsCount*i.itemHeight+"px",i.DateArea_Container.appendChild(i.DTP_Mid_Area),i.DateArea_Container.appendChild(i.GradientLayer),i.DTP_Conatiner.appendChild(a),i.DTP_Conatiner.appendChild(i.DateArea_Container),i.isDone=!1};return i.prototype={CancelClick:function(e){var t=this;void 0!=t.CancelMethod&&t.CancelMethod(),t.hide()},OkClick:function(e){var t=this,i=t.getValue();void 0!=t.OkMethod&&t.OkMethod(i),t.hide()},setTitle:function(e){var t=this;return t.TitleLabel.innerHTML=e||"",t},bind:function(e,t){var i=this;return"clear"==e?i.ClearMethod=t:"ok"==e?i.OkMethod=t:"cancel"==e?i.CancelMethod=t:"change"==e&&(i.ChangeMethod=t),i},ClearClick:function(e){var t=this;void 0!=t.ClearMethod&&t.ClearMethod(),t.hide()},done:function(){var e=this;return e.isDone||(e._InitLayout(),e._InitEvent(),e._InitLimit(),e.isDone=!0),e},_CompleteDateInfo:function(e){var t={Date:null,DateStr:null};return void 0==e.yyyy||void 0==e.yyyy.value?t:(e.MM=e.MM||{index:0,value:1},e.MM.value=e.MM.value||1,e.dd=e.dd||{index:0,value:1},e.dd.value=e.dd.value||1,e.hh=e.hh||{index:0,value:0},e.hh.value=e.hh.value||0,e.mm=e.mm||{index:0,value:0},e.mm.value=e.mm.value||0,t.mapping=e,t.DateStr=e.yyyy.value+"-"+e.MM.value+"-"+e.dd.value+" "+e.hh.value+":"+e.mm.value,t.Date=new Date(t.DateStr.replace("-","/").replace("-","/")),t)},setMaxValue:function(e){var t=this;if(!e||!t.isDone)return t;if(t.max_key_index_Mapping=t._getKey_IndexMappingByDateStr(e,!1),t.max_date_info=t._CompleteDateInfo(t.max_key_index_Mapping),void 0!=t.min_date_info&&t.max_date_info.Date<t.min_date_info.Date)return t.max_date_info=null,t;if(t.mapping.yyyy.show){var i=t.max_date_info.Date.getFullYear(),n=i-t.mapping.yyyy.start;t.mapping.yyyy.limit.max=t._reviseIndexByKeyByIndex(t.mapping.yyyy,n)}return t},setMinValue:function(e){var t=this;if(!e||!t.isDone)return t;if(t.min_key_index_Mapping=t._getKey_IndexMappingByDateStr(e,!1),t.min_date_info=t._CompleteDateInfo(t.min_key_index_Mapping),void 0!=t.max_date_info&&t.max_date_info.Date<t.min_date_info.Date)return t.min_date_info=null,t;if(t.mapping.yyyy.show){var i=t.min_date_info.Date.getFullYear(),n=i-t.mapping.yyyy.start;t.mapping.yyyy.limit.min=t._reviseIndexByKeyByIndex(t.mapping.yyyy,n)}return t},_InitLimit:function(){for(var e=this,t=0,i=e.RealModeArr.length;t<i;t++){var n=e.RealModeArr[t],a=e.mapping[n];void 0!=a.start?a.limit={min:0,max:a.end-a.start}:a.limit={min:0,max:_curMappingInfo.data.length-1}}},show:function(e,t){var i=this;return window.setTimeout(function(){void 0==e||/^\s*$/.test(e)?i.setValueByDate(i.Now):i.setValueByDateStr(e),i.DTP_Width=i.GradientLayer.offsetWidth,i.DTP_Height=i.GradientLayer.offsetHeight,i.POS={left:0,top:window.innerHeight-i.DateArea_Container.offsetHeight}},200),i.DTP_Conatiner.className="tmpk-wrapper tmpk-wrapper-show",i.BackCover.style.display="block",i},hide:function(){var e=this;return e.DTP_Conatiner.className="tmpk-wrapper",e.BackCover.style.display="none",e},_getKey_IndexMappingByDateStr:function(e,t){var i=this,n={},a=[];void 0!=e&&(a=i.getValueArr(e));for(var o=0,s=i.TimeArrModeArr.length;o<s;o++){var r=i.TimeArrModeArr[o],l=parseInt(a[o]),c=i._getValueIndexByValue(i.mapping[r],l,t);n[r]=c}return n},_getValueIndexByValue:function(e,t,i){var n=this;if(void 0!=e.start){var a=i?e.limit.min:0,o=i?e.limit.max:n.getItemCount(e);if(isNaN(t))return{index:a,value:e.start};var s=t-e.start;return s=s<a?a:s,s=s>o?o:s,{index:s,value:s+e.start}}throw new Error("未实现")},_reviseIndexByKeyByIndex:function(e,t){var i=this;if(isNaN(t))return 0;var n=i.getItemCount(e)-1;return t>n?n:t<0?0:t},_reviseValueIndexByKeyByIndex:function(e,t){return isNaN(t)?e.limit.min:t>e.limit.max?e.limit.max:t<e.limit.min?e.limit.min:t},setPosByKeyByIndex:function(e,t){var i=this,n=i.mapping[e];t=i._reviseValueIndexByKeyByIndex(n,t);var a=n.index,o=i.DTP_Obj[a],s=o.obj,r=i.itemHeight*(-t+2);o.y=r,o.index=t,s.style[i.transition]="none",s.style[i.transform]="translate(0,"+r+"px)"},getValue:function(){for(var e=this,t=e.mode,i=0,n=e.TimeArrModeArr.length;i<n;i++){var a=e.TimeArrModeArr[i];t=t.replace(a,e.getValueByKey(a))}return t},setValueByDateStr:function(e){var t=this,i=t._getKey_IndexMappingByDateStr(e,!0);for(var n in i)t.setPosByKeyByIndex(n,i[n].index),i.MM=i.MM||{index:0,value:1},i.dd=i.dd||{index:0,value:1},i.yyyy=i.yyyy||{index:0,value:1},t.ModifyDayCount("MM",i.yyyy.value,i.MM.value,i.dd.value)},setValueByDate:function(e){var t=e.getFullYear(),i=e.getMonth()+1,n=e.getDate(),a=e.getHours(),o=e.getMinutes(),s=this;s.setValueByDateStr(t+"-"+i+"-"+n+" "+a+":"+o)},getValueByKey:function(e){var t=this,i=t.mapping[e];if(1!=i.show)return null;var n=t.DTP_Obj[i.index];if(void 0!=i.start){var a=i.start+n.index;return a=a<10?"0"+a:a}return i.data[n.index].value},setParent:function(e){var t=this;return t.ParentContainer=e,t},setMode:function(e){var t=this;return t.mode=e,t},_InitEvent:function(){function e(e){a.e=e,e.preventDefault();var i=e.touches?e.touches[0]:e;a.timeMark.start=new Date,a.touchStart.x=i.pageX,a.curListIndex=Math.ceil(a.touchStart.x/a.DTP_Width*a.RealModeArr.length)-1,a.touchEnd.y=a.touchStart.y=i.pageY;var n=a.DTP_Obj[a.curListIndex],o=t(n.obj);n.obj.style[a.transition]="",n.obj.style["-webkit-transform"]="translate(0,"+o.y+"px)",a.curPosY=n.y=o.y,a.touchleave=!1,canmove=!0}function i(e){if(!a.touchleave&&canmove){e.preventDefault();var t=e.touches?e.touches[0]:e,i=a.touchEnd.y-a.touchStart.y;a.touchEnd.y=t.pageY;var o=t.pageX,s=a.DTP_Obj[a.curListIndex],r=s.obj;return s.y=a.curPosY+i,r.style[a.transform]="translate(0,"+s.y+"px)",o<=10||o>=a.DTP_Width-10||a.touchEnd.y-a.POS.top<=10||a.touchEnd.y-a.POS.top>=a.DTP_Height-10?(n(),void(a.touchleave=!0)):void(a.touchleave=!1)}}function n(e){if(canmove=!1,!a.touchleave){a.timeMark.end=new Date;var t=a.timeMark.end-a.timeMark.start,i=a.touchEnd.y-a.touchStart.y,n=0,o=a.DTP_Obj[a.curListIndex],s=a.mapping[a.RealModeArr[a.curListIndex]],r=0;if(t<350&&Math.abs(i)>10){var l=a.getCanScrollValue(a.getCanScrollMaxHeight(s),i);n=l.value,r=l.duration}else window.setTimeout(function(){a._transitionEnd(null,!0,a.curListIndex)},20);o.y=a.getRealPosY(o.y+n,a.getLimit(s),o),o.obj.style[a.transition]=a.transform+" "+r+"s cubic-bezier(0.333333, 0.666667, 0.666667, 1)",o.obj.style[a.transform]="translate(0,"+o.y+"px)"}}var a=this;a.BackCover.addEventListener("click",function(e){a.hide()}),a.BackCover.addEventListener("touchmove",function(e){e.preventDefault(),e.stopPropagation()});var o=a.CanTouch?"touchstart":"mousedown",s=a.CanTouch?"touchmove":"mousemove",r=a.CanTouch?"touchend":"mouseup";a.GradientLayer.addEventListener(o,function(t){e(t)}),a.GradientLayer.addEventListener(s,function(e){i(e)}),a.GradientLayer.addEventListener(r,function(e){n(e)}),a.curListIndex=0,a.curPosY=0,a.touchleave=!1,canmove=!1,a.touchStart={x:0,Y:0},a.touchEnd={x:0,y:0},a.timeMark={start:0,end:0}},_InitLayout:function(){var e=this;0==e.RealModeArr.length&&(e.RealModeArr=e.getModeArr(),e.TimeArrModeArr=e.getModeArr()),0==e.RealModeArr.length&&(e.mode="yyyy-MM-dd",e.RealModeArr=["yyyy","MM","dd"]),e.listwidth=100/e.RealModeArr.length+"%";for(var t=0,i=e.RealModeArr.length;t<i;t++){var n=e.RealModeArr[t],a=e.mapping[n];a.show=!0,a.index=t,e._InitLayout_List(n,a,t)}e.BackCover=document.createElement("DIV"),e.BackCover.className="tmpk-back-cover",e.ParentContainer.appendChild(e.BackCover),e.ParentContainer.appendChild(e.DTP_Conatiner)},extendData:function(e){var t=this;0==t.RealModeArr.length&&(t.RealModeArr=t.getModeArr(),t.TimeArrModeArr=t.getModeArr());var i=e.key;if(void 0==i||""==i)return t;if(void 0!=t.mapping[i])throw new Error("已存在相应的key");t.mapping[i]=e;var n=e.index||0;return n=isNaN(n)||n<0?0:n,n=n>t.RealModeArr.length-1?t.RealModeArr.length:n,t.RealModeArr.splice(n,0,i),t},_InitLayout_List:function(e,t,i){var n=this,a=document.createElement("UL");if(n.DTP_Obj[i]={obj:a,y:0,index:0,key:e},void 0!=t.start)for(var o=t.start,s=t.end,r=o;r<=s;r++){var l=document.createElement("LI");l.className="tmpk-item",l.style.height=n.itemHeight+"px",l.style.lineHeight=n.itemHeight+"px",r=r<10?"0"+r:r;var c=r+t.label;l.innerHTML=c,a.appendChild(l)}else for(var p=0,d=t.data.length;p<d;p++){var h=t.data[p],l=document.createElement("LI");l.className="tmpk-item",l.style.height=n.itemHeight+"px",l.style.lineHeight=n.itemHeight+"px";var c=h.text;l.innerHTML=c,a.appendChild(l)}a.className="tmpk-list",a.setAttribute("index",i),a.setAttribute("key",e),a.style.width=n.listwidth,a.addEventListener(n.transitionend,function(e){n._transitionEnd(e)}),n.DateArea_Container.appendChild(a)},_setMaxLimitByKeyByIndex:function(e,t){},setLimit:function(){},_transitionEnd:function(e,t,i){var n,a=this;n=t===!0?a.DTP_Obj[i]:a.DTP_Obj[e.target.getAttribute("index")],n.isInTransition=!1;var o=n.key,s=a.getValueByKey("yyyy"),r=a.getValueByKey("MM")||1,l=a.getValueByKey("dd")||1,c=a.getValueByKey("hh")||0,p=a.getValueByKey("mm")||0;if(null!=s?(a.CurDateStr=s+"-"+r+"-"+l+" "+c+":"+p,a.CurDate=new Date(s,r-1,l,c,p)):(a.CurDateStr="",a.CurDate=null),a.ModifyDayCount(o,s,r,l),void 0!=a.max_date_info&&null!=a.CurDate){var d=a.max_date_info.Date;a.CurDate>d&&a.setValueByDate(d)}if(void 0!=a.min_date_info&&null!=a.min_date_info){var h=a.min_date_info.Date;a.CurDate<h&&a.setValueByDate(h)}void 0!=a.ChangeMethod&&a.ChangeMethod(a.getValue())},ModifyDayCount:function(e,t,i,n){var a=this;if(a.mapping.dd.show&&a.mapping.yyyy.show&&a.mapping.MM.show&&("MM"==e&&1!=a.getIsInTransitionByKey("yyyy")||"yyyy"==e&&1!=a.getIsInTransitionByKey("MM"))){var o=a.DayNumOfMonth(t,i),s=a.mapping.dd;s.limit.max=o-1;for(var r=s.index,l=a.DTP_Obj[r],c=l.obj,p=31-o,d=30;d>=27;d--)p>0?(c.childNodes[d].style.display="none",p-=1):c.childNodes[d].style.display="block";n>o&&a.setPosByKeyByIndex("dd",s.limit.max)}},getIsInTransitionByKey:function(e){var t=this,i=t.mapping[e].index,n=t.DTP_Obj[i];return n.isInTransition},getModeArr:function(){for(var e=this,t=[],i=(e.mode||"").split(" "),n=!1,a=0,o=i.length;a<o;a++){var s="-",r=i[a];if(r.indexOf("-")>0);else{if(!(r.indexOf(":")>0)){t.push(r);break}s=":"}var l=r.split(s);if(n)break;for(var c=0,p=l.length;c<p;c++){var d=l[c];if(!e.mapping[d]){n=!0;break}t.push(d)}}return t},getValueArr:function(e){for(var t=[],i=(e||"").split(" "),n=0,a=i.length;n<a;n++)for(var o=0==n?i[n].split("-"):i[n].split(":"),s=0,r=o.length;s<r;s++){var l=o[s];t.push(l)}return t},getCanScrollValue:function(e,t){var i=this,n=t<0?-1:1;t=Math.abs(t);var a=.5,o=3*i.itemHeight*n;return t>i.itemHeight*i.rowsCount*3/5?o=e*n*.9:t<=i.itemHeight*i.rowsCount*3/5&&t>i.itemHeight*i.rowsCount*2/5?(o=e*n*.7,a=.4):t<=i.itemHeight*i.rowsCount*2/5&&t>i.itemHeight*i.rowsCount*1/5?(o=e*n*.6,a=.3):(o=3*i.itemHeight*n,a=.3),{value:o,duration:a}},getRealPosY:function(e,t,i){var n=this,a=n.itemHeight*Math.floor(n.rowsCount/2)-t.min*n.itemHeight,o=n.itemHeight*Math.ceil(n.rowsCount/2)-(t.max+1)*n.itemHeight,s=e<a?e>o?e:o:a,r=Math.abs(Math.round(s/n.itemHeight-Math.floor(n.rowsCount/2)));return i.index=r,n.itemHeight*Math.floor(n.rowsCount/2)-r*n.itemHeight},getLimit:function(e){return e.limit},getItemCount:function(e){if(void 0!=e.start){var t=e.end-e.start+1;return t}return e.data.length},getCanScrollMaxHeight:function(e){var t=this,i=t.getItemCount(e);return i=i>20?10:i,i*t.itemHeight},DayNumOfMonth:function(e,t){var i=new Date(e,t,0);return i.getDate()}},i}),define("logic/form",["../parts/timepicker","../parts/common","utils","../components/ApplyDetail","../components/ApplyInputDateCalculate","../components/ApplyInputDate","../components/ApplyInputCheckbox","../components/ApplyInputDateBetween","../components/ApplyInputRadio","../components/ApplyLayout","../components/ApplyInputText","../components/ApplyInputTextarea","../components/ApplyInputTextNum","../components/ApplyImage","../components/ApplyInputTextMoney","../components/ApplyInputString","../components/ApplyInputEmail","../components/ApplyInputMobile","../components/ApplyScore","../components/ApplyInputTextPercent","../components/ApplyTileRadio","../components/ApplyTileCheckbox","../components/ApplyInputPassword","../components/ApplyInputLink","../components/ApplySwitch","../components/ApplyViewImage","../components/ApplyDividingLine","../components/ApplyBillMaker","../components/ApplyCodeRule","../components/ApplyReference","../components/ApplyEmployee","../components/ApplyDepartment","../components/ApplyBillMakerManager","../components/ApplyBillMakerOrg","../components/ApplyFile","../components/ApplyTaskComment","../components/ApplyBillMakerPost","../components/ApplyIdentifyCode","../../../components/dialog"],function(e,t,i,n,a,o,s,r,l,c,p,d,h,u,f,g,m,y,v,w,x,b,_,D,I,S,C,T,k,R,L,A,E,P,M,N,F,W,O){function B(t){this.pageview=t.pageview;var i=this;this.itemDict={},this.mode=this.pageview.params.formType,this.isFreeApprove=!1,this.isQrRreview="1"===this.pageview.params.qrcodepreview,this.templateid=this.pageview.params.templateid,this.id=this.pageview.params.id,this.isPreview="1"===this.pageview.params.preview,this.source=this.pageview.params.source||"",this.taskDefinitionKey=this.pageview.params.taskDefinitionKey,this.autoFields=[],this.formName=this.pageview.showPageParams.formName||decodeURI(this.pageview.params.title)||"",this.share=this.pageview.params.share||"",this.tenantId=this.pageview.params.tenantId||"",this.shareTenantId="",this.shareUserId="",this.pk_boins="",this.procInstName=this.pageview.params.procInstName||decodeURI(this.pageview.params.procInstName)||"",this.optionsFlow={},this.isPreview?($(document.body).addClass("pc-zoom"),window.isPreview=!0,window.previewPlugin=this):this.loadData(),this.isQrRreview&&(window.isPreview=!0),this.year=(new Date).getFullYear(),this.itemInstanceArr=[],this.yyyyMMTimePicker=new e,this.yyyyMMTimePicker.mapping.yyyy.start=1910,this.yyyyMMTimePicker.mapping.yyyy.end=this.year+20,this.yyyyMMTimePicker.setMode("yyyy-MM").setParent(this.pageview.$el[0]).done().bind("clear",function(){}).bind("ok",function(e){i.yyyyMMTimePicker.curDateInstance?i.yyyyMMTimePicker.curDateInstance.setValue(e,i.yyyyMMTimePicker.sender):i.yyyyMMTimePicker.curDateBetweenInstance&&i.yyyyMMTimePicker.curDateBetweenInstance.setSingleValue(e,i.yyyyMMTimePicker.curDateBetweenInstanceIndex,i.yyyyMMTimePicker.sender)}).bind("cancel",function(){}),this.yyyyMMddTimePicker=new e,this.yyyyMMddTimePicker.mapping.yyyy.start=1910,this.yyyyMMddTimePicker.mapping.yyyy.end=this.year+20,this.yyyyMMddTimePicker.setMode("yyyy-MM-dd").setParent(this.pageview.$el[0]).done().bind("clear",function(){}).bind("ok",function(e){i.yyyyMMddTimePicker.curDateInstance?i.yyyyMMddTimePicker.curDateInstance.setValue(e,i.yyyyMMddTimePicker.sender):i.yyyyMMddTimePicker.curDateBetweenInstance&&i.yyyyMMddTimePicker.curDateBetweenInstance.setSingleValue(e,i.yyyyMMddTimePicker.curDateBetweenInstanceIndex,i.yyyyMMddTimePicker.sender)}).bind("cancel",function(){}),this.yyyyMMddhhssTimePicker=new e,this.yyyyMMddhhssTimePicker.mapping.yyyy.start=1910,this.yyyyMMddhhssTimePicker.mapping.yyyy.end=this.year+20,this.yyyyMMddhhssTimePicker.setMode("yyyy-MM-dd hh:mm").setParent(this.pageview.$el[0]).done().bind("clear",function(){}).bind("ok",function(e){i.yyyyMMddhhssTimePicker.curDateInstance?i.yyyyMMddhhssTimePicker.curDateInstance.setValue(e,i.yyyyMMddhhssTimePicker.sender):i.yyyyMMddhhssTimePicker.curDateBetweenInstance&&i.yyyyMMddhhssTimePicker.curDateBetweenInstance.setSingleValue(e,i.yyyyMMddhhssTimePicker.curDateBetweenInstanceIndex,i.yyyyMMddhhssTimePicker.sender)}).bind("cancel",function(){}),this.setHeader()}return B.prototype={onPageResume:function(){this.setHeader()},setHeader:function(){try{window.yyesn.client.setHeader(function(){},{type:2,title:this.formName||"审批",rightTitle:"",rightValues:[]},function(e){})}catch(e){this.setH5Header()}},setH5Header:function(){},approve_line_repeat_itemclick:function(e,t){this.isFreeApprove&&e.remove()},getItemTitle:function(e){return"ApplyInputDateBetween"===e.type?(e.title||"")+"-"+(e.title1||""):e.title},pushTitle:function(e,t){return"ApplyInputString"!==e.type&&void t.push(this.getItemTitle(e)+"$$xz"+e.id)},getExcelContent:function(e){for(var t=[],i=[],n=0,a=e.length;n<a;n++){var o=e[n];if(this.pushTitle(o,t)!==!1&&"ApplyLayout"===o.type&&"1"===o.isChildForm){for(var s=o.inputs||[],r=-1,l=-1,c=0,p=s.length;c<p;c++){var d=s[c];this.pushTitle(d,t,!0)!==!1&&(r===-1&&(r=t.length-1),l=t.length-1)}var h=0;s.length>0&&(h=s[0].value.length),i.push({detailItem:o,detailRowCount:h})}}var u={title:t};this.getExcelContentValue(u,i,e,t);for(var f=0,g=u.title.length;f<g;f++)u.title[f]=u.title[f].split("$$xz")[0];return u},getExcelContentValue:function(e,t,i,n){var a=[];if(0===t.length){for(var o=[],s=0,r=i.length;s<r;s++)"ApplyInputString"!==i[s].type&&o.push(this.formartValue(i[s].value,i[s]));a.push(o)}else for(var l=0;l<t.length;l++)for(var c=t[l],p=c.detailItem,d=c.detailRowCount,h=0;h<d;h++){for(var u=[],f=0;f<n.length;f++)u.push(this.getExcelFieldValue(n[f],p,h,i));a.push(u)}e.content=a},formartValue:function(e,t,i){try{if("ApplyLayout"===t.type&&"1"===t.isChildForm)return t.title+""+(i+1);if("ApplyInputRadio"===t.type){var n=t.value||{};return n.value||""}if("ApplyInputCheckbox"===t.type){var a=t.value||[];a=a[i]||[];for(var o=[],s=0,r=a.length;s<r;s++)o.push(a[s].value);return o.join(",")}return e.toString()}catch(e){return""}},getExcelFieldValue:function(e,t,i,n){for(var a=e.split("$$xz")[1],o="",s=!1,r=0,l=n.length;r<l;r++){var c=n[r];if(c.id.toString()===a.toString()){o=this.formartValue(c.value,c,i),s=!0;break}}if(s===!1)for(var p=t.inputs,d=0;d<p.length;d++){var h=p[d];if(h.id.toString()===a.toString()){var u=h.value,f=u[i];o=this.formartValue(f,h,i);break}}return o},submitbtn_click:function(){var e=this,t={};if(!this.isPreview&&!this.isQrRreview){for(var i=[],n={},a=this.form.processKey,o=0,s=this.itemInstanceArr.length;o<s;o++){var r=this.itemInstanceArr[o].getConfig();if(r===!1){i=null;break}r instanceof Array?n[this.itemInstanceArr[o].id]=r:i.push(r)}if(null!==i)if("addFormMore"===e.mode)e.goAgreeAndAssign(this.processFormData(i,n));else{for(var l=[],c=0,p=this.pageview.refs.cc_line_repeat.datasource.length;c<p;c++)l.push(this.pageview.refs.cc_line_repeat.datasource[c].memberId);var d=[];if(i.forEach(function(e,t){e.crux&&e.keyFeature&&d.push(e.keyFeature)}),t="MODIFY"===e.mode?{pk_boins:this.pk_boins,instanceId:this.id,procInstName:this.procInstName,tableName:this.form.tableName||"",formData:this.processFormData(i,n),keyFeature:JSON.stringify(d)||[],mapping:this.processMapping(i)||{},keyValues:JSON.stringify(this.optionsFlow)||{}}:{formId:this.form.id,tableName:this.form.tableName||"",formName:this.form.name,processKey:a,assignInfoItems:l.join(",")||[],formData:this.processFormData(i,n),copyToUsers:l.join(",")||[],source:this.source,share:this.share||"",shareTenantId:this.shareTenantId||"",shareUserId:this.shareUserId||"",
keyFeature:JSON.stringify(d)||[],mapping:this.processMapping(i)||{},keyValues:JSON.stringify(this.optionsFlow)||{}},""!==this.form.processKey&&"freeflow"!==this.form.processKey||(t.processKey="freeflow"),this.isFreeApprove){for(var h=this.pageview.refs.approve_line_repeat.datasource,u=[],f=0,g=h.length;f<g;f++)u.push(h[f].memberId);if(0===u.length)return void this.pageview.showTip({text:"请选择审批人",duration:1200});t.nextAuditors=u.join(","),this.pageview.showLoading({text:"正在提交..."}),this.submitData(t)}else this.pageview.showLoading({text:"正在提交..."}),this.isConditionApprove?this.updateApproveLines(function(i){i.length>0?e.submitData(t):(e.pageview.hideLoading(!0),e.pageview.showTip({text:"请选择审批人员",duration:1400}))},function(){e.pageview.hideLoading(!0)}):this.submitData(t)}}},processMapping:function(e){var t={};return e.forEach(function(e){t[e.columncode]=e.fieldId}),JSON.stringify(t)},processFormData:function(e,t){var i=this,n={formData:[]};return e.forEach(function(e,t){var a=e.type;i.source&&(a=e.componentKey),"IdentifyCode"!==a?n.formData.push({name:e.columncode,type:a,value:e.value,fieldId:e.fieldId}):n.smsData=[{mobile:e.value.mobile||"",smsVerCode:e.value.smsVerCode||""}]}),n.version=this.form.version||"",n.pkValue=this.form.pkValue||"",n.tableName=this.form.tableName||"",n.pkTemp=this.form.pkTemp||"",this.autoFields.forEach(function(e,t){e.fieldId&&(e.fieldValue=$("."+e.fieldId).find("input").val())}),n.autoFields=this.autoFields,n.subFormMap=t,console.log(n),JSON.stringify(n)},submitData:function(e){var t=this,i="/process/submitForm";"MODIFY"===t.mode&&(i="/process/updateEditForm"),this.pageview.ajax({type:"POST",url:i,data:e,success:function(e){if(t.pageview.hideLoading(0===e.code),0===e.code){window.needRefresMyApproveListData=!0,window.needRefresCopyApproveListData=!0;var i=t.form.thankPageMessage;if(t.form.showThankPage&&i?t.pageview.showTip({text:i,duration:1e3}):t.pageview.showTip({text:"已提交成功",duration:1e3}),t.share)return void t.pageview.replaceGo("thanks");window.setTimeout(function(){var i=e.data[0];"NEW"===t.mode&&(i=e.data[2]),"MODIFY"===t.mode?t.pageview.replaceGo("detail",{formId:t.form.id,instId:t.id,formDataName:encodeURI(t.formName)}):t.pageview.replaceGo("detail",{formId:e.data[0],instId:e.data[2],formDataName:encodeURI(t.formName)})},1e3)}else t.pageview.showTip({text:e.msg||"操作失败!请稍后再试",duration:1e3})},error:function(e){t.pageview.hideLoading(!1),t.pageview.showTip({text:"操作失败!请稍后再试",duration:1e3})}})},loadData:function(){var e=this;this.pageview.showLoading({text:"努力加载中...",timeout:9e3,reLoadCallBack:function(){e._loadData()}}),e._loadData()},_loadData:function(){var e,i=this,n={type:"GET",error:function(e){i.pageview.hideLoading(!1)}};"NEW"===this.mode?(e=this.templateid,n.url="/form/enterform",n.data={formId:e,source:i.source,share:i.share,tenantId:i.tenantId},n.success=function(e){if(0===e.code){i.form=e.data.form,i.shareTenantId=e.data.shareTenantId||"",i.shareUserId=e.data.shareUserId||"",i.layoutData=[],i.processAuthinfo=i.form.processAuthinfo;var t=null;try{var n=e.data.formLayout.layoutDetail;t=i.source&&"string"==typeof n?JSON.parse(n).layoutDetail:n.layoutDetail,console.log(t)}catch(e){i.pageview.showTip({text:"模版结构错误！请联系管理员"})}t.forEach(function(e,t){"TableLayout"===e.componentKey?e.layoutDetail.forEach(function(e,t){e.layoutDetail.forEach(function(e,t){i.layoutData.push(e)})}):"ColumnPanel"===e.componentKey?e.layoutDetail.forEach(function(e,t){e.layoutDetail.forEach(function(e,t){i.layoutData.push(e)})}):i.layoutData.push(e)}),i.initSetApprovePersonData(i.form.processKey),i.loadSuccess(i.layoutData)}else i.isQrRreview&&i.pageview.showTip({text:"预览失败,在预览期间请勿关闭二维码,请重试!"});i.pageview.hideLoading(0===e.code)}):"MODIFY"===this.mode||"reAdd"===this.mode?(e=this.id,n.url="/form/editform",n.data={instanceId:e,source:i.source},n.success=function(e){if(0===e.code){i.layoutData=[];var n=e.data.form,a=null;i.form=n,i.pk_boins=n.pk_boins,i.subFormPk=e.data.subFormPk,a=e.data.formLayout.layoutDetail,i.processAuthinfo=i.form.processAuthinfo,a.layoutDetail&&(a=a.layoutDetail),a.forEach(function(e,t){"TableLayout"===e.componentKey?e.layoutDetail.forEach(function(e,t){e.layoutDetail.forEach(function(e,t){i.layoutData.push(e)})}):"ColumnPanel"===e.componentKey?e.layoutDetail.forEach(function(e,t){e.layoutDetail.forEach(function(e,t){i.layoutData.push(e)})}):i.layoutData.push(e)}),i.initSetApprovePersonData(i.form.processKey),i.loadSuccess(i.layoutData),i.isConditionApprove&&window.setTimeout(function(){i.updateApproveLines()},100),i.pageview.hideLoading(0===e.code)}else i.pageview.hideLoading(),i.warningDialog=new O({mode:3,wrapper:i.pageview.$el,contentText:e.msg,btnDirection:"row",className:"dialog-custom-className",buttons:[{title:"确定",style:{height:45,fontSize:16,color:t.titleColor,borderRight:"1px solid #eee"},onClick:function(){i.warningDialog.hide(),setTimeout(function(){i.pageview.goBack(-1)},800)}}]}),i.warningDialog.show()}):"addFormMore"===this.mode&&(e=this.id,n.url="/form/activityForm",n.data={formId:window._applyHistory.nodeFormID,processId:window._applyHistory.instData.processDefinitionId,activityId:window._applyHistory.instData.currentActivityId,taskId:window._applyHistory.taskId,starter:window._applyHistory.instData.startUserId,instanceId:window._applyHistory.instData.id,businessKey:window._applyHistory.instData.businessKey},n.success=function(e){if(0===e.code){i.layoutData=[],i.form=e.data.form;var t=e.data.formLayout.layoutDetail.layoutDetail;t.forEach(function(e,t){"TableLayout"===e.componentKey?e.layoutDetail.forEach(function(e,t){e.layoutDetail.forEach(function(e,t){i.layoutData.push(e)})}):"ColumnPanel"===e.componentKey?e.layoutDetail.forEach(function(e,t){e.layoutDetail.forEach(function(e,t){i.layoutData.push(e)})}):i.layoutData.push(e)}),i.initSetApprovePersonData(i.form.processKey),i.loadSuccess(i.layoutData),i.isConditionApprove&&window.setTimeout(function(){i.updateApproveLines()},100)}i.pageview.hideLoading(0===e.code)}),this.pageview.ajax(n)},loadSuccess:function(e){this.pageview.hideLoading(!0),this.createLayout(e)},createLayout:function(e){var t=this;window.setTimeout(function(){for(var e in t.itemDict)t.itemDict[e]&&t.itemDict[e].isDetail===!0&&t.itemDict[e].updateSummary(!1)},100);for(var i=this.pageview.config.components,n=0,a=e.length;n<a;n++){var o=e[n];this.addItemLayout(o,i)}i.body.root.push("approve_line_wrap"),i.body.root.push("cc_line_warp"),i.body.root.push("submitbtn"),this.pageview.delegate("statusview",function(e){e.change("body")}),this.pageview.delegate("headertitle",function(e){e.setText(t.form.name)})},dateCtlClick:function(e,t){console.log(e)},detailItemDeleteInit:function(e,t){0===e.parent.parent.config.index&&(e.config.style.display="none")},detailItemDeleteClick:function(e,i){var n=this;this.curDateInstance=i.DetailInstance,this.curDetailItem=e,this.chexiaoDialog||(this.chexiaoDialog=new O({mode:3,wrapper:this.pageview.$el,contentText:"你确定要删除该明细吗？",btnDirection:"row",buttons:[{title:"取消",style:{height:45,fontSize:16,color:t.titleColor},onClick:function(){n.chexiaoDialog.hide()}},{title:"确定",style:{height:45,fontSize:16,color:"#37b7fd"},onClick:function(){n.delDetailItem(),n.chexiaoDialog.hide()}}]})),this.chexiaoDialog.show()},delDetailItem:function(){var e=this.curDetailItem;e.rowInstance.remove();var t=e.config.titleLabel,i=e.config.titleKey;this.curDateInstance.updateSummary(!0),this.updateApproveLines(),e.rowInstance.parent.eachItem(function(e,n){n>=0&&e.delegate(i,function(e){var i=parseInt(n,10)+1;e.setText(t+"("+i+")")})})},detailItemTitleInit:function(e,t){var i=e.parent.parent.config.index;i>=0&&(i=parseInt(i,10)+1,e.config.text=e.config.text+"("+i+")")},repeatAddMoreClick:function(e,t){this.isPreview||this.isQrRreview||e.parent.addItem({})},approve_icon_init:function(e){e.config.src=t.thumbImg(e.config.src)},addSubComponent:function(e,i,c,$,O){var B=t.parseAuthInfo(this.processAuthinfo,e,this.mode,this.taskDefinitionKey);if(!B)return!1;var z,H=e.componentKey,K={plugin:this,components:i,itemData:e,root:c,repeatKey:$,DetailInstance:O,authInfo:B,form:this.form};switch(H){case"Text":z=e.textArea||e.isTextArea?new d(K):new p(K);break;case"Paragraph":z=new g(K);break;case"Hyperlink":z=new D(K);break;case"Mobile":z=new y(K);break;case"TextEditor":z=new d(K);break;case"Phone":z=new y(K);break;case"Email":z=new m(K);break;case"Precent":z=new w(K);break;case"Raty":z=new v(K);break;case"Money":z=new f(K);break;case"Number":z=new h(K);break;case"Password":z=new _(K);break;case"Date":z=new o(K);break;case"DateInterval":z=new r(K);break;case"Picture":z=new S(K);break;case"DividingLine":z=new C(K);break;case"BillMaker":z=new T(K);break;case"CodeRule":z=new k(K);break;case"Select":z=e.switcher?new I(K):e.multiselect?"Inline"===e.optionsType?new b(K):new s(K):"Inline"===e.optionsType?new x(K):new l(K);break;case"ApplyImage":z=new u(K);break;case"DataTable":z=new n(K);break;case"Reference":z=new R(K);break;case"Employee":z=new L(K);break;case"Department":z=new A(K);break;case"DateCalculate":z=new a(K);break;case"BillMakerManager":z=new E(K);break;case"BillMakerOrg":z=new P(K);break;case"File":z=new M(K);break;case"TaskComment":z=new N(K);break;case"BillMakerPost":z=new F(K);break;case"IdentifyCode":z=new W(K)}var V=e.fieldId||e.subFormId;return this.itemDict[V.toString()]=z,z},addItemLayout:function(e,t){var i=this.addSubComponent(e,t,t.body.root,null,null);i&&this.itemInstanceArr.push(i)},setFreeApprove:function(){this.isFreeApprove=!0,this.pageview.delegate("approve_line_repeat",function(e){e.$el.removeClass("displaynone")}),this.pageview.delegate("approve_line_wrap_title",function(e){e.setNextText("(点击头像可删除)")})},initSetApprovePersonData:function(e){return this.isConditionApprove=!1,"freeflow"===e||""===e?void this.setFreeApprove():void("processKey"===e?(this.pageview.delegate("approve_line_wrap",function(e){e.$el.hide()}),this.pageview.delegate("cc_line_warp",function(e){e.$el.hide()})):this.pageview.delegate("approve_line_wrap",function(e){e.$el.hide()}))},cc_line_repeat_itemclick:function(e,t){var i=e.datasource.memberId.toString();if(this.cc_select_list)for(var n=this.cc_select_list.length-1;n>=0;n--)this.cc_select_list[n].member_id.toString()===i&&this.cc_select_list.splice(n,1);e.remove()},add_cc_btn_click:function(e){if(!this.isPreview&&!this.isQrRreview){var t=this;try{window.yyesn.enterprise.selectContacts(function(e){if("0"===e.error_code){var i=e.data;t.pageview.refs.cc_line_repeat.empty(),t.cc_select_list=[];for(var n=0,a=i.length;n<a;n++){var o=i[n];t.cc_select_list.push(o),t.pageview.refs.cc_line_repeat.addItem({userName:o.name,headImgUrl:o.avatar,memberId:o.member_id})}}},{mode:1,multi:1,select_list:t.cc_select_list||[]},function(e){})}catch(e){alert(JSON.stringify(e))}}},add_approve_btn_click:function(e){if(!this.isPreview&&!this.isQrRreview){var t=this;try{window.yyesn.enterprise.selectContacts(function(e){if("0"===e.error_code){var i=e.data[0],n=t.checkSelectedPerson(i);if(n===!1)return;t.pageview.refs.approve_line_repeat.addItem({userName:i.name,headImgUrl:i.avatar,memberId:i.member_id})}},{mode:1,multi:0},function(e){})}catch(e){alert(JSON.stringify(e))}}},checkSelectedPerson:function(e){for(var t=!0,i=this.pageview.refs.approve_line_repeat.datasource,n=0,a=i.length;n<a;n++){var o=i[n];if(o.memberId.toString()===e.member_id.toString()){this.pageview.showTip({text:"不能添加重复的审批人!",duration:1200}),t=!1;break}}return t},showDefaultApprveLineWhenHasCondition:function(){this.pageview.delegate("approve_line_wrap_title",function(e){e.setNextText("(审批人已由管理员内置)"),e.$el.removeClass("displaynone")})},approve_line_loadingtext_click:function(e,t){var i=e.getText();i.indexOf("加载")>=0&&this.loadApprovePerson()},getItemInstanceById:function(e){return this.itemDict[e.toString()]},updateApproveLines:function(e,t){if(!this.isPreview&&!this.isQrRreview){return this.conditionItemInstance||this.isConditionApprove!==!0?void(this.loadApprovePersonTimeID&&window.clearTimeout(this.loadApprovePersonTimeID)):void this.pageview.showTip({text:"本单据审批流程错误!请联系管理员配置修改"})}},loadApprovePerson:function(e,t,i){var n=this;this.pageview.delegate("approve_line_loadingtext",function(e){e.setText(""),e.showLoading()});var a={type:"GET",url:"/formdata/member",data:{ftid:this.templateid},success:function(e){n.pageview.delegate("approve_line_loadingtext",function(a){a.hideLoading(),0===e.code?(n.pageview.delegate("approve_line_repeat",function(t){t.$el.removeClass("displaynone"),0===e.data.length?(n.isFreeApprove=!0,t.bindData([]),t.showOrHideSubComponent(!0),n.pageview.delegate("approve_line_wrap_title",function(e){e.$el.removeClass("displaynone"),e.setNextText("(点击头像可删除)")})):(n.pageview.delegate("approve_line_wrap_title",function(e){e.setNextText("(审批人已由管理员内置)"),e.$el.removeClass("displaynone")}),window.setTimeout(function(){t.showOrHideSubComponent(!1)},60),t.bindData(e.data))}),t&&t(e.data)):(a.setText("审批人获取失败,点击重新加载"),n.pageview.delegate("approve_line_wrap_title",function(e){e.$el.addClass("displaynone")}),i&&i())})},error:function(e){i&&i(),n.pageview.delegate("approve_line_loadingtext",function(e){e.hideLoading(),e.setText("审批人获取失败,点击重新加载"),n.pageview.delegate("approve_line_wrap_title",function(e){e.$el.addClass("displaynone")})})}};this.isConditionApprove===!0&&(a.data.condition=e),this.pageview.ajax(a)},goAgreeAndAssign:function(e){var i=this,n=window._applyHistory.instData.processDefinitionId,a=window._applyHistory.taskId,o=window._applyHistory.instData.id,s=window._applyHistory.instData.businessKey;window.localStorage.setItem(t.ADDITIONAL_FORM_DATA,e),this.pageview.showLoading({text:"努力加载中...",timeout:8e3}),this.pageview.ajax({url:"process/assignCheck",type:"GET",data:{taskId:a},success:function(e){i.pageview.hideLoading(!0),e.success?e.data.assignAble?(window.localStorage.setItem("ASSIGN_CHECK_DATA",JSON.stringify(e)),i.pageview.go("deal",{type:3,instanceId:o,processId:n,taskId:a,isAdd:!0,formName:i.form.name})):i.pageview.go("deal",{type:1,instanceId:o,processId:n,taskId:a,businessKey:s,isAdd:!0,formName:i.form.name}):i.pageview.showTip({text:e.msg,duration:1e3})},error:function(e){console.error("指派检查失败")}})},cc_line_warp_init:function(e){"addFormMore"!==this.mode&&"MODIFY"!==this.mode||e.$el.hide()},headerview_init:function(e){this.share?e.config.style.display="flex":e.config.style.display="none"},headertitle_init:function(e){},headerpadding_init:function(e){this.share?e.config.style.display="flex":e.config.style.display="none"}},B}),define("pages/form",["../logic/form","../parts/common","utils"],function(e,t,i){var n={pluginClass:e,style:{backgroundColor:t.backColor,overflow:"auto"},root:["headerview","headerpadding","statusview"],components:{headerview:{type:"view",ref:!0,className:"bottom-half-line",style:{height:44,backgroundColor:"#fff",position:"fixed",top:0,left:0,right:0,zIndex:12},root:["headertitle"]},headertitle:{type:"text",ref:!0,style:{height:"100%",justifyContent:"center",fontSize:16},text:""},headerpadding:{type:"view",ref:!0,style:{height:44}},statusview:{ref:!0,type:"statusview"},body:{type:"view",style:{flexDirction:"column",width:"100%",paddingBottom:20},root:[]},cc_line_warp:{type:"view",ref:!0,style:{backgroundColor:"#fff",marginTop:10},root:["cc_line_title","cc_line_repeat"]},cc_line_title:{type:"text",text:"抄送人",nextText:"",style:{marginTop:10,paddingBottom:10,color:"333333",fontSize:14,marginLeft:14},nextTextStyle:{color:"#999"}},cc_line_repeat:{type:"repeat",className:"line-repeat",ref:!0,style:{minHeight:80,flexWrap:"wrap",paddingLeft:6,paddingBottom:10,flexDirection:"row"},subComponent:"add_cc_btn",itemStyle:{width:50},root:["cc_icon"]},cc_icon:{type:"icon",style:{paddingTop:10,zIndex:10},iconStyle:{w:32,backgroundColor:"#eee",borderRadius:"100%",overflow:"hidden"},textStyle:{marginTop:3,color:"#999999",fontSize:12},title_bind:"userName",src_bind:"headImgUrl",text_bind:"userName",textPos:"bottom"},add_cc_btn:{type:"image",src:"./imgs/addapprove.png",style:{w:32,marginTop:9,marginLeft:9,backgroundColor:"#fff"}},approve_line_wrap:{type:"view",ref:!0,style:{backgroundColor:"#fff",marginTop:10},root:["approve_line_topview","approve_line_repeat"]},approve_line_topview:{type:"view",style:{flexDirection:"row"},root:["approve_line_loadingtext","approve_line_wrap_title"]},approve_line_loadingtext:{type:"text",ref:!0,textStyle:{fontSize:14,color:"red"},style:{paddingTop:10,paddingBottom:10,marginLeft:13},text:""},approve_line_wrap_title:{type:"text",ref:!0,text:"审批人",style:{marginTop:10,paddingBottom:10,color:"333333",fontSize:14},nextTextStyle:{color:"#999"},nextText:""},approve_line_repeat:{type:"repeat",ref:!0,className:"line-repeat displaynone",style:{minHeight:80,flexWrap:"wrap",paddingLeft:2,paddingBottom:10,flexDirection:"row"},subComponent:"add_approve_btn",itemStyle:{width:50},root:["approve_icon","repeat_line"]},repeat_line:{type:"view",style:{position:"absolute",top:24,height:2,backgroundColor:"#eee",left:0,right:0,zIndex:2}},approve_icon:{type:"icon",style:{paddingTop:10,zIndex:10},iconStyle:{w:32,backgroundColor:"#eee",borderRadius:"100%",overflow:"hidden"},textStyle:{marginTop:3,color:"#999999",fontSize:12},title_bind:"userName",src_bind:"headImgUrl",text_bind:"userName",textPos:"bottom"},add_approve_btn:{type:"image",src:"./imgs/addapprove.png",style:{w:32,marginTop:9,marginLeft:9,backgroundColor:"#fff"}},submitbtn:{type:"button",title:"提交",mode:2,style:{height:44,width:345,margin:"15 auto",fontSize:16,backgroundColor:"#29b6f6"}}}};return n}),define("logic/formAttachment",["../parts/common","utils","../../../components/dialog"],function(e,t,i){function n(e){this.pageview=e.pageview,this._taskId=this.pageview.params.formId,this.parentThis=this.pageview.viewpagerParams.parent,this.format={"application/msword":{ext:"word.png"},"application/pdf":{ext:"pdf.png"},"application/pgp-signature":{ext:"other.png"},"application/postscript":{ext:"other.png"},"application/rtf":{ext:"other.png"},"application/vnd.ms-excel":{ext:"exc.png"},"application/vnd.ms-powerpoint":{ext:"ppt.png"},"application/zip":{ext:"zipfile.png"},"application/x-shockwave-flash":{ext:"other.png"},"application/vnd.openxmlformats-officedocument.wordprocessingml.document":{ext:"word.png"},"application/vnd.openxmlformats-officedocument.wordprocessingml.template":{ext:"word.png"},"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":{ext:"exc.png"},"application/vnd.openxmlformats-officedocument.presentationml.presentation":{ext:"ppt.png"},"application/vnd.openxmlformats-officedocument.presentationml.template":{ext:"other.png"},"application/vnd.openxmlformats-officedocument.presentationml.slideshow":{ext:"other.png"},"application/x-javascript":{ext:"other.png"},"application/json":{ext:"other.png"},"audio/mpeg":{ext:"other.png"},"audio/x-wav":{ext:"music.png"},"audio/x-m4a":{ext:"music.png"},"audio/ogg":{ext:"music.png"},"audio/aiff":{ext:"other.png"},"audio/flac":{ext:"other.png"},"audio/aac":{ext:"other.png"},"audio/ac3":{ext:"other.png"},"audio/x-ms-wma":{ext:"other.png"},"image/bmp":{ext:"pic.png"},"image/gif":{ext:"pic.png"},"image/jpeg":{ext:"pic.png"},"image/photoshop":{ext:"other.png"},"image/png":{ext:"pic.png"},"image/svg+xml":{ext:"other.png"},"image/tiff":{ext:"other.png"},"text/plain":{ext:"text.png"},"text/html":{ext:"other.png"},"text/css":{ext:"other.png"},"text/csv":{ext:"other.png"},"text/rtf":{ext:"other.png"},"video/mpeg":{ext:"video.png"},"video/quicktime":{ext:"video.png"},"video/mp4":{ext:"video.png"},"video/x-m4v":{ext:"video.png"},"video/x-flv":{ext:"video.png"},"video/x-ms-wmv":{ext:"video.png"},"video/avi":{ext:"video.png"},"video/webm":{ext:"video.png"},"video/3gpp":{ext:"video.png"},"video/3gpp2":{ext:"video.png"},"video/vnd.rn-realvideo":{ext:"video.png"},"video/ogg":{ext:"video.png"},"video/x-matroska":{ext:"video.png"},"application/vnd.oasis.opendocument.formula-template":{ext:"other.png"},"application/octet-stream":{ext:"other.png"},unknow:{ext:"other.png"}},this.loadData()}return n.prototype={loadData:function(){var e=this;this.applyHistory=window._applyHistory,this.pageview.showLoading({text:"努力加载中...",timeout:8e3,reLoadCallBack:function(){e._loadData()}}),e._loadData()},_loadData:function(){var e=this,t={url:"/process/getTaskAttachments",type:"POST",data:{taskId:this._taskId||""},success:function(t){e.pageview.hideLoading(!0),e.pageview.delegate("flow_repeat",function(e){e.bindData(t.data)})},error:function(e){}};this.pageview.ajax(t)},format_image_init:function(e,t){var i=e.datasource.type||"unknow";i.indexOf("image")>-1?e.config.src=e.datasource.aliOSSLimitUrl:e.config.src="./imgs/"+(this.format[e.datasource.type]?this.format[e.datasource.type].ext:this.format.unknow.ext)},atta_contributor_init:function(e,t){this.applyHistory=window._applyHistory,this.applyHistory.currentUserId===e.datasource.userId&&this.applyHistory.instData.historicActivityInstances.forEach(function(t,i){t.assignee===e.datasource.userId&&(e.config.style.display="block")})},file_size_init:function(e,t){var i=e.config.text;e.config.text=i+e.datasource.author},atta_contributor_click:function(t,n){var a=this;a.deleteDialog=new i({mode:3,wrapper:a.parentThis.pageview.$el,contentText:"确定要删除该附件吗?",btnDirection:"row",buttons:[{title:"取消",style:{height:45,fontSize:16,color:e.titleColor,borderRight:"1px solid #eee"},onClick:function(){a.deleteDialog.hide()}},{title:"确定",style:{height:45,fontSize:16,color:"#37b7fd"},onClick:function(){a.deleteDialog.hide(),a.pageview.showLoading({text:"删除中...",timeout:8e3}),a.parentThis.fileUploader.deleteServerUploadImage(t.datasource.id,function(e){a.pageview.hideLoading(!0),t.rowInstance.remove(),a.pageview.showTip({text:"删除成功",duration:1e3})},function(){a.pageview.hideLoading(!0),a.pageview.showTip({text:"删除失败，请稍后重试",duration:1e3})})}}]}),a.deleteDialog.show()},title_view_init:function(e,t){var i=e.datasource.name.split("_"),n=i[i.length-1];e.config.text=n},flow_repeat_itemclick:function(e,t){var i=e.datasource.type,n=e.datasource.name.split("_"),a=n[n.length-1];if(i.indexOf("image")>-1)try{window.yyesn.client.viewImage({files:e.datasource.aliOSSUrl})}catch(e){}else{var o=window.location.origin,s=o+"/approve-app/file/downloadattachment/";this.downloadFile(a,s+e.datasource.id)}},downloadFile:function(e,t){return window.open(t),!1},atta_time_init:function(e,i){e.config.text=t.timestampToTimeStr(e.datasource.time)}},n}),define("pages/formAttachment",["../logic/formAttachment","../parts/common","utils"],function(e,t,i){var n={pluginClass:e,style:{backgroundColor:"#F7F7F7"},root:["flow_repeat"],components:{flow_repeat:{type:"repeat",ref:!0,style:{marginTop:10,background:"#F7F7F7",flexDirection:"column",paddingBottom:20},itemStyle:{flexDirection:"row",background:"#fff",height:65,borderBottom:"solid 1px #EDEDED"},nodata:"list_nodata",root:["flow_view"]},list_nodata:{type:"view",root:["list_nodata_img","list_nodata_text"],style:{justifyContent:"center",alignItems:"center",height:300}},list_nodata_img:{type:"image",src:"./imgs/yunshen_nodata.png",style:{w:80,h:80,background:"#f7f7f7",marginBottom:14}},list_nodata_text:{type:"text",text:"暂无内容",style:{fontSize:14,color:"#adadad"}},flow_view:{type:"view",root:["flow_left","flow_middle","flow_right"],style:{flexDirection:"row",flex:1,alignItems:"center",justifyContent:"center"}},flow_left:{type:"view",style:{width:40,justifyContent:"center",display:"flex",height:"100%",marginLeft:12,marginRight:14},root:["format_image"]},format_image:{type:"image",src:"./imgs/exc.png",ref:!0,style:{borderRadius:4}},flow_middle:{type:"view",style:{flex:1,justifyContent:"center"},root:["title_view","file_size"]},title_view:{type:"text",text_bind:"name",numberofline:1,style:{fontSize:16,color:"#262626",display:"block",overflow:"hidden",textOverflow:"ellipsis",paddingBottom:2}},file_size:{type:"text",text:"贡献者：",style:{fontSize:13,color:"#9E9E9E"}},flow_right:{type:"view",style:{width:120,flexDirection:"column",alignItems:"flex-end",justifyContent:"center",paddingRight:12},root:["atta_time","atta_contributor"]},atta_time:{type:"text",text:"00:00",style:{fontSize:13,paddingBottom:3}},atta_contributor:{type:"text",text:"删除",style:{display:"none",fontSize:13,color:"#0093ff"}}}};return n}),define("logic/help",[],function(){function e(e){this.pageview=e.pageview,this.setHeader()}return e.prototype={onPageResume:function(){this.setHeader()},setHeader:function(){try{window.yyesn.client.setHeader(function(){},{type:2,title:"帮助",rightTitle:"",rightValues:[]},function(e){})}catch(e){}},list_itemclick:function(e,t){0===t.index?this.pageview.go("initiationApproval"):1===t.index?this.pageview.go("additionApproval"):2===t.index?this.pageview.go("setApprovers"):this.pageview.go("detailComponent")}},e}),define("pages/help",["../logic/help","../parts/common","utils"],function(e,t,i){var n={pluginClass:e,style:{backgroundColor:t.backColor},root:["body"],components:{body:{type:"view",style:{flex:1,overflowY:"auto",overflowX:"hidden"},root:["list"]},list:{type:"repeat",itemStyle:{height:50},style:{flexDirection:"column",backgroundColor:"#fff"},items:[{label:"如何发起审批？"},{label:"如何添加审批模板？"},{label:"如何设置审批流程？"},{label:"什么是明细组件？"}],root:["view"]},view:{type:"view",style:{borderBottom:"solid 1px #eee",marginLeft:20,height:50,lineHeight:50,flexDirection:"row",justifyContent:"space-between"},root:["label","icon"]},label:{type:"text",text_bind:"label",style:{color:"#333",fontSize:15}},icon:{type:"icon",font:"icomoon_e913",style:{marginRight:20,color:"#bbb",fontSize:15}}}};return n}),define("logic/index",["../parts/common","utils","../../../components/dialog"],function(e,t,i){function n(e){this.countNum=0,this.toBeApproveNum=0,this.myApproveNum=0,this.copy2MeNum=0,this.pageview=e.pageview,this.loadNum(),this.loadData(),this.setHeader(),this.getUserInfo()}return n.prototype={onPageResume:function(){this.loadNum(),this.setHeader()},getUserInfo:function(){this.pageview.ajax({url:"/user/getMeInfo",type:"GET",success:function(e){e.success&&(window.currentUserInfo=e.data)}})},setHeader:function(){var e=this;try{window.yyesn.client.setHeader(function(){},{type:2,title:"审批",rightTitle:"帮助",rightValues:[{key:"submit",value:"帮助"}]},function(t){t.registerHandler("submit",function(t,i){e.pageview.go("help")})})}catch(e){}},loadNum:function(){var e=this;this.pageview.ajax({type:"POST",url:"/process/myDataCount",data:{},success:function(t){if(t.success===!0){var i=t.data;e.toBeApproveNum=parseInt(i.todo),e.myApproveNum=parseInt(i.running),e.copy2MeNum=parseInt(i.copyTo),e.pageview.delegate("waitme_approve_icon",function(t){var i=e.toBeApproveNum>99?"99+":e.toBeApproveNum;t.setBadge(i,{backgroundColor:"#F66C6C",right:"-15px",top:"-10px"})}),e.pageview.delegate("my_approve_icon",function(t){0===e.myApproveNum&&t.$el.find(".yy-icon-img img").attr("src","./imgs/yunshen_applied_finish.png?v=1")}),e.pageview.delegate("copy_approve_icon",function(t){var i=e.copy2MeNum>99?"99+":e.copy2MeNum;t.setBadge(i,{backgroundColor:"#F66C6C",right:"-8px",top:"-10px"})})}},error:function(e){}})},loadData:function(){var e=this;this.pageview.showLoading({text:"努力加载中...",timeout:9e3,reLoadCallBack:function(){e._loadData()}}),e._loadData()},_loadData:function(){var e=this;this.pageview.ajax({url:"/form/listForm",type:"POST",data:{size:"20",start:"0"},success:function(t){e._loadSuccess(t.data)},error:function(t){e.pageview.showTip({text:t.msg,duration:1e3})}})},_loadSuccess:function(e){this.pageview.hideLoading(!0),e&&0!==e.list.length?this.pageview.delegate("more_template_end",function(e){e.$el.css({display:""})}):e={list:[]};var t=e.list;this.pageview.delegate("app_repeat",function(e){e.bindData(t)})},app_repeat_itemclick:function(e,t){var i=e.datasource.title,n=e.datasource.formId,a=e.datasource.source,o="NEW";null!==i&&void 0!==i?this.pageview.go("form",{templateid:n,title:encodeURI(i),source:a,formType:o}):e.$el.addClass("no-result")},app_repeat_iteminit:function(e,t){var i=e.datasource.name;null!==i&&void 0!==i||e.$el.addClass("no-result")},onPageBeforeLeave:function(e,t){if(t.isForward!==!0)return window.yyesn.client.closePage(),!1},topview_left_click:function(){window.pageViewTitle=null,this.pageview.go("waitmeapprove",{type:"waitmeapprove",countNum:this.toBeApproveNum})},topview_middle_click:function(){this.pageview.go("myapprove",{type:"myapprove",countNum:this.myApproveNum})},topview_right_click:function(){this.pageview.go("commonlist",{type:"copyapprove",countNum:this.copy2MeNum})},more_template_end_click:function(e){var t=this;this.pageview.ajax({url:"/user/isAdmin",type:"POST",data:{},success:function(e){if(e.success===!0){var i=!!e.data;t.pageview.go("moreTemplate",{isAdmin:i})}}})},app_repeat_icon_init:function(e,t){e.datasource.c=e.datasource.icon||"icon-1",e.config.src="./imgs/"+e.datasource.c+".png"},app_repeat_introduce_init:function(e,t){e.datasource.desc||(e.config.style.display="none")}},n}),define("pages/index",["../logic/index","../parts/common","utils"],function(e,t,i){var n={pluginClass:e,style:{backgroundColor:t.backColor},root:["topfixed","bottomview"],components:{topfixed:{type:"view",style:{width:"100%",position:"absolute",zIndex:"11",backgroundColor:"#f7f7f7",flexDirection:"column"},root:["topview","topfixedbar"]},topfixedbar:{type:"view",style:{height:"10px"}},topview:{type:"view",style:{height:105,backgroundColor:"#fff",flexDirection:"row",width:"100%"},root:["topview_left","topview_middle","topview_right"]},topview_left:{type:"view",style:{paddingTop:8,flex:1,justifyContent:"center",alignItems:"center",flexDirection:"row"},root:["waitme_approve_icon","first_split_line"]},waitme_approve_icon:{type:"icon",ref:!0,src:"./imgs/yunshen_approving.png?v=1",text:"待审批",textPos:"bottom",textStyle:{fontSize:"13px",color:"#666"},iconStyle:{w:25,marginBottom:8,boderRight:"1px solid #EDEDED"}},first_split_line:{type:"view",className:"right-half-line",style:{position:"absolute",top:"40px",right:"0px",width:"1px",height:"25px",alineItems:"center"}},topview_middle:{type:"view",style:{paddingTop:8,flex:1,justifyContent:"center",alignItems:"center"},root:["my_approve_icon","second_split_line"]},my_approve_icon:{type:"icon",ref:"true",src:"./imgs/yunshen_applied_yet.png?v=1",text:"我发起的",textPos:"bottom",textStyle:{fontSize:"13px",color:"#666"},iconStyle:{marginBottom:8,w:25}},second_split_line:{type:"view",className:"right-half-line",style:{width:"1px",height:"25px",position:"absolute",right:"0px",top:"40px"}},topview_right:{type:"view",style:{paddingTop:8,flex:1,justifyContent:"center",alignItems:"center"},root:["copy_approve_icon"]},copy_approve_icon:{type:"icon",ref:!0,src:"./imgs/yunshen_copy2me.png?v=1",text:"抄送我的",textPos:"bottom",textStyle:{fontSize:"13px",color:"#666"},iconStyle:{marginBottom:8,w:25}},bottomview:{type:"view",style:{position:"absolute",top:115,bottom:0,left:0,right:0,overflowY:"auto"},root:["app_repeat"]},app_repeat:{type:"repeat",ref:!0,className:"app-repeat index-repeat-item",itemClassName:"bottom-half-line right-half-line-before",subComponent:"more_template_end",nodata:"app_repeat_nodata",style:{flexWrap:"wrap"},itemStyle:{width:"33.3%",height:110,justifyContent:"center",alignItems:"center",padding:"0 10px 0 10px",background:"#fff"},root:["app_repeat_icon"]},app_repeat_nodata:{ref:"true",type:"icon",text:"暂无内容",textPos:"bottom",src:"./imgs/yunshen_nodata.png?v=1",textStyle:{fontSize:"15px",color:"#ADADAD",paddingLeft:11,paddingTop:10},style:{width:"100%",alineItems:"center",justifyContent:"center",backgroundColor:"#F7F7F7",paddingTop:180},iconStyle:{w:80,h:80}},app_repeat_icon:{type:"icon",font:"",ref:!0,className:"icon",iconStyle:{w:30},textStyle:{fontSize:"13px",color:"#666",marginTop:9},text_bind:"title",textPos:"bottom"},more_template_end:{type:"icon",src:"./imgs/more-btn.png",text:"更多",ref:!0,className:"icon form-row",iconStyle:{w:30},textStyle:{fontSize:"13px",color:"#666",marginTop:9},style:{display:"none",width:"33.3%",height:110,justifyContent:"center",alignItems:"center",borderBottom:"1px solid #eee",borderRight:"1px solid #eee",padding:"0 6px 0 6px",background:"#fff"},textPos:"bottom"}}};return n;
}),define("pages/initiationApproval",["../logic/additionApproval","../parts/common","utils"],function(e,t,i){var n={pluginClass:e,style:{backgroundColor:t.backColor,overflow:"auto"},root:["body"],components:{body:{type:"view",style:{padding:15,color:"#999"},root:["title","titleLable","contentText","contentImage","contentText1","contentImage1","contentText2","contentImage2","contentText3","contentImage3","contentText4","imageView","contentText5","contentImage6"]},title:{type:"text",text:"如何发起审批",style:{fontSize:17,color:"#000",margin:"auto",fontWeight:"bold"}},titleLable:{type:"text",text:"进入移动端审批应用之后，如何发起审批呢，下面来看看吧。",style:{fontSize:14,marginTop:15}},contentText:{type:"text",text:"1、点击你想创建的审批类型，比方说订货申请单。",style:{fontSize:14,margin:"15px 0"}},contentText1:{type:"text",text:"2、进入单据详情，输入相关内容。如果有提示必填，则必须填写该项才可提交；单据内如果有明细，则可以多条明细一起提交；如果管理员未设置审批人则需要自己选择审批人哦，未选择审批人也不可以提交审批单据。",style:{fontSize:14,margin:"15px 0"}},contentText2:{type:"text",text:"3、提交成功之后，就坐等审批结果吧，不论是审批通过或者审批拒绝，该条审批单据都算是完成了，如果需要重新提交，我们也有相应的快速提交入口哦，点击重新提交，读取已经填写的内容，你可以直接修改在此提交。",style:{fontSize:14,margin:"15px 0"}},contentText3:{type:"text",text:"4、如果提交时输入错误，可以撤销重新提交哦，所以发生错误的时候也不要太紧张。",style:{fontSize:14,margin:"15px 0"}},contentText4:{type:"text",text:"5、审批同意，审批拒绝都会有消息提示，随时随地了解自己审批的进程。",style:{fontSize:14,margin:"15px 0"}},contentText5:{type:"text",text:"6、对于审批人，可以通过“待我审批”查看需要审批的单据，分类清晰，提高工作效率。",style:{fontSize:14,margin:"15px 0"}},contentImage:{type:"image",src:"./imgs/help/4.1.png",style:{margin:"auto"}},contentImage1:{type:"image",src:"./imgs/help/4.2.png",style:{margin:"auto"}},contentImage2:{type:"image",src:"./imgs/help/4.3.png",style:{margin:"auto"}},contentImage3:{type:"image",src:"./imgs/help/4.4.png",style:{margin:"auto"}},imageView:{type:"view",style:{textAlign:"center"},root:["contentImage4","contentImage5"]},contentImage4:{type:"image",src:"./imgs/help/4.5.png",style:{display:"inline-block"}},contentImage5:{type:"image",src:"./imgs/help/4.6.png",style:{marginLeft:10,display:"inline-block"}},contentImage6:{type:"image",src:"./imgs/help/4.7.png",style:{margin:"auto"}}}};return n}),define("logic/moreTemplate",["../parts/common","utils","../../../components/dialog"],function(e,t,i){function n(e){this.pageview=e.pageview,this.isAdmin="true"===this.pageview.params.isAdmin||!1,this.inAdmin="true"===this.pageview.params.inAdmin||!1,this.setHeader()}return n.prototype={onPageResume:function(){"adminMoreTemplate"===this.goWhere&&(this.inAdmin=!1,this.body_pulltorefresh()),this.setHeader()},setHeader:function(e){var t=this,i="";this.isAdmin&&!this.inAdmin?i="管理":this.isAdmin&&this.inAdmin&&(i="完成");try{window.yyesn.client.setHeader(function(){},{type:2,title:"更多",rightTitle:i,rightValues:[{key:"submit",value:i}]},function(e){e.registerHandler("submit",function(e,i){t.inAdmin?(t.inAdmin=!t.inAdmin,t.pageview.goBack()):(t.goWhere="adminMoreTemplate",t.inAdmin=!t.inAdmin,t.pageview.go("moreTemplate",{inAdmin:t.inAdmin,isAdmin:t.isAdmin}))})})}catch(e){}},body_init:function(e){this.body=e},main_view_init:function(e){var t=this;t.listviewSender=e,this.start=new Date,e.config.ajaxConfig={url:"/form/moreListForm",type:"POST",pageSize:1,pageNumKey:"pageNum",data:{pageNum:1,start:0,size:100,isManager:t.inAdmin?"true":"false"}},e.config.autoLoadData=!0},body_loadmore:function(e,t){var i=this.pageview.refs.main_view.ajaxConfig.data.size,n=this.pageview.refs.main_view.ajaxConfig.data.start,a=i+n;this.pageview.refs.main_view.ajaxConfig.data.start=a,this.pageview.refs.main_view.ajaxConfig.data.pageNum++,this.pageview.refs.main_view.setAjaxConfigParams(),this.pageview.refs.main_view.loadNextPageData()},body_pulltorefresh:function(e,t){this.pageview.refs.main_view.ajaxConfig.data.start=0,this.pageview.refs.main_view.ajaxConfig.data.pageNum=1,this.pageview.refs.main_view.setAjaxConfigParams(),this.pageview.refs.main_view.loadFirstPageData()},main_view_parsedata:function(e,t){var i=t.data;return i.success===!0&&(i.data||(i.data={list:[]}),0===i.data.list.length,i.data.list)},main_view_afterload:function(e,t){var i=e.rows.length;t.isFirstLoad===!1&&t.data.length>0&&e.rows[i-1].datasource.formList[0].categoryId===t.data[0].formList[0].categoryId&&e.$el.find(".template_item_title").last().css("display","none")},right_btn_click:function(t,n){var a=this;"true"===t.datasource.phoneEnabled?(a.phoneEnabledDialog=new i({mode:3,wrapper:a.pageview.$el,contentText:"你确定要停用此表单吗？",btnDirection:"row",buttons:[{title:"取消",style:{height:45,fontSize:16,color:e.titleColor,borderRight:"1px solid #eee"},onClick:function(){a.phoneEnabledDialog.hide()}},{title:"确定",style:{height:45,fontSize:16,color:"#37b7fd"},onClick:function(){a.phoneEnabledDialog.hide(),a.change_state(t,n)}}]}),a.phoneEnabledDialog.show()):a.change_state(t,n)},change_state:function(e,t){var i=this,n=e,a=e.datasource.formId,o=e.datasource.code,s=e.datasource.title,r=e.datasource.phoneEnabled,l="";l="true"===r?"false":"true";var c="true"===l?"启用中...":"停用中...";this.pageview.showLoading({text:c}),i.pageview.ajax({url:"/user/getToken",type:"POST",data:{},success:function(e){if(e.success===!0){var t=e.data.token;this.pageviewInstance.params.token=t,i.pageview.ajax({url:"/form/updateTemplate",type:"POST",data:{formId:a,formCode:o,formName:s,newState:l,token:t},success:function(e){i.pageview.hideLoading(),e.success===!0&&("true"===l?(n.$el.css({transform:"rotateY(0deg) translateZ(0)","-webkit-transform":"rotateY(0deg) translateZ(0)"}),n.datasource.phoneEnabled="true"):(n.$el.css({transform:"rotateY(180deg) translateZ(0)","-webkit-transform":"rotateY(180deg) translateZ(0)"}),n.datasource.phoneEnabled="false"))},error:function(e){i.pageview.showTip({text:e.msg,duration:1e3})}})}else e.success===!1&&i.pageview.showTip({text:e.msg,duration:1e3})},error:function(e){i.pageview.showTip({text:e.msg,duration:1e3})}})},template_item_click:function(e,t){var i=this;if(i.inAdmin)return!1;var n=e.datasource.title,a=e.datasource.formId,o=e.datasource.source,s=(e.datasource.type,"NEW");null!==n&&void 0!==n?(this.goWhere="form",this.pageview.go("form",{templateid:a,title:encodeURI(n),formType:s,source:o})):e.$el.addClass("no-result")},template_item_icon_init:function(e,t){e.config.src="./imgs/"+(e.datasource.icon?e.datasource.icon:"icon-1")+".png"},searchBtn_click:function(e,t){this.pageview.refs.main_view.$el.hide(),this.pageview.refs.searchInput.$el.show(),this.pageview.refs.searchInput._focus(),this.pageview.refs.approveSelector.hideDropDown()},searchInput_cancel:function(e,t){var i=t.value;i&&(e.input.val(""),this.listviewSender.config.ajaxConfig.data.keyword="",this.pageview.refs.main_view.loadFirstPageData({parentAnimate:!0})),this.pageview.refs.main_view.$el.show()},searchInput_search:function(e,t){this.listviewSender.config.ajaxConfig.data.keyword=t.value,this.pageview.refs.main_view.loadFirstPageData({parentAnimate:!0})},template_item_repeat_init:function(e,t){if(e.datasource&&e.datasource.formList){var i=e.datasource&&e.datasource.formList.length;if(i%3!==0)for(var n=3-i%3,a=0;a<n;a++)e.datasource.formList.push({type:"forEmptyCss"})}},template_item_init:function(e,t){e.datasource.type&&"forEmptyCss"===e.datasource.type&&(e.config.style.display="none")},right_btn_container_init:function(e,t){this.inAdmin&&(e.config.style.display="")},right_btn_init:function(e,t){var i="false"!==e.datasource.phoneEnabled;this.inAdmin&&(e.config.style.transition="0.6s",e.config.style.transformStyle="preserve-3d",e.config.style["-webkit-transform-style"]="preserve-3d",i||(e.config.style.transform="rotateY(180deg) translateZ(0)",e.config.style["-webkit-transform"]="rotateY(180deg) translateZ(0)"))},right_btn_front_init:function(e,t){"false"!==e.datasource.phoneEnabled;this.inAdmin&&(e.config.style.backfaceVisibility="hidden",e.config.style["-webkit-backface-visibility"]="hidden")},right_btn_back_init:function(e,t){"false"!==e.datasource.phoneEnabled;this.inAdmin&&(e.config.style.backfaceVisibility="hidden",e.config.style["-webkit-backface-visibility"]="hidden",e.config.style.transform="rotateY(180deg) translateZ(0)",e.config.style["-webkit-transform"]="rotateY(180deg) translateZ(0)")}},n}),define("pages/moreTemplate",["../logic/moreTemplate","../parts/common","utils"],function(e,t,i){var n={pluginClass:e,style:{backgroundColor:t.backColor,overflowY:"auto"},root:["body"],components:{body:{type:"view",style:{flex:1,overflowY:"auto",overflowX:"hidden"},root:["searchInput","main_view"]},manageBtn:{type:"button",title:"管理",style:{width:50,height:20}},searchInput:{cancelBtnStyle:{color:"#37B7FD",fontSize:15},style:{backgroundColor:"#fff"},iconStyle:{},placeholder:"搜索标题",font:"ap_e903",ref:!0,type:"simplesearchview"},nodata:{ref:"true",type:"icon",text:"暂无内容",textPos:"bottom",src:"./imgs/yunshen_nodata.png?v=1",textStyle:{fontSize:"15px",color:"#ADADAD",paddingLeft:11,paddingTop:10},style:{width:"100%",alineItems:"center",justifyContent:"center",backgroundColor:"#F7F7F7",paddingTop:180},iconStyle:{w:80,h:80}},main_view:{type:"listview",nodata:"nodata",ref:!0,style:{fontSize:16,color:"#262626",flexWrap:"wrap",flexDirection:"column"},rowStyle:{width:"100%",height:"100%"},root:["template_item_title","template_item_repeat"]},template_item_title:{type:"text",ref:!0,text_bind:"category",textStyle:{fontSize:13,color:"#9E9E9E"},style:{width:"100%",height:"25px",padding:"6px 0 22px 12px",backgroundColor:"#F7F7F7",display:"block"}},template_item_repeat:{type:"repeat",style:{flexWrap:"wrap"},ref:!0,items_bind:"formList",itemClassName:"bottom-half-line right-half-line-before",itemStyle:{width:"33.3%",height:120,justifyContent:"center",alignItems:"center",padding:"0 10px 0 10px",backgroundColor:"#fff"},root:["template_item"]},template_item:{type:"view",style:{width:"100%",height:"100%",justifyContent:"center",alignItems:"center",background:"#fff"},root:["template_item_icon","right_btn_container"]},template_item_icon:{type:"icon",src_bind:"icon",text_bind:"title",textPos:"bottom",iconStyle:{w:30},textStyle:{fontSize:"13px",color:"#666",marginTop:9}},right_btn_container:{type:"view",ref:!0,style:{perspective:1e3,display:"none",position:"absolute",top:"8px",right:"-2px",width:"22px",height:"22px"},root:["right_btn"]},right_btn:{type:"view",ref:!0,style:{position:"relative",height:"100%",width:"100%"},root:["right_btn_front","right_btn_back"]},right_btn_front:{type:"icon",font:"cap_e90a",ref:!0,style:{position:"absolute",height:"100%",width:"100%",top:0,left:0,color:"#FC615D"},iconStyle:{fontSize:"18px"}},right_btn_back:{type:"icon",font:"cap_e90a",ref:!0,style:{height:"100%",width:"100%",position:"absolute",top:0,left:0,color:"#ccc"},iconStyle:{fontSize:"18px"}}}};return n}),define("pages/moreTemplateBackUp",["../logic/moreTemplate","../parts/common","utils"],function(e,t,i){var n={pluginClass:e,style:{backgroundColor:t.backColor,overflowY:"auto"},root:["body"],components:{body:{type:"view",style:{flex:1,overflowY:"auto",overflowX:"hidden"},root:["searchInput","main_view"]},searchInput:{cancelBtnStyle:{color:"#37B7FD",fontSize:15},style:{backgroundColor:"#fff",borderBottom:"1px solid rgb(226, 232, 237)"},iconStyle:{},placeholder:"搜索标题",font:"ap_e903",ref:!0,type:"simplesearchview"},nodata:{ref:"true",type:"icon",text:"暂无内容",textPos:"bottom",src:"./imgs/yunshen_nodata.png?v=1",textStyle:{fontSize:"15px",color:"#ADADAD",paddingLeft:11,paddingTop:10},style:{width:"100%",alineItems:"center",justifyContent:"center",backgroundColor:"#F2F4F4",paddingTop:180},iconStyle:{w:80,h:80}},main_view:{type:"listview",nodata:"nodata",ref:!0,style:{fontSize:16,color:"#262626",flexWrap:"wrap",flexDirection:"column"},rowStyle:{width:"100%",height:"100%"},root:["template_item_title","template_item_repeat"]},template_item_title:{type:"text",ref:!0,text_bind:"category",textStyle:{fontSize:13,color:"#9E9E9E"},style:{width:"100%",height:"25px",padding:"6px 0 22px 12px",backgroundColor:"#F7F7F7",display:"block"}},template_item_repeat:{type:"repeat",style:{flexWrap:"wrap",backgroundColor:"#fff"},ref:!0,items_bind:"formList",itemStyle:{width:"100%",height:70,justifyContent:"center",alignItems:"flex-start",borderBottom:"1px solid #eee"},root:["template_item"]},template_item:{type:"view",style:{width:"100%",display:"flex",flexDirection:"row"},root:["template_item_icon","template_item_detail","right_btn"]},template_item_icon:{type:"icon",src_bind:"icon",iconStyle:{w:28,h:28},style:{w:70}},template_item_detail:{type:"view",style:{flex:1,height:"70px",flexDirection:"column",justifyContent:"center"},root:["right_title","right_introduce"]},right_title:{type:"text",ref:!0,text_bind:"title",numberofline:1,style:{height:16,lineHeight:16,width:"80%"},textStyle:{}},right_introduce:{type:"text",ref:!0,text_bind:"desc",numberofline:1,style:{marginTop:10,width:"80%"},textStyle:{fontSize:"13px",color:"#ADADAD"}},right_btn:{type:"button",text:"button",ref:!0,text_bind:"added",style:{color:"#FA4F52",display:"none",border:"1px solid #FA4F52",borderRadius:"5px",fontSize:"13px",width:"50px",height:"28",position:"absolute",top:"20px",right:"10px"}}}};return n}),define("logic/myapprove",["../parts/common","utils"],function(e,t){function i(e){this.pageview=e.pageview,this.countNum=this.pageview.params.countNum}return i.prototype={onPageResume:function(){window.changeFormStatus&&this.viewpager.curPageViewItem.contentInstance.refs.listview.loadFirstPageData({parentAnimate:!0}),this.setHeader()},setHeader:function(){var e="审批";"commonlist_myapproverunning"===window.pageViewTitle?e="我发起的":"commonlist_waitmyapprovedone"===window.pageViewTitle?e="我已审批":"commonlist_waitmyapprove"===window.pageViewTitle?e="待我审批":"commonlist_copyapprove"===window.pageViewTitle&&(e="抄送我的");try{window.yyesn.client.setHeader(function(){},{type:2,title:e,rightTitle:"",rightValues:[]},function(e){})}catch(e){}},loadNum:function(){},segment_item_init:function(e){var t=e.datasource.title;"进行中"===t&&(this.myapproveLabel=e,void 0!==this.countNum&&null!==this.countNum&&(e.config.text="进行中("+this.countNum+")"))},viewpager_init:function(e,t){this.viewpager=e},segment_change:function(e,t){if(!t.nochange){var i=t.item,n=i.datasource,a=n.title;"已完成"===a?this.viewpager.showItem("commonlist_myapprovedone",{type:"done"}):this.viewpager.showItem("commonlist_myapproverunning",{type:"waiting"})}}},i}),define("pages/myapprove",["../logic/myapprove","../parts/common","utils"],function(e,t,i){var n={pluginClass:e,style:{backgroundColor:t.backColor},root:["viewpager"],components:{segment:{type:"segment_android",items:[{title:"进行中"},{title:"已完成"}],root:["segment_item"],indicatorStyle:{backgroundColor:"#29B6F6"},style:{height:40,backgroundColor:"#fff"}},segment_item:{type:"text",text:"加载中...",text_bind:"title",selectedClassName:"ar-sgm-item-selected-android",style:{color:"#262626",fontSize:13,textAlign:"center",justifyContent:"center",width:"100%",borderRight:"1px solid #eee"}},viewpager:{type:"viewpager",defaultKey:"commonlist_myapproverunning",style:{flex:1}}}};return n}),define("logic/referenceList",["../parts/common","utils"],function(e,t){function i(e){this.pageview=e.pageview,this.params=this.pageview.showPageParams,this.referenceData=this.params.config.itemData,this.isMutiSelect=this.referenceData.isMutiSelect,this.parentThis=this.pageview.showPageParams.parent,this.listDataSource=[],this.searchValue="",this.setHeader(),this.searchKey=!0}return i.prototype={body_init:function(e){this.body=e},setHeader:function(){var e=this;try{window.yyesn.client.setHeader(function(){},{type:2,title:e.parentThis.itemData.title||"关联",rightTitle:"",rightValues:[]},function(e){})}catch(e){}},searchBtn_click:function(e,t){this.pageview.refs.leftview.$el.hide(),this.pageview.refs.searchInput.$el.show(),this.pageview.refs.searchInput._focus(),this.pageview.refs.approveSelector.hideDropDown()},searchInput_init:function(e,t){this.searchKey?e.config.style.display="show":e.config.style.display="none"},searchInput_cancel:function(e,t){var i=t.value;i&&(e.input.val(""),this.listviewSender.config.ajaxConfig.data.keyword="",this.pageview.refs.listview.loadFirstPageData({parentAnimate:!0})),this.pageview.refs.leftview.$el.show()},searchInput_search:function(e,t){this.listviewSender.config.ajaxConfig.data.keyword=t.value,this.pageview.refs.listview.loadFirstPageData({parentAnimate:!0})},onPageResume:function(){this.pageview.refs.listview.loadFirstPageData({parentAnimate:!0}),this.setHeader()},body_pulltorefresh:function(e,t){this.pageview.refs.listview.ajaxConfig.data.start=0,this.pageview.refs.listview.ajaxConfig.data.pageNum=1,this.pageview.refs.listview.setAjaxConfigParams(),this.pageview.refs.listview.loadFirstPageData()},body_reload:function(e){this.pageview.refs.listview.reload()},body_loadmore:function(e,t){this.pageview.refs.listview.ajaxConfig.data.size,this.pageview.refs.listview.ajaxConfig.data.start;this.pageview.refs.listview.ajaxConfig.data.pageNum++,this.pageview.refs.listview.setAjaxConfigParams(),this.pageview.refs.listview.loadNextPageData()},listview_rowclick:function(e,t){e.select(),this.isMutiSelect?this.pageview.delegate("bottom_left",function(t){t.setText("已选择 "+e.parent.selectedRows.length)}):(this.parentThis.afterClosePage(e.parent.selectedRows[0].datasource),this.pageview.close())},listview_parsedata:function(e,t){var i=t.data,n=this;return!!i.success&&(i.data=i.data?JSON.parse(i.data).data:[],i.data.forEach(function(e,t){var i=[];n.referenceData.contMetaOption.fieldIds.forEach(function(t,n){i.push({value:t.name+": "+e[t.fieldId],key:t.name})}),e.data=i,e.mutiSelect=n.isMutiSelect}),i.data||(i.data={list:[]}),i.data)},listview_init:function(e){var t=this;if(this.listviewSender=e,this.isMutiSelect?e.config.selectedMode="m":e.config.selectedMode="s",this.clientParam={},this.parentThis.itemData.linkageComponent){var i=window.linkageComponents[this.parentThis.itemData.linkageComponent];$.isArray(i)?i.forEach(function(e,i){t.clientParam.linkageField=t.parentThis.itemData.linkageField,t.clientParam.value=e.refcode}):(t.clientParam.linkageField=i.linkageField,t.clientParam.value=i.refcode)}e.config.ajaxConfig={url:"/iref_ctr/ref",type:"POST",pageSize:20,pageNumKey:"index",data:{refCode:"formref",transmitParam:JSON.stringify({pk_bo:t.referenceData.pk_bo,relate_pk_bo:t.referenceData.contMeta,fieldId:t.referenceData.fieldId,formName:t.referenceData.contMetaName,hasLinkage:t.referenceData.hasLinkage,contMetaOption:t.referenceData.contMetaOption.fieldIds}),cfgParam:JSON.stringify({isMultiSelectedEnabled:t.isMutiSelect,isCheckListEnabled:!1}),clientParam:JSON.stringify(this.clientParam),pageSize:20,index:1}},e.config.autoLoadData=!0},listview_rowinit:function(e,t){this.parentThis.selectedData&&(this.isMutiSelect?this.parentThis.selectedData.forEach(function(t,i){e.datasource.refcode===t.refcode&&setTimeout(function(){e.select()},100)}):e.datasource.refcode===this.parentThis.selectedData.refcode&&setTimeout(function(){e.select()},100))},row_left_repeat_init:function(e,t){e.bindData(e.datasource.data)},row_right_statusview_didmount:function(e,t){e.datasource.mutiSelect&&e.change("row_right_checkbox")},bottom_init:function(e,t){this.isMutiSelect?e.config.style.display="flex":e.config.style.display="none"},bottom_right_btn_click:function(e,t){var i=[];this.pageview.refs.listview.selectedRows.forEach(function(e,t){i.push(e.datasource)}),this.parentThis.afterClosePage(i),this.pageview.close()},bottom_left_init:function(e,t){this.parentThis.selectedData&&this.isMutiSelect&&(e.config.text="已选择 "+this.parentThis.selectedData.length)}},i}),define("pages/referenceList",["../logic/referenceList","../parts/common","utils"],function(e,t,i){var n={pluginClass:e,style:{backgroundColor:t.backColor},root:["body","bottom"],components:{body:{type:"view",style:{flex:1,overflowX:"hidden",overflowY:"auto"},root:["listview"]},searchInput:{cancelBtnStyle:{color:"#37B7FD",fontSize:15},style:{backgroundColor:"#fff",display:"none",borderBottom:"1px solid rgb(226, 232, 237)"},iconStyle:{},placeholder:"搜索标题",font:"ap_e903",ref:!0,type:"simplesearchview"},nodata:{ref:"true",type:"icon",text:"暂无内容",textPos:"bottom",src:"./imgs/yunshen_nodata.png?v=1",textStyle:{fontSize:"15px",color:"#ADADAD",paddingLeft:11,paddingTop:10},style:{width:"100%",alineItems:"center",justifyContent:"center",backgroundColor:"#F7F7F7",paddingTop:180},iconStyle:{w:80,h:80}},listview:{ref:!0,type:"listview",nodata:"nodata",rowStyle:{flexDirection:"row",paddingTop:12,paddingBottom:12,borderBottom:"1px solid #eee"},style:{flexDirection:"column"},root:["row_left_repeat","row_right_statusview"]},row_left_repeat:{type:"repeat",root:["row_text_repeat_item"],style:{flexDirection:"column",marginLeft:15}},row_text_repeat_item:{type:"text",text_bind:"value",style:{fontSize:14}},row_right_statusview:{type:"statusview",ref:!0,defaultKey:"row_right_radiobox",style:{flex:1,width:100,alignItems:"center",justifyContent:"flex-end",paddingRight:15}},row_right_checkbox:{type:"checkbox"},row_right_radiobox:{type:"radiobox",style:{},radioStyle:{},selectedRadioStyle:{fontSize:22}},bottom:{type:"view",style:{display:"none",height:60,borderTop:"1px solid #ddd",backgroundColor:"#fff",flexDirection:"row",alignItems:"center"},root:["bottom_left","bottom_right"]},bottom_left:{type:"text",text:"已选择 0",ref:!0,style:{alignItems:"flex-start",fontSize:15,color:"#333",marginLeft:15,justifyContent:"center"}},bottom_right:{type:"view",root:["bottom_right_btn"],style:{flex:1,alignItems:"flex-end"}},bottom_right_btn:{type:"button",text:"确定",mode:2,style:{backgroundColor:"#29B6F6",color:"#fff",height:35,width:62,marginRight:15}}}};return n}),define("logic/selectApprovers",["../parts/common","utils"],function(e,t){function i(e){this.pageview=e.pageview,this.params=this.pageview.params,this.setHeader()}return i.prototype={body_init:function(e){this.body=e},loadData:function(){this.pageview.delegate("list_repeat",function(e){var t=this.pageview.showPageParams.approverList.participants;e.bindData(t)})},setHeader:function(){var e="选择审批人";try{window.yyesn.client.setHeader(function(){},{type:2,title:e,rightTitle:"",rightValues:[]},function(e){})}catch(e){}},list_repeat_init:function(e,t){var i=this.pageview.showPageParams.approverList.participants;e.bindData(i)},list_repeat_item_init:function(e,t){},list_repeat_itemclick:function(e,t){e.select()},bottom_submit_click:function(e,t){var i=this.processSubmitData(e.parent.components.list_repeat.selectedItems),n=this.pageview.showPageParams.dealLogic;n.hasSelectData=i,n.hasSelectIndex=this.pageview.showPageParams.index,this.pageview.goBack()},processSubmitData:function(e){var t=[];return e.forEach(function(e,i){t.push(e.datasource)}),t},onPageResume:function(){this.setHeader(),this.loadData()}},i}),define("pages/selectApprovers",["../logic/selectApprovers","../parts/common","utils"],function(e,t,i){var n={pluginClass:e,style:{backgroundColor:t.backColor},root:["body"],components:{body:{type:"view",style:{flex:1,overflowY:"auto",overflowX:"hidden"},root:["list_repeat","bottom_submit"]},list_repeat:{ref:!0,type:"repeat",selectedMode:"m",root:["list_repeat_item"],style:{flexDirection:"column",marginTop:15,paddingLeft:15,backgroundColor:"#fff"},itemStyle:{borderBottom:"1px solid #eee"}},list_repeat_item:{type:"view",itemSelectClassName:"list_repeat_item_select",root:["list_repeat_item_left","list_repeat_item_middle","list_repeat_item_right"],style:{flexDirection:"row",width:"100%",height:65,alignItems:"center"}},list_repeat_item_left:{type:"image",src_bind:"pic",title_bind:"name",style:{height:40,width:40,marginRight:13,borderRadius:"50%"}},list_repeat_item_middle:{type:"text",text_bind:"name",style:{fontSize:16,color:"#262626",flex:1}},list_repeat_item_right:{type:"checkbox",style:{width:20,height:20,marginRight:13}},bottom_submit:{type:"button",mode:2,text:"确定",style:{height:40,backgroundColor:"#37b7fd",color:"#fff",width:"100%",position:"absolute",bottom:0,borderRadius:0}}}};return n}),define("pages/setApprovers",["../logic/additionApproval","../parts/common","utils"],function(e,t,i){var n={pluginClass:e,style:{backgroundColor:t.backColor,overflow:"auto"},root:["body"],components:{body:{type:"view",style:{padding:15,color:"#999"},root:["title","titleLable","titleLable1","contentText","contentImage","contentText1","contentText2","contentText3","contentImage1","titleLable2","titleLable3","contentText4","contentText5","contentImage2","contentImage3","titleLable4","contentText6","contentText7","contentImage4","contentText8","contentImage5","contentText9"]},title:{type:"text",text:"如何设置审批流程",style:{fontSize:17,color:"#000",margin:"auto",fontWeight:"bold"}},titleLable:{type:"text",text:"提供两种审批人设置方式：",style:{fontSize:14,marginTop:15}},titleLable1:{type:"text",text:"一、自由设置：自由设置顾名思义就是想怎么选就怎么选，完全没有任何限制。发起人在发起审批的时候选择自己想要制定的审批人，数量不限。这个方式非常适合权限划分不是非常清晰的中小企业，因为他们公司结构比较简单，用起来非常便捷。",style:{fontSize:14,marginTop:15}},titleLable2:{type:"text",text:"二、预设审批人：管理员按照公司的规章制度在审批单里预先设置好审批人，可以根据公司的管理层级来设定，也可以制定某一个人为审批人。",style:{fontSize:14,marginTop:15}},titleLable3:{type:"text",text:"A、不分条件审批人",style:{fontSize:14,marginTop:15}},titleLable4:{type:"text",text:"B、分条件审批人",style:{fontSize:14,marginTop:15}},contentText:{type:"text",text:"1、打开“报销审批”，我们一起来填写这份报销审批",style:{fontSize:14,margin:"15px 0"}},contentText1:{type:"text",text:"2、内容填写好以后点击“添加审批人”",style:{fontSize:14,marginTop:15}},contentText2:{type:"text",text:"3、选择审批人，可以反复添加多个",style:{fontSize:14,marginTop:15}},contentText3:{type:"text",text:"4、选择的审批人会显示在请假审批页中，点击提交就可以了",style:{fontSize:14,margin:"15px 0"}},contentText4:{type:"text",text:"1、进入“审批”应用，点击“审批人”进入审批人设置页",style:{fontSize:14,marginTop:15}},contentText5:{type:"text",text:"2、点击“添加”或者“设置”即可选择审批人，在移动端则显示指定的审批人",style:{fontSize:14,margin:"15px 0"}},contentText6:{type:"text",text:"1、进入审批人设置页面，点击“分条件设置审批人”，如果该审批表单包含一下表单项，则可设置条件：时间段、金额、数字且均未必填，明细组件内部有时间段、金额、数字且内部统计",style:{fontSize:14,marginTop:15}},contentText7:{type:"text",text:"2、选择一个条件，输入该条件各个数值，点击完成即可进入下一步；以时长为例，我们设置“4<10”",style:{fontSize:14,margin:"15px 0"}},contentText8:{type:"text",text:"3、可以看到时长就被划分为三段，一段以时长小于4，一段时长大于等于4小于等于10，一段时长大于10。我们可以理解为时长小于4时走第一段的审批人流程，大于等于4小于等于10时走第二段审批人流程，大于10时走第三段审批人流程",style:{fontSize:14,margin:"15px 0"}},contentText9:{type:"text",text:"4、只可设置一个条件为分条件审批人",style:{fontSize:14,margin:"15px 0"}},contentImage:{type:"image",src:"./imgs/help/2.1.png",style:{margin:"auto"}},contentImage1:{type:"image",src:"./imgs/help/2.2.png",style:{margin:"auto"}},contentImage2:{type:"image",src:"./imgs/help/2.3.png",style:{margin:"auto"}},contentImage3:{type:"image",src:"./imgs/help/2.4.png",style:{margin:"auto"}},contentImage4:{type:"image",src:"./imgs/help/2.5.png",style:{margin:"auto"}},contentImage5:{type:"image",src:"./imgs/help/2.6.png",style:{margin:"auto"}}}};return n}),define("logic/subformDetail",["../parts/currency","utils","../parts/format"],function(e,t,i){function n(e){this.pageview=e.pageview,this.currentId=this.pageview.params.id,window._applyHistory=JSON.parse(localStorage.getItem("_applyHistory")),this.bpmActivityForms=window._applyHistory.bpmActivityForms,this.itemNum=1,this.classContent={"alert-none":{color:"rgb(85, 85, 85)","border-color":"rgb(204, 204, 204)"},"alert-success":{color:"rgb(60, 118, 61)","background-color":"rgb(223, 240, 216)"},"alert-info":{color:"rgb(49, 112, 143)","background-color":"rgb(217, 237, 247)"},"alert-warning":{color:"rgb(138, 109, 59)","background-color":"rgb(252, 248, 227)"},"alert-danger":{color:"rgb(169, 68, 66)","background-color":"rgb(242, 222, 222)"}}}return n.prototype={body_init:function(e,t){for(var i=0,n=window._applyHistory.formDataMap[this.currentId],a=0;a<this.bpmActivityForms.length;a++)if(this.currentId===this.bpmActivityForms[a].id){i=a;break}for(var o=[],s={},r=this.bpmActivityForms?this.bpmActivityForms[i].fields:[],l=0;l<r.length;l++){s={};var c=JSON.parse(r[l].fieldContent),p=JSON.parse(r[l].variableContent),d=p.name?p.name:"未命名";if(s.title=d+": ",s.type=p.type.name,n.length>0&&n[0][r[l].tableFieldName]&&(s.content=n[0][r[l].tableFieldName]),c.keyFeatures){var h=s.content;"boolean"===s.type&&(h="1"===s.content?"是":"否")}o.push(s)}for(var u=[],f=this.bpmActivityForms?this.bpmActivityForms[i].subForms:[],g=0;g<f.length;g++){var m={},y=f[g]?f[g].fields:[];m.title=f[g].title,m.item=[];for(var v=0;v<y.length;v++){var w=JSON.parse(y[v].variableContent),x=w.name?w.name:"未命名",b=w.type.name,_=n>0&&n[0][y[v].tableFieldName]?n[0][y[v].tableFieldName]:"";m.item.push({name:x+"：",type:b,content:_})}u.push(m)}this.pageview.delegate("detail_repeat",function(e){e.bindData(o)}),this.pageview.delegate("subform_repeat",function(e){e.bindData(u)})},detail_item_content_init:function(i,n){var a=i.datasource.type;switch(a){case"link":i.config.style.color="#0093ff";break;case"date":"datetime"===i.datasource.kind?i.config.text=i.config.text?t.ConvertDateToStr(i.config.text,"yyyy-MM-dd hh:mm:ss"):"":"time"===i.datasource.kind?i.config.text=i.config.text?t.ConvertDateToStr(i.config.text,"hh:mm:ss"):"":i.config.text=i.config.text?t.ConvertDateToStr(i.config.text,"yyyy-MM-dd"):"";break;case"user":var o=i.config.text,s={url:"/user/getUserInfo",type:"POST",data:{userId:o||""},success:function(e){0===e.code&&i.setText(e.data.userName)},error:function(e){}};this.pageview.ajax(s);break;case"money":var r=JSON.parse(i.config.text),l=e.getCurrencyName(r.currency);i.config.text=r.amount+" "+l.name;break;case"boolean":var c="1"===i.datasource.content?"是":"否";i.config.text=c;break;case"Paragraph":i.$el.css(this.classContent[i.datasource.style]),i.config.text=" "+i.datasource.content;break;case"file":i.$el.hide()}},detail_repeat_iteminit:function(e,t){"file"===e.datasource.type&&e.$el.hide()},detail_repeat_itemclick:function(e,t){"link"===e.datasource.type&&window.open(e.datasource.content,"_self")},detail_item_title_init:function(e,t){"file"===e.datasource.type?(e.config.style.minHeight=30,e.config.style.backgroundColor="rgb(251,251,251)"):"Paragraph"===e.datasource.type&&e.$el.hide()},detail_view_init:function(e,t){"file"===e.datasource.type&&e.$el.css({"flex-direction":"column",width:"100%"})},detail_item_files_init:function(e,t){var i=e;if("file"===e.rowInstance.datasource.type){var n={url:"/process/getInstanceAttachments",type:"POST",data:{fileIds:e.rowInstance.datasource.content||""},success:function(e){0===e.code&&i.bindData(e.data)},error:function(e){}};this.pageview.ajax(n)}else e.config.style.display="none"},detail_item_files_itemclick:function(e,t){var i=e.datasource.type,n=e.datasource.name.split("_");n[n.length-1];if(i.indexOf("image")>-1)try{window.yyesn.client.viewImage({files:e.datasource.aliOSSUrl})}catch(e){}else console.log("下载")},detail_files_view_left_init:function(e,t){var n=e.datasource.type||"unknow";e.config.src="./imgs/"+i.getFormat(n).ext},subform_view_title_init:function(e,t){e.config.preText=this.itemNum,this.itemNum++},subform_view_item_init:function(e,t){e.bindData(e.rowInstance.datasource.item)}},n}),define("pages/subformDetail",["../logic/subformDetail","../parts/common"],function(e,t){var i={pluginClass:e,style:{backgroundColor:t.backColor},root:["body"],components:{body:{type:"view",root:["detail_repeat","subform_repeat"],style:{"flex-direction":"column"}},subform_repeat:{type:"repeat",ref:!0,root:["subform_view"],style:{display:"inline",width:"100%",backgroundColor:"#fff"},itemStyle:{borderBottom:"solid 1px #EDEDED",minHeight:40,flexDirection:"row"}},subform_view:{type:"view",root:["subform_view_title","subform_view_item"],style:{flexDirection:"column",width:"100%"}},subform_view_title:{type:"text",text_bind:"title",preText:"1",preTextStyle:{backgroundColor:"#F39801",color:"rgb(255, 255, 255)",borderRadius:"50%",fontSize:12,w:15,lineHeight:14,marginRight:4,textAlign:"center"},style:{backgroundColor:"rgb(251,251,251)",color:"#9E9E9E",fontSize:13,paddingLeft:14,height:40}},subform_view_item:{type:"repeat",root:["subform_view_item_title","subform_view_item_content"],style:{display:"inline",width:"100%",backgroundColor:"#fff"},itemStyle:{minHeight:30,flexDirection:"row"}},subform_view_item_title:{type:"text",text_bind:"name",style:{color:"#9E9E9E",fontSize:13,paddingLeft:14}},subform_view_item_content:{type:"text",text_bind:"content",
style:{color:"#262626",fontSize:13}},detail_repeat:{type:"repeat",ref:!0,root:["detail_view"],style:{display:"inline",width:"100%",backgroundColor:"#fff",marginTop:10},itemStyle:{borderBottom:"solid 1px #EDEDED",minHeight:40,flexDirection:"row",widht:"100%"}},detail_view:{type:"view",root:["detail_item_title","detail_item_content","detail_item_files"],style:{flexDirection:"row",width:"100%"}},detail_item_title:{type:"text",text:"title:",text_bind:"title",style:{color:"#9E9E9E",fontSize:13,paddingLeft:14,paddingRight:20,widht:"100%"}},detail_item_content:{type:"text",text:"content",text_bind:"content",numberofline:1,style:{flex:1,color:"#262626",fontSize:13}},detail_item_files:{type:"repeat",ref:!0,root:["detail_files_view"],style:{display:"inline",width:"100%",backgroundColor:"#fff"},itemStyle:{height:40,flexDirection:"row"}},detail_files_view:{type:"view",style:{flexDirection:"row",width:"100%"},root:["detail_files_view_left","detail_files_view_right"]},detail_files_view_left:{type:"image",style:{w:34,margin:"4px 8px 0 10px"},src:"./imgs/link.png"},detail_files_view_right:{type:"text",text_bind:"name",numberofline:1,style:{flex:1,color:"#262626",fontSize:13,paddingRight:10}}}};return i}),define("logic/subformList",["../parts/currency","utils"],function(e,t){function i(e){this.pageview=e.pageview,this.currentId=this.pageview.params.id,console.log(window._applyHistory)}return i.prototype={list_repeat_init:function(e,t){e.bindData(window._applyHistory.bpmActivityForms)},list_repeat_itemclick:function(e,t){this.pageview.go("subformDetail",{id:e.datasource.id})}},i}),define("pages/subformList",["../logic/subformList","../parts/common"],function(e,t){var i={pluginClass:e,style:{backgroundColor:t.backColor},root:["body"],components:{body:{type:"view",root:["list_repeat"]},list_repeat:{type:"repeat",ref:!0,root:["list_view"],style:{display:"inline",width:"100%",backgroundColor:"#fff",marginTop:10},itemStyle:{borderBottom:"solid 1px #EDEDED",height:40,flexDirection:"row"}},list_view:{type:"view",root:["list_item_left","list_item_right","rp_right_icon"],style:{width:"100%",flexDirection:"row"}},list_item_left:{type:"text",text:"title:",text_bind:"title",style:{color:"#262626",fontSize:14,flex:1,paddingLeft:14}},list_item_right:{type:"text",text:" ",style:{color:"#ADADAD",fontSize:14,flex:1,justifyContent:"flex-end"}},rp_right_icon:{type:"icon",iconStyle:{fontSize:14,color:"#ccc"},style:{width:30},font:"cap_e901"}}};return i}),define("logic/thanks",[],function(){function e(e){this.pageview=e.pageview}return e.prototype={},e}),define("pages/thanks",["../logic/thanks","../parts/common","utils"],function(e,t,i){var n={pluginClass:e,style:{backgroundColor:t.backColor},root:["body"],components:{body:{type:"view",style:{flex:1,backgroundColor:"#fff",alignItems:"center"},root:["body_top","body_middle","body_bottom"]},body_top:{type:"icon",font:"cap_e90a",style:{fontSize:93,marginTop:50,marginBottom:30,width:100,height:100,borderRadius:"50%"},iconStyle:{fontSize:93,color:"#09BB07"}},body_middle:{type:"text",text:"感谢您的填写",style:{marginBottom:5,fontWeight:400,fontSize:20}},body_bottom:{type:"text",text:"由 <span style='color: #29b6f6'>用友云表单</span> 提供支持",style:{position:"absolute",textAlign:"center",width:"100%",bottom:0,left:0,right:0,margin:"auto",marginBottom:20,fontSize:14,color:"#666"},textStyle:{width:"100%"}}}};return n}),define("logic/waitmeapprove",["../parts/common","utils"],function(e,t){function i(e){this.pageview=e.pageview,this.countNum=this.pageview.params.countNum,this.loadNum()}return i.prototype={onPageResume:function(){window.changeFormStatus&&this.viewpager.curPageViewItem.contentInstance.refs.listview.loadFirstPageData({parentAnimate:!0}),this.loadNum(),this.setHeader()},setHeader:function(){var e="审批";"commonlist_myapproverunning"===window.pageViewTitle?e="我发起的":"commonlist_waitmyapprovedone"===window.pageViewTitle?e="我已审批":"commonlist_waitmyapprove"===window.pageViewTitle?e="待我审批":"commonlist_copyapprove"===window.pageViewTitle&&(e="抄送我的");try{window.yyesn.client.setHeader(function(){},{type:2,title:e,rightTitle:"",rightValues:[]},function(e){})}catch(e){}},loadNum:function(){var e=this;this.pageview.ajax({type:"GET",url:"/process/myDataCount",data:{},success:function(t){0===t.code&&void 0!==t.data.todo&&null!==t.data.todo&&e.waitmeapproveLabel.setText("待我审批("+t.data.todo+")")},error:function(e){}})},searchview_init:function(e,t){this.searchview=e,window.pageViewTitle?(e.config.style.display="none","commonlist_waitmyapprove"===window.pageViewTitle&&(e.config.style.display="block")):e.config.style.display="block"},segment_item_init:function(e){var t=e.datasource.title;"待我审批"===t&&(this.waitmeapproveLabel=e,void 0!==this.countNum&&null!==this.countNum&&(e.config.text="待我审批("+this.countNum+")"))},viewpager_init:function(e,t){this.viewpager=e},segment_change:function(e,t){if(!t.nochange){var i=t.item,n=i.datasource,a=n.title;"我已审批"===a?(this.searchview.$el.hide(),this.pageview.refs.approveSelector.hideDropDown(),this.viewpager.showItem("commonlist_waitmyapprovedone",{type:"done"})):(this.searchview.$el.show(),this.viewpager.showItem("commonlist_waitmyapprove",{type:"waiting"}))}},searchBtn_click:function(e,t){this.pageview.refs.leftview.$el.hide(),this.pageview.refs.searchInput.$el.show(),this.pageview.refs.searchInput._focus(),this.pageview.refs.approveSelector.hideDropDown()},searchInput_cancel:function(e,t){var i=t.value;(i||this.searchValue)&&(this.searchValue=!1,e.input.val(""),this.viewpager.curPageViewItem.contentInstance.refs.listview.config.ajaxConfig.data.keyword="",this.viewpager.curPageViewItem.contentInstance.refs.listview.loadFirstPageData({parentAnimate:!0})),this.pageview.refs.leftview.$el.show(),this.pageview.refs.searchInput.$el.hide()},searchInput_search:function(e,t){t.value&&(this.searchValue=!0),this.viewpager.curPageViewItem.contentInstance.refs.listview.config.ajaxConfig.data.categoryIds=null,this.viewpager.curPageViewItem.contentInstance.refs.listview.config.ajaxConfig.data.keyword=t.value,this.viewpager.curPageViewItem.contentInstance.refs.listview.loadFirstPageData({parentAnimate:!0})},approveSelector_menu1_loaddata:function(e,t){var i=t.success,n=(t.error,[{name:"全部时间",id:"taskTime_all",group:"taskTime"},{name:"今天",id:"taskTime_today",group:"taskTime"},{name:"昨天",id:"taskTime_yesterday",group:"taskTime"},{name:"两天前",id:"taskTime_2more",group:"taskTime"}]);i(n)},approveSelector_menu0_loaddata:function(e,t){var i=t.success,n=(t.error,[{name:"全部状态",id:"dueDate_all",group:"dueDate"},{name:"正常",id:"dueDate_normal",group:"dueDate"},{name:"逾期",id:"dueDate_overdue",group:"dueDate"}]);i(n)},approveSelector_menu2_loaddata:function(e,t){var i=t.success,n=(t.error,this);window.setTimeout(function(){var e={url:"/process/category",type:"POST",data:{},success:function(e){for(var t=[{name:"全部类型",id:"",group:"type"}],n=0;n<e.data.length;n++){var a={name:e.data[n].name,id:e.data[n].id,group:"type"};t.push(a)}i(t)},error:function(e){}};n.pageview.ajax(e)})},approveSelector_menu0_itemClick:function(e,t){e.rootInstance.hideDropDown(),this.viewpager.curPageViewItem.contentInstance.refs.listview.config.ajaxConfig.data.taskDue=e.curSelectedItem.data.id,this.viewpager.curPageViewItem.contentInstance.refs.listview.loadFirstPageData({parentAnimate:!0})},approveSelector_menu1_itemClick:function(e,t){e.rootInstance.hideDropDown(),this.viewpager.curPageViewItem.contentInstance.refs.listview.config.ajaxConfig.data.taskDate=e.curSelectedItem.data.id,this.viewpager.curPageViewItem.contentInstance.refs.listview.loadFirstPageData({parentAnimate:!0})},approveSelector_menu2_itemClick:function(e,t){e.rootInstance.hideDropDown(),this.viewpager.curPageViewItem.contentInstance.refs.listview.config.ajaxConfig.data.categoryIds=e.curSelectedItem.data.id,this.viewpager.curPageViewItem.contentInstance.refs.listview.loadFirstPageData({parentAnimate:!0})}},i}),define("pages/waitmeapprove",["../logic/waitmeapprove","../parts/common","utils"],function(e,t,i){var n={pluginClass:e,style:{backgroundColor:t.backColor},root:["segment","searchview","viewpager"],components:{segment:{type:"segment_android",items:[{title:"待我审批"},{title:"我已审批"}],root:["segment_item"],className:"bottom-half-line",indicatorStyle:{backgroundColor:"#29B6F6"},style:{height:40,backgroundColor:"#fff"}},segment_item:{type:"text",text:"加载中...",text_bind:"title",selectedClassName:"ar-sgm-item-selected-android",className:"right-half-line",style:{color:"#262626",fontSize:13,textAlign:"center",justifyContent:"center",width:"100%"}},viewpager:{type:"viewpager",defaultKey:"commonlist_waitmyapprove",style:{flex:1}},searchview:{type:"view",root:["leftview","searchInput"],style:{width:"100%"}},leftview:{type:"view",ref:!0,root:["selectItem","searchBtn"]},selectItem:{type:"view",ref:!0,root:["approveSelector"],style:{background:"#fff",width:331}},approveSelector:{type:"conditionselector",mode:1,ref:!0,menu1ClassName:"approveSelector bottom-half-line",style:{backgroundColor:"#fff",borderBottom:"solid 1px #F7F7F7"},items:["全部状态","全部时间","全部类型"],menu0LabelKey:"name",menu1LabelKey:"name",menu2LabelKey:"name",menu0selectedKey:0,menu1selectedKey:0,menu2selectedKey:0,menu2LeftStyle:{width:90},menu1Style:{minHeight:40},menu2Style:{minHeight:40},menu0Style:{minHeight:40},menu0Col:2},searchBtn:{type:"icon",ref:!0,font:"cap_e90c",iconStyle:{fontSize:20},style:{borderBottom:"solid 1px #F7F7F7",backgroundColor:"#fff",color:"#ccc",width:45,position:"absolute",right:0,top:0,bottom:0}},searchInput:{cancelBtnStyle:{color:"#37B7FD",fontSize:15},style:{backgroundColor:"#fff",display:"none"},iconStyle:{},placeholder:"搜索标题",font:"ap_e903",ref:!0,type:"simplesearchview"}}};return n});var Brigdge=function(e){var t=window.navigator.userAgent,i={_initialized:!1,ios:/iPhone|iPad|iPod/i.test(t),android:/Android/i.test(t),readycallback:[]},n=function(t){var n=function(a,o,s){if(i._initialized){if(a||(a=function(e){}),"object"==typeof a&&(o=a,a=function(e){}),s&&"function"==typeof s&&t.parameters&&t.parameters.callback){var r=t.parameters.callback;e.WebViewJavascriptBridge.registerHandler(r,s)}if(s&&"function"==typeof s&&s(e.WebViewJavascriptBridge),o&&"object"==typeof o)if(t.parameters)for(var l in o)t.parameters[l]=o[l];else t.parameters=o;e.WebViewJavascriptBridge.send(JSON.stringify(t),function(e){a(JSON.parse(e))})}else i.readycallback.push({func:n,args:arguments}),console.log("js bridge has not been initialized yet.")};return n},a=function(e){var t={client:{hiddenMenu:{function:"hiddenMenu"},closePage:{function:"closePage"},setHeader:{function:"navRightItemList"},scanQRCode:{function:"scanQRCode",parameters:{type:0,callback:"scanQRCodeCallback"}},scanQRCodeMore:{function:"scanQRCode",parameters:{type:1,callback:"scanQRCodeCallback"}},openWindow:{function:"openWindow"},selectDate:{function:"selectDate"},selectList:{function:"selectList"},selectAttachment:{function:"selectAttachment"},selectCity:{function:"selectCity"},selectMap:{function:"selectMap"},copyText:{function:"copyText"},configNavigationBar:{function:"configNavigationBar"},share:{function:"share"},viewOrDeleteImage:{function:"viewOrDeleteImage"},viewImage:{function:"viewImage"}},enterprise:{openApp:{function:"openAPP"},selectContacts:{function:"selectContacts"},callUer:{function:"callUer"},bindPhone:{function:"bindPhone"},feedReply:{function:"feedReply"},sendMemail:{function:"sendMemail"},sendMessage:{function:"sendMessage"},callUsers:{function:"callUsers"},selectGroup:{function:"selectGroup"},selectDepartmentForVerify:{function:"selectDepartmentForVerify"},processAt:{function:"processAt"},viewUser:{function:"viewUser"},openChatWindow:{function:"openChatWindow"},createFeed:{function:"createFeed"},previewFile:{function:"previewFile"},viewTaskLog:{function:"viewTaskLog"},viewTaskUser:{function:"viewTaskUser"},createOredit:{function:"createOredit"},taskComment:{function:"taskComment"},feedDataUpdate:{function:"feedDataUpdate"},fileBrowser:{function:"fileBrowser"}}};for(var i in t){e[i]={};for(var a in t[i]){var o=t[i][a];e[i][a]=n(o)}}},o=function(e){window.WebViewJavascriptBridge?e(WebViewJavascriptBridge):document.addEventListener("WebViewJavascriptBridgeReady",function(){e(WebViewJavascriptBridge)},!1)};return o(function(t){t.init(function(e,t){}),e.WebViewJavascriptBridge||(e.WebViewJavascriptBridge=t),i._initialized=!0,i.readycallback&&(i.readycallback.forEach(function(e){0==e.args.length?e.func():1==e.args.length?e.func(e.args[0]):2==e.args.length?e.func(e.args[0],e.args[1]):3==e.args.length&&e.func(e.args[0],e.args[1],e.args[2])}),i.readycallback=[])}),a(i),e.yyesn=i,i};Brigdge(window),define("libs/bridge",function(){});